



<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#FFF">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">

<link rel="icon" type="image/ico" sizes="32x32" href="/images/favicon.ico">
  <meta http-equiv="Cache-Control" content="no-transform">
  <meta http-equiv="Cache-Control" content="no-siteapp">


<link rel="alternate" type="application/rss+xml" title="我知这世界本如露水般短暂 然而 然而" href="https://lhchen74.github.io/rss.xml" />
<link rel="alternate" type="application/atom+xml" title="我知这世界本如露水般短暂 然而 然而" href="https://lhchen74.github.io/atom.xml" />
<link rel="alternate" type="application/json" title="我知这世界本如露水般短暂 然而 然而" href="https://lhchen74.github.io/feed.json" />

<link rel="stylesheet" href="//fonts.googleapis.com/css?family=Mulish:300,300italic,400,400italic,700,700italic%7CFredericka%20the%20Great:300,300italic,400,400italic,700,700italic%7CNoto%20Serif%20JP:300,300italic,400,400italic,700,700italic%7CNoto%20Serif%20SC:300,300italic,400,400italic,700,700italic%7CInconsolata:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext">

<link rel="stylesheet" href="/css/app.css?v=0.2.5">

  
  <meta name="keywords" content="node" />


<link rel="canonical" href="https://lhchen74.github.io/2019/10/26/node-jsonserver/">



  <title>
json-server 详解 |
露の世 = 我知这世界本如露水般短暂 然而 然而</title>
<meta name="generator" content="Hexo 5.4.0"></head>
<body itemscope itemtype="http://schema.org/WebPage">
  <div id="loading">
    <div class="cat">
      <div class="body"></div>
      <div class="head">
        <div class="face"></div>
      </div>
      <div class="foot">
        <div class="tummy-end"></div>
        <div class="bottom"></div>
        <div class="legs left"></div>
        <div class="legs right"></div>
      </div>
      <div class="paw">
        <div class="hands left"></div>
        <div class="hands right"></div>
      </div>
    </div>
  </div>
  <div id="container">
    <header id="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="inner">
        <div id="brand">
          <div class="pjax">
          
  <h1 itemprop="name headline">json-server 详解
  </h1>
  
<div class="meta">
  <span class="item" title="Created: 2019-10-26 00:00:00">
    <span class="icon">
      <i class="ic i-calendar"></i>
    </span>
    <span class="text">Posted on</span>
    <time itemprop="dateCreated datePublished" datetime="2019-10-26T00:00:00+08:00">2019-10-26</time>
  </span>
</div>


          </div>
        </div>
        <nav id="nav">
  <div class="inner">
    <div class="toggle">
      <div class="lines" aria-label="Toggle navigation bar">
        <span class="line"></span>
        <span class="line"></span>
        <span class="line"></span>
      </div>
    </div>
    <ul class="menu">
      <li class="item title"><a href="/" rel="start">露の世</a></li>
    </ul>
    <ul class="right">
      <li class="item theme">
        <i class="ic i-sun"></i>
      </li>
      <li class="item search">
        <i class="ic i-search"></i>
      </li>
    </ul>
  </div>
</nav>

      </div>
      <div id="imgs" class="pjax">
        <ul>
          <li class="item" data-background-image="https://tva4.sinaimg.cn/large/6833939bly1gicitspjpbj20zk0m81ky.jpg"></li>
          <li class="item" data-background-image="https://tva4.sinaimg.cn/large/6833939bly1gicitzannuj20zk0m8b29.jpg"></li>
          <li class="item" data-background-image="https://tva4.sinaimg.cn/large/6833939bly1giclhfehz7j20zk0m8u0x.jpg"></li>
          <li class="item" data-background-image="https://tva4.sinaimg.cn/large/6833939bly1giph4lm9i7j20zk0m84qp.jpg"></li>
          <li class="item" data-background-image="https://tva4.sinaimg.cn/large/6833939bly1gipexoj0moj20zk0m8kgu.jpg"></li>
          <li class="item" data-background-image="https://tva4.sinaimg.cn/large/6833939bly1gicm0fdw5cj20zk0m8hdt.jpg"></li>
        </ul>
      </div>
    </header>
    <div id="waves">
      <svg class="waves" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 24 150 28" preserveAspectRatio="none" shape-rendering="auto">
        <defs>
          <path id="gentle-wave" d="M-160 44c30 0 58-18 88-18s 58 18 88 18 58-18 88-18 58 18 88 18 v44h-352z" />
        </defs>
        <g class="parallax">
          <use xlink:href="#gentle-wave" x="48" y="0" />
          <use xlink:href="#gentle-wave" x="48" y="3" />
          <use xlink:href="#gentle-wave" x="48" y="5" />
          <use xlink:href="#gentle-wave" x="48" y="7" />
        </g>
      </svg>
    </div>
    <main>
      <div class="inner">
        <div id="main" class="pjax">
          
  <div class="article wrap">
    
<div class="breadcrumb" itemscope itemtype="https://schema.org/BreadcrumbList">
<i class="ic i-home"></i>
<span><a href="/">Home</a></span>
</div>

    <article itemscope itemtype="http://schema.org/Article" class="post block" lang="en">
  <link itemprop="mainEntityOfPage" href="https://lhchen74.github.io/2019/10/26/node-jsonserver/">

  <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
    <meta itemprop="image" content="/images/avatar.jpg">
    <meta itemprop="name" content="江边鸟">
    <meta itemprop="description" content=", ">
  </span>

  <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
    <meta itemprop="name" content="我知这世界本如露水般短暂 然而 然而">
  </span>

  <div class="body md" itemprop="articleBody">
    

    <p>JSON-Server 是一个 Node 模块，运行 Express 服务器，你可以指定一个 json 文件作为 api 的数据源。</p>
<h2 id="安装-json-server"><a class="markdownIt-Anchor" href="#安装-json-server">#</a> 安装 json-server</h2>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install -g json-server</span><br></pre></td></tr></table></figure>
<h2 id="启动-json-server"><a class="markdownIt-Anchor" href="#启动-json-server">#</a> 启动 json-server</h2>
<p><code>json-server</code>  可以直接把一个 <code>json</code>  文件托管成一个具备全 <code>RESTful</code>  风格的 <code>API</code> , 并支持跨域、 <code>jsonp</code> 、路由订制、数据快照保存等功能的 web 服务器。</p>
<p>db.json 文件的内容：</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">&quot;course&quot;</span>: [</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="attr">&quot;id&quot;</span>: <span class="number">1000</span>,</span><br><span class="line">      <span class="attr">&quot;course_name&quot;</span>: <span class="string">&quot;马连白米且&quot;</span>,</span><br><span class="line">      <span class="attr">&quot;autor&quot;</span>: <span class="string">&quot;袁明&quot;</span>,</span><br><span class="line">      <span class="attr">&quot;college&quot;</span>: <span class="string">&quot;金并即总变史&quot;</span>,</span><br><span class="line">      <span class="attr">&quot;category_Id&quot;</span>: <span class="number">2</span></span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="attr">&quot;id&quot;</span>: <span class="number">1001</span>,</span><br><span class="line">      <span class="attr">&quot;course_name&quot;</span>: <span class="string">&quot;公拉农题队始果动&quot;</span>,</span><br><span class="line">      <span class="attr">&quot;autor&quot;</span>: <span class="string">&quot;高丽&quot;</span>,</span><br><span class="line">      <span class="attr">&quot;college&quot;</span>: <span class="string">&quot;先了队叫及便&quot;</span>,</span><br><span class="line">      <span class="attr">&quot;category_Id&quot;</span>: <span class="number">2</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>例如以下命令，把 <code>db.json</code>  文件托管成一个 web 服务。</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ json-server --watch --port 53000 db.json</span><br></pre></td></tr></table></figure>
<p>输出类似以下内容，说明启动成功。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">\&#123;^_^&#125;&#x2F; hi!</span><br><span class="line"></span><br><span class="line">Loading db.json</span><br><span class="line">Done</span><br><span class="line"></span><br><span class="line">Resources</span><br><span class="line">http:&#x2F;&#x2F;localhost:53000&#x2F;course</span><br><span class="line"></span><br><span class="line">Home</span><br><span class="line">http:&#x2F;&#x2F;localhost:53000</span><br><span class="line"></span><br><span class="line">Type s + enter at any time to create a snapshot of the database</span><br><span class="line">Watching...</span><br></pre></td></tr></table></figure>
<p>此时，你可以打开你的浏览器，然后输入：<span class="exturl" data-url="aHR0cDovL2xvY2FsaG9zdDo1MzAwMC9jb3Vyc2U=">http://localhost:53000/course</span></p>
<h2 id="json-server-的相关启动参数"><a class="markdownIt-Anchor" href="#json-server-的相关启动参数">#</a> json-server 的相关启动参数</h2>
<ul>
<li>语法： <code>json-server [options] &lt;source&gt;</code></li>
<li>选项列表：</li>
</ul>
<table>
<thead>
<tr>
<th>参数</th>
<th>简写</th>
<th>默认值</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>–config</td>
<td>-c</td>
<td>指定配置文件</td>
<td>[默认值: “json-server.json”]</td>
</tr>
<tr>
<td>–port</td>
<td>-p</td>
<td>设置端口 [默认值: 3000]</td>
<td>Number</td>
</tr>
<tr>
<td>–host</td>
<td>-H</td>
<td>设置域 [默认值: “0.0.0.0”]</td>
<td>String</td>
</tr>
<tr>
<td>–watch</td>
<td>-w</td>
<td>Watch file(s)</td>
<td>是否监听</td>
</tr>
<tr>
<td>–routes</td>
<td>-r</td>
<td>指定自定义路由</td>
<td></td>
</tr>
<tr>
<td>–middlewares</td>
<td>-m</td>
<td>指定中间件 files</td>
<td>[数组]</td>
</tr>
<tr>
<td>–static</td>
<td>-s</td>
<td>Set static files directory</td>
<td>静态目录，类比：express 的静态目录</td>
</tr>
<tr>
<td>–readonly</td>
<td>–ro</td>
<td>Allow only GET requests [布尔]</td>
<td></td>
</tr>
<tr>
<td>–nocors</td>
<td>–nc</td>
<td>Disable Cross-Origin Resource Sharing [布尔]</td>
<td></td>
</tr>
<tr>
<td>–no</td>
<td>gzip</td>
<td>, --ng Disable GZIP Content-Encoding [布尔]</td>
<td></td>
</tr>
<tr>
<td>–snapshots</td>
<td>-S</td>
<td>Set snapshots directory [默认值: “.”]</td>
<td></td>
</tr>
<tr>
<td>–delay</td>
<td>-d</td>
<td>Add delay to responses (ms)</td>
<td></td>
</tr>
<tr>
<td>–id</td>
<td>-i</td>
<td>Set database id property (e.g. _id) [默认值: “id”]</td>
<td></td>
</tr>
<tr>
<td>–foreignKeySuffix</td>
<td>–</td>
<td>fks Set foreign key suffix (e.g. _id as in post_id)</td>
<td>[默认值: “Id”]</td>
</tr>
<tr>
<td>–help</td>
<td>-h</td>
<td>显示帮助信息</td>
<td>[布尔]</td>
</tr>
<tr>
<td>–version</td>
<td>-v</td>
<td>显示版本号</td>
<td>[布尔]</td>
</tr>
</tbody>
</table>
<ul>
<li>source 可以是 json 文件或者 js 文件。实例：</li>
</ul>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$ json-server --watch -c ./jsonserver.json</span><br><span class="line">$ json-server --watch app.js</span><br><span class="line">$ json-server db.json</span><br><span class="line">json-server --watch -port 8888 db.json</span><br></pre></td></tr></table></figure>
<h2 id="动态生成模拟数据"><a class="markdownIt-Anchor" href="#动态生成模拟数据">#</a> 动态生成模拟数据</h2>
<p>例如启动 json-server 的命令： <code>json-server --watch app.js</code>  是把一个 js 文件返回的数据托管成 web 服务。</p>
<p>app.js 配合<span class="exturl" data-url="aHR0cDovL21vY2tqcy5jb20v"> mockjs</span> 库可以很方便的进行生成模拟数据。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 用mockjs模拟生成数据</span></span><br><span class="line"><span class="keyword">var</span> Mock = <span class="built_in">require</span>(<span class="string">&#x27;mockjs&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">// 使用 Mock</span></span><br><span class="line">  <span class="keyword">var</span> data = Mock.mock(&#123;</span><br><span class="line">    <span class="string">&#x27;course|227&#x27;</span>: [</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="comment">// 属性 id 是一个自增数，起始值为 1，每次增 1</span></span><br><span class="line">        <span class="string">&#x27;id|+1&#x27;</span>: <span class="number">1000</span>,</span><br><span class="line">        course_name: <span class="string">&#x27;@ctitle(5,10)&#x27;</span>,</span><br><span class="line">        autor: <span class="string">&#x27;@cname&#x27;</span>,</span><br><span class="line">        college: <span class="string">&#x27;@ctitle(6)&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;category_Id|1-6&#x27;</span>: <span class="number">1</span></span><br><span class="line">      &#125;</span><br><span class="line">    ],</span><br><span class="line">    <span class="string">&#x27;course_category|6&#x27;</span>: [</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="string">&#x27;id|+1&#x27;</span>: <span class="number">1</span>,</span><br><span class="line">        pid: -<span class="number">1</span>,</span><br><span class="line">        cName: <span class="string">&#x27;@ctitle(4)&#x27;</span></span><br><span class="line">      &#125;</span><br><span class="line">    ]</span><br><span class="line">  &#125;)</span><br><span class="line">  <span class="comment">// 返回的data会作为json-server的数据</span></span><br><span class="line">  <span class="keyword">return</span> data</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="路由"><a class="markdownIt-Anchor" href="#路由">#</a> 路由</h2>
<h3 id="默认的路由"><a class="markdownIt-Anchor" href="#默认的路由">#</a> 默认的路由</h3>
<p><code>json-server</code>  为提供了 <code>GET</code> , <code>POST</code> ,  <code>PUT</code> ,  <code>PATCH</code>  , <code>DELETE</code>  等请求的 API, 分别对应数据中的所有类型的实体。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"># 获取所有的课程信息</span><br><span class="line">GET    &#x2F;course</span><br><span class="line"></span><br><span class="line"># 获取id&#x3D;1001的课程信息</span><br><span class="line">GET    &#x2F;course&#x2F;1001</span><br><span class="line"></span><br><span class="line"># 添加课程信息，请求body中必须包含course的属性数据，json-server自动保存。</span><br><span class="line">POST   &#x2F;course</span><br><span class="line"></span><br><span class="line"># 修改课程，请求body中必须包含course的属性数据</span><br><span class="line">PUT    &#x2F;course&#x2F;1</span><br><span class="line">PATCH  &#x2F;course&#x2F;1</span><br><span class="line"></span><br><span class="line"># 删除课程信息</span><br><span class="line">DELETE &#x2F;course&#x2F;1</span><br><span class="line"></span><br><span class="line"># 获取具体课程信息id&#x3D;1001</span><br><span class="line">GET    &#x2F;course&#x2F;1001</span><br></pre></td></tr></table></figure>
<h3 id="自定义路由"><a class="markdownIt-Anchor" href="#自定义路由">#</a> 自定义路由</h3>
<p>当然你可以自定义路由：</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ json-server --watch --routes route.json db.json</span><br></pre></td></tr></table></figure>
<p><code>route.json</code>  文件</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">&quot;/api/*&quot;</span>: <span class="string">&quot;/$1&quot;</span>, <span class="comment">//   /api/course   &lt;==&gt;  /course</span></span><br><span class="line">  <span class="attr">&quot;/:resource/:id/show&quot;</span>: <span class="string">&quot;/:resource/:id&quot;</span>,</span><br><span class="line">  <span class="attr">&quot;/posts/:category&quot;</span>: <span class="string">&quot;/posts?category=:category&quot;</span>,</span><br><span class="line">  <span class="attr">&quot;/articles\\?id=:id&quot;</span>: <span class="string">&quot;/posts/:id&quot;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="自定义配置文件"><a class="markdownIt-Anchor" href="#自定义配置文件">#</a> 自定义配置文件</h2>
<p>通过命令行配置路由、数据文件、监控等会让命令变的很长，而且容易敲错，可以把命令写到 npm 的 scripts 中，但是依然配置不方便。</p>
<p>json-server 允许我们把所有的配置放到一个配置文件中，这个配置文件默认 <code>json-server.json</code> ;</p>
<p>例如:</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">&quot;port&quot;</span>: <span class="number">53000</span>,</span><br><span class="line">  <span class="attr">&quot;watch&quot;</span>: <span class="literal">true</span>,</span><br><span class="line">  <span class="attr">&quot;static&quot;</span>: <span class="string">&quot;./public&quot;</span>,</span><br><span class="line">  <span class="attr">&quot;read-only&quot;</span>: <span class="literal">false</span>,</span><br><span class="line">  <span class="attr">&quot;no-cors&quot;</span>: <span class="literal">false</span>,</span><br><span class="line">  <span class="attr">&quot;no-gzip&quot;</span>: <span class="literal">false</span>,</span><br><span class="line">  <span class="attr">&quot;routes&quot;</span>: <span class="string">&quot;route.json&quot;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>使用配置文件启动 json-server:</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 默认使用：json-server.json配置文件</span></span><br><span class="line">$ json-server --watch app.js</span><br><span class="line"></span><br><span class="line"><span class="comment"># 指定配置文件</span></span><br><span class="line">$ json-server --watch -c jserver.json db.json</span><br></pre></td></tr></table></figure>
<h2 id="过滤查询"><a class="markdownIt-Anchor" href="#过滤查询">#</a> 过滤查询</h2>
<p>查询数据，可以额外提供</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">GET &#x2F;posts?title&#x3D;json-server&amp;author&#x3D;typicode</span><br><span class="line">GET &#x2F;posts?id&#x3D;1&amp;id&#x3D;2</span><br><span class="line"></span><br><span class="line"># 可以用 . 访问更深层的属性。</span><br><span class="line">GET &#x2F;comments?author.name&#x3D;typicode</span><br></pre></td></tr></table></figure>
<p>还可以使用一些判断条件作为过滤查询的辅助。</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">GET /posts?views_gte=10&amp;views_lte=20</span><br></pre></td></tr></table></figure>
<p>可以用的拼接条件为：</p>
<ul>
<li><code>_gte</code>  : 大于等于</li>
<li><code>_lte</code>  : 小于等于</li>
<li><code>_ne</code>  : 不等于</li>
<li><code>_like</code>  : 包含</li>
</ul>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">GET /posts?id_ne=1</span><br><span class="line">GET /posts?id_lte=100</span><br><span class="line">GET /posts?title_like=server</span><br></pre></td></tr></table></figure>
<h2 id="分页查询"><a class="markdownIt-Anchor" href="#分页查询">#</a> 分页查询</h2>
<p>默认后台处理分页参数为：  <code>_page</code>  第几页，  <code>_limit</code>  一页多少条。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">GET &#x2F;posts?_page&#x3D;7</span><br><span class="line">GET &#x2F;posts?_page&#x3D;7&amp;_limit&#x3D;20</span><br></pre></td></tr></table></figure>
<blockquote>
<p>默认一页 10 条。</p>
</blockquote>
<p>后台会返回总条数，总条数的数据在响应头: <code>X-Total-Count</code>  中。</p>
<h2 id="排序"><a class="markdownIt-Anchor" href="#排序">#</a> 排序</h2>
<ul>
<li>参数：  <code>_sort</code>  设定排序的字段</li>
<li>参数：  <code>_order</code>  设定排序的方式（默认升序）</li>
</ul>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">GET /posts?_sort=views&amp;_order=asc</span><br><span class="line">GET /posts/1/comments?_sort=votes&amp;_order=asc</span><br></pre></td></tr></table></figure>
<p>支持多个字段排序：</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">GET /posts?_sort=user,views&amp;_order=desc,asc</span><br></pre></td></tr></table></figure>
<h2 id="任意切片数据"><a class="markdownIt-Anchor" href="#任意切片数据">#</a> 任意切片数据</h2>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">GET /posts?_start=20&amp;_end=30</span><br><span class="line">GET /posts/1/comments?_start=20&amp;_end=30</span><br><span class="line">GET /posts/1/comments?_start=20&amp;_limit=10</span><br></pre></td></tr></table></figure>
<h2 id="全文检索"><a class="markdownIt-Anchor" href="#全文检索">#</a> 全文检索</h2>
<p>可以通过 <code>q</code>  参数进行全文检索，例如： <code>GET /posts?q=internet</code></p>
<h2 id="实体关联"><a class="markdownIt-Anchor" href="#实体关联">#</a> 实体关联</h2>
<h3 id="关联子实体"><a class="markdownIt-Anchor" href="#关联子实体">#</a> 关联子实体</h3>
<p>包含 children 的对象，添加 <code>_embed</code></p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">GET /posts?_embed=comments</span><br><span class="line">GET /posts/1?_embed=comments</span><br></pre></td></tr></table></figure>
<h3 id="关联父实体"><a class="markdownIt-Anchor" href="#关联父实体">#</a> 关联父实体</h3>
<p>包含 parent 的对象，添加 <code>_expand</code></p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">GET /comments?_expand=post</span><br><span class="line">GET /comments/1?_expand=post</span><br></pre></td></tr></table></figure>
<h2 id="其他高级用法"><a class="markdownIt-Anchor" href="#其他高级用法">#</a> 其他高级用法</h2>
<p><code>json-server</code>  本身就是依赖 express 开发而来，可以进行深度定制。细节就不展开，具体详情请参考<span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL3R5cGljb2RlL2pzb24tc2VydmVy">官网</span>。</p>
<ul>
<li>自定义路由</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> jsonServer = <span class="built_in">require</span>(<span class="string">&#x27;json-server&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> server = jsonServer.create()</span><br><span class="line"><span class="keyword">const</span> router = jsonServer.router(<span class="string">&#x27;db.json&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> middlewares = jsonServer.defaults()</span><br><span class="line"></span><br><span class="line">server.use(middlewares)</span><br><span class="line"></span><br><span class="line">server.get(<span class="string">&#x27;/echo&#x27;</span>, <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">  res.jsonp(req.query)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">server.use(jsonServer.bodyParser)</span><br><span class="line">server.use(<span class="function">(<span class="params">req, res, next</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">if</span> (req.method === <span class="string">&#x27;POST&#x27;</span>) &#123;</span><br><span class="line">    req.body.createdAt = <span class="built_in">Date</span>.now()</span><br><span class="line">  &#125;</span><br><span class="line">  next()</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">server.use(router)</span><br><span class="line">server.listen(<span class="number">3000</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">&#x27;JSON Server is running&#x27;</span>)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<ul>
<li>自定义输出内容</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">router.render = <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">  res.jsonp(&#123;</span><br><span class="line">    body: res.locals.data</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>自定义用户校验</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> jsonServer = <span class="built_in">require</span>(<span class="string">&#x27;json-server&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> server = jsonServer.create()</span><br><span class="line"><span class="keyword">const</span> router = jsonServer.router(<span class="string">&#x27;db.json&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> middlewares = jsonServer.defaults()</span><br><span class="line"></span><br><span class="line">server.use(middlewares)</span><br><span class="line">server.use(<span class="function">(<span class="params">req, res, next</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">if</span> (isAuthorized(req)) &#123;</span><br><span class="line">    <span class="comment">// add your authorization logic here</span></span><br><span class="line">    next() <span class="comment">// continue to JSON Server router</span></span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    res.sendStatus(<span class="number">401</span>)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br><span class="line">server.use(router)</span><br><span class="line">server.listen(<span class="number">3000</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">&#x27;JSON Server is running&#x27;</span>)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<blockquote>
<p>作者：<span class="exturl" data-url="aHR0cDovL3d3dy5jbmJsb2dzLmNvbS9mbHlfZHJhZ29uLw==">FlyDragon</span><br>
 出处：<span class="exturl" data-url="aHR0cDovL3d3dy5jbmJsb2dzLmNvbS9mbHlfZHJhZ29uLw==">http://www.cnblogs.com/fly_dragon/</span><br>
 关于作者：专注于微软平台项目架构、管理和企业解决方案。如有问题或建议，请多多赐教！<br>
本文版权归作者和博客园共有，欢迎转载，但未经作者同意必须保留此段声明，且在文章页面明显位置给出原文连接，如有问题，可以通 <span class="exturl" data-url="bWFpbHRvOm1hbHVuNjY2QDEyNi5jb20=">malun666@126.com</span> 联系我，非常感谢。</p>
</blockquote>

      <div class="tags">
          <a href="/tags/node/" rel="tag"><i class="ic i-tag"></i> node</a>
      </div>
  </div>

   <footer>

    <div class="meta">
  <span class="item">
    <span class="icon">
      <i class="ic i-calendar-check"></i>
    </span>
    <span class="text">Edited on</span>
    <time title="Modified: 2019-10-26 16:31:16" itemprop="dateModified" datetime="2019-10-26T16:31:16+08:00">2019-10-26</time>
  </span>
</div>

      

  </footer>

</article>

  </div>
  

<div class="post-nav">
    <div class="item left">
      

  <a href="/2019/10/25/csharp-dotnetcore-iis/" itemprop="url" rel="prev" data-background-image="https:&#x2F;&#x2F;tva4.sinaimg.cn&#x2F;mw690&#x2F;6833939bly1gipeyonbf9j20zk0m8e81.jpg" title="在IIS上部署你的ASP.NET Core项目">
  <span class="type">Previous Post</span>
  <span class="category"><i class="ic i-flag"></i> </span>
  <h3>在IIS上部署你的ASP.NET Core项目</h3>
  </a>

    </div>
    <div class="item right">
      

  <a href="/2019/10/28/python-pipenv/" itemprop="url" rel="next" data-background-image="https:&#x2F;&#x2F;tva4.sinaimg.cn&#x2F;mw690&#x2F;6833939bly1giciukx8a7j20zk0m8aio.jpg" title="python pipenv">
  <span class="type">Next Post</span>
  <span class="category"><i class="ic i-flag"></i> </span>
  <h3>python pipenv</h3>
  </a>

    </div>
</div>

  
  <div class="wrap" id="comments"></div>


        </div>
        <div id="sidebar">
          

<div class="inner">

  <div class="panels">
    <div class="inner">
      <div class="contents panel pjax" data-title="Contents">
          <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AE%89%E8%A3%85-json-server"><span class="toc-number">1.</span> <span class="toc-text"> 安装 json-server</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%90%AF%E5%8A%A8-json-server"><span class="toc-number">2.</span> <span class="toc-text"> 启动 json-server</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#json-server-%E7%9A%84%E7%9B%B8%E5%85%B3%E5%90%AF%E5%8A%A8%E5%8F%82%E6%95%B0"><span class="toc-number">3.</span> <span class="toc-text"> json-server 的相关启动参数</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8A%A8%E6%80%81%E7%94%9F%E6%88%90%E6%A8%A1%E6%8B%9F%E6%95%B0%E6%8D%AE"><span class="toc-number">4.</span> <span class="toc-text"> 动态生成模拟数据</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%B7%AF%E7%94%B1"><span class="toc-number">5.</span> <span class="toc-text"> 路由</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%BB%98%E8%AE%A4%E7%9A%84%E8%B7%AF%E7%94%B1"><span class="toc-number">5.1.</span> <span class="toc-text"> 默认的路由</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%87%AA%E5%AE%9A%E4%B9%89%E8%B7%AF%E7%94%B1"><span class="toc-number">5.2.</span> <span class="toc-text"> 自定义路由</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%87%AA%E5%AE%9A%E4%B9%89%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6"><span class="toc-number">6.</span> <span class="toc-text"> 自定义配置文件</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%BF%87%E6%BB%A4%E6%9F%A5%E8%AF%A2"><span class="toc-number">7.</span> <span class="toc-text"> 过滤查询</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%88%86%E9%A1%B5%E6%9F%A5%E8%AF%A2"><span class="toc-number">8.</span> <span class="toc-text"> 分页查询</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%8E%92%E5%BA%8F"><span class="toc-number">9.</span> <span class="toc-text"> 排序</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BB%BB%E6%84%8F%E5%88%87%E7%89%87%E6%95%B0%E6%8D%AE"><span class="toc-number">10.</span> <span class="toc-text"> 任意切片数据</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%85%A8%E6%96%87%E6%A3%80%E7%B4%A2"><span class="toc-number">11.</span> <span class="toc-text"> 全文检索</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AE%9E%E4%BD%93%E5%85%B3%E8%81%94"><span class="toc-number">12.</span> <span class="toc-text"> 实体关联</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%85%B3%E8%81%94%E5%AD%90%E5%AE%9E%E4%BD%93"><span class="toc-number">12.1.</span> <span class="toc-text"> 关联子实体</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%85%B3%E8%81%94%E7%88%B6%E5%AE%9E%E4%BD%93"><span class="toc-number">12.2.</span> <span class="toc-text"> 关联父实体</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%85%B6%E4%BB%96%E9%AB%98%E7%BA%A7%E7%94%A8%E6%B3%95"><span class="toc-number">13.</span> <span class="toc-text"> 其他高级用法</span></a></li></ol>
      </div>
      <div class="related panel pjax" data-title="Related">
      </div>
      <div class="overview panel" data-title="Overview">
        <div class="author" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <img class="image" itemprop="image" alt="江边鸟"
      data-src="/images/avatar.jpg">
  <p class="name" itemprop="name">江边鸟</p>
  <div class="description" itemprop="description"></div>
</div>

<nav class="state">
    <div class="item posts">
      <a href="/archives/">
        <span class="count">257</span>
        <span class="name">posts</span>
      </a>
    </div>
    <div class="item categories">
      <a href="/categories/">
        <span class="count">2</span>
        <span class="name">categories</span>
      </a>
    </div>
    <div class="item tags">
      <a href="/tags/">
        <span class="count">42</span>
        <span class="name">tags</span>
      </a>
    </div>
</nav>

<div class="social">
      <span class="exturl item github" data-url="aHR0cHM6Ly9naXRodWIuY29tL2xoY2hlbjc0" title="https:&#x2F;&#x2F;github.com&#x2F;lhchen74"><i class="ic i-github"></i></span>
      <span class="exturl item music" data-url="aHR0cHM6Ly9tdXNpYy4xNjMuY29tLw==" title="https:&#x2F;&#x2F;music.163.com&#x2F;"><i class="ic i-cloud-music"></i></span>
</div>

<ul class="menu">
  
    
  <li class="item">
    <a href="/" rel="section"><i class="ic i-home"></i>Home</a>
  </li>

    
  <li class="item">
    <a href="/about/" rel="section"><i class="ic i-user"></i>About</a>
  </li>

        
  <li class="item dropdown">
      <a href="javascript:void(0);"><i class="ic i-feather"></i>Posts</a>
    <ul class="submenu">

        
  <li class="item">
    <a href="/archives/" rel="section"><i class="ic i-list-alt"></i>Archives</a>
  </li>

        
  <li class="item">
    <a href="/categories/" rel="section"><i class="ic i-th"></i>Categories</a>
  </li>

        
  <li class="item">
    <a href="/tags/" rel="section"><i class="ic i-tags"></i>Tags</a>
  </li>

  </ul>
    
  <li class="item">
    <a href="/friends/" rel="section"><i class="ic i-heart"></i>Friends</a>
  </li>


</ul>

      </div>
    </div>
  </div>

  <ul id="quick">
    <li class="prev pjax">
        <a href="/2019/10/25/csharp-dotnetcore-iis/" rel="prev" title="Previous Post"><i class="ic i-chevron-left"></i></a>
    </li>
    <li class="up"><i class="ic i-arrow-up"></i></li>
    <li class="down"><i class="ic i-arrow-down"></i></li>
    <li class="next pjax">
        <a href="/2019/10/28/python-pipenv/" rel="next" title="Next Post"><i class="ic i-chevron-right"></i></a>
    </li>
    <li class="percent"></li>
  </ul>
</div>


        </div>
        <div class="dimmer"></div>
      </div>
    </main>
    <footer id="footer">
      <div class="inner">
        <div class="widgets">
          

        </div>
        <div class="status">
  <div class="copyright">
    
    &copy; 2010 – 
    <span itemprop="copyrightYear">2021</span>
    <span class="with-love">
      <i class="ic i-sakura rotate"></i>
    </span>
    <span class="author" itemprop="copyrightHolder">江边鸟 @ 露の世</span>
  </div>
  <div class="powered-by">
    Powered by <span class="exturl" data-url="aHR0cHM6Ly9oZXhvLmlv">Hexo</span> & Theme.<span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL2FtZWhpbWUvaGV4by10aGVtZS1zaG9rYQ==">Shoka</span>
  </div>
</div>

      </div>
    </footer>
  </div>
<script data-config type="text/javascript">
  var LOCAL = {
    path: '2019/10/26/node-jsonserver/',
    favicon: {
      show: "（●´3｀●）Goooood",
      hide: "(´Д｀)Booooom"
    },
    search : {
      placeholder: "Search for Posts",
      empty: "We didn't find any results for the search: ${query}",
      stats: "${hits} results found in ${time} ms"
    },
    valine: true,fancybox: true,
    ignores : [
      function(uri) {
        return uri.includes('#');
      },
      function(uri) {
        return new RegExp(LOCAL.path+"$").test(uri);
      }
    ]
  };
</script>

<script src="https://cdn.polyfill.io/v2/polyfill.js"></script>

<script src="//cdn.jsdelivr.net/combine/npm/pace-js@1.0.2/pace.min.js,npm/pjax@0.2.8/pjax.min.js,npm/whatwg-fetch@3.4.0/dist/fetch.umd.min.js,npm/animejs@3.2.0/lib/anime.min.js,npm/algoliasearch@4/dist/algoliasearch-lite.umd.js,npm/instantsearch.js@4/dist/instantsearch.production.min.js,npm/lozad@1/dist/lozad.min.js,npm/quicklink@2/dist/quicklink.umd.js"></script>

<script src="/js/app.js?v=0.2.5"></script>




</body>
</html>
