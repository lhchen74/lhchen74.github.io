



<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#FFF">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">

<link rel="icon" type="image/ico" sizes="32x32" href="/images/favicon.ico">
  <meta http-equiv="Cache-Control" content="no-transform">
  <meta http-equiv="Cache-Control" content="no-siteapp">


<link rel="alternate" type="application/rss+xml" title="我知这世界本如露水般短暂 然而 然而" href="https://lhchen74.github.io/rss.xml" />
<link rel="alternate" type="application/atom+xml" title="我知这世界本如露水般短暂 然而 然而" href="https://lhchen74.github.io/atom.xml" />
<link rel="alternate" type="application/json" title="我知这世界本如露水般短暂 然而 然而" href="https://lhchen74.github.io/feed.json" />

<link rel="stylesheet" href="//fonts.googleapis.com/css?family=Mulish:300,300italic,400,400italic,700,700italic%7CFredericka%20the%20Great:300,300italic,400,400italic,700,700italic%7CNoto%20Serif%20JP:300,300italic,400,400italic,700,700italic%7CNoto%20Serif%20SC:300,300italic,400,400italic,700,700italic%7CInconsolata:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext">

<link rel="stylesheet" href="/css/app.css?v=0.2.5">

  
  <meta name="keywords" content="node" />


<link rel="canonical" href="https://lhchen74.github.io/2019/07/15/node/">



  <title>
node |
露の世 = 我知这世界本如露水般短暂 然而 然而</title>
<meta name="generator" content="Hexo 5.4.0"></head>
<body itemscope itemtype="http://schema.org/WebPage">
  <div id="loading">
    <div class="cat">
      <div class="body"></div>
      <div class="head">
        <div class="face"></div>
      </div>
      <div class="foot">
        <div class="tummy-end"></div>
        <div class="bottom"></div>
        <div class="legs left"></div>
        <div class="legs right"></div>
      </div>
      <div class="paw">
        <div class="hands left"></div>
        <div class="hands right"></div>
      </div>
    </div>
  </div>
  <div id="container">
    <header id="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="inner">
        <div id="brand">
          <div class="pjax">
          
  <h1 itemprop="name headline">node
  </h1>
  
<div class="meta">
  <span class="item" title="Created: 2019-07-15 00:00:00">
    <span class="icon">
      <i class="ic i-calendar"></i>
    </span>
    <span class="text">Posted on</span>
    <time itemprop="dateCreated datePublished" datetime="2019-07-15T00:00:00+08:00">2019-07-15</time>
  </span>
</div>


          </div>
        </div>
        <nav id="nav">
  <div class="inner">
    <div class="toggle">
      <div class="lines" aria-label="Toggle navigation bar">
        <span class="line"></span>
        <span class="line"></span>
        <span class="line"></span>
      </div>
    </div>
    <ul class="menu">
      <li class="item title"><a href="/" rel="start">露の世</a></li>
    </ul>
    <ul class="right">
      <li class="item theme">
        <i class="ic i-sun"></i>
      </li>
      <li class="item search">
        <i class="ic i-search"></i>
      </li>
    </ul>
  </div>
</nav>

      </div>
      <div id="imgs" class="pjax">
        <ul>
          <li class="item" data-background-image="https://tva3.sinaimg.cn/large/6833939bly1giclhtuo6nj20zk0m8ttm.jpg"></li>
          <li class="item" data-background-image="https://tva3.sinaimg.cn/large/6833939bly1gipey84bjtj20zk0m8hdt.jpg"></li>
          <li class="item" data-background-image="https://tva3.sinaimg.cn/large/6833939bly1giciundwu5j20zk0m8n9e.jpg"></li>
          <li class="item" data-background-image="https://tva3.sinaimg.cn/large/6833939bly1gicitspjpbj20zk0m81ky.jpg"></li>
          <li class="item" data-background-image="https://tva3.sinaimg.cn/large/6833939bly1gipex2cdtbj20zk0m8x6p.jpg"></li>
          <li class="item" data-background-image="https://tva3.sinaimg.cn/large/6833939bly1gipexbei4hj20zk0m8npd.jpg"></li>
        </ul>
      </div>
    </header>
    <div id="waves">
      <svg class="waves" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 24 150 28" preserveAspectRatio="none" shape-rendering="auto">
        <defs>
          <path id="gentle-wave" d="M-160 44c30 0 58-18 88-18s 58 18 88 18 58-18 88-18 58 18 88 18 v44h-352z" />
        </defs>
        <g class="parallax">
          <use xlink:href="#gentle-wave" x="48" y="0" />
          <use xlink:href="#gentle-wave" x="48" y="3" />
          <use xlink:href="#gentle-wave" x="48" y="5" />
          <use xlink:href="#gentle-wave" x="48" y="7" />
        </g>
      </svg>
    </div>
    <main>
      <div class="inner">
        <div id="main" class="pjax">
          
  <div class="article wrap">
    
<div class="breadcrumb" itemscope itemtype="https://schema.org/BreadcrumbList">
<i class="ic i-home"></i>
<span><a href="/">Home</a></span>
</div>

    <article itemscope itemtype="http://schema.org/Article" class="post block" lang="en">
  <link itemprop="mainEntityOfPage" href="https://lhchen74.github.io/2019/07/15/node/">

  <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
    <meta itemprop="image" content="/images/avatar.jpg">
    <meta itemprop="name" content="江边鸟">
    <meta itemprop="description" content=", ">
  </span>

  <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
    <meta itemprop="name" content="我知这世界本如露水般短暂 然而 然而">
  </span>

  <div class="body md" itemprop="articleBody">
    

    <h2 id="javascript"><a class="markdownIt-Anchor" href="#javascript">#</a> javascript</h2>
<h3 id="javascript-数据类型"><a class="markdownIt-Anchor" href="#javascript-数据类型">#</a> javascript 数据类型</h3>
<h4 id="类型分类"><a class="markdownIt-Anchor" href="#类型分类">#</a> 类型分类</h4>
<p>基本 (值) 类型:  <code>String, Number, Boolean, null, undefined</code> <br>
 对象 (引用) 类型:  <code>Object, Function, Array</code> , 其中 Function 和 Array 也是一种特别的 Object 类型</p>
<h4 id="类型判断"><a class="markdownIt-Anchor" href="#类型判断">#</a> 类型判断</h4>
<p><strong>typeof</strong> , 返回对象的字符串表示形式，由下表可以看出  <code>typeof</code>  可以用来比较  <code>String, Number, Boolean, undefined, Function</code>  等类型，但是无法比较  <code>null, Array, Object</code>  , 因为  <code>typeof(null), typeof(Array), typeof(Object)</code>  返回的都是  <code>'object'</code></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Result</th>
</tr>
</thead>
<tbody>
<tr>
<td>String</td>
<td>‘string’</td>
</tr>
<tr>
<td>Number</td>
<td>‘number’</td>
</tr>
<tr>
<td>Boolean</td>
<td>‘boolean’</td>
</tr>
<tr>
<td><strong>null</strong></td>
<td><strong>’object’</strong></td>
</tr>
<tr>
<td>undefined</td>
<td>‘undefined’</td>
</tr>
<tr>
<td><strong>Object</strong></td>
<td><strong>’object’</strong></td>
</tr>
<tr>
<td><strong>Array</strong></td>
<td><strong>’object’</strong></td>
</tr>
<tr>
<td>Function</td>
<td>‘function’</td>
</tr>
</tbody>
</table>
<p><strong>instanceof</strong> 用于判断对象的具体类型，可以判断 <code>Object, Array, Function</code> , 由于 Function 和 Array 也是一种特别的 Object 类型，所以  <code>Array|Function's instance instanceof Object 返回 true</code> , 具体判断如下</p>
<table>
<thead>
<tr>
<th>Instance</th>
<th>Type</th>
<th>Result</th>
</tr>
</thead>
<tbody>
<tr>
<td>array</td>
<td>Array</td>
<td>true</td>
</tr>
<tr>
<td>function</td>
<td>Function</td>
<td>true</td>
</tr>
<tr>
<td>array</td>
<td>Object</td>
<td>true</td>
</tr>
<tr>
<td>function</td>
<td>Object</td>
<td>true</td>
</tr>
<tr>
<td>object</td>
<td>Object</td>
<td>true</td>
</tr>
</tbody>
</table>
<p><strong>===</strong> 可以用来判断  <code>undefined, null</code>  因为它们是全局唯一的，undefined 和 null 区别如下：</p>
<p>undefined 表示变量未赋值，null 表示变量赋了值，但是值为 null<br>
null 作用:</p>
<ol>
<li>var b = null 初始赋值为 null, 表明将要赋值为对象（typeof b === ‘object’)<br>
b = [‘a’, 2]</li>
<li>b = null 让 b 指向的对象成为垃圾对象（被垃圾回收器回收）</li>
</ol>
<h4 id="数据类型和变量类型"><a class="markdownIt-Anchor" href="#数据类型和变量类型">#</a> 数据类型和变量类型</h4>
<table>
<thead>
<tr>
<th>数据类型</th>
<th>变量类型（变量内存值的类型）</th>
</tr>
</thead>
<tbody>
<tr>
<td>基本类型</td>
<td>基本类型：保存的是基本类型的数据</td>
</tr>
<tr>
<td>引用类型</td>
<td>引用类型：保存的是地址值</td>
</tr>
</tbody>
</table>
<h4 id="数据-变量和内存"><a class="markdownIt-Anchor" href="#数据-变量和内存">#</a> 数据、变量和内存</h4>
<p><code>内存是存储数据的空间，变量是内存的标识</code></p>
<p><strong>数据</strong><br>
存储在内存中代表特定信息的东西，本质上是 ‘0101…’, 数据是内存中所有操作的目标，算术运算、逻辑运算、赋值、运行函数<br>
数据特点：可传递，可运算</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> a = <span class="number">2</span>;</span><br><span class="line"><span class="keyword">var</span> b = a;</span><br><span class="line"><span class="keyword">var</span> c = a + <span class="number">2</span>;</span><br></pre></td></tr></table></figure>
<p><strong>内存</strong><br>
内存条通电后产生的可一存储数据的空间，是临时的，断电后内存空间和数据都会消失，一块小内存包含  <code>内部存储的数据</code>  和  <code>地址值</code> <br>
内存分为栈和堆<br>
栈：存储全局变量和局部变量</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> a = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">var</span> b = &#123; <span class="attr">name</span>: <span class="string">&quot;bbb&quot;</span> &#125;; <span class="comment">// b 的值是对象在堆中的地址，对象存储在堆中，变量 b 存储在栈中</span></span><br></pre></td></tr></table></figure>
<p>堆：存储对象</p>
<p><strong>变量</strong><br>
可变化的量，由变量名和变量值组成，每个变量都对应一块内存，变量名用来查找对应的内存，变量的值就是内存中保存的数据</p>
<h4 id="引用变量赋值"><a class="markdownIt-Anchor" href="#引用变量赋值">#</a> 引用变量赋值</h4>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> obj1 = &#123; <span class="attr">name</span>: <span class="string">&quot;aaa&quot;</span> &#125;;</span><br><span class="line"><span class="comment">// 拷贝 obj1 的内容到 obj2, 只不过 obj1 的值是对象的地址，</span></span><br><span class="line"><span class="comment">// 所以 obj2 和 obj1 指向同一对象</span></span><br><span class="line"><span class="keyword">var</span> obj2 = obj1;</span><br></pre></td></tr></table></figure>
<h3 id="javascript-函数"><a class="markdownIt-Anchor" href="#javascript-函数">#</a> javascript 函数</h3>
<h4 id="函数定义方式"><a class="markdownIt-Anchor" href="#函数定义方式">#</a> 函数定义方式</h4>
<p>函数声明和函数表达式</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 函数声明</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">fn1</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&quot;fn1()&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 函数表达式</span></span><br><span class="line"><span class="keyword">var</span> fn2 = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&quot;fn2()&quot;</span>);</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h4 id="函数调用"><a class="markdownIt-Anchor" href="#函数调用">#</a> 函数调用</h4>
<table>
<thead>
<tr>
<th>call</th>
<th>desc</th>
</tr>
</thead>
<tbody>
<tr>
<td>test()</td>
<td>直接调用</td>
</tr>
<tr>
<td>new test()</td>
<td>new 方式调用</td>
</tr>
<tr>
<td>obj.test()</td>
<td>对象调用</td>
</tr>
<tr>
<td>test.call/apply(obj)</td>
<td>让 test 成为 obj 的方法调用</td>
</tr>
</tbody>
</table>
<h4 id="回调函数"><a class="markdownIt-Anchor" href="#回调函数">#</a> 回调函数</h4>
<p>定义的函数没有手动调用，但最终它会执行，常见回调函数</p>
<ul>
<li>dom 事件回调函数</li>
<li>定时器函数</li>
<li>ajax 请求回调函数</li>
<li>生命周期回调函数</li>
</ul>
<h4 id="iife"><a class="markdownIt-Anchor" href="#iife">#</a> IIFE</h4>
<p>Immediately-InvokedFunctionExpression (立即执行函数表达式)，其实就是  <code>匿名函数自调用</code> ，作用是隐藏实现，并且不会污染全局空间</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> a = <span class="number">3</span>;</span><br><span class="line">    <span class="built_in">console</span>.log(a + <span class="number">3</span>);</span><br><span class="line">&#125;)();</span><br></pre></td></tr></table></figure>
<h4 id="this"><a class="markdownIt-Anchor" href="#this">#</a> this</h4>
<p>任何函数本质上都是通过某个对象调用，在浏览器中没有直接指定就是 window，所有函数内部都有一个变量 this， 它的值是调用函数的当前对象，可通过如下方式判断：</p>
<table>
<thead>
<tr>
<th>call</th>
<th>this</th>
</tr>
</thead>
<tbody>
<tr>
<td>test()</td>
<td>window</td>
</tr>
<tr>
<td>new test()</td>
<td>新创建的对象</td>
</tr>
<tr>
<td>obj.test()</td>
<td>obj</td>
</tr>
<tr>
<td>test.call/apply(obj)</td>
<td>obj</td>
</tr>
</tbody>
</table>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Person</span>(<span class="params">color</span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="built_in">this</span>)</span><br><span class="line">    <span class="built_in">this</span>.color = color</span><br><span class="line">    <span class="built_in">this</span>.setColor = <span class="function"><span class="keyword">function</span>(<span class="params">color</span>) </span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="built_in">this</span>)</span><br><span class="line">        <span class="built_in">this</span>.color = color</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">Person(<span class="string">&quot;red&quot;</span>)                  <span class="comment">// window</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> p = <span class="keyword">new</span> Person(<span class="string">&quot;yellow&quot;</span>)   <span class="comment">// Person &#123;&#125;</span></span><br><span class="line">p.setColor(<span class="string">&#x27;red&#x27;</span>)              <span class="comment">// Person &#123; color: &#x27;yellow&#x27;， setColor: [Function] &#125;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> obj = &#123;<span class="attr">name</span>: <span class="string">&#x27;obj&#x27;</span>&#125;</span><br><span class="line">p.setColor.call(obj， <span class="string">&#x27;black&#x27;</span>) <span class="comment">// &#123; name: &#x27;obj&#x27; &#125;</span></span><br></pre></td></tr></table></figure>
<h4 id="何时加分号"><a class="markdownIt-Anchor" href="#何时加分号">#</a> 何时加分号</h4>
<p>需要加分号 <code>;</code>  的地方，以  <code>() or []</code>  开头的语句</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 如果不加分号就会出现 3(...)， TypeError: 3 is not a function</span></span><br><span class="line"><span class="keyword">var</span> a = <span class="number">3</span></span><br><span class="line">;(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line"></span><br><span class="line">&#125;)()</span><br><span class="line"><span class="comment">// 如果不加分号，4[1， 2， 3] 返回 undefined， TypeError: Cannot read property &#x27;forEach&#x27; of undefined</span></span><br><span class="line"><span class="keyword">var</span> b = <span class="number">4</span></span><br><span class="line">;[<span class="number">1</span>，<span class="number">2</span>，<span class="number">3</span>].forEach(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line"></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<h4 id="js-调用函数传递变量参数是值传递还是引用传递"><a class="markdownIt-Anchor" href="#js-调用函数传递变量参数是值传递还是引用传递">#</a> js 调用函数传递变量参数是值传递还是引用传递</h4>
<p>可以说都是值（基本 / 地址值）传递<br>
也可以说可能是值传递，也可能是引用传递 (地址值)</p>
<h3 id="javascript-对象"><a class="markdownIt-Anchor" href="#javascript-对象">#</a> javascript 对象</h3>
<ol>
<li>
<p>什么是对象<br>
用来保存多个数据的容器，用于统一管理数据<br>
一个对象用来代表现实世界中的一个事物</p>
</li>
<li>
<p>对象组成</p>
<p>属性<br>
方法（一种特别属性）</p>
</li>
<li>
<p>访问对象内部数据</p>
<p>. 属性名</p>
<p>[属性名] - 属性名包含特殊字符 -、空格、变量名等时使用</p>
</li>
</ol>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> p = &#123;&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// p.content-type = &#x27;text/json&#x27;</span></span><br><span class="line"></span><br><span class="line">p[<span class="string">&quot;content-type&quot;</span>] = <span class="string">&quot;text/json&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(p[<span class="string">&quot;content-type&quot;</span>]);</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> propName = <span class="string">&quot;Age&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> propValue = <span class="number">18</span>;</span><br><span class="line"></span><br><span class="line">p[propName] = propValue;</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(p[propName]);</span><br></pre></td></tr></table></figure>
<h3 id="javascript-原型"><a class="markdownIt-Anchor" href="#javascript-原型">#</a> javascript 原型</h3>
<p><strong>原型对象</strong></p>
<ul>
<li>
<p>每个函数都有一个 prototype 属性，它默认指向一个 Object 空对象（即原型对象）</p>
</li>
<li>
<p>原型对象中有一个属性 constructor, 它指向函数本身</p>
</li>
</ul>
<p>作用</p>
<ul>
<li>函数对象的所有实例会自动拥有原型中的属性和方法</li>
</ul>
<p><strong>显示原型和隐式原型</strong></p>
<ul>
<li>
<p>每个函数 function 都有一个 prototype, 即显示原型属性，默认指向一个空的 Object 对象</p>
</li>
<li>
<p>每个实例对象都有一个  <code>__proto__</code> , 即隐式原型</p>
</li>
<li>
<p>对象隐式原型的值为其构造函数的显示原型的值</p>
</li>
</ul>
<p><strong>原型链</strong></p>
<ul>
<li>访问一个对象的属性时，先从自身查找，然后沿着  <code>__proto__</code>  向上查找，</li>
<li>当查找不到时 ( <code>__proto__</code>  === null) 返回 undefine</li>
</ul>
<p><strong>总结</strong></p>
<ul>
<li>函数的 prototype 属性在定义函数时自动添加，默认为 Object 空对象</li>
<li>对象的  <code>__proto__</code>  属性在创建对象时自动添加，默认为构造函数的 prototype 属性值</li>
</ul>
<ul>
<li>
<p>所有函数都是通过 new Function () 产生的，所以所有函数的 <code>__proto__</code>  都相等，都是 Function.prototype</p>
</li>
<li>
<p>因为 Function 也是通过 new Function () 产生的，所以 Function. <code>__proto__</code>  === Function.prototype</p>
</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Fn</span>(<span class="params"></span>) </span>&#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(Fn.prototype);</span><br><span class="line"><span class="built_in">console</span>.log(Fn.prototype.constructor);</span><br><span class="line"><span class="built_in">console</span>.log(Fn.prototype.constructor === Fn);</span><br><span class="line"></span><br><span class="line">Fn.prototype.test = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&quot;test&quot;</span>);</span><br><span class="line">&#125;;</span><br><span class="line"><span class="built_in">console</span>.log(Fn.prototype);</span><br><span class="line"><span class="keyword">var</span> fn = <span class="keyword">new</span> Fn();</span><br><span class="line">fn.test();</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">&quot;---------------------------------&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">F0</span>(<span class="params"></span>) </span>&#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> f0 = <span class="keyword">new</span> F0();</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(F0.prototype);</span><br><span class="line"><span class="built_in">console</span>.log(f0.__proto__);</span><br><span class="line"><span class="built_in">console</span>.log(f0.__proto__ == F0.prototype);</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">&quot;---------------------------------&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">F1</span>(<span class="params"></span>) </span>&#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">F2</span>(<span class="params"></span>) </span>&#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> F3 = <span class="keyword">new</span> <span class="built_in">Function</span>();</span><br><span class="line"><span class="comment">// 所有函数都是通过 new Function() 产生的，所以所有函数的 __proto__ 都相等, 都是 Function.prototype</span></span><br><span class="line"><span class="comment">// 因为 Function 也是通过 new Function() 产生的，所以 Function.__proto__ === Function.prototype</span></span><br><span class="line"><span class="built_in">console</span>.log(F1.__proto__);</span><br><span class="line"><span class="built_in">console</span>.log(F3.__proto__);</span><br><span class="line"><span class="built_in">console</span>.log(F1.__proto__ === F2.__proto__);</span><br><span class="line"><span class="built_in">console</span>.log(F1.__proto__ === <span class="built_in">Function</span>.prototype);</span><br><span class="line"><span class="built_in">console</span>.log(F3.__proto__ === <span class="built_in">Function</span>.prototype);</span><br><span class="line"><span class="built_in">console</span>.log(<span class="built_in">Function</span>.__proto__ === <span class="built_in">Function</span>.prototype);</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">&quot;---------------------------------&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 1. 函数的显示原型指向的对象默认是空 Object 实例对象（Object例外)</span></span><br><span class="line"><span class="built_in">console</span>.log(Fn.prototype <span class="keyword">instanceof</span> <span class="built_in">Object</span>);</span><br><span class="line"><span class="built_in">console</span>.log(<span class="built_in">Function</span>.prototype <span class="keyword">instanceof</span> <span class="built_in">Object</span>);</span><br><span class="line"><span class="built_in">console</span>.log(<span class="built_in">Object</span>.prototype <span class="keyword">instanceof</span> <span class="built_in">Object</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 2. 所有函数都是 Function 实例，包括 Function</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="built_in">Function</span>.__proto__ === <span class="built_in">Function</span>.prototype);</span><br><span class="line"><span class="built_in">console</span>.log(<span class="built_in">Object</span>.__proto__ === <span class="built_in">Function</span>.prototype);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 3. Object 的原型对象是原型链的尽头</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="built_in">Object</span>.prototype.__proto__); <span class="comment">// null</span></span><br></pre></td></tr></table></figure>
<img data-src="/2019/07/15/node/prototype1.png" class="" title="原型">
<p>图解原型链</p>
<img data-src="/2019/07/15/node/prototype2.png" class="" title="原型链">
<h2 id="node"><a class="markdownIt-Anchor" href="#node">#</a> node</h2>
<h3 id="模块"><a class="markdownIt-Anchor" href="#模块">#</a> 模块</h3>
<h4 id="exports"><a class="markdownIt-Anchor" href="#exports">#</a> exports</h4>
<p>exports 对象是当前模块的导出对象，用于导出模块公有方法和属性。别的模块通过 require 函数使用当前模块时得到的就是当前模块的 exports 对象。以下例子中导出了一个公有方法。 <code>const exports = module.exports</code>  , exports 是 module.exports 的快捷方式，NodeJS 对外暴露模块是通过 module.exports, 不能修改 exports 的指向，否则就不会导出模块。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">exports</span>.hello = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&quot;Hello World!&quot;</span>);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 改变了 exports 指向， module.exports 不会导出 hello</span></span><br><span class="line"><span class="built_in">exports</span> = &#123;</span><br><span class="line">    hello: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">&quot;Hello World!&quot;</span>);</span><br><span class="line">    &#125;,</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">// 可以使用 module.exports 直接导出对象</span></span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">    hello: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">&quot;Hello World!&quot;</span>);</span><br><span class="line">    &#125;,</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h4 id="module"><a class="markdownIt-Anchor" href="#module">#</a> module</h4>
<p>通过 module 对象可以访问到当前模块的一些相关信息，但最多的用途是替换当前模块的导出对象。例如模块导出对象默认是一个普通对象，如果想改成一个函数的话，可以使用以下方式。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">module</span>.exports = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&quot;Hello World!&quot;</span>);</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p>以上代码中，模块默认导出对象被替换为一个函数。</p>
<h4 id="模块初始化"><a class="markdownIt-Anchor" href="#模块初始化">#</a> 模块初始化</h4>
<p>一个模块中的 JS 代码仅在模块第一次被使用时执行一次，并在执行过程中初始化模块的导出对象。之后，缓存起来的导出对象被重复利用。例如有以下目录。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">-<span class="regexp">/home/</span>ersu / hello / -util / counter.js;</span><br><span class="line">main.js;</span><br></pre></td></tr></table></figure>
<p>其中 counter.js 内容如下：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> i = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">count</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> ++i;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">exports</span>.count = count;</span><br></pre></td></tr></table></figure>
<p>该模块内部定义了一个私有变量 i，并在 exports 对象导出了一个公有方法 count。主模块 main.js 内容如下：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> counter1 = <span class="built_in">require</span>(<span class="string">&quot;./util/counter&quot;</span>);</span><br><span class="line"><span class="keyword">var</span> counter2 = <span class="built_in">require</span>(<span class="string">&quot;./util/counter&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(counter1.count());</span><br><span class="line"><span class="built_in">console</span>.log(counter2.count());</span><br><span class="line"><span class="built_in">console</span>.log(counter2.count());</span><br></pre></td></tr></table></figure>
<p>运行该程序的结果如下：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$ node main.js</span><br><span class="line"><span class="number">1</span></span><br><span class="line"><span class="number">2</span></span><br><span class="line"><span class="number">3</span></span><br></pre></td></tr></table></figure>
<p>可以看到，counter.js 并没有因为被 require 了两次而初始化两次。</p>
<h4 id="模块路径解析规则"><a class="markdownIt-Anchor" href="#模块路径解析规则">#</a> 模块路径解析规则</h4>
<p><strong>内置模块</strong></p>
<p>如果传递给 require 函数的是 NodeJS 内置模块名称，不做路径解析，直接返回内部模块的导出对象，例如 require (‘fs’)。</p>
<p><strong>node_modules 目录</strong></p>
<p>NodeJS 定义了一个特殊的 node_modules 目录用于存放模块。例如某个模块的绝对路径是 /home/user/hello.js，在该模块中使用 require (‘foo/bar’) 方式加载模块时，则 NodeJS 依次尝试使用以下路径。</p>
<p><code>/home/user/node_modules/foo/bar</code>  -&gt;  <code>/home/node_modules/foo/bar</code>  -&gt;  <code>/node_modules/foo/bar</code></p>
<p><strong>NODE_PATH 环境变量</strong></p>
<p>与 PATH 环境变量类似，NodeJS 允许通过  <code>NODE_PATH</code>  环境变量来指定额外的模块搜索路径。NODE_PATH 环境变量中包含一到多个目录路径，路径之间在 Linux 下使用  <code>:</code>  分隔，在 Windows 下使用  <code>;</code>  分隔。例如定义了以下 NODE_PATH 环境变量：</p>
<p><code>NODE_PATH=/home/user/lib;/home/lib</code></p>
<p>当使用 require (‘foo/bar’) 的方式加载模块时，则 NodeJS 依次尝试以下路径。</p>
<p><code>/home/user/lib/foo/bar</code>  -&gt;  <code>/home/lib/foo/bar</code></p>
<h3 id="命令行程序"><a class="markdownIt-Anchor" href="#命令行程序">#</a> 命令行程序</h3>
<p>在 Windows 系统下的做法完全不同，我们得靠.cmd 文件来解决问题。<br>
假设 node-echo.js 存放在 C:\Users\user\bin 目录，并且该目录已经添加到 PATH 环境变量里了。<br>
接下来需要在该目录下新建一个名为 node-echo.cmd 的文件，文件内容如下：</p>
<p><code>@node &quot;C:\User\user\bin\node-echo.js&quot; %*</code></p>
<p>这样处理后，我们就可以在任何目录下使用 node-echo 命令了。</p>
<h3 id="packagejson-中的-bin"><a class="markdownIt-Anchor" href="#packagejson-中的-bin">#</a> package.json 中的 bin</h3>
<p>许多包有一个或多个可执行文件希望被安装到系统路径。在 npm 下要这么做非常容易 (事实上，npm 就是这么运行的)。这需要在你的 package.json 中提供一个 bin 字段，它是一个命令名和本地文件名的映射。在安装时，如果是全局安装，npm 将会使用符号链接把这些文件链接到 prefix/bin，如果是本地安装，会链接到./node_modules/.bin/。比如，要使用 myapp 作为命令时可以这么做：</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123; <span class="attr">&quot;bin&quot;</span>: &#123; <span class="attr">&quot;myapp&quot;</span>: <span class="string">&quot;./cli.js&quot;</span> &#125; &#125;</span><br></pre></td></tr></table></figure>
<p>这么一来，当你安装 myapp，npm 会从 cli.js 文件创建一个到 /usr/local/bin/myapp 的符号链接 (这使你可以直接在命令行执行 myapp)。如果你只有一个可执行文件，那么它的名字应该和包名相同，此时只需要提供这个文件路径 (字符串)，比如：</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="attr">&quot;name&quot;</span>: <span class="string">&quot;my-program&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;version&quot;</span>: <span class="string">&quot;1.2.5&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;bin&quot;</span>: <span class="string">&quot;./path/to/program&quot;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>这和以下这种写法相同：</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="attr">&quot;name&quot;</span>: <span class="string">&quot;my-program&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;version&quot;</span>: <span class="string">&quot;1.2.5&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;bin&quot;</span>: &#123;</span><br><span class="line">        <span class="attr">&quot;my-program&quot;</span>: <span class="string">&quot;./path/to/program&quot;</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="process"><a class="markdownIt-Anchor" href="#process">#</a> process</h3>
<p>process 是一个全局变量，可通过 process.argv 获得命令行参数。由于 argv [0] 固定等于 NodeJS 执行程序的绝对路径，argv [1] 固定等于主模块的绝对路径，因此第一个命令行参数从 argv [2] 这个位置开始。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> fs = <span class="built_in">require</span>(<span class="string">&quot;fs&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">copy</span>(<span class="params">src, dst</span>) </span>&#123;</span><br><span class="line">    fs.createReadStream(src).pipe(fs.createWriteStream(dst));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">main</span>(<span class="params">argv</span>) </span>&#123;</span><br><span class="line">    copy(argv[<span class="number">0</span>], argv[<span class="number">1</span>]);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">main(process.argv.slice(<span class="number">2</span>));</span><br></pre></td></tr></table></figure>
<h3 id="文件操作"><a class="markdownIt-Anchor" href="#文件操作">#</a> 文件操作</h3>
<h4 id="stream"><a class="markdownIt-Anchor" href="#stream">#</a> Stream</h4>
<p>stream 以流的方式读写文件</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> fs = <span class="built_in">require</span>(<span class="string">&quot;fs&quot;</span>);</span><br><span class="line"><span class="keyword">var</span> rs = fs.createReadStream(src);</span><br><span class="line"></span><br><span class="line">rs.on(<span class="string">&quot;data&quot;</span>, <span class="function"><span class="keyword">function</span> (<span class="params">chunk</span>) </span>&#123;</span><br><span class="line">    <span class="comment">// 处理数据前暂停数据读取，并在处理数据后继续读取数据</span></span><br><span class="line">    rs.pause(); <span class="comment">//暂停</span></span><br><span class="line">    doSomething(chunk, <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">        rs.resume(); <span class="comment">//继续</span></span><br><span class="line">    &#125;);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">rs.on(<span class="string">&quot;end&quot;</span>, <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    cleanUp();</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 如果写入速度跟不上读取速度的话，只写数据流内部的缓存会爆仓。</span></span><br><span class="line"><span class="comment">// 我们可以根据 write 方法的返回值来判断传入的数据是写入目标了，还是临时放在了缓存了，</span></span><br><span class="line"><span class="comment">// 并根据 drain 事件来判断什么时候只写数据流已经将缓存中的数据写入目标， 可以传入下一个待写数据了。</span></span><br><span class="line"><span class="comment">// 因此代码可以改造如下：</span></span><br><span class="line"><span class="keyword">var</span> rs = fs.createReadStream(src);</span><br><span class="line"><span class="keyword">var</span> ws = fs.createWriteStream(dst);</span><br><span class="line">rs.on(<span class="string">&quot;data&quot;</span>, <span class="function"><span class="keyword">function</span> (<span class="params">chunk</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (ws.write(chunk) === <span class="literal">false</span>) &#123;</span><br><span class="line">        rs.pause();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">rs.on(<span class="string">&quot;end&quot;</span>, <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    ws.end();</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">ws.on(<span class="string">&quot;drain&quot;</span>, <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="comment">//drain 排水，流干</span></span><br><span class="line">    rs.resume();</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<h4 id="bom-的移除"><a class="markdownIt-Anchor" href="#bom-的移除">#</a> BOM 的移除</h4>
<p>BOM 用于标记一个文本文件使用 Unicode 编码，其本身是一个 Unicode 字符（&quot;\uFEFF&quot;），位于文本文件头部。<br>
在不同的 Unicode 编码下，BOM 字符对应的二进制字节如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">    Bytes      Encoding</span><br><span class="line">----------------------------</span><br><span class="line">    FE FF       UTF16BE</span><br><span class="line">    FF FE       UTF16LE</span><br><span class="line">    EF BB BF    UTF8</span><br></pre></td></tr></table></figure>
<p>因此，我们可以根据文本文件头几个字节等于啥来判断文件是否包含 BOM，以及使用哪种 Unicode 编码。但是，BOM 字符虽然起到了标记文件编码的作用，其本身却不属于文件内容的一部分，如果读取文本文件时不去掉 BOM，在某些使用场景下就会有问题。例如我们把几个 JS 文件合并成一个文件后，如果文件中间含有 BOM 字符，就会导致浏览器 JS 语法错误。因此，使用 NodeJS 读取文本文件时，一般需要去掉 BOM。例如，以下代码实现了识别和去除 UTF8 BOM 的功能。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">readText</span>(<span class="params">pathname</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> bin = fs.readFileSync(pathname);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (bin[<span class="number">0</span>] === <span class="number">0xef</span> &amp;&amp; bin[<span class="number">1</span>] === <span class="number">0xbb</span> &amp;&amp; bin[<span class="number">2</span>] === <span class="number">0xbf</span>) &#123;</span><br><span class="line">        bin = bin.slice(<span class="number">3</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> bin.toString(<span class="string">&quot;utf-8&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="gbk-转-utf8"><a class="markdownIt-Anchor" href="#gbk-转-utf8">#</a> GBK 转 UTF8</h4>
<p>NodeJS 支持在读取文本文件时，或者在 Buffer 转换为字符串时指定文本编码，但遗憾的是，GBK 编码不在 NodeJS 自身支持范围内。因此，一般我们借助 iconv-lite 这个三方包来转换编码。使用 NPM 下载该包后，我们可以按下边方式编写一个读取 GBK 文本文件的函数。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> iconv = <span class="built_in">require</span>(<span class="string">&quot;iconv-lite&quot;</span>);</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">readGBKText</span>(<span class="params">pathname</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> bin = fs.readFileSync(pathname);</span><br><span class="line">    <span class="keyword">return</span> iconv.decode(bin, <span class="string">&quot;gbk&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="http"><a class="markdownIt-Anchor" href="#http">#</a> http</h3>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// server</span></span><br><span class="line">http.createServer(<span class="function"><span class="keyword">function</span> (<span class="params">request, response</span>) </span>&#123;</span><br><span class="line">    response.writeHead(<span class="number">200</span>, &#123; <span class="string">&quot;Content-Type&quot;</span>: <span class="string">&quot;text/plain&quot;</span> &#125;);</span><br><span class="line"></span><br><span class="line">    request.on(<span class="string">&quot;data&quot;</span>, <span class="function"><span class="keyword">function</span> (<span class="params">chunk</span>) </span>&#123;</span><br><span class="line">        response.write(chunk);</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line">    request.on(<span class="string">&quot;end&quot;</span>, <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">        response.end();</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;).listen(<span class="number">80</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// client</span></span><br><span class="line"><span class="keyword">var</span> options = &#123;</span><br><span class="line">    hostname: <span class="string">&quot;www.example.com&quot;</span>,</span><br><span class="line">    port: <span class="number">80</span>,</span><br><span class="line">    path: <span class="string">&quot;/upload&quot;</span>,</span><br><span class="line">    method: <span class="string">&quot;POST&quot;</span>,</span><br><span class="line">    headers: &#123;</span><br><span class="line">        <span class="string">&quot;Content-Type&quot;</span>: <span class="string">&quot;application/x-www-form-urlencoded&quot;</span>,</span><br><span class="line">    &#125;,</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> request = http.request(options, <span class="function"><span class="keyword">function</span> (<span class="params">response</span>) </span>&#123;&#125;);</span><br><span class="line"></span><br><span class="line">request.write(<span class="string">&quot;Hello World&quot;</span>);</span><br><span class="line">request.end();</span><br></pre></td></tr></table></figure>
<h3 id="event"><a class="markdownIt-Anchor" href="#event">#</a> event</h3>
<p>扩展事件发射器实现文件监听</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> events = <span class="built_in">require</span>(<span class="string">&quot;events&quot;</span>);</span><br><span class="line"><span class="keyword">var</span> util = <span class="built_in">require</span>(<span class="string">&quot;util&quot;</span>);</span><br><span class="line"><span class="keyword">var</span> fs = <span class="built_in">require</span>(<span class="string">&quot;fs&quot;</span>);</span><br><span class="line"><span class="keyword">var</span> watchDir = <span class="string">&quot;./watch&quot;</span>;</span><br><span class="line"><span class="keyword">var</span> processDir = <span class="string">&quot;./done&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 创建文件监视器构造器</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Watcher</span>(<span class="params">watchDir, processDir</span>) </span>&#123;</span><br><span class="line">    <span class="built_in">this</span>.watchDir = watchDir;</span><br><span class="line">    <span class="built_in">this</span>.processDir = processDir;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 继承事件发射器行为</span></span><br><span class="line">util.inherits(Watcher, events.EventEmitter);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 扩展事件发射器行为</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// Node wacthFile 监控目录文件变动，触发 watch 方法</span></span><br><span class="line">Watcher.prototype.start = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> watcher = <span class="built_in">this</span>;</span><br><span class="line">    fs.watchFile(<span class="built_in">this</span>.watchDir, <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">        watcher.watch();</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// wacth 方法对每一个文件发出 process 事件</span></span><br><span class="line">Watcher.prototype.watch = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> watcher = <span class="built_in">this</span>;</span><br><span class="line">    fs.readdir(<span class="built_in">this</span>.watchDir, <span class="function"><span class="keyword">function</span> (<span class="params">err, files</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (err) <span class="keyword">throw</span> err;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">var</span> index <span class="keyword">in</span> files) &#123;</span><br><span class="line">            watcher.emit(<span class="string">&quot;process&quot;</span>, files[index]);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> watcher = <span class="keyword">new</span> Watcher(watchDir, processDir);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 监听文件 process 事件，将文件名转换为小写从原始目录移动到目标目录</span></span><br><span class="line">watcher.on(<span class="string">&quot;process&quot;</span>, <span class="function"><span class="keyword">function</span> <span class="title">process</span>(<span class="params">file</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> wacthFile = <span class="built_in">this</span>.watchDir + <span class="string">&quot;/&quot;</span> + file;</span><br><span class="line">    <span class="keyword">var</span> processFile = <span class="built_in">this</span>.processDir + <span class="string">&quot;/&quot;</span> + file.toLowerCase();</span><br><span class="line">    fs.rename(wacthFile, processFile, <span class="function"><span class="keyword">function</span> (<span class="params">err</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (err) <span class="keyword">throw</span> err;</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">watcher.start();</span><br></pre></td></tr></table></figure>
<h3 id="正则"><a class="markdownIt-Anchor" href="#正则">#</a> 正则</h3>
<p><code>\b</code>  匹配单词边界</p>
<p><code>x(?=y)</code>  如果 y 跟随在 x 后面，匹配 x</p>
<p><code>x(?=y)</code>  如果 y 不跟随在 x 后面，匹配 x</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> date = <span class="keyword">new</span> <span class="built_in">Date</span>(<span class="string">&quot;2019-03-01T08:02:06Z&quot;</span>);</span><br><span class="line"><span class="keyword">let</span> localDateString = date.toLocaleDateString();</span><br><span class="line"><span class="built_in">console</span>.log(localDateString); <span class="comment">// 2019-3-1</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">&quot;2019-3-1&quot;</span>.replace(<span class="regexp">/(\b\d\b)/g</span>, <span class="string">&quot;0&quot;</span>)); <span class="comment">// 2019-0-0</span></span><br><span class="line"><span class="comment">// x(?=y)  Matches x only if x is followed by y.</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">&quot;2019-3-1&quot;</span>.replace(<span class="regexp">/(?=\b\d\b)/g</span>, <span class="string">&quot;0&quot;</span>)); <span class="comment">// 2019-03-01</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">&quot;123xx123&quot;</span>.replace(<span class="regexp">/\d(?!$)/g</span>, <span class="string">&quot;•&quot;</span>)); <span class="comment">//  •••xx••3 替换非最后一个数字为 •</span></span><br></pre></td></tr></table></figure>
<h3 id="判断空字符串nullundefined"><a class="markdownIt-Anchor" href="#判断空字符串nullundefined">#</a> 判断空字符串，null，undefined</h3>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// !name 可以判断  name=&quot;&quot;, null, undefined</span></span><br><span class="line"><span class="comment">// /^[ ]+$/.test(name) 可以判断 name=&quot; &quot;, &quot;   &quot;</span></span><br><span class="line"><span class="keyword">if</span> (!name || <span class="regexp">/^[ ]+$/</span>.test(name)) &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&quot;missing name&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 只判断 name=&quot;&quot;, &quot; &quot;, &quot;   &quot; 不判断 null, undefined</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">isNull</span>(<span class="params">str</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (str == <span class="string">&quot;&quot;</span>) <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    <span class="keyword">let</span> re = <span class="keyword">new</span> <span class="built_in">RegExp</span>(<span class="string">&quot;^[ ]+$&quot;</span>);</span><br><span class="line">    <span class="keyword">return</span> re.test(str);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="generaterandomalphanum"><a class="markdownIt-Anchor" href="#generaterandomalphanum">#</a> GenerateRandomAlphaNum</h3>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// toString(36) 转换为 36 进制</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">generateRandomAlphaNum</span>(<span class="params">len</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">let</span> rmdString = <span class="string">&quot;&quot;</span>;</span><br><span class="line">    <span class="keyword">for</span> (</span><br><span class="line">        ;</span><br><span class="line">        rmdString.length &lt; len;</span><br><span class="line">        rmdString += <span class="built_in">Math</span>.random().toString(<span class="number">36</span>).substr(<span class="number">2</span>)</span><br><span class="line">    );</span><br><span class="line">    <span class="keyword">return</span> rmdString.substr(<span class="number">0</span>, len);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(generateRandomAlphaNum(<span class="number">12</span>)); <span class="comment">// 6qy9i7w5j1sw</span></span><br></pre></td></tr></table></figure>
<h3 id="parseint-~~"><a class="markdownIt-Anchor" href="#parseint-~~">#</a> parseInt &amp; ~~</h3>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">console</span>.log(~<span class="number">1.5</span>, ~-<span class="number">1.5</span>); <span class="comment">// -2 0</span></span><br><span class="line"><span class="built_in">console</span>.log(</span><br><span class="line">    ~~<span class="number">1.5</span>,</span><br><span class="line">    ~~-<span class="number">1.5</span>,</span><br><span class="line">    <span class="built_in">Math</span>.floor(<span class="number">1.5</span>),</span><br><span class="line">    <span class="built_in">Math</span>.floor(-<span class="number">1.5</span>),</span><br><span class="line">    <span class="built_in">Math</span>.ceil(<span class="number">1.5</span>),</span><br><span class="line">    <span class="built_in">Math</span>.ceil(-<span class="number">1.5</span>)</span><br><span class="line">); <span class="comment">// 1 -1 1 -2 2 -1</span></span><br><span class="line"><span class="built_in">console</span>.log(</span><br><span class="line">    <span class="built_in">parseInt</span>(<span class="number">1.5</span>),</span><br><span class="line">    <span class="built_in">parseInt</span>(-<span class="number">1.5</span>),</span><br><span class="line">    <span class="built_in">parseInt</span>(<span class="number">0.000001</span>),</span><br><span class="line">    <span class="built_in">parseInt</span>(<span class="number">0.0000001</span>),</span><br><span class="line">    ~~<span class="number">0.0000001</span></span><br><span class="line">); <span class="comment">// 1 -1 0 1 0</span></span><br></pre></td></tr></table></figure>
<h3 id="const"><a class="markdownIt-Anchor" href="#const">#</a> const</h3>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// es5</span></span><br><span class="line"><span class="built_in">Object</span>.defineProperty(<span class="built_in">window</span>, <span class="string">&quot;name&quot;</span>, &#123;</span><br><span class="line">    value: <span class="string">&quot;babb&quot;</span>,</span><br><span class="line">    writable: <span class="literal">false</span>,</span><br><span class="line">&#125;);</span><br><span class="line">name = <span class="string">&quot;babb chen&quot;</span>;</span><br><span class="line"><span class="built_in">console</span>.log(name); <span class="comment">// babb</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> name = <span class="string">&quot;babb&quot;</span>;</span><br><span class="line"><span class="keyword">const</span> name2 = <span class="string">&quot;babb chen&quot;</span>;</span><br><span class="line"><span class="built_in">console</span>.log(<span class="built_in">window</span>.name); <span class="comment">// , window has name property, default is empty</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="built_in">window</span>.name2); <span class="comment">// undefined, const not belong top window</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// const obj = &#123;</span></span><br><span class="line"><span class="comment">//     name: &quot;babb&quot;,</span></span><br><span class="line"><span class="comment">//     age: 18,</span></span><br><span class="line"><span class="comment">// &#125;;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// Object.freeze(obj);</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// obj.name = &quot;babb chen&quot;;</span></span><br><span class="line"><span class="comment">// console.log(obj); // &#123;name: &quot;babb&quot;, age: 18&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// const obj = &#123;</span></span><br><span class="line"><span class="comment">//     name: &quot;es6&quot;,</span></span><br><span class="line"><span class="comment">//     extensions: [&quot;es7&quot;, &quot;es8&quot;, &quot;es9&quot;],</span></span><br><span class="line"><span class="comment">// &#125;;</span></span><br><span class="line"><span class="comment">// Object.freeze(obj);</span></span><br><span class="line"><span class="comment">// obj.extensions[0] = &quot;es2016&quot;;</span></span><br><span class="line"><span class="comment">// console.log(obj.extensions); // [&quot;es2016&quot;, &quot;es8&quot;, &quot;es9&quot;]</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> obj = &#123;</span><br><span class="line">    name: <span class="string">&quot;es6&quot;</span>,</span><br><span class="line">    extensions: [<span class="string">&quot;es7&quot;</span>, <span class="string">&quot;es8&quot;</span>, <span class="string">&quot;es9&quot;</span>],</span><br><span class="line">&#125;;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">myFreeze</span>(<span class="params">obj</span>) </span>&#123;</span><br><span class="line">    <span class="built_in">Object</span>.freeze(obj);</span><br><span class="line">    <span class="built_in">Object</span>.keys(obj).forEach(<span class="function">(<span class="params">k</span>) =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">typeof</span> obj[k] === <span class="string">&quot;object&quot;</span>) &#123;</span><br><span class="line">            myFreeze(obj[k]);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br><span class="line">myFreeze(obj);</span><br><span class="line">obj.extensions[<span class="number">0</span>] = <span class="string">&quot;es2016&quot;</span>;</span><br><span class="line"><span class="built_in">console</span>.log(obj.extensions);</span><br></pre></td></tr></table></figure>
<h3 id="node-2"><a class="markdownIt-Anchor" href="#node-2">#</a> node .</h3>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="attr">&quot;name&quot;</span>: <span class="string">&quot;npx-example&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;version&quot;</span>: <span class="string">&quot;1.0.0&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;main&quot;</span>: <span class="string">&quot;index.js&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;bin&quot;</span>: <span class="string">&quot;index.js&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;scripts&quot;</span>: &#123;</span><br><span class="line">        <span class="attr">&quot;start&quot;</span>: <span class="string">&quot;node .&quot;</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">&quot;license&quot;</span>: <span class="string">&quot;MIT&quot;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>Node will try to load module located in the folder you pass (. - just bash variant of current folder), and start whatever is written in “main” section of package.json.</p>
<p>if no package.json found in the folder, node will still try to run index.js file.</p>
<h3 id="js-trap"><a class="markdownIt-Anchor" href="#js-trap">#</a> JS trap</h3>
<h4 id="1-0"><a class="markdownIt-Anchor" href="#1-0">#</a> 1 / 0</h4>
<p>在 node 中除以 0 不会产生异常</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">console</span>.log(<span class="number">0</span> / <span class="number">0</span>, <span class="number">1</span> / <span class="number">0</span>, -<span class="number">1</span> / <span class="number">0</span>)</span><br><span class="line"><span class="comment">// NaN Infinity -Infinity</span></span><br></pre></td></tr></table></figure>
<h4 id="undefined-compare"><a class="markdownIt-Anchor" href="#undefined-compare">#</a> undefined compare</h4>
<p>undefined 可以和其它类型比较</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">console</span>.log(<span class="literal">undefined</span> &lt; <span class="number">1</span>, <span class="literal">undefined</span> &gt; <span class="number">1</span>, <span class="literal">undefined</span> &lt; <span class="string">&#x27;1&#x27;</span>)</span><br><span class="line"><span class="comment">// false false false</span></span><br></pre></td></tr></table></figure>

      <div class="tags">
          <a href="/tags/node/" rel="tag"><i class="ic i-tag"></i> node</a>
      </div>
  </div>

   <footer>

    <div class="meta">
  <span class="item">
    <span class="icon">
      <i class="ic i-calendar-check"></i>
    </span>
    <span class="text">Edited on</span>
    <time title="Modified: 2021-05-16 22:28:30" itemprop="dateModified" datetime="2021-05-16T22:28:30+08:00">2021-05-16</time>
  </span>
</div>

      

  </footer>

</article>

  </div>
  

<div class="post-nav">
    <div class="item left">
      

  <a href="/2019/07/14/graphql/" itemprop="url" rel="prev" data-background-image="https:&#x2F;&#x2F;tva3.sinaimg.cn&#x2F;mw690&#x2F;6833939bly1gicit4jrvuj20zk0m8785.jpg" title="GraphQL sample">
  <span class="type">Previous Post</span>
  <span class="category"><i class="ic i-flag"></i> </span>
  <h3>GraphQL sample</h3>
  </a>

    </div>
    <div class="item right">
      

  <a href="/2019/07/15/python-xml/" itemprop="url" rel="next" data-background-image="https:&#x2F;&#x2F;tva3.sinaimg.cn&#x2F;mw690&#x2F;6833939bly1gipeun65urj20zk0m81ii.jpg" title="python xml parsing">
  <span class="type">Next Post</span>
  <span class="category"><i class="ic i-flag"></i> </span>
  <h3>python xml parsing</h3>
  </a>

    </div>
</div>

  
  <div class="wrap" id="comments"></div>


        </div>
        <div id="sidebar">
          

<div class="inner">

  <div class="panels">
    <div class="inner">
      <div class="contents panel pjax" data-title="Contents">
          <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#javascript"><span class="toc-number">1.</span> <span class="toc-text"> javascript</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#javascript-%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B"><span class="toc-number">1.1.</span> <span class="toc-text"> javascript 数据类型</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%B1%BB%E5%9E%8B%E5%88%86%E7%B1%BB"><span class="toc-number">1.1.1.</span> <span class="toc-text"> 类型分类</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%B1%BB%E5%9E%8B%E5%88%A4%E6%96%AD"><span class="toc-number">1.1.2.</span> <span class="toc-text"> 类型判断</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B%E5%92%8C%E5%8F%98%E9%87%8F%E7%B1%BB%E5%9E%8B"><span class="toc-number">1.1.3.</span> <span class="toc-text"> 数据类型和变量类型</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE-%E5%8F%98%E9%87%8F%E5%92%8C%E5%86%85%E5%AD%98"><span class="toc-number">1.1.4.</span> <span class="toc-text"> 数据、变量和内存</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%BC%95%E7%94%A8%E5%8F%98%E9%87%8F%E8%B5%8B%E5%80%BC"><span class="toc-number">1.1.5.</span> <span class="toc-text"> 引用变量赋值</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#javascript-%E5%87%BD%E6%95%B0"><span class="toc-number">1.2.</span> <span class="toc-text"> javascript 函数</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%87%BD%E6%95%B0%E5%AE%9A%E4%B9%89%E6%96%B9%E5%BC%8F"><span class="toc-number">1.2.1.</span> <span class="toc-text"> 函数定义方式</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%87%BD%E6%95%B0%E8%B0%83%E7%94%A8"><span class="toc-number">1.2.2.</span> <span class="toc-text"> 函数调用</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%9B%9E%E8%B0%83%E5%87%BD%E6%95%B0"><span class="toc-number">1.2.3.</span> <span class="toc-text"> 回调函数</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#iife"><span class="toc-number">1.2.4.</span> <span class="toc-text"> IIFE</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#this"><span class="toc-number">1.2.5.</span> <span class="toc-text"> this</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BD%95%E6%97%B6%E5%8A%A0%E5%88%86%E5%8F%B7"><span class="toc-number">1.2.6.</span> <span class="toc-text"> 何时加分号</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#js-%E8%B0%83%E7%94%A8%E5%87%BD%E6%95%B0%E4%BC%A0%E9%80%92%E5%8F%98%E9%87%8F%E5%8F%82%E6%95%B0%E6%98%AF%E5%80%BC%E4%BC%A0%E9%80%92%E8%BF%98%E6%98%AF%E5%BC%95%E7%94%A8%E4%BC%A0%E9%80%92"><span class="toc-number">1.2.7.</span> <span class="toc-text"> js 调用函数传递变量参数是值传递还是引用传递</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#javascript-%E5%AF%B9%E8%B1%A1"><span class="toc-number">1.3.</span> <span class="toc-text"> javascript 对象</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#javascript-%E5%8E%9F%E5%9E%8B"><span class="toc-number">1.4.</span> <span class="toc-text"> javascript 原型</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#node"><span class="toc-number">2.</span> <span class="toc-text"> node</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%A8%A1%E5%9D%97"><span class="toc-number">2.1.</span> <span class="toc-text"> 模块</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#exports"><span class="toc-number">2.1.1.</span> <span class="toc-text"> exports</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#module"><span class="toc-number">2.1.2.</span> <span class="toc-text"> module</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%A8%A1%E5%9D%97%E5%88%9D%E5%A7%8B%E5%8C%96"><span class="toc-number">2.1.3.</span> <span class="toc-text"> 模块初始化</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%A8%A1%E5%9D%97%E8%B7%AF%E5%BE%84%E8%A7%A3%E6%9E%90%E8%A7%84%E5%88%99"><span class="toc-number">2.1.4.</span> <span class="toc-text"> 模块路径解析规则</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%91%BD%E4%BB%A4%E8%A1%8C%E7%A8%8B%E5%BA%8F"><span class="toc-number">2.2.</span> <span class="toc-text"> 命令行程序</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#packagejson-%E4%B8%AD%E7%9A%84-bin"><span class="toc-number">2.3.</span> <span class="toc-text"> package.json 中的 bin</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#process"><span class="toc-number">2.4.</span> <span class="toc-text"> process</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%96%87%E4%BB%B6%E6%93%8D%E4%BD%9C"><span class="toc-number">2.5.</span> <span class="toc-text"> 文件操作</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#stream"><span class="toc-number">2.5.1.</span> <span class="toc-text"> Stream</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#bom-%E7%9A%84%E7%A7%BB%E9%99%A4"><span class="toc-number">2.5.2.</span> <span class="toc-text"> BOM 的移除</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#gbk-%E8%BD%AC-utf8"><span class="toc-number">2.5.3.</span> <span class="toc-text"> GBK 转 UTF8</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#http"><span class="toc-number">2.6.</span> <span class="toc-text"> http</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#event"><span class="toc-number">2.7.</span> <span class="toc-text"> event</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%AD%A3%E5%88%99"><span class="toc-number">2.8.</span> <span class="toc-text"> 正则</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%A4%E6%96%AD%E7%A9%BA%E5%AD%97%E7%AC%A6%E4%B8%B2nullundefined"><span class="toc-number">2.9.</span> <span class="toc-text"> 判断空字符串，null，undefined</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#generaterandomalphanum"><span class="toc-number">2.10.</span> <span class="toc-text"> GenerateRandomAlphaNum</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#parseint-~~"><span class="toc-number">2.11.</span> <span class="toc-text"> parseInt &amp; ~~</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#const"><span class="toc-number">2.12.</span> <span class="toc-text"> const</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#node-2"><span class="toc-number">2.13.</span> <span class="toc-text"> node .</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#js-trap"><span class="toc-number">2.14.</span> <span class="toc-text"> JS trap</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-0"><span class="toc-number">2.14.1.</span> <span class="toc-text"> 1 &#x2F; 0</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#undefined-compare"><span class="toc-number">2.14.2.</span> <span class="toc-text"> undefined compare</span></a></li></ol></li></ol></li></ol>
      </div>
      <div class="related panel pjax" data-title="Related">
      </div>
      <div class="overview panel" data-title="Overview">
        <div class="author" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <img class="image" itemprop="image" alt="江边鸟"
      data-src="/images/avatar.jpg">
  <p class="name" itemprop="name">江边鸟</p>
  <div class="description" itemprop="description"></div>
</div>

<nav class="state">
    <div class="item posts">
      <a href="/archives/">
        <span class="count">257</span>
        <span class="name">posts</span>
      </a>
    </div>
    <div class="item categories">
      <a href="/categories/">
        <span class="count">1</span>
        <span class="name">categories</span>
      </a>
    </div>
    <div class="item tags">
      <a href="/tags/">
        <span class="count">41</span>
        <span class="name">tags</span>
      </a>
    </div>
</nav>

<div class="social">
      <span class="exturl item github" data-url="aHR0cHM6Ly9naXRodWIuY29tL2xoY2hlbjc0" title="https:&#x2F;&#x2F;github.com&#x2F;lhchen74"><i class="ic i-github"></i></span>
      <span class="exturl item twitter" data-url="aHR0cHM6Ly90d2l0dGVyLmNvbS95b3VybmFtZQ==" title="https:&#x2F;&#x2F;twitter.com&#x2F;yourname"><i class="ic i-twitter"></i></span>
      <span class="exturl item zhihu" data-url="aHR0cHM6Ly93d3cuemhpaHUuY29tL3Blb3BsZS95b3VybmFtZQ==" title="https:&#x2F;&#x2F;www.zhihu.com&#x2F;people&#x2F;yourname"><i class="ic i-zhihu"></i></span>
      <span class="exturl item music" data-url="aHR0cHM6Ly9tdXNpYy4xNjMuY29tLyMvdXNlci9ob21lP2lkPXlvdXJpZA==" title="https:&#x2F;&#x2F;music.163.com&#x2F;#&#x2F;user&#x2F;home?id&#x3D;yourid"><i class="ic i-cloud-music"></i></span>
      <span class="exturl item weibo" data-url="aHR0cHM6Ly93ZWliby5jb20veW91cm5hbWU=" title="https:&#x2F;&#x2F;weibo.com&#x2F;yourname"><i class="ic i-weibo"></i></span>
      <span class="exturl item about" data-url="aHR0cHM6Ly9hYm91dC5tZS95b3VybmFtZQ==" title="https:&#x2F;&#x2F;about.me&#x2F;yourname"><i class="ic i-address-card"></i></span>
</div>

<ul class="menu">
  
    
  <li class="item">
    <a href="/" rel="section"><i class="ic i-home"></i>Home</a>
  </li>

    
  <li class="item">
    <a href="/about/" rel="section"><i class="ic i-user"></i>About</a>
  </li>

        
  <li class="item dropdown">
      <a href="javascript:void(0);"><i class="ic i-feather"></i>Posts</a>
    <ul class="submenu">

        
  <li class="item">
    <a href="/archives/" rel="section"><i class="ic i-list-alt"></i>Archives</a>
  </li>

        
  <li class="item">
    <a href="/categories/" rel="section"><i class="ic i-th"></i>Categories</a>
  </li>

        
  <li class="item">
    <a href="/tags/" rel="section"><i class="ic i-tags"></i>Tags</a>
  </li>

  </ul>
    
  <li class="item">
    <a href="/friends/" rel="section"><i class="ic i-heart"></i>friends</a>
  </li>


</ul>

      </div>
    </div>
  </div>

  <ul id="quick">
    <li class="prev pjax">
        <a href="/2019/07/14/graphql/" rel="prev" title="Previous Post"><i class="ic i-chevron-left"></i></a>
    </li>
    <li class="up"><i class="ic i-arrow-up"></i></li>
    <li class="down"><i class="ic i-arrow-down"></i></li>
    <li class="next pjax">
        <a href="/2019/07/15/python-xml/" rel="next" title="Next Post"><i class="ic i-chevron-right"></i></a>
    </li>
    <li class="percent"></li>
  </ul>
</div>


        </div>
        <div class="dimmer"></div>
      </div>
    </main>
    <footer id="footer">
      <div class="inner">
        <div class="widgets">
          

        </div>
        <div class="status">
  <div class="copyright">
    
    &copy; 2010 – 
    <span itemprop="copyrightYear">2021</span>
    <span class="with-love">
      <i class="ic i-sakura rotate"></i>
    </span>
    <span class="author" itemprop="copyrightHolder">江边鸟 @ 露の世</span>
  </div>
  <div class="powered-by">
    Powered by <span class="exturl" data-url="aHR0cHM6Ly9oZXhvLmlv">Hexo</span> & Theme.<span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL2FtZWhpbWUvaGV4by10aGVtZS1zaG9rYQ==">Shoka</span>
  </div>
</div>

      </div>
    </footer>
  </div>
<script data-config type="text/javascript">
  var LOCAL = {
    path: '2019/07/15/node/',
    favicon: {
      show: "（●´3｀●）Goooood",
      hide: "(´Д｀)Booooom"
    },
    search : {
      placeholder: "Search for Posts",
      empty: "We didn't find any results for the search: ${query}",
      stats: "${hits} results found in ${time} ms"
    },
    valine: true,fancybox: true,
    ignores : [
      function(uri) {
        return uri.includes('#');
      },
      function(uri) {
        return new RegExp(LOCAL.path+"$").test(uri);
      }
    ]
  };
</script>

<script src="https://cdn.polyfill.io/v2/polyfill.js"></script>

<script src="//cdn.jsdelivr.net/combine/npm/pace-js@1.0.2/pace.min.js,npm/pjax@0.2.8/pjax.min.js,npm/whatwg-fetch@3.4.0/dist/fetch.umd.min.js,npm/animejs@3.2.0/lib/anime.min.js,npm/algoliasearch@4/dist/algoliasearch-lite.umd.js,npm/instantsearch.js@4/dist/instantsearch.production.min.js,npm/lozad@1/dist/lozad.min.js,npm/quicklink@2/dist/quicklink.umd.js"></script>

<script src="/js/app.js?v=0.2.5"></script>




</body>
</html>
