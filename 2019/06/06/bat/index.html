



<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#FFF">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">

<link rel="icon" type="image/ico" sizes="32x32" href="/images/favicon.ico">
  <meta http-equiv="Cache-Control" content="no-transform">
  <meta http-equiv="Cache-Control" content="no-siteapp">


<link rel="alternate" type="application/rss+xml" title="露の世" href="https://lhchen74.github.io/rss.xml" />
<link rel="alternate" type="application/atom+xml" title="露の世" href="https://lhchen74.github.io/atom.xml" />
<link rel="alternate" type="application/json" title="露の世" href="https://lhchen74.github.io/feed.json" />

<link rel="stylesheet" href="//fonts.googleapis.com/css?family=Mulish:300,300italic,400,400italic,700,700italic%7CFredericka%20the%20Great:300,300italic,400,400italic,700,700italic%7CNoto%20Serif%20JP:300,300italic,400,400italic,700,700italic%7CNoto%20Serif%20SC:300,300italic,400,400italic,700,700italic%7CInconsolata:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext">

<link rel="stylesheet" href="/css/app.css?v=0.2.5">

  
  <meta name="keywords" content="shell" />


<link rel="canonical" href="https://lhchen74.github.io/2019/06/06/bat/">



  <title>
Window Bat - manual |
D E W = 露の世</title>
<meta name="generator" content="Hexo 5.4.0"></head>
<body itemscope itemtype="http://schema.org/WebPage">
  <div id="loading">
    <div class="cat">
      <div class="body"></div>
      <div class="head">
        <div class="face"></div>
      </div>
      <div class="foot">
        <div class="tummy-end"></div>
        <div class="bottom"></div>
        <div class="legs left"></div>
        <div class="legs right"></div>
      </div>
      <div class="paw">
        <div class="hands left"></div>
        <div class="hands right"></div>
      </div>
    </div>
  </div>
  <div id="container">
    <header id="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="inner">
        <div id="brand">
          <div class="pjax">
          
  <h1 itemprop="name headline">Window Bat
  </h1>
  
<div class="meta">
  <span class="item" title="Created: 2019-06-06 00:00:00">
    <span class="icon">
      <i class="ic i-calendar"></i>
    </span>
    <span class="text">Posted on</span>
    <time itemprop="dateCreated datePublished" datetime="2019-06-06T00:00:00+08:00">2019-06-06</time>
  </span>
</div>


          </div>
        </div>
        <nav id="nav">
  <div class="inner">
    <div class="toggle">
      <div class="lines" aria-label="Toggle navigation bar">
        <span class="line"></span>
        <span class="line"></span>
        <span class="line"></span>
      </div>
    </div>
    <ul class="menu">
      <li class="item title"><a href="/" rel="start">D E W</a></li>
    </ul>
    <ul class="right">
      <li class="item theme">
        <i class="ic i-sun"></i>
      </li>
      <li class="item search">
        <i class="ic i-search"></i>
      </li>
    </ul>
  </div>
</nav>

      </div>
      <div id="imgs" class="pjax">
        <ul>
          <li class="item" data-background-image="https://tva3.sinaimg.cn/large/6833939bly1gicliwyw55j20zk0m8hdt.jpg"></li>
          <li class="item" data-background-image="https://tva3.sinaimg.cn/large/6833939bly1gipewf5l51j20zk0m8b29.jpg"></li>
          <li class="item" data-background-image="https://tva3.sinaimg.cn/large/6833939bly1gipetv6p75j20zk0m8x6p.jpg"></li>
          <li class="item" data-background-image="https://tva3.sinaimg.cn/large/6833939bly1giph4baakhj20zk0m8h5q.jpg"></li>
          <li class="item" data-background-image="https://tva3.sinaimg.cn/large/6833939bly1gipexj2jgzj20zk0m8b09.jpg"></li>
          <li class="item" data-background-image="https://tva3.sinaimg.cn/large/6833939bly1giclhtuo6nj20zk0m8ttm.jpg"></li>
        </ul>
      </div>
    </header>
    <div id="waves">
      <svg class="waves" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 24 150 28" preserveAspectRatio="none" shape-rendering="auto">
        <defs>
          <path id="gentle-wave" d="M-160 44c30 0 58-18 88-18s 58 18 88 18 58-18 88-18 58 18 88 18 v44h-352z" />
        </defs>
        <g class="parallax">
          <use xlink:href="#gentle-wave" x="48" y="0" />
          <use xlink:href="#gentle-wave" x="48" y="3" />
          <use xlink:href="#gentle-wave" x="48" y="5" />
          <use xlink:href="#gentle-wave" x="48" y="7" />
        </g>
      </svg>
    </div>
    <main>
      <div class="inner">
        <div id="main" class="pjax">
          
  <div class="article wrap">
    
<div class="breadcrumb" itemscope itemtype="https://schema.org/BreadcrumbList">
<i class="ic i-home"></i>
<span><a href="/">Home</a></span><i class="ic i-angle-right"></i>
<span  class="current" itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem"><a href="/categories/manual/" itemprop="item" rel="index" title="In manual"><span itemprop="name">manual</span></a>
<meta itemprop="position" content="1" /></span>
</div>

    <article itemscope itemtype="http://schema.org/Article" class="post block" lang="en">
  <link itemprop="mainEntityOfPage" href="https://lhchen74.github.io/2019/06/06/bat/">

  <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
    <meta itemprop="image" content="/images/avatar.jpg">
    <meta itemprop="name" content="江边鸟">
    <meta itemprop="description" content=", ">
  </span>

  <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
    <meta itemprop="name" content="露の世">
  </span>

  <div class="body md" itemprop="articleBody">
    

    <h3 id="help"><a class="markdownIt-Anchor" href="#help">#</a> help</h3>
<p>window bat 查看命令的帮助，在命令后面使用  <code>/?</code></p>
<p>例如： <code>set /?</code></p>
<h3 id="set"><a class="markdownIt-Anchor" href="#set">#</a> set</h3>
<p>参数：</p>
<table>
<thead>
<tr>
<th>option</th>
<th>meaning</th>
</tr>
</thead>
<tbody>
<tr>
<td>/A</td>
<td>expression 指定等号右边的字符串为数字表达式</td>
</tr>
<tr>
<td>/P</td>
<td>variable=[promptString] 提示用户输入</td>
</tr>
</tbody>
</table>
<p>示例：</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">@<span class="built_in">echo</span> off</span><br><span class="line"><span class="built_in">set</span> /p b=please input number:</span><br><span class="line"><span class="built_in">echo</span> %b%</span><br><span class="line"><span class="built_in">set</span> /a a=<span class="number">2</span>*%b%</span><br><span class="line"><span class="built_in">echo</span> %b%+%b%=%a%</span><br><span class="line">pause&gt;nul</span><br><span class="line"></span><br><span class="line">:: please input number:<span class="number">2</span></span><br><span class="line">:: <span class="number">2</span></span><br><span class="line">:: <span class="number">2</span>+<span class="number">2</span>=<span class="number">4</span></span><br></pre></td></tr></table></figure>
<h3 id="move"><a class="markdownIt-Anchor" href="#move">#</a> move</h3>
<p>功能：</p>
<ol>
<li>移动一个或多个文件到你指定的位置</li>
<li>重命名目录</li>
</ol>
<p>注意：</p>
<p>move 命令可以跨分区移动文件，却不可以跨分区移动文件夹</p>
<p>参数：</p>
<table>
<thead>
<tr>
<th style="text-align:left">option</th>
<th style="text-align:left">meaning</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">/Y</td>
<td style="text-align:left">发生文件覆盖时不进行提示</td>
</tr>
<tr>
<td style="text-align:left">/-Y</td>
<td style="text-align:left">发生文件覆盖时进行提示</td>
</tr>
</tbody>
</table>
<p>示例：</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">move</span> /<span class="literal">-Y</span> <span class="string">&quot;E:\study\bash\source\e.jpg&quot;</span> <span class="string">&quot;E:\study\bash\dest\d.jpg&quot;</span></span><br></pre></td></tr></table></figure>
<h3 id="del"><a class="markdownIt-Anchor" href="#del">#</a> del</h3>
<p>参数：</p>
<table>
<thead>
<tr>
<th style="text-align:left">option</th>
<th style="text-align:left">meaning</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">/P</td>
<td style="text-align:left">删除每一个文件之前提示确认</td>
</tr>
<tr>
<td style="text-align:left">/F</td>
<td style="text-align:left">强制删除只读文件</td>
</tr>
<tr>
<td style="text-align:left">/S</td>
<td style="text-align:left">从所有子目录删除指定文件</td>
</tr>
<tr>
<td style="text-align:left">/Q</td>
<td style="text-align:left">安静模式，删除全局通配符时，不要求确认</td>
</tr>
<tr>
<td style="text-align:left">/A</td>
<td style="text-align:left">根据属性选择要删除的文件</td>
</tr>
</tbody>
</table>
<p>/A 属性选择：</p>
<table>
<thead>
<tr>
<th style="text-align:left">option</th>
<th style="text-align:left">meaning</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">r</td>
<td style="text-align:left">只读</td>
</tr>
<tr>
<td style="text-align:left">a</td>
<td style="text-align:left">存档</td>
</tr>
<tr>
<td style="text-align:left">s</td>
<td style="text-align:left">系统</td>
</tr>
<tr>
<td style="text-align:left">h</td>
<td style="text-align:left">隐藏</td>
</tr>
<tr>
<td style="text-align:left">-</td>
<td style="text-align:left">前缀表明 非</td>
</tr>
</tbody>
</table>
<p>存档：表示该文件在上次备份前已经修改过了，一些备份软件在备份系统后会把这些文件默认的设为存档属性</p>
<h3 id="for"><a class="markdownIt-Anchor" href="#for">#</a> for</h3>
<p>在 cmd 窗口中，for 之后的形式变量  <code>i</code>  必须使用单百分号引用，即  <code>%i</code> ；而在批处理文件中，引用形式变量  <code>i</code>  必须使用双百分号，即  <code>%%i</code> 。</p>
<p>在 cmd 窗口中：</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">FOR</span> %variable <span class="keyword">IN</span> (<span class="built_in">set</span>) <span class="keyword">DO</span> command [<span class="type">command</span>-<span class="type">parameters</span>]</span><br></pre></td></tr></table></figure>
<p>在批处理文件中：</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">FOR</span> %%variable <span class="keyword">IN</span> (<span class="built_in">set</span>) <span class="keyword">DO</span> command [<span class="type">command</span>-<span class="type">parameters</span>]</span><br></pre></td></tr></table></figure>
<p>基本用法：</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> %%i <span class="keyword">in</span> (<span class="number">1</span> <span class="number">2</span> <span class="number">3</span>) <span class="keyword">do</span> @<span class="built_in">echo</span> %%i</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> %%i <span class="keyword">in</span> (java, ruby, python) <span class="keyword">do</span> @<span class="built_in">echo</span> %%i</span><br><span class="line"></span><br><span class="line"><span class="built_in">set</span> str=c d e f g <span class="built_in">h</span> i j k l m n o p q <span class="built_in">r</span> s t u v w x y z</span><br><span class="line"><span class="keyword">for</span> %%i <span class="keyword">in</span> (%str%) <span class="keyword">do</span> <span class="keyword">if</span> exist %%i: <span class="built_in">echo</span> %%i</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> %%i <span class="keyword">in</span> (*.bat) <span class="keyword">do</span> <span class="built_in">echo</span> <span class="string">&quot;%%i&quot;</span></span><br><span class="line"></span><br><span class="line">:: ? <span class="number">0</span>个或一个字符</span><br><span class="line"><span class="keyword">for</span> %%i <span class="keyword">in</span> (???.bat) <span class="keyword">do</span> <span class="built_in">echo</span> <span class="string">&quot;%%i&quot;</span></span><br></pre></td></tr></table></figure>
<h4 id="for-f"><a class="markdownIt-Anchor" href="#for-f">#</a> for /f</h4>
<p>解析文本、读取文件内容、提取某几行字符、截取某个字符片段、对提取到的内容再处理。</p>
<p>使用方式：</p>
<ul>
<li><code>for /f %%i in (文件名) do</code></li>
<li><code>for /f %%i in ('命令语句') do</code></li>
<li><code>for /f %%i in (&quot;字符串&quot;) do</code></li>
<li><code>for /f &quot;usebackq&quot; %%i in (&quot;文件名&quot;) do (这种方式文件名可以使用空格)</code></li>
<li><code>for /f &quot;usebackq&quot; %%i in (命令语句) do</code></li>
<li><code>for /f &quot;usebackq&quot; %%i in ('字符串') do</code></li>
</ul>
<p>参数：</p>
<table>
<thead>
<tr>
<th style="text-align:left">option</th>
<th>meaning</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">delims=,</td>
<td>以，作为分隔符；默认为空格</td>
</tr>
<tr>
<td style="text-align:left">tokens=2</td>
<td>提取切分的第二部分内容；默认为 1</td>
</tr>
<tr>
<td style="text-align:left">skip=2</td>
<td>跳过无关内容；跳过前两行内容</td>
</tr>
<tr>
<td style="text-align:left">eol=,</td>
<td>忽略以，开头的行；默认为；</td>
</tr>
</tbody>
</table>
<p>测试文本 test.txt：</p>
<figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">php is the best language in the world</span><br><span class="line">life is short, i use python, and you?</span><br></pre></td></tr></table></figure>
<p>测试脚本：</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">::默认 delims 是空格</span><br><span class="line"><span class="keyword">for</span> /f %%i <span class="keyword">in</span> (test.txt) <span class="keyword">do</span> <span class="built_in">echo</span> %%i</span><br><span class="line">::php</span><br><span class="line">::life</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> /f <span class="string">&quot;delims=,&quot;</span> %%i <span class="keyword">in</span> (test.txt) <span class="keyword">do</span> <span class="built_in">echo</span> %%i</span><br><span class="line">::php is the best language <span class="keyword">in</span> the world</span><br><span class="line">::life is short</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> /f <span class="string">&quot;delims=, tokens=1-2,*&quot;</span> %%i <span class="keyword">in</span> (test.txt) <span class="keyword">do</span> <span class="built_in">echo</span> %%i %%j %%k</span><br><span class="line">::php is the best language <span class="keyword">in</span> the world</span><br><span class="line">::life is short  i use python  and you?</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> /f <span class="string">&quot;delims=, tokens=1-2,* eol=p&quot;</span> %%i <span class="keyword">in</span> (test.txt) <span class="keyword">do</span> <span class="built_in">echo</span> %%i %%j %%k</span><br><span class="line">::life is short  i use python  and you?</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> /f <span class="string">&quot;delims=, tokens=1-2,* skip=1&quot;</span> %%i <span class="keyword">in</span> (test.txt) <span class="keyword">do</span> <span class="built_in">echo</span> %%i %%j %%k</span><br><span class="line">::life is short  i use python  and you?</span><br></pre></td></tr></table></figure>
<h4 id="for-r"><a class="markdownIt-Anchor" href="#for-r">#</a> for /r</h4>
<p>遍历文件夹</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">::遍历文件夹和子文件夹，每个文件夹后添加.</span><br><span class="line"><span class="keyword">for</span> /<span class="built_in">r</span> E:\study\bash %%i <span class="keyword">in</span> (.) <span class="keyword">do</span> <span class="built_in">echo</span> %%i</span><br><span class="line">::E:\study\bash\.</span><br><span class="line">::E:\study\bash\dest\.</span><br><span class="line">::E:\study\bash\source\.</span><br><span class="line"></span><br><span class="line">::遍历文件夹和子文件夹下以.txt结尾的文件，不包括文件夹</span><br><span class="line"><span class="keyword">for</span> /<span class="built_in">r</span> E:\study\c<span class="comment">#\bash %%i in (*.txt) do echo %%i</span></span><br><span class="line">::E:\study\bash\test.txt</span><br><span class="line">::E:\study\bash\dest\test.txt</span><br></pre></td></tr></table></figure>
<h4 id="for-l"><a class="markdownIt-Anchor" href="#for-l">#</a> for /l</h4>
<p>计数循环</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">::x、y和z都只能取整数，正负皆可，x指代起始值，y指代步长，z为终止值</span><br><span class="line"><span class="keyword">for</span> /l %%i <span class="keyword">in</span> (<span class="number">1</span>, <span class="number">2</span>, <span class="number">10</span>) <span class="keyword">do</span> <span class="built_in">echo</span> %%i</span><br><span class="line">::<span class="number">1</span></span><br><span class="line">::<span class="number">3</span></span><br><span class="line">::<span class="number">5</span></span><br><span class="line">::<span class="number">7</span></span><br><span class="line">::<span class="number">9</span></span><br></pre></td></tr></table></figure>
<h3 id="forfiles"><a class="markdownIt-Anchor" href="#forfiles">#</a> forfiles</h3>
<p>从文件夹或树中选择要进行批处理的文件，进行相关处理。</p>
<p><code>forfiles [/p Path ][/m SearchMask ] [/s ][/c Command ] [/d [&#123;+ | - &#125;][&#123;MM / DD / YYYY | DD &#125;]]</code></p>
<p>参数：</p>
<table>
<thead>
<tr>
<th style="text-align:left">option</th>
<th style="text-align:left">meaning</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">/p Path</td>
<td style="text-align:left">指定 Path ，表明要从哪里开始搜索。默认的文件夹是当前工作目录 <code>(.)</code></td>
</tr>
<tr>
<td style="text-align:left">/m SearchMask</td>
<td style="text-align:left">按照 SearchMask（模糊搜索） 搜索文件。默认的 SearchMask 是  <code>*.*</code></td>
</tr>
<tr>
<td style="text-align:left">/s</td>
<td style="text-align:left">指示 forfiles 在子目录中搜索</td>
</tr>
<tr>
<td style="text-align:left">/c Command</td>
<td style="text-align:left">在每个文件上运行指定的 Command, 带有空格的命令字符串必须用引号括起来；默认的 Command 是  <code>cmd /c echo @file</code></td>
</tr>
<tr>
<td style="text-align:left">/d</td>
<td style="text-align:left"><code>/d [&#123;+ or -&#125;][&#123;MM/DD/YYYY or DD &#125;]</code>  选择日期  <code>+(&gt;=) or -(&lt;=)</code>  指定日期的文件</td>
</tr>
</tbody>
</table>
<p>删除两天前的文件</p>
<p><code>forfiles /p e:/bak /s /m *.* /d -2 /c &quot;cmd /c del @file&quot;</code></p>
<p>/c command 中可以使用的变量</p>
<table>
<thead>
<tr>
<th>变量</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>@file</td>
<td>文件名</td>
</tr>
<tr>
<td>@fname</td>
<td>无扩展名的文件名</td>
</tr>
<tr>
<td>@ext</td>
<td>文件扩展名</td>
</tr>
<tr>
<td>@path</td>
<td>文件的完整路径</td>
</tr>
<tr>
<td>@relpath</td>
<td>文件的相对路径</td>
</tr>
<tr>
<td>@isdir</td>
<td>如果文件类型是目录，则计算值为 TRUE，否则值为 FALSE</td>
</tr>
<tr>
<td>@fsize</td>
<td>用字节表示的文件大小</td>
</tr>
<tr>
<td>@fdate</td>
<td>文件中上次修改的日期戳</td>
</tr>
<tr>
<td>@ftime</td>
<td>文件中上次修改的时间戳</td>
</tr>
</tbody>
</table>
<h3 id="dir"><a class="markdownIt-Anchor" href="#dir">#</a> dir</h3>
<p>显示目录下的文件和文件夹</p>
<p><code>dir [D:][PATH][NAME][[/A][:attrib]][/o:[sorted][/s][/b][/l][/c[h]</code></p>
<p>参数：</p>
<table>
<thead>
<tr>
<th>option</th>
<th>meaning</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>/a:attrib</strong></td>
<td><strong>以指定属性显示文件，未指定显示所有文件包括隐藏文件</strong></td>
</tr>
<tr>
<td>[h/-h]</td>
<td>只显示隐含文件或非隐含文件。</td>
</tr>
<tr>
<td>[r/-r]</td>
<td>只显示只读文件或非只读文件</td>
</tr>
<tr>
<td>[s/-s]</td>
<td>只显示系统文件或非系统文件</td>
</tr>
<tr>
<td>[a/-a]</td>
<td>只显示要归档文件或非归档文件</td>
</tr>
<tr>
<td><strong>/o[:]</strong></td>
<td><strong>sorted: 缺省完全按字母顺序，子目录显示在文件之前</strong></td>
</tr>
<tr>
<td>[n/-n]</td>
<td>按字母顺序或按文件名顺序 / 反向显示</td>
</tr>
<tr>
<td>[e/-e]</td>
<td>按扩展名字母顺序 / 反向显示</td>
</tr>
<tr>
<td>[d/-d]</td>
<td>按时间顺序 / 反向显示</td>
</tr>
<tr>
<td>[s/-s]</td>
<td>按大小从大到小或 / 反向显示</td>
</tr>
<tr>
<td>[g/-g]</td>
<td>按子目录先于文件或文件先于子目录</td>
</tr>
<tr>
<td>/s 参数</td>
<td>对当前目录及其子目录中所有文件进行列表</td>
</tr>
<tr>
<td>/b 参数</td>
<td>将只显示文件名与扩展名</td>
</tr>
<tr>
<td>/l  参数</td>
<td>将全部用小写字母对文件或子目录进行列表</td>
</tr>
</tbody>
</table>
<p>示例：</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">:: d:test 路径, /b 文件名.扩展名, /o<span class="literal">-d</span> 时间倒序排列, o* 以 o 开头的文件</span><br><span class="line"><span class="built_in">dir</span> d:test /b /o<span class="literal">-d</span> o*</span><br></pre></td></tr></table></figure>
<h3 id="findstr"><a class="markdownIt-Anchor" href="#findstr">#</a> findstr</h3>
<p>findstr 用于查找某路径下指定的一个或多个文件中包含某些特定字符串的行，并将该行完整的信息打印出来，或者打印查询字符串所在的文件名。</p>
<table>
<thead>
<tr>
<th>option</th>
<th>meaning</th>
</tr>
</thead>
<tbody>
<tr>
<td>/i</td>
<td>指定搜索不区分大小写</td>
</tr>
<tr>
<td>/s</td>
<td>在当前目录和所有子目录中搜索匹配的文件</td>
</tr>
<tr>
<td>/c:string</td>
<td>使用指定的文本作为文字搜索字符串</td>
</tr>
</tbody>
</table>
<p>注意： <code>/c:cmd</code>  指定的文本 cmd 作为文字搜索字符串，会查找  <code>'c','m','d','cm','cmd' ...</code>  所在行数据</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">findstr /s /i /c:<span class="string">&quot;cmd&quot;</span> C:\tmp\*.txt</span><br></pre></td></tr></table></figure>
<p>精确查找字符串： <code>&quot;\&lt;string\&gt;&quot;</code></p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">echo</span> hello world computer|findstr <span class="string">&quot;\&lt;computer\&gt;&quot;</span></span><br><span class="line"><span class="built_in">echo</span> hello worldcomputer|findstr <span class="string">&quot;.*computer\&gt;&quot;</span></span><br></pre></td></tr></table></figure>
<h3 id="example"><a class="markdownIt-Anchor" href="#example">#</a> example</h3>
<p>测试文本 test.txt</p>
<figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">php @123 the best language in the world</span><br><span class="line">life is short, i use python</span><br></pre></td></tr></table></figure>
<p>测试脚本</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">:: 以 <span class="selector-tag">@</span> 和 空格分割</span><br><span class="line">:: test*.txt 模式匹配，匹配会包含文件名</span><br><span class="line">:: test.txt:php <span class="number">123</span></span><br><span class="line"><span class="keyword">for</span> /f <span class="string">&quot;tokens=1,2 delims==@ &quot;</span> %%i <span class="keyword">in</span> (<span class="string">&#x27;findstr /c:&quot;@&quot; test*.txt&#x27;</span>) <span class="keyword">do</span> (</span><br><span class="line">    <span class="built_in">echo</span> %%i %%j</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">:: test.txt 完整匹配，匹配不会包含文件名</span><br><span class="line">:: php <span class="number">123</span></span><br><span class="line"><span class="keyword">for</span> /f <span class="string">&quot;tokens=1,2 delims==@ &quot;</span> %%i <span class="keyword">in</span> (<span class="string">&#x27;findstr /c:&quot;@&quot; test.txt&#x27;</span>) <span class="keyword">do</span> (</span><br><span class="line">    <span class="built_in">echo</span> %%i %%j</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">:: 只以 <span class="selector-tag">@</span> 分割</span><br><span class="line">:: php <span class="number">123</span> the best language <span class="keyword">in</span> the world</span><br><span class="line"><span class="keyword">for</span> /f <span class="string">&quot;tokens=1,2 delims==@&quot;</span> %%i <span class="keyword">in</span> (<span class="string">&#x27;findstr /c:&quot;@&quot; test.txt&#x27;</span>) <span class="keyword">do</span> (</span><br><span class="line">    <span class="built_in">echo</span> %%i %%j</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">REM 以 t, <span class="built_in">h</span>, e, th ... the 分割</span><br><span class="line">REM p</span><br><span class="line">REM p @<span class="number">123</span></span><br><span class="line">REM  b</span><br><span class="line">REM s</span><br><span class="line">REM  languag</span><br><span class="line"><span class="keyword">for</span> /f <span class="string">&quot;tokens=1,2,3,4,5 delims==the&quot;</span> %%i <span class="keyword">in</span> (<span class="string">&#x27;findstr /c:&quot;@&quot; test.txt&#x27;</span>) <span class="keyword">do</span> (</span><br><span class="line">    <span class="built_in">echo</span> %%i</span><br><span class="line">    <span class="built_in">echo</span> %%j</span><br><span class="line">    <span class="built_in">echo</span> %%k</span><br><span class="line">    <span class="built_in">echo</span> %%l</span><br><span class="line">    <span class="built_in">echo</span> %%m</span><br><span class="line">）</span><br></pre></td></tr></table></figure>
<h3 id="delayedexpansion"><a class="markdownIt-Anchor" href="#delayedexpansion">#</a> delayedexpansion</h3>
<p>批处理运行命令的机制：批处理读取命令时是按行读取的（另外 for 命令等，其后用一对圆括号闭合的所有语句也当作一行），在处理之前要完成必要的预处理工作，这其中就包括对该行命令中的变量赋值。例如：批处理在运行到这句  <code>set a=5&amp;echo %a%</code>  之前，先把这一句整句读取并做了预处理 — 之前对变量 a 赋了值，那么 % a% 就是 4</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">@<span class="built_in">echo</span> off</span><br><span class="line"><span class="built_in">set</span> a=<span class="number">4</span></span><br><span class="line"><span class="built_in">set</span> a=<span class="number">5</span>&amp;<span class="built_in">echo</span> %a%</span><br><span class="line">pause</span><br><span class="line">:: <span class="number">4</span></span><br></pre></td></tr></table></figure>
<p>为了能够感知环境变量的动态变化，批处理设计了变量延迟。简单来说，在读取了一条完整的语句之后，不立即对该行的变量赋值。变量引用要用  <code>! !</code>  包裹</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">@<span class="built_in">echo</span> off</span><br><span class="line">setlocal enabledelayedexpansion</span><br><span class="line"><span class="built_in">set</span> a=<span class="number">4</span></span><br><span class="line"><span class="built_in">set</span> a=<span class="number">5</span>&amp;<span class="built_in">echo</span> !a!</span><br><span class="line">pause</span><br><span class="line">::<span class="number">5</span></span><br></pre></td></tr></table></figure>
<p>for 命令等，其后用一对圆括号闭合的所有语句也当作一行，下面是使用变量延迟扩展和不使用的区别</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">@<span class="built_in">echo</span> off&amp;setlocal enabledelayedexpansion</span><br><span class="line"><span class="keyword">for</span> /l %%i <span class="keyword">in</span> (<span class="number">1</span>, <span class="number">2</span>, <span class="number">5</span>) <span class="keyword">do</span> (</span><br><span class="line">    <span class="built_in">set</span> <span class="string">&quot;a=%%i&quot;</span></span><br><span class="line">    <span class="built_in">echo</span> !a!</span><br><span class="line">)</span><br><span class="line">pause&gt;nul</span><br><span class="line">:: <span class="number">1</span></span><br><span class="line">:: <span class="number">3</span></span><br><span class="line">:: <span class="number">5</span></span><br><span class="line"></span><br><span class="line">@<span class="built_in">echo</span> off</span><br><span class="line"><span class="keyword">for</span> /l %%i <span class="keyword">in</span> (<span class="number">1</span>,<span class="number">2</span>,<span class="number">5</span>) <span class="keyword">do</span> (</span><br><span class="line">    <span class="built_in">set</span> <span class="string">&quot;a=%%i&quot;</span></span><br><span class="line">    <span class="built_in">echo</span> %a%</span><br><span class="line">)</span><br><span class="line">pause&gt;nul</span><br><span class="line">:: <span class="built_in">ECHO</span> 处于关闭状态。</span><br><span class="line">:: <span class="built_in">ECHO</span> 处于关闭状态。</span><br><span class="line">:: <span class="built_in">ECHO</span> 处于关闭状态。</span><br></pre></td></tr></table></figure>
<h3 id="goto-eof"><a class="markdownIt-Anchor" href="#goto-eof">#</a> goto :eof</h3>
<ul>
<li>
<p>在主程序中使用</p>
<p>如果是在主程序使用 goto :eof，那它的作用就是退出批处理并关闭 cmd 窗口，作用相当于 exit</p>
</li>
<li>
<p>在子程序中使用</p>
<p>子程序就是指，用 call 调用的部分，如果是在子程序使用 goto :eof 作用就是结束当前子程序并把控制权交还给调用它的主程序以便主程序继续执行下面的命令</p>
</li>
</ul>
<h3 id="call"><a class="markdownIt-Anchor" href="#call">#</a> call</h3>
<ul>
<li>
<p>调用另一个批处理</p>
<p>在批处理中，可以使用  <code>%*</code>  代表所有参数  <code>%1-%9</code>  代表 9 个参数， <code>%0</code>  代表批处理自己</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">:: %<span class="number">0</span> 代表 a.bat 自己，%<span class="number">1</span> 代表 hello，%<span class="number">2</span> 代表 world</span><br><span class="line">call a.bat hello world</span><br></pre></td></tr></table></figure>
</li>
<li>
<p>调用一个命令</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">call ping <span class="number">127.0</span>.<span class="number">0.1</span></span><br></pre></td></tr></table></figure>
</li>
<li>
<p>调用一个应用程序</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">call python test.py</span><br></pre></td></tr></table></figure>
</li>
<li>
<p>调用批处理的一个标签</p>
<p>goto :no1 是转到标签 :no1 处运行，运行完就退出，而 call 是调用 :no1，运行完继续执行 call 下面的命令</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">:: 先启动 calc 然后启动 notepad.exe 再退出</span><br><span class="line">@<span class="built_in">echo</span> off</span><br><span class="line">call :no1</span><br><span class="line"><span class="built_in">start</span> notepad.exe</span><br><span class="line"><span class="keyword">exit</span></span><br><span class="line">:no1</span><br><span class="line"><span class="built_in">start</span> calc</span><br><span class="line"></span><br><span class="line">:: 只启动 calc 不会启动 notepad.exe 也不会退出</span><br><span class="line">@<span class="built_in">echo</span> off</span><br><span class="line">goto :no1</span><br><span class="line"><span class="built_in">start</span> notepad.exe</span><br><span class="line"><span class="keyword">exit</span></span><br><span class="line">:no1</span><br><span class="line"><span class="built_in">start</span> calc</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h3 id="strreplace"><a class="markdownIt-Anchor" href="#strreplace">#</a> strreplace</h3>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">:: 将 .txt 文件中的 aa 替换为 bb</span><br><span class="line">@<span class="built_in">echo</span> off&amp;&amp;setlocal enabledelayedexpansion</span><br><span class="line"><span class="keyword">for</span> %%i <span class="keyword">in</span> (*.txt) <span class="keyword">do</span> (</span><br><span class="line">    <span class="built_in">set</span> original=%%i</span><br><span class="line">    <span class="built_in">set</span> replaced=!original:aa=bb!</span><br><span class="line">    <span class="keyword">if</span> !original! neq !replaced! (<span class="built_in">ren</span> <span class="string">&quot;!original!&quot;</span> <span class="string">&quot;!replaced!&quot;</span>)</span><br><span class="line">)</span><br><span class="line">endlocal</span><br><span class="line"></span><br><span class="line">:: 将 .txt 文件重命名为 .bat</span><br><span class="line">:: delims=表示不使用默认空格分隔，避免处理带空格文件时错误</span><br><span class="line">:: /s 对当前目录及其子目录中所有文件进行列表</span><br><span class="line">@<span class="built_in">echo</span> off</span><br><span class="line"><span class="keyword">for</span> /f <span class="string">&quot;tokens=* delims=&quot;</span> %%i <span class="keyword">in</span> (<span class="string">&#x27;dir /b/s *.txt&#x27;</span>) <span class="keyword">do</span> (</span><br><span class="line">    rename <span class="string">&quot;%%i&quot;</span> <span class="string">&quot;*.bat&quot;</span></span><br><span class="line">)</span><br><span class="line">:: 可以直接使用 rename 当前目录文件</span><br><span class="line"><span class="built_in">ren</span> *.txt *.bat</span><br><span class="line"></span><br><span class="line">:: 替换 <span class="comment"># 为换行</span></span><br><span class="line">:: <span class="built_in">start</span> tmp.txt 打开 tmp.txt</span><br><span class="line">:: goto :eof 跳到 <span class="keyword">for</span> 循环中继续执行</span><br><span class="line">:: %~<span class="number">1</span> 扩充 %<span class="number">1</span> 删除引号(<span class="string">&quot;)</span></span><br><span class="line"><span class="string">@echo off&gt;tmp.txt</span></span><br><span class="line"><span class="string">for /f &quot;</span>delims=<span class="string">&quot; %%i in (a.txt) do (</span></span><br><span class="line"><span class="string">set &quot;</span>s=%%i<span class="string">&quot;</span></span><br><span class="line"><span class="string">call set &quot;</span>s=%%s:<span class="comment">#=&amp;echo.%%&quot;</span></span><br><span class="line">call call :<span class="built_in">write</span> <span class="string">&quot;echo.%%s%%&quot;</span></span><br><span class="line">)</span><br><span class="line"><span class="built_in">start</span> tmp.txt</span><br><span class="line"><span class="keyword">exit</span></span><br><span class="line">:<span class="built_in">write</span></span><br><span class="line">(%~<span class="number">1</span>)&gt;&gt;tmp.txt</span><br><span class="line">goto :eof</span><br></pre></td></tr></table></figure>
<h3 id="errorlevel"><a class="markdownIt-Anchor" href="#errorlevel">#</a> errorlevel</h3>
<p>当 copy 错误时会记录日志到 test.log</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">copy</span> a b || <span class="built_in">echo</span> <span class="built_in">copy</span> error %ERRORLEVEL% &gt;&gt; test.log</span><br></pre></td></tr></table></figure>
<h3 id="pause"><a class="markdownIt-Anchor" href="#pause">#</a> pause</h3>
<p><code>pause</code>  就是暂停命令，执行时会在命令行窗口显示  <code>请按任意键继续. . .</code>  并等待你按键。</p>
<p><code>pause &gt; nul</code>  的作用是同样的，区别是不显示  <code>请按任意键继续. . .</code>  这些字，nul 相当于空文件，把这些文字隐去了。但是同样是等待你按键。</p>
<h3 id="date"><a class="markdownIt-Anchor" href="#date">#</a> date</h3>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">echo</span> off</span><br><span class="line"><span class="built_in">echo</span> %date% %time%</span><br><span class="line"><span class="built_in">echo</span> %date:~<span class="number">0</span>,<span class="number">10</span>% %time:~<span class="number">0</span>,<span class="number">8</span>%</span><br><span class="line">:: <span class="number">2018</span>/<span class="number">12</span>/<span class="number">21</span> 周五 <span class="number">16</span>:<span class="number">28</span>:<span class="number">54.34</span></span><br><span class="line">:: <span class="number">2018</span>/<span class="number">12</span>/<span class="number">21</span> <span class="number">16</span>:<span class="number">28</span>:<span class="number">54</span></span><br></pre></td></tr></table></figure>
<h3 id="tree"><a class="markdownIt-Anchor" href="#tree">#</a> tree</h3>
<p>显示目录结构</p>
<h3 id="tasklist"><a class="markdownIt-Anchor" href="#tasklist">#</a> tasklist</h3>
<p>tasklist 列出正在运行的进程</p>
<figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">tasklist /fi &quot;imagename eq python.exe&quot;  查找映像名称为 python.exe 的进程</span><br><span class="line"></span><br><span class="line">映像名称                       PID 会话名              会话#       内存使用</span><br><span class="line">========================= ======== ================ =========== ============</span><br><span class="line">python.exe                    1688 Console                    1     74,972 K</span><br><span class="line">python.exe                    5312 Console                    1     24,556 K</span><br><span class="line"></span><br><span class="line">tasklist /fi &quot;imagename eq python.exe&quot; | findstr python.exe</span><br><span class="line">python.exe                    1688 Console                    1     74,972 K</span><br><span class="line">python.exe                    5312 Console                    1     24,556 K</span><br></pre></td></tr></table></figure>
<h3 id="rd"><a class="markdownIt-Anchor" href="#rd">#</a> rd</h3>
<p>rd dir /s /q</p>
<p>删除目录</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">C:\Users\<span class="number">11435</span>&gt;<span class="built_in">rd</span>/?</span><br><span class="line">删除一个目录。</span><br><span class="line"></span><br><span class="line"><span class="built_in">RMDIR</span> [/<span class="type">S</span>] [/<span class="type">Q</span>] [<span class="type">drive</span>:]path</span><br><span class="line"><span class="built_in">RD</span> [/<span class="type">S</span>] [/<span class="type">Q</span>] [<span class="type">drive</span>:]path</span><br><span class="line"></span><br><span class="line">    /S      除目录本身外，还将删除指定目录下的所有子目录和</span><br><span class="line">            文件。用于删除目录树。</span><br><span class="line"></span><br><span class="line">    /Q      安静模式，带 /S 删除目录树时不要求确认</span><br></pre></td></tr></table></figure>
<h3 id="other"><a class="markdownIt-Anchor" href="#other">#</a> other</h3>
<h4 id="check-network-driver-connect"><a class="markdownIt-Anchor" href="#check-network-driver-connect">#</a> check network driver connect</h4>
<p>建立映射网络驱动器 <code> Z:</code>  连接到 <code> \\11435-NB1\netdisk</code>  （netdisk 是一个共享文件夹）</p>
<img data-src="/2019/06/06/bat/1592543073752.png" class="">
<p>移动映射网络驱动器 <code> Z:</code>  中的文件到  <code>D:\program\filepool</code></p>
<p>当映射网络驱动器断开时，会产生  <code>错误: 指定的目录不存在。</code>  这时  <code>echo netdisk &quot;%netdisk-path%&quot; disconnected &gt;&gt; %logfile% </code>  将 映射网络驱动器断开信息写入日志</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">SET logfile=D:\program\<span class="built_in">log</span>\error.log</span><br><span class="line">SET netdisk-path=Z:\</span><br><span class="line">SET dst-path=D:\program\filepool</span><br><span class="line"></span><br><span class="line">forfiles /p %netdisk-path% /m *.* /c <span class="string">&quot;cmd /c move /y @FILE %dst-path%@FILE || echo move @FILE failed &gt;&gt; %logfile%&quot;</span>  || <span class="built_in">echo</span> netdisk <span class="string">&quot;%netdisk-path%&quot;</span> disconnected &gt;&gt; %logfile%</span><br></pre></td></tr></table></figure>

      <div class="tags">
          <a href="/tags/shell/" rel="tag"><i class="ic i-tag"></i> shell</a>
      </div>
  </div>

   <footer>

    <div class="meta">
  <span class="item">
    <span class="icon">
      <i class="ic i-calendar-check"></i>
    </span>
    <span class="text">Edited on</span>
    <time title="Modified: 2022-01-07 11:28:37" itemprop="dateModified" datetime="2022-01-07T11:28:37+08:00">2022-01-07</time>
  </span>
</div>

      

  </footer>

</article>

  </div>
  

<div class="post-nav">
    <div class="item left">
      

  <a href="/2019/06/06/oracle/" itemprop="url" rel="prev" data-background-image="https:&#x2F;&#x2F;tva3.sinaimg.cn&#x2F;mw690&#x2F;6833939bly1giclil3m4ej20zk0m8tn8.jpg" title="Oracle">
  <span class="type">Previous Post</span>
  <span class="category"><i class="ic i-flag"></i> manual</span>
  <h3>Oracle</h3>
  </a>

    </div>
    <div class="item right">
      

  <a href="/2019/06/06/uml-sequence/" itemprop="url" rel="next" data-background-image="https:&#x2F;&#x2F;tva3.sinaimg.cn&#x2F;mw690&#x2F;6833939bly1gipey84bjtj20zk0m8hdt.jpg" title="UML 使用循序圖傳達各物件互動及時序關係">
  <span class="type">Next Post</span>
  <span class="category"><i class="ic i-flag"></i> </span>
  <h3>UML 使用循序圖傳達各物件互動及時序關係</h3>
  </a>

    </div>
</div>

  
  <div class="wrap" id="comments"></div>


        </div>
        <div id="sidebar">
          

<div class="inner">

  <div class="panels">
    <div class="inner">
      <div class="contents panel pjax" data-title="Contents">
          <ol class="toc"><li class="toc-item toc-level-3"><a class="toc-link" href="#help"><span class="toc-number">1.</span> <span class="toc-text"> help</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#set"><span class="toc-number">2.</span> <span class="toc-text"> set</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#move"><span class="toc-number">3.</span> <span class="toc-text"> move</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#del"><span class="toc-number">4.</span> <span class="toc-text"> del</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#for"><span class="toc-number">5.</span> <span class="toc-text"> for</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#for-f"><span class="toc-number">5.1.</span> <span class="toc-text"> for &#x2F;f</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#for-r"><span class="toc-number">5.2.</span> <span class="toc-text"> for &#x2F;r</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#for-l"><span class="toc-number">5.3.</span> <span class="toc-text"> for &#x2F;l</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#forfiles"><span class="toc-number">6.</span> <span class="toc-text"> forfiles</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#dir"><span class="toc-number">7.</span> <span class="toc-text"> dir</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#findstr"><span class="toc-number">8.</span> <span class="toc-text"> findstr</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#example"><span class="toc-number">9.</span> <span class="toc-text"> example</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#delayedexpansion"><span class="toc-number">10.</span> <span class="toc-text"> delayedexpansion</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#goto-eof"><span class="toc-number">11.</span> <span class="toc-text"> goto :eof</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#call"><span class="toc-number">12.</span> <span class="toc-text"> call</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#strreplace"><span class="toc-number">13.</span> <span class="toc-text"> strreplace</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#errorlevel"><span class="toc-number">14.</span> <span class="toc-text"> errorlevel</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#pause"><span class="toc-number">15.</span> <span class="toc-text"> pause</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#date"><span class="toc-number">16.</span> <span class="toc-text"> date</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#tree"><span class="toc-number">17.</span> <span class="toc-text"> tree</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#tasklist"><span class="toc-number">18.</span> <span class="toc-text"> tasklist</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#rd"><span class="toc-number">19.</span> <span class="toc-text"> rd</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#other"><span class="toc-number">20.</span> <span class="toc-text"> other</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#check-network-driver-connect"><span class="toc-number">20.1.</span> <span class="toc-text"> check network driver connect</span></a></li></ol></li></ol>
      </div>
      <div class="related panel pjax" data-title="Related">
        <ul>
          <li class="active"><a href="/2019/06/06/bat/" rel="bookmark" title="Window Bat">Window Bat</a></li><li><a href="/2019/06/06/oracle/" rel="bookmark" title="Oracle">Oracle</a></li><li><a href="/2019/06/06/python/" rel="bookmark" title="Python">Python</a></li><li><a href="/2019/10/12/linux-vim/" rel="bookmark" title="Vim">Vim</a></li><li><a href="/2020/09/01/sql-advance/" rel="bookmark" title="SQL Advance">SQL Advance</a></li><li><a href="/2021/01/01/a-resource/" rel="bookmark" title="Resources">Resources</a></li><li><a href="/2021/04/06/japanese/" rel="bookmark" title="Japanese">Japanese</a></li><li><a href="/2021/04/25/excel/" rel="bookmark" title="Excel Basic">Excel Basic</a></li><li><a href="/2021/05/06/edi-flow/" rel="bookmark" title="EDI Flow">EDI Flow</a></li><li><a href="/2021/05/13/r-tutorial/" rel="bookmark" title="R tutorial">R tutorial</a></li><li><a href="/2021/07/10/rust-for-node/" rel="bookmark" title="Deep Dive into Rust for Node.js Developers">Deep Dive into Rust for Node.js Developers</a></li><li><a href="/2021/07/20/python-daily-tool/" rel="bookmark" title="Daily Tool">Daily Tool</a></li>
        </ul>
      </div>
      <div class="overview panel" data-title="Overview">
        <div class="author" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <img class="image" itemprop="image" alt="江边鸟"
      data-src="/images/avatar.jpg">
  <p class="name" itemprop="name">江边鸟</p>
  <div class="description" itemprop="description"></div>
</div>

<nav class="state">
    <div class="item posts">
      <a href="/archives/">
        <span class="count">290</span>
        <span class="name">posts</span>
      </a>
    </div>
    <div class="item categories">
      <a href="/categories/">
        <span class="count">2</span>
        <span class="name">categories</span>
      </a>
    </div>
    <div class="item tags">
      <a href="/tags/">
        <span class="count">40</span>
        <span class="name">tags</span>
      </a>
    </div>
</nav>

<div class="social">
      <span class="exturl item github" data-url="aHR0cHM6Ly9naXRodWIuY29tL2xoY2hlbjc0" title="https:&#x2F;&#x2F;github.com&#x2F;lhchen74"><i class="ic i-github"></i></span>
      <span class="exturl item music" data-url="aHR0cHM6Ly9tdXNpYy4xNjMuY29tLw==" title="https:&#x2F;&#x2F;music.163.com&#x2F;"><i class="ic i-cloud-music"></i></span>
      <span class="exturl item about" data-url="aHR0cHM6Ly9jb2RlcGVuLmlvL2xoY2hlbjc0" title="https:&#x2F;&#x2F;codepen.io&#x2F;lhchen74"><i class="ic i-address-card"></i></span>
</div>

<ul class="menu">
  
    
  <li class="item">
    <a href="/" rel="section"><i class="ic i-home"></i>Home</a>
  </li>

    
  <li class="item">
    <a href="/about/" rel="section"><i class="ic i-user"></i>About</a>
  </li>

        
  <li class="item dropdown">
      <a href="javascript:void(0);"><i class="ic i-feather"></i>Posts</a>
    <ul class="submenu">

        
  <li class="item">
    <a href="/archives/" rel="section"><i class="ic i-list-alt"></i>Archives</a>
  </li>

        
  <li class="item">
    <a href="/categories/" rel="section"><i class="ic i-th"></i>Categories</a>
  </li>

        
  <li class="item">
    <a href="/tags/" rel="section"><i class="ic i-tags"></i>Tags</a>
  </li>

  </ul>
    
  <li class="item">
    <a href="/friends/" rel="section"><i class="ic i-heart"></i>Friends</a>
  </li>


</ul>

      </div>
    </div>
  </div>

  <ul id="quick">
    <li class="prev pjax">
        <a href="/2019/06/06/oracle/" rel="prev" title="Previous Post"><i class="ic i-chevron-left"></i></a>
    </li>
    <li class="up"><i class="ic i-arrow-up"></i></li>
    <li class="down"><i class="ic i-arrow-down"></i></li>
    <li class="next pjax">
        <a href="/2019/06/06/uml-sequence/" rel="next" title="Next Post"><i class="ic i-chevron-right"></i></a>
    </li>
    <li class="percent"></li>
  </ul>
</div>


        </div>
        <div class="dimmer"></div>
      </div>
    </main>
    <footer id="footer">
      <div class="inner">
        <div class="widgets">
          

        </div>
        <div class="status">
  <div class="copyright">
    
    &copy; 2010 – 
    <span itemprop="copyrightYear">2022</span>
    <span class="with-love">
      <i class="ic i-sakura rotate"></i>
    </span>
    <span class="author" itemprop="copyrightHolder">江边鸟 @ D E W</span>
  </div>
  <div class="powered-by">
    Powered by <span class="exturl" data-url="aHR0cHM6Ly9oZXhvLmlv">Hexo</span> & Theme.<span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL2FtZWhpbWUvaGV4by10aGVtZS1zaG9rYQ==">Shoka</span>
  </div>
</div>

      </div>
    </footer>
  </div>
<script data-config type="text/javascript">
  var LOCAL = {
    path: '2019/06/06/bat/',
    favicon: {
      show: "（●´3｀●）Goooood",
      hide: "(´Д｀)Booooom"
    },
    search : {
      placeholder: "Search for Posts",
      empty: "We didn't find any results for the search: ${query}",
      stats: "${hits} results found in ${time} ms"
    },
    valine: true,fancybox: true,
    ignores : [
      function(uri) {
        return uri.includes('#');
      },
      function(uri) {
        return new RegExp(LOCAL.path+"$").test(uri);
      }
    ]
  };
</script>

<script src="https://cdn.polyfill.io/v2/polyfill.js"></script>

<script src="//cdn.jsdelivr.net/combine/npm/pace-js@1.0.2/pace.min.js,npm/pjax@0.2.8/pjax.min.js,npm/whatwg-fetch@3.4.0/dist/fetch.umd.min.js,npm/animejs@3.2.0/lib/anime.min.js,npm/algoliasearch@4/dist/algoliasearch-lite.umd.js,npm/instantsearch.js@4/dist/instantsearch.production.min.js,npm/lozad@1/dist/lozad.min.js,npm/quicklink@2/dist/quicklink.umd.js"></script>

<script src="/js/app.js?v=0.2.5"></script>




</body>
</html>
