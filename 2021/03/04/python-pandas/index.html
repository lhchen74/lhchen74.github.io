



<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#FFF">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">

<link rel="icon" type="image/ico" sizes="32x32" href="/images/favicon.ico">
  <meta http-equiv="Cache-Control" content="no-transform">
  <meta http-equiv="Cache-Control" content="no-siteapp">


<link rel="alternate" type="application/rss+xml" title="露の世" href="https://lhchen74.github.io/rss.xml" />
<link rel="alternate" type="application/atom+xml" title="露の世" href="https://lhchen74.github.io/atom.xml" />
<link rel="alternate" type="application/json" title="露の世" href="https://lhchen74.github.io/feed.json" />

<link rel="stylesheet" href="//fonts.googleapis.com/css?family=Mulish:300,300italic,400,400italic,700,700italic%7CFredericka%20the%20Great:300,300italic,400,400italic,700,700italic%7CNoto%20Serif%20JP:300,300italic,400,400italic,700,700italic%7CNoto%20Serif%20SC:300,300italic,400,400italic,700,700italic%7CInconsolata:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext">

<link rel="stylesheet" href="/css/app.css?v=0.2.5">

  
  <meta name="keywords" content="python" />


<link rel="canonical" href="https://lhchen74.github.io/2021/03/04/python-pandas/">



  <title>
python pandas |
Dew's World = 露の世</title>
<meta name="generator" content="Hexo 5.4.0"></head>
<body itemscope itemtype="http://schema.org/WebPage">
  <div id="loading">
    <div class="cat">
      <div class="body"></div>
      <div class="head">
        <div class="face"></div>
      </div>
      <div class="foot">
        <div class="tummy-end"></div>
        <div class="bottom"></div>
        <div class="legs left"></div>
        <div class="legs right"></div>
      </div>
      <div class="paw">
        <div class="hands left"></div>
        <div class="hands right"></div>
      </div>
    </div>
  </div>
  <div id="container">
    <header id="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="inner">
        <div id="brand">
          <div class="pjax">
          
  <h1 itemprop="name headline">python pandas
  </h1>
  
<div class="meta">
  <span class="item" title="Created: 2021-03-04 15:41:15">
    <span class="icon">
      <i class="ic i-calendar"></i>
    </span>
    <span class="text">Posted on</span>
    <time itemprop="dateCreated datePublished" datetime="2021-03-04T15:41:15+08:00">2021-03-04</time>
  </span>
</div>


          </div>
        </div>
        <nav id="nav">
  <div class="inner">
    <div class="toggle">
      <div class="lines" aria-label="Toggle navigation bar">
        <span class="line"></span>
        <span class="line"></span>
        <span class="line"></span>
      </div>
    </div>
    <ul class="menu">
      <li class="item title"><a href="/" rel="start">Dew's World</a></li>
    </ul>
    <ul class="right">
      <li class="item theme">
        <i class="ic i-sun"></i>
      </li>
      <li class="item search">
        <i class="ic i-search"></i>
      </li>
    </ul>
  </div>
</nav>

      </div>
      <div id="imgs" class="pjax">
        <ul>
          <li class="item" data-background-image="https://tva4.sinaimg.cn/large/6833939bly1giclwrdwyaj20zk0m8are.jpg"></li>
          <li class="item" data-background-image="https://tva4.sinaimg.cn/large/6833939bly1giciryrr3rj20zk0m8nhk.jpg"></li>
          <li class="item" data-background-image="https://tva4.sinaimg.cn/large/6833939bly1giclga70tsj20zk0m84mr.jpg"></li>
          <li class="item" data-background-image="https://tva4.sinaimg.cn/large/6833939bly1gipewr8iypj20zk0m8b29.jpg"></li>
          <li class="item" data-background-image="https://tva4.sinaimg.cn/large/6833939bly1gicitcxhpij20zk0m8hdt.jpg"></li>
          <li class="item" data-background-image="https://tva4.sinaimg.cn/large/6833939bly1gipeubcbajj20zk0m8h1h.jpg"></li>
        </ul>
      </div>
    </header>
    <div id="waves">
      <svg class="waves" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 24 150 28" preserveAspectRatio="none" shape-rendering="auto">
        <defs>
          <path id="gentle-wave" d="M-160 44c30 0 58-18 88-18s 58 18 88 18 58-18 88-18 58 18 88 18 v44h-352z" />
        </defs>
        <g class="parallax">
          <use xlink:href="#gentle-wave" x="48" y="0" />
          <use xlink:href="#gentle-wave" x="48" y="3" />
          <use xlink:href="#gentle-wave" x="48" y="5" />
          <use xlink:href="#gentle-wave" x="48" y="7" />
        </g>
      </svg>
    </div>
    <main>
      <div class="inner">
        <div id="main" class="pjax">
          
  <div class="article wrap">
    
<div class="breadcrumb" itemscope itemtype="https://schema.org/BreadcrumbList">
<i class="ic i-home"></i>
<span><a href="/">Home</a></span>
</div>

    <article itemscope itemtype="http://schema.org/Article" class="post block" lang="en">
  <link itemprop="mainEntityOfPage" href="https://lhchen74.github.io/2021/03/04/python-pandas/">

  <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
    <meta itemprop="image" content="/images/avatar.jpg">
    <meta itemprop="name" content="江边鸟">
    <meta itemprop="description" content=", ">
  </span>

  <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
    <meta itemprop="name" content="露の世">
  </span>

  <div class="body md" itemprop="articleBody">
    

    <h3 id="创建对象"><a class="markdownIt-Anchor" href="#创建对象">#</a> 创建对象</h3>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1.</span> 通过传递一个<span class="built_in">list</span>对象来创建一个Series，pandas会默认创建整型索引</span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line">s = pd.Series([<span class="number">1</span>,<span class="number">3</span>,<span class="number">5</span>,np.nan])</span><br><span class="line"><span class="comment"># print(s)</span></span><br><span class="line"><span class="comment"># 0    1.0</span></span><br><span class="line"><span class="comment"># 1    3.0</span></span><br><span class="line"><span class="comment"># 2    5.0</span></span><br><span class="line"><span class="comment"># 3    NaN</span></span><br><span class="line"><span class="comment"># dtype: float64</span></span><br><span class="line"></span><br><span class="line"><span class="number">2.</span> 通过传递一个numpy array，时间索引以及列标签来创建一个DataFrame</span><br><span class="line">dates = pd.date_range(<span class="string">&#x27;20180119&#x27;</span>,periods = <span class="number">6</span>)</span><br><span class="line"><span class="comment"># print(dates)</span></span><br><span class="line"><span class="comment"># DatetimeIndex([&#x27;2018-01-19&#x27;, &#x27;2018-01-20&#x27;, &#x27;2018-01-21&#x27;, &#x27;2018-01-22&#x27;,</span></span><br><span class="line"><span class="comment">#                &#x27;2018-01-23&#x27;, &#x27;2018-01-24&#x27;],</span></span><br><span class="line"><span class="comment">#               dtype=&#x27;datetime64[ns]&#x27;, freq=&#x27;D&#x27;)</span></span><br><span class="line">df = pd.DataFrame(np.random.randn(<span class="number">6</span>,<span class="number">4</span>),index=dates,columns=<span class="built_in">list</span>(<span class="string">&#x27;ABCD&#x27;</span>))</span><br><span class="line"><span class="comment"># print(df)</span></span><br><span class="line"><span class="comment">#                    A         B         C         D</span></span><br><span class="line"><span class="comment"># 2018-01-19 -2.902452 -0.311695 -0.342849  1.616858</span></span><br><span class="line"><span class="comment"># 2018-01-20  0.475718 -0.323746  1.885224 -1.139170</span></span><br><span class="line"><span class="comment"># 2018-01-21  0.404301  0.386661  1.176591 -0.889582</span></span><br><span class="line"><span class="comment"># 2018-01-22 -0.415695 -0.027721  0.565688 -0.158884</span></span><br><span class="line"><span class="comment"># 2018-01-23 -0.361975  0.508800 -1.429186 -0.638797</span></span><br><span class="line"><span class="comment"># 2018-01-24  0.466634 -0.655750  0.845265 -1.381422</span></span><br><span class="line"><span class="comment"># numpy.random.randn(d0, d1, …, dn)是从标准正态分布中返回一个或多个样本值。</span></span><br><span class="line"><span class="comment"># numpy.random.rand(d0, d1, …, dn)的随机样本位于[0, 1)中</span></span><br><span class="line"></span><br><span class="line"><span class="number">3.</span> 通过传递一个能够被转换成类似序列结构的字典对象来创建一个DataFrame</span><br><span class="line">df2 = pd.DataFrame(&#123;</span><br><span class="line">    <span class="string">&#x27;A&#x27;</span> : <span class="number">1.</span>,</span><br><span class="line">    <span class="string">&#x27;B&#x27;</span> : pd.Timestamp(<span class="string">&#x27;20180119&#x27;</span>),</span><br><span class="line">    <span class="string">&#x27;C&#x27;</span> : pd.Series(<span class="number">1</span>,index=<span class="built_in">list</span>(<span class="built_in">range</span>(<span class="number">4</span>)),dtype=<span class="string">&#x27;float32&#x27;</span>),</span><br><span class="line">    <span class="string">&#x27;D&#x27;</span> : np.array([<span class="number">3</span>] * <span class="number">4</span>,dtype=<span class="string">&#x27;int32&#x27;</span>),</span><br><span class="line">    <span class="string">&#x27;E&#x27;</span> : pd.Categorical([<span class="string">&#x27;test&#x27;</span>,<span class="string">&#x27;test&#x27;</span>,<span class="string">&#x27;test2&#x27;</span>,<span class="string">&#x27;test3&#x27;</span>]),</span><br><span class="line">    <span class="string">&#x27;F&#x27;</span> : <span class="string">&#x27;foo&#x27;</span></span><br><span class="line">&#125;)</span><br><span class="line"><span class="comment"># print(df2)</span></span><br><span class="line"><span class="comment">#     A          B    C  D      E    F</span></span><br><span class="line"><span class="comment"># 0  1.0 2018-01-19  1.0  3   test  foo</span></span><br><span class="line"><span class="comment"># 1  1.0 2018-01-19  1.0  3   test  foo</span></span><br><span class="line"><span class="comment"># 2  1.0 2018-01-19  1.0  3  test2  foo</span></span><br><span class="line"><span class="comment"># 3  1.0 2018-01-19  1.0  3  test3  foo</span></span><br><span class="line"><span class="comment"># print(df2.dtypes)</span></span><br><span class="line"><span class="comment"># A           float64</span></span><br><span class="line"><span class="comment"># B    datetime64[ns]</span></span><br><span class="line"><span class="comment"># C           float32</span></span><br><span class="line"><span class="comment"># D             int32</span></span><br><span class="line"><span class="comment"># E          category</span></span><br><span class="line"><span class="comment"># F            object</span></span><br><span class="line"><span class="comment"># dtype: object</span></span><br></pre></td></tr></table></figure>
<h3 id="查看数据"><a class="markdownIt-Anchor" href="#查看数据">#</a> 查看数据</h3>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line">dates = pd.date_range(<span class="string">&#x27;20180119&#x27;</span>,periods = <span class="number">6</span>)</span><br><span class="line">df = pd.DataFrame(np.random.randn(<span class="number">6</span>,<span class="number">4</span>),index=dates,columns=<span class="built_in">list</span>(<span class="string">&#x27;ABCD&#x27;</span>))</span><br><span class="line"><span class="number">1.</span> 查看frame中头部和尾部的行</span><br><span class="line"><span class="comment"># print(df.head())</span></span><br><span class="line"><span class="comment">#                   A         B         C         D</span></span><br><span class="line"><span class="comment"># 2018-01-19  0.315776 -1.262597  0.417930  0.816487</span></span><br><span class="line"><span class="comment"># 2018-01-20 -1.851086 -0.081404 -0.816561 -0.275335</span></span><br><span class="line"><span class="comment"># 2018-01-21  2.198723 -1.162804  0.455082 -1.106705</span></span><br><span class="line"><span class="comment"># 2018-01-22 -1.086726 -0.974309  0.975481 -0.053164</span></span><br><span class="line"><span class="comment"># 2018-01-23 -1.808937 -1.477894  0.392138  0.131833</span></span><br><span class="line"><span class="comment"># print(df.tail(3))</span></span><br><span class="line"><span class="comment">#                    A         B         C         D</span></span><br><span class="line"><span class="comment"># 2018-01-22 -1.086726 -0.974309  0.975481 -0.053164</span></span><br><span class="line"><span class="comment"># 2018-01-23 -1.808937 -1.477894  0.392138  0.131833</span></span><br><span class="line"><span class="comment"># 2018-01-24  2.435823  0.010048  0.806189  0.559598</span></span><br><span class="line"><span class="number">2.</span> 显示索引、列和底层的numpy数据</span><br><span class="line"><span class="comment"># print(df.index)</span></span><br><span class="line"><span class="comment"># DatetimeIndex([&#x27;2018-01-19&#x27;, &#x27;2018-01-20&#x27;, &#x27;2018-01-21&#x27;, &#x27;2018-01-22&#x27;,</span></span><br><span class="line"><span class="comment">#                &#x27;2018-01-23&#x27;, &#x27;2018-01-24&#x27;],</span></span><br><span class="line"><span class="comment">#               dtype=&#x27;datetime64[ns]&#x27;, freq=&#x27;D&#x27;)</span></span><br><span class="line"><span class="comment"># print(df.columns)</span></span><br><span class="line"><span class="comment"># Index([&#x27;A&#x27;, &#x27;B&#x27;, &#x27;C&#x27;, &#x27;D&#x27;], dtype=&#x27;object&#x27;)</span></span><br><span class="line"><span class="comment"># print(df.values)</span></span><br><span class="line"><span class="comment"># [[ 0.24919313  1.69670287  0.00307654 -0.22192602]</span></span><br><span class="line"><span class="comment">#  [-0.49304832 -1.15940945 -0.33040307  0.83062988]</span></span><br><span class="line"><span class="comment">#  [-0.60605614 -0.94390582  0.0920051  -0.25452046]</span></span><br><span class="line"><span class="comment">#  [ 0.49692782 -0.68505704 -0.06938114  0.69423629]</span></span><br><span class="line"><span class="comment">#  [-0.67451809 -0.49074972  1.2760681   0.06424315]</span></span><br><span class="line"><span class="comment">#  [ 1.11390404 -1.37691908 -0.03828506 -0.88249195]]</span></span><br><span class="line"><span class="number">3.</span> describe()函数对于数据的快速统计汇总</span><br><span class="line"><span class="comment"># print(df.describe())</span></span><br><span class="line"><span class="comment">#              A         B         C         D</span></span><br><span class="line"><span class="comment"># count  6.000000  6.000000  6.000000  6.000000</span></span><br><span class="line"><span class="comment"># mean   0.234599 -0.066277 -0.368595 -0.078489</span></span><br><span class="line"><span class="comment"># std    0.714956  1.322297  0.774115  1.201034</span></span><br><span class="line"><span class="comment"># min   -0.578654 -1.756372 -1.624966 -1.429098</span></span><br><span class="line"><span class="comment"># 25%   -0.151149 -0.930873 -0.774090 -0.965526</span></span><br><span class="line"><span class="comment"># 50%    0.131585  0.018819 -0.009791 -0.034075</span></span><br><span class="line"><span class="comment"># 75%    0.380844  0.441674  0.059116  0.319939</span></span><br><span class="line"><span class="comment"># max    1.504540  1.985881  0.379752  1.864379</span></span><br><span class="line"><span class="number">4.</span>  对数据的转置</span><br><span class="line"><span class="comment"># print(df.T)</span></span><br><span class="line"><span class="comment">#  2018-01-19  2018-01-20  2018-01-21  2018-01-22  2018-01-23  2018-01-24</span></span><br><span class="line"><span class="comment"># A   -0.919441    1.018841   -1.539721   -0.863824   -2.239723   -0.103792</span></span><br><span class="line"><span class="comment"># B   -1.830522    1.425763   -1.757576    0.848743   -0.520246    1.281699</span></span><br><span class="line"><span class="comment"># C    0.592624    0.960820    0.117273    0.189679    1.452047    1.237425</span></span><br><span class="line"><span class="comment"># D    0.195343   -1.081498    0.237329    0.237053   -0.859959   -0.031775</span></span><br><span class="line"><span class="number">5.</span> 按轴进行排序</span><br><span class="line"><span class="comment"># print(df.sort_index(axis=1,ascending=False))</span></span><br><span class="line"><span class="comment">#                   D         C         B         A</span></span><br><span class="line"><span class="comment"># 2018-01-19  0.539793  0.586982 -0.913723 -0.565786</span></span><br><span class="line"><span class="comment"># 2018-01-20 -0.965416  0.611870 -0.007035  0.241761</span></span><br><span class="line"><span class="comment"># 2018-01-21  0.200597  0.301047  0.762469  0.674582</span></span><br><span class="line"><span class="comment"># 2018-01-22 -0.647771  1.014385  0.953812 -0.852226</span></span><br><span class="line"><span class="comment"># 2018-01-23  0.317777  0.207167  0.086378  0.446269</span></span><br><span class="line"><span class="comment"># 2018-01-24  1.180738 -2.144122  0.214231  0.423743</span></span><br><span class="line"><span class="number">6.</span> 按值进行排序</span><br><span class="line"><span class="comment"># print(df.sort_values(by=&#x27;B&#x27;))</span></span><br><span class="line"><span class="comment">#                    A         B         C         D</span></span><br><span class="line"><span class="comment"># 2018-01-19 -0.565786 -0.913723  0.586982  0.539793</span></span><br><span class="line"><span class="comment"># 2018-01-20  0.241761 -0.007035  0.611870 -0.965416</span></span><br><span class="line"><span class="comment"># 2018-01-23  0.446269  0.086378  0.207167  0.317777</span></span><br><span class="line"><span class="comment"># 2018-01-24  0.423743  0.214231 -2.144122  1.180738</span></span><br><span class="line"><span class="comment"># 2018-01-21  0.674582  0.762469  0.301047  0.200597</span></span><br><span class="line"><span class="comment"># 2018-01-22 -0.852226  0.953812  1.014385 -0.647771</span></span><br></pre></td></tr></table></figure>
<h3 id="选择"><a class="markdownIt-Anchor" href="#选择">#</a> 选择</h3>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line">dates = pd.date_range(<span class="string">&#x27;20180119&#x27;</span>,periods = <span class="number">6</span>)</span><br><span class="line">df = pd.DataFrame(np.random.randn(<span class="number">6</span>,<span class="number">4</span>),index=dates,columns=<span class="built_in">list</span>(<span class="string">&#x27;ABCD&#x27;</span>))</span><br><span class="line"><span class="number">1.</span> 获取</span><br><span class="line"><span class="number">1.1</span> 选择一个单独的列，这将会返回一个Series，等同于df.A</span><br><span class="line"><span class="comment"># print(df[&#x27;A&#x27;])</span></span><br><span class="line"><span class="comment"># 2018-01-19   -0.453672</span></span><br><span class="line"><span class="comment"># 2018-01-20    0.014933</span></span><br><span class="line"><span class="comment"># 2018-01-21    0.519788</span></span><br><span class="line"><span class="comment"># 2018-01-22    0.259396</span></span><br><span class="line"><span class="comment"># 2018-01-23    1.510170</span></span><br><span class="line"><span class="comment"># 2018-01-24    0.765011</span></span><br><span class="line"><span class="comment"># Freq: D, Name: A, dtype: float64</span></span><br><span class="line"><span class="number">1.2</span> 通过[]进行选择，这将会对行进行切片</span><br><span class="line"><span class="comment"># print(df[0:2])</span></span><br><span class="line"><span class="comment">#                    A         B         C         D</span></span><br><span class="line"><span class="comment"># 2018-01-19  1.244513 -0.186764 -0.215445 -0.678315</span></span><br><span class="line"><span class="comment"># 2018-01-20 -0.390595 -0.089850  1.693733  1.326059</span></span><br><span class="line"><span class="comment"># print(df[&#x27;20180119&#x27;:&#x27;20180121&#x27;])</span></span><br><span class="line"><span class="comment">#                    A         B         C         D</span></span><br><span class="line"><span class="comment"># 2018-01-19  1.244513 -0.186764 -0.215445 -0.678315</span></span><br><span class="line"><span class="comment"># 2018-01-20 -0.390595 -0.089850  1.693733  1.326059</span></span><br><span class="line"></span><br><span class="line"><span class="number">2.</span> 通过标签选择</span><br><span class="line"><span class="number">2.1</span> 使用标签来获取某一行</span><br><span class="line"><span class="comment"># print(df.loc[dates[0]])</span></span><br><span class="line"><span class="comment"># A   -0.267135</span></span><br><span class="line"><span class="comment"># B   -1.417678</span></span><br><span class="line"><span class="comment"># C   -0.418960</span></span><br><span class="line"><span class="comment"># D   -0.481945</span></span><br><span class="line"><span class="comment"># Name: 2018-01-19 00:00:00, dtype: float64</span></span><br><span class="line"><span class="number">2.2</span> 通过标签来在多个轴上进行选择</span><br><span class="line"><span class="comment"># print(df.loc[:, [&#x27;A&#x27;,&#x27;B&#x27;]])</span></span><br><span class="line"><span class="comment">#                   A         B</span></span><br><span class="line"><span class="comment"># 2018-01-19 -0.267135 -1.417678</span></span><br><span class="line"><span class="comment"># 2018-01-20  0.646314  0.840619</span></span><br><span class="line"><span class="comment"># 2018-01-21  0.715013  1.101890</span></span><br><span class="line"><span class="comment"># 2018-01-22 -2.059424  1.981140</span></span><br><span class="line"><span class="comment"># 2018-01-23  0.085624  0.081103</span></span><br><span class="line"><span class="comment"># 2018-01-24  0.554221 -1.941612</span></span><br><span class="line"><span class="number">2.3</span> 标签切片</span><br><span class="line"><span class="comment"># print(df.loc[&#x27;20180119&#x27;:&#x27;20180121&#x27;,[&#x27;A&#x27;,&#x27;B&#x27;]])</span></span><br><span class="line"><span class="comment">#                   A         B</span></span><br><span class="line"><span class="comment"># 2018-01-19 -0.267135 -1.417678</span></span><br><span class="line"><span class="comment"># 2018-01-20  0.646314  0.840619</span></span><br><span class="line"><span class="comment"># 2018-01-21  0.715013  1.101890</span></span><br><span class="line"><span class="number">2.4</span> 对返回的对象进行维度缩减</span><br><span class="line"><span class="comment"># print(df.loc[&#x27;20180119&#x27;,[&#x27;A&#x27;,&#x27;B&#x27;]])</span></span><br><span class="line"><span class="comment"># A   -0.267135</span></span><br><span class="line"><span class="comment"># B   -1.417678</span></span><br><span class="line"><span class="number">2.5</span> 获取一个标量</span><br><span class="line"><span class="comment"># print(df.loc[dates[0],&#x27;A&#x27;])</span></span><br><span class="line"><span class="comment"># -0.267135186243</span></span><br><span class="line"><span class="number">2.6</span> 快速访问一个标量（与上一个方法等价）</span><br><span class="line"><span class="comment"># print(df.at[dates[0],&#x27;A&#x27;])</span></span><br><span class="line"><span class="comment"># -0.267135186243</span></span><br><span class="line"></span><br><span class="line"><span class="number">3.</span> 通过位置选择</span><br><span class="line"><span class="number">3.1</span> 通过传递数值进行位置选择（选择的是行）</span><br><span class="line"><span class="comment"># print(df.iloc[3])</span></span><br><span class="line"><span class="comment"># A    0.014979</span></span><br><span class="line"><span class="comment"># B    1.848822</span></span><br><span class="line"><span class="comment"># C   -0.195405</span></span><br><span class="line"><span class="comment"># D   -0.698225</span></span><br><span class="line"><span class="comment"># Name: 2018-01-22 00:00:00, dtype: float64</span></span><br><span class="line"><span class="number">3.2</span> 通过数值进行切片，与numpy/python中的情况类似</span><br><span class="line"><span class="comment"># print(df.iloc[3:5,0:2])</span></span><br><span class="line"><span class="comment">#                  A         B</span></span><br><span class="line"><span class="comment"># 2018-01-22  0.014979  1.848822</span></span><br><span class="line"><span class="comment"># 2018-01-23 -0.474405 -1.333422</span></span><br><span class="line"><span class="number">3.3</span> 通过指定一个位置的列表，与numpy/python中的情况类似</span><br><span class="line"><span class="comment"># print(df.iloc[[1,2,4],[0,2]])</span></span><br><span class="line"><span class="comment">#                   A         C</span></span><br><span class="line"><span class="comment"># 2018-01-20  0.225366 -0.127717</span></span><br><span class="line"><span class="comment"># 2018-01-21  2.062152  0.064430</span></span><br><span class="line"><span class="comment"># 2018-01-23 -0.474405  0.423630</span></span><br><span class="line"><span class="number">3.4</span> 对行进行切片</span><br><span class="line"><span class="comment"># print(df.iloc[1:3,:])</span></span><br><span class="line"><span class="comment">#                    A         B         C         D</span></span><br><span class="line"><span class="comment"># 2018-01-20  0.225366 -2.010948 -0.127717 -0.352816</span></span><br><span class="line"><span class="comment"># 2018-01-21  2.062152  1.307013  0.064430  0.866045</span></span><br><span class="line"><span class="number">3.5</span> 对列进行切片</span><br><span class="line"><span class="comment"># print(df.iloc[:,1:3])</span></span><br><span class="line"><span class="comment">#                    B         C</span></span><br><span class="line"><span class="comment"># 2018-01-19 -0.099002 -0.903149</span></span><br><span class="line"><span class="comment"># 2018-01-20 -2.010948 -0.127717</span></span><br><span class="line"><span class="comment"># 2018-01-21  1.307013  0.064430</span></span><br><span class="line"><span class="comment"># 2018-01-22  1.848822 -0.195405</span></span><br><span class="line"><span class="comment"># 2018-01-23 -1.333422  0.423630</span></span><br><span class="line"><span class="comment"># 2018-01-24  2.056474 -1.5990</span></span><br><span class="line"><span class="number">3.6</span> 获取特定的值</span><br><span class="line"><span class="comment"># print(df.iloc[1,1])</span></span><br><span class="line"><span class="comment"># 2.01094849818</span></span><br><span class="line"><span class="comment"># print(df.iat[1,1])</span></span><br><span class="line"><span class="comment"># 2.01094849818</span></span><br><span class="line"></span><br><span class="line"><span class="number">4.</span> 布尔索引</span><br><span class="line"><span class="number">4.1</span> 使用一个单独列的值来选择数据</span><br><span class="line"><span class="comment"># print(df[df.A &gt; 0])</span></span><br><span class="line"><span class="comment">#                    A         B         C         D</span></span><br><span class="line"><span class="comment"># 2018-01-19  0.967563  0.826202 -0.659629 -1.255783</span></span><br><span class="line"><span class="comment"># 2018-01-21  1.222864  1.007020 -0.403161  1.219606</span></span><br><span class="line"><span class="comment"># 2018-01-23  0.344947  0.138564 -1.451801  1.862504</span></span><br><span class="line"><span class="comment"># 2018-01-24  0.142064  0.804119 -1.562833 -0.101581</span></span><br><span class="line"><span class="number">4.2</span> 使用where操作来选择数据</span><br><span class="line"><span class="comment"># print(df[df &gt; 0])</span></span><br><span class="line"><span class="comment">#                    A         B   C         D</span></span><br><span class="line"><span class="comment"># 2018-01-19  0.967563  0.826202 NaN       NaN</span></span><br><span class="line"><span class="comment"># 2018-01-20       NaN       NaN NaN       NaN</span></span><br><span class="line"><span class="comment"># 2018-01-21  1.222864  1.007020 NaN  1.219606</span></span><br><span class="line"><span class="comment"># 2018-01-22       NaN       NaN NaN       NaN</span></span><br><span class="line"><span class="comment"># 2018-01-23  0.344947  0.138564 NaN  1.862504</span></span><br><span class="line"><span class="comment"># 2018-01-24  0.142064  0.804119 NaN       NaN</span></span><br><span class="line"><span class="comment"># df2 = df.copy()</span></span><br><span class="line"><span class="comment"># df2[&#x27;E&#x27;] = [&#x27;one&#x27;,&#x27;two&#x27;,&#x27;three&#x27;,&#x27;one&#x27;,&#x27;two&#x27;,&#x27;four&#x27;]</span></span><br><span class="line"><span class="comment"># print(df2)</span></span><br><span class="line"><span class="comment">#                   A         B         C         D      E</span></span><br><span class="line"><span class="comment"># 2018-01-19 -1.888155 -0.327337  0.927265 -1.782017    one</span></span><br><span class="line"><span class="comment"># 2018-01-20  0.075757  1.071116  0.299332 -0.194304    two</span></span><br><span class="line"><span class="comment"># 2018-01-21 -0.762645  1.139858  0.395793  1.439923  three</span></span><br><span class="line"><span class="comment"># 2018-01-22 -0.885407  0.361705  2.067125 -0.279005    one</span></span><br><span class="line"><span class="comment"># 2018-01-23 -0.255210  0.675473  1.148087 -0.144612    two</span></span><br><span class="line"><span class="comment"># 2018-01-24 -0.774092  1.433175  1.243407 -2.192897   four</span></span><br><span class="line"><span class="comment"># print(df2[df2[&#x27;E&#x27;].isin([&#x27;two&#x27;,&#x27;four&#x27;])])</span></span><br><span class="line"><span class="comment">#                    A         B         C         D     E</span></span><br><span class="line"><span class="comment"># 2018-01-20  0.075757  1.071116  0.299332 -0.194304   two</span></span><br><span class="line"><span class="comment"># 2018-01-23 -0.255210  0.675473  1.148087 -0.144612   two</span></span><br><span class="line"><span class="comment"># 2018-01-24 -0.774092  1.433175  1.243407 -2.192897  four</span></span><br><span class="line"></span><br><span class="line"><span class="number">4.</span> 设置</span><br><span class="line"><span class="number">4.1</span> 设置一个新的列</span><br><span class="line">nl = pd.Series([<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>],index = pd.date_range(<span class="string">&#x27;20180119&#x27;</span>,periods=<span class="number">6</span>))</span><br><span class="line">df[<span class="string">&#x27;F&#x27;</span>] = nl</span><br><span class="line"><span class="number">4.2</span> 通过标签设置新的值</span><br><span class="line">df.at[dates[<span class="number">0</span>],<span class="string">&#x27;A&#x27;</span>] = <span class="number">0</span></span><br><span class="line"><span class="number">4.3</span> 通过位置设置新的值</span><br><span class="line">df.iat[<span class="number">0</span>,<span class="number">1</span>] = <span class="number">0</span></span><br><span class="line"><span class="number">4.4</span> 通过一个numpy数组设置一组新值</span><br><span class="line">df.loc[:,<span class="string">&#x27;D&#x27;</span>] = np.array([<span class="number">5</span>] * <span class="built_in">len</span>(df))</span><br><span class="line"><span class="comment"># print(df)</span></span><br><span class="line"><span class="comment">#                    A         B         C  D  F</span></span><br><span class="line"><span class="comment"># 2018-01-19  0.000000  0.000000 -0.263677  5  1</span></span><br><span class="line"><span class="comment"># 2018-01-20 -0.230378  0.037756 -0.590645  5  2</span></span><br><span class="line"><span class="comment"># 2018-01-21 -0.664824  0.840482  0.194120  5  3</span></span><br><span class="line"><span class="comment"># 2018-01-22  0.919228 -1.004659  0.817310  5  4</span></span><br><span class="line"><span class="comment"># 2018-01-23  0.013167  0.298806  1.107084  5  5</span></span><br><span class="line"><span class="comment"># 2018-01-24  0.072986 -0.094253  0.263455  5  6</span></span><br><span class="line"><span class="number">4.5</span> 通过where操作来设置新的值</span><br><span class="line">df2 = df.copy()</span><br><span class="line">df2[df2 &gt; <span class="number">0</span>] = -df2</span><br><span class="line"><span class="comment"># print(df2)</span></span><br><span class="line"><span class="comment">#                    A         B         C  D  F</span></span><br><span class="line"><span class="comment"># 2018-01-19  0.000000  0.000000 -1.387060 -5 -1</span></span><br><span class="line"><span class="comment"># 2018-01-20 -0.205605 -0.393647 -0.372126 -5 -2</span></span><br><span class="line"><span class="comment"># 2018-01-21 -1.347434 -1.480279 -0.314913 -5 -3</span></span><br><span class="line"><span class="comment"># 2018-01-22 -0.642557 -0.762170 -0.703247 -5 -4</span></span><br><span class="line"><span class="comment"># 2018-01-23 -0.634930 -1.000218 -0.523227 -5 -5</span></span><br><span class="line"><span class="comment"># 2018-01-24 -0.340961 -1.349274 -0.521104 -5 -6</span></span><br></pre></td></tr></table></figure>
<h3 id="缺失值处理"><a class="markdownIt-Anchor" href="#缺失值处理">#</a> 缺失值处理</h3>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&#x27;&#x27;&#x27;在pandas中，使用np.nan来代替缺失值，这些值将默认不会包含在计算中&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line">dates = pd.date_range(<span class="string">&#x27;20180119&#x27;</span>,periods = <span class="number">6</span>)</span><br><span class="line">df = pd.DataFrame(np.random.randn(<span class="number">6</span>,<span class="number">4</span>),index=dates,columns=<span class="built_in">list</span>(<span class="string">&#x27;ABCD&#x27;</span>))</span><br><span class="line"><span class="number">1.</span> reindex()方法可以对指定轴上的索引进行改变/增加/删除操作，这将返回原始数据的一个拷贝</span><br><span class="line">df1 = df.reindex(index = dates[<span class="number">0</span>:<span class="number">4</span>],columns = <span class="built_in">list</span>(df.columns)+[<span class="string">&#x27;E&#x27;</span>])</span><br><span class="line"><span class="comment"># print(df1)</span></span><br><span class="line"><span class="comment">#                    A         B         C         D   E</span></span><br><span class="line"><span class="comment"># 2018-01-19  1.642620 -0.395311 -1.600835 -0.859785 NaN</span></span><br><span class="line"><span class="comment"># 2018-01-20  0.507611  0.272737  0.752700 -0.945402 NaN</span></span><br><span class="line"><span class="comment"># 2018-01-21  1.388164  2.008823  0.141275  0.000459 NaN</span></span><br><span class="line"><span class="comment"># 2018-01-22 -0.149260  0.475242 -0.103702  0.931095 NaN</span></span><br><span class="line">df1.loc[dates[<span class="number">0</span>]:dates[<span class="number">1</span>],<span class="string">&#x27;E&#x27;</span>] = <span class="number">1</span></span><br><span class="line"><span class="comment"># print(df1)</span></span><br><span class="line"><span class="comment">#                    A         B         C         D    E</span></span><br><span class="line"><span class="comment"># 2018-01-19  1.642620 -0.395311 -1.600835 -0.859785  1.0</span></span><br><span class="line"><span class="comment"># 2018-01-20  0.507611  0.272737  0.752700 -0.945402  1.0</span></span><br><span class="line"><span class="comment"># 2018-01-21  1.388164  2.008823  0.141275  0.000459  NaN</span></span><br><span class="line"><span class="comment"># 2018-01-22 -0.149260  0.475242 -0.103702  0.931095  NaN</span></span><br><span class="line"><span class="number">2.</span> 去掉包含缺失值的行</span><br><span class="line"><span class="comment"># print(df1.dropna(how=&#x27;any&#x27;))</span></span><br><span class="line"><span class="comment">#                    A         B         C         D    E</span></span><br><span class="line"><span class="comment"># 2018-01-19 -0.482124  2.026149 -0.946748  1.085659  1.0</span></span><br><span class="line"><span class="comment"># 2018-01-20 -0.341300  0.004407  0.808773  0.002304  1.0</span></span><br><span class="line"><span class="number">3.</span> 对缺失值进行填充</span><br><span class="line"><span class="comment"># print(df1.fillna(value=5))</span></span><br><span class="line"><span class="comment">#                    A         B         C         D    E</span></span><br><span class="line"><span class="comment"># 2018-01-19 -0.482124  2.026149 -0.946748  1.085659  1.0</span></span><br><span class="line"><span class="comment"># 2018-01-20 -0.341300  0.004407  0.808773  0.002304  1.0</span></span><br><span class="line"><span class="comment"># 2018-01-21  0.872226 -2.001683  1.528639 -1.464248  5.0</span></span><br><span class="line"><span class="comment"># 2018-01-22  1.730996 -0.843465  0.711038  1.324974  5.0</span></span><br><span class="line"><span class="number">4.</span> 对数据进行布尔填充</span><br><span class="line"><span class="comment"># print(pd.isnull(df1))</span></span><br><span class="line"><span class="comment">#                 A      B      C      D      E</span></span><br><span class="line"><span class="comment"># 2018-01-19  False  False  False  False  False</span></span><br><span class="line"><span class="comment"># 2018-01-20  False  False  False  False  False</span></span><br><span class="line"><span class="comment"># 2018-01-21  False  False  False  False   True</span></span><br><span class="line"><span class="comment"># 2018-01-22  False  False  False  False   True</span></span><br></pre></td></tr></table></figure>
<h3 id="相关操作"><a class="markdownIt-Anchor" href="#相关操作">#</a> 相关操作</h3>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line">dates = pd.date_range(<span class="string">&#x27;20180119&#x27;</span>,periods = <span class="number">6</span>)</span><br><span class="line">df = pd.DataFrame(np.random.randn(<span class="number">6</span>,<span class="number">4</span>),index=dates,columns=<span class="built_in">list</span>(<span class="string">&#x27;ABCD&#x27;</span>))</span><br><span class="line"><span class="number">1.</span> 统计（相关操作通常情况下不包括缺失值）</span><br><span class="line"><span class="number">1.1</span> 执行描述性统计</span><br><span class="line">print(df.mean())</span><br><span class="line"><span class="comment"># A    0.720938</span></span><br><span class="line"><span class="comment"># B   -0.653084</span></span><br><span class="line"><span class="comment"># C   -0.748462</span></span><br><span class="line"><span class="comment"># D   -0.581817</span></span><br><span class="line"><span class="comment"># dtype: float64</span></span><br><span class="line"><span class="number">1.2</span> 在其他轴上进行相同的操作</span><br><span class="line">print(df.mean(<span class="number">1</span>))</span><br><span class="line"><span class="comment"># 2018-01-19    0.431505</span></span><br><span class="line"><span class="comment"># 2018-01-20    0.384786</span></span><br><span class="line"><span class="comment"># 2018-01-21   -0.040841</span></span><br><span class="line"><span class="comment"># 2018-01-22    0.264810</span></span><br><span class="line"><span class="comment"># 2018-01-23    0.180190</span></span><br><span class="line"><span class="comment"># 2018-01-24   -0.924237</span></span><br><span class="line"><span class="comment"># Freq: D, dtype: float64</span></span><br><span class="line"><span class="number">1.3</span> 对于拥有不同维度，需要对齐的对象进行操作；Pandas会自动的沿着指定的维度进行广播</span><br><span class="line">s = pd.Series([<span class="number">1</span>,<span class="number">3</span>,<span class="number">5</span>,np.nan,<span class="number">6</span>,<span class="number">8</span>],index=dates).shift(<span class="number">2</span>)</span><br><span class="line"><span class="comment"># print(s)</span></span><br><span class="line"><span class="comment"># 2018-01-19    NaN</span></span><br><span class="line"><span class="comment"># 2018-01-20    NaN</span></span><br><span class="line"><span class="comment"># 2018-01-21    1.0</span></span><br><span class="line"><span class="comment"># 2018-01-22    3.0</span></span><br><span class="line"><span class="comment"># 2018-01-23    5.0</span></span><br><span class="line"><span class="comment"># 2018-01-24    NaN</span></span><br><span class="line"><span class="comment"># Freq: D, dtype: float64</span></span><br><span class="line"><span class="comment"># print(df.sub(s,axis=&#x27;index&#x27;))</span></span><br><span class="line"><span class="comment">#                    A         B         C         D</span></span><br><span class="line"><span class="comment"># 2018-01-19       NaN       NaN       NaN       NaN</span></span><br><span class="line"><span class="comment"># 2018-01-20       NaN       NaN       NaN       NaN</span></span><br><span class="line"><span class="comment"># 2018-01-21 -2.368813 -1.484338 -0.528546 -1.707081</span></span><br><span class="line"><span class="comment"># 2018-01-22 -4.079782 -2.097843 -3.377571 -1.564515</span></span><br><span class="line"><span class="comment"># 2018-01-23 -4.887766 -5.817630 -5.109856 -5.165325</span></span><br><span class="line"><span class="comment"># 2018-01-24       NaN       NaN       NaN       NaN</span></span><br><span class="line"><span class="number">2.</span> Apply</span><br><span class="line"><span class="number">2.1</span> 对数据在列上应用函数</span><br><span class="line">print(df.apply(np.cumsum))</span><br><span class="line"><span class="comment"># cumsum 计算累加值</span></span><br><span class="line"><span class="comment"># 比如一个列表是这样[1,2,3,4,5]</span></span><br><span class="line"><span class="comment"># 返回是这样[1,3,6,10,15]</span></span><br><span class="line"><span class="comment">#                    A         B         C         D</span></span><br><span class="line"><span class="comment"># 2018-01-19  0.795920  0.014270 -0.622258 -0.348737</span></span><br><span class="line"><span class="comment"># 2018-01-20  0.105926  0.236074 -2.368370 -0.287449</span></span><br><span class="line"><span class="comment"># 2018-01-21 -1.931999  1.868371 -2.526263 -0.013665</span></span><br><span class="line"><span class="comment"># 2018-01-22 -0.036079  0.976260 -2.906968  0.583806</span></span><br><span class="line"><span class="comment"># 2018-01-23  0.296386  1.971066 -4.294293  1.715660</span></span><br><span class="line"><span class="comment"># 2018-01-24 -2.085994  3.238730 -6.224375  1.005203</span></span><br><span class="line"><span class="comment"># print(df.apply(lambda x: x.max()-x.min()))</span></span><br><span class="line"><span class="comment"># A    2.138003</span></span><br><span class="line"><span class="comment"># B    4.037926</span></span><br><span class="line"><span class="comment"># C    1.753592</span></span><br><span class="line"><span class="comment"># D    2.419793</span></span><br><span class="line"><span class="comment"># dtype: float64</span></span><br><span class="line"><span class="number">2.2</span> 对数据在行上应用函数</span><br><span class="line">print(df.apply(<span class="keyword">lambda</span> x: x.<span class="built_in">max</span>()-x.<span class="built_in">min</span>(),axis=<span class="number">1</span>))</span><br><span class="line"><span class="comment"># 2018-01-19    2.374446</span></span><br><span class="line"><span class="comment"># 2018-01-20    1.545403</span></span><br><span class="line"><span class="comment"># 2018-01-21    1.709167</span></span><br><span class="line"><span class="comment"># 2018-01-22    2.893604</span></span><br><span class="line"><span class="comment"># 2018-01-23    1.162231</span></span><br><span class="line"><span class="comment"># 2018-01-24    3.495989</span></span><br><span class="line"><span class="comment"># Freq: D, dtype: float64</span></span><br><span class="line"><span class="number">3.</span> 直方图</span><br><span class="line">s = pd.Series(np.random.randint(<span class="number">0</span>,<span class="number">7</span>,size=<span class="number">10</span>))</span><br><span class="line"><span class="comment"># print(s)</span></span><br><span class="line"><span class="comment"># 0    5</span></span><br><span class="line"><span class="comment"># 1    2</span></span><br><span class="line"><span class="comment"># 2    6</span></span><br><span class="line"><span class="comment"># 3    6</span></span><br><span class="line"><span class="comment"># 4    3</span></span><br><span class="line"><span class="comment"># 5    6</span></span><br><span class="line"><span class="comment"># 6    2</span></span><br><span class="line"><span class="comment"># 7    6</span></span><br><span class="line"><span class="comment"># 8    3</span></span><br><span class="line"><span class="comment"># 9    1</span></span><br><span class="line"><span class="comment"># dtype: int32</span></span><br><span class="line">print(s.value_counts())</span><br><span class="line"><span class="comment"># 4    4</span></span><br><span class="line"><span class="comment"># 1    2</span></span><br><span class="line"><span class="comment"># 6    1</span></span><br><span class="line"><span class="comment"># 5    1</span></span><br><span class="line"><span class="comment"># 2    1</span></span><br><span class="line"><span class="comment"># 0    1</span></span><br><span class="line"><span class="comment"># dtype: int64</span></span><br><span class="line"><span class="number">4.</span> 字符串方法</span><br><span class="line">Series对象在其<span class="built_in">str</span>属性中配备了一组字符串处理方法，可以很容易的应用到数组中的每个元素</span><br><span class="line">s = pd.Series([<span class="string">&#x27;A&#x27;</span>,<span class="string">&#x27;B&#x27;</span>,np.nan,<span class="string">&#x27;JAVA&#x27;</span>])</span><br><span class="line">print(s.<span class="built_in">str</span>.lower())</span><br><span class="line"><span class="comment"># 0       a</span></span><br><span class="line"><span class="comment"># 1       b</span></span><br><span class="line"><span class="comment"># 2     NaN</span></span><br><span class="line"><span class="comment"># 3    java</span></span><br><span class="line"><span class="comment"># dtype: object</span></span><br></pre></td></tr></table></figure>
<h3 id="合并"><a class="markdownIt-Anchor" href="#合并">#</a> 合并</h3>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="number">1.</span> Concat</span><br><span class="line">df = pd.DataFrame(np.random.randn(<span class="number">10</span>,<span class="number">4</span>))</span><br><span class="line"><span class="comment"># print(df)</span></span><br><span class="line"><span class="comment">#           0         1         2         3</span></span><br><span class="line"><span class="comment"># 0  0.350526 -0.677201 -0.588620 -1.748650</span></span><br><span class="line"><span class="comment"># 1 -2.035935  0.393700 -0.011889  0.147334</span></span><br><span class="line"><span class="comment"># 2 -1.299210  0.176314 -0.705539 -0.008890</span></span><br><span class="line"><span class="comment"># 3  1.106802 -0.514109  0.478564  1.089387</span></span><br><span class="line"><span class="comment"># 4  0.663188  1.149408  0.053992 -0.499767</span></span><br><span class="line"><span class="comment"># 5 -0.821530  1.780245 -0.504094  0.268785</span></span><br><span class="line"><span class="comment"># 6  0.413706 -0.370817 -0.435808  0.928407</span></span><br><span class="line"><span class="comment"># 7 -0.170325  0.894643 -0.290098  0.123416</span></span><br><span class="line"><span class="comment"># 8  0.396641  0.482592  0.342057 -1.162410</span></span><br><span class="line"><span class="comment"># 9 -0.196543  0.326026  0.883571  0.296892</span></span><br><span class="line"><span class="comment"># pieces = [df[:3],df[3:7],df[7:]]</span></span><br><span class="line"><span class="comment"># print(pieces)</span></span><br><span class="line"><span class="comment"># print(pd.concat(pieces))</span></span><br><span class="line"><span class="number">2.</span> merge类似于SQL类型的join合并</span><br><span class="line">left = pd.DataFrame(&#123;<span class="string">&#x27;key&#x27;</span>:[<span class="string">&#x27;foo&#x27;</span>,<span class="string">&#x27;foo&#x27;</span>],<span class="string">&#x27;lval&#x27;</span>:[<span class="number">1</span>,<span class="number">2</span>]&#125;)</span><br><span class="line">right = pd.DataFrame(&#123;<span class="string">&#x27;key&#x27;</span>:[<span class="string">&#x27;foo&#x27;</span>,<span class="string">&#x27;foo&#x27;</span>],<span class="string">&#x27;lval&#x27;</span>:[<span class="number">4</span>,<span class="number">5</span>]&#125;)</span><br><span class="line"><span class="comment"># print(left)</span></span><br><span class="line"><span class="comment">#    key  lval</span></span><br><span class="line"><span class="comment"># 0  foo     1</span></span><br><span class="line"><span class="comment"># 1  foo     2</span></span><br><span class="line"><span class="comment"># print(right)</span></span><br><span class="line"><span class="comment">#    key  lval</span></span><br><span class="line"><span class="comment"># 0  foo     4</span></span><br><span class="line"><span class="comment"># 1  foo     5</span></span><br><span class="line">result = pd.merge(left,right,on=<span class="string">&#x27;key&#x27;</span>)</span><br><span class="line"><span class="comment"># print(result)</span></span><br><span class="line"><span class="comment">#    key  lval_x  lval_y</span></span><br><span class="line"><span class="comment"># 0  foo       1       4</span></span><br><span class="line"><span class="comment"># 1  foo       1       5</span></span><br><span class="line"><span class="comment"># 2  foo       2       4</span></span><br><span class="line"><span class="comment"># 3  foo       2       5</span></span><br><span class="line"><span class="number">3.</span> Append 将一行连接到一个DataFrame</span><br><span class="line">df = pd.DataFrame(np.random.randn(<span class="number">6</span>,<span class="number">4</span>),columns=[<span class="string">&#x27;A&#x27;</span>,<span class="string">&#x27;B&#x27;</span>,<span class="string">&#x27;C&#x27;</span>,<span class="string">&#x27;D&#x27;</span>])</span><br><span class="line"><span class="comment"># print(df)</span></span><br><span class="line"><span class="comment">#           A         B         C         D</span></span><br><span class="line"><span class="comment"># 0 -0.434823 -0.674820 -1.035094  0.926023</span></span><br><span class="line"><span class="comment"># 1  0.281293  1.075782  0.601072 -0.840849</span></span><br><span class="line"><span class="comment"># 2 -0.921222 -0.013399 -0.920835 -1.104292</span></span><br><span class="line"><span class="comment"># 3  0.544048 -0.055161 -2.655735  0.713720</span></span><br><span class="line"><span class="comment"># 4 -0.260426 -0.377402 -0.633011  1.394622</span></span><br><span class="line"><span class="comment"># 5 -0.158969  1.372356  0.202284  1.848250</span></span><br><span class="line">s = df.iloc[<span class="number">3</span>]</span><br><span class="line"><span class="comment"># print(s)</span></span><br><span class="line"><span class="comment"># A    0.544048</span></span><br><span class="line"><span class="comment"># B   -0.055161</span></span><br><span class="line"><span class="comment"># C   -2.655735</span></span><br><span class="line"><span class="comment"># D    0.713720</span></span><br><span class="line"><span class="comment"># Name: 3, dtype: float64</span></span><br><span class="line">result = df.append(s,ignore_index=<span class="literal">True</span>)</span><br><span class="line"><span class="comment"># print(result)</span></span><br><span class="line"><span class="comment">#           A         B         C         D</span></span><br><span class="line"><span class="comment"># 0 -0.434823 -0.674820 -1.035094  0.926023</span></span><br><span class="line"><span class="comment"># 1  0.281293  1.075782  0.601072 -0.840849</span></span><br><span class="line"><span class="comment"># 2 -0.921222 -0.013399 -0.920835 -1.104292</span></span><br><span class="line"><span class="comment"># 3  0.544048 -0.055161 -2.655735  0.713720</span></span><br><span class="line"><span class="comment"># 4 -0.260426 -0.377402 -0.633011  1.394622</span></span><br><span class="line"><span class="comment"># 5 -0.158969  1.372356  0.202284  1.848250</span></span><br><span class="line"><span class="comment"># 6  0.544048 -0.055161 -2.655735  0.713720</span></span><br></pre></td></tr></table></figure>
<h3 id="分组"><a class="markdownIt-Anchor" href="#分组">#</a> 分组</h3>
<p>对于”group by” 操作，我们通常是指以下一个或多个操作步骤：</p>
<ul>
<li>
<p>（Splitting）按照一些规则将数据分为不同的组；</p>
</li>
<li>
<p>（Applying）对于每组数据分别执行一个函数；</p>
</li>
<li>
<p>（Combining）将结果组合到一个数据结构中。</p>
</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line">df = pd.DataFrame(&#123;</span><br><span class="line">    <span class="string">&#x27;A&#x27;</span>:[<span class="string">&#x27;foo&#x27;</span>,<span class="string">&#x27;bar&#x27;</span>,<span class="string">&#x27;foo&#x27;</span>,<span class="string">&#x27;bar&#x27;</span>,<span class="string">&#x27;foo&#x27;</span>,<span class="string">&#x27;bar&#x27;</span>,<span class="string">&#x27;foo&#x27;</span>,<span class="string">&#x27;foo&#x27;</span>],</span><br><span class="line">    <span class="string">&#x27;B&#x27;</span>:[<span class="string">&#x27;one&#x27;</span>,<span class="string">&#x27;one&#x27;</span>,<span class="string">&#x27;two&#x27;</span>,<span class="string">&#x27;three&#x27;</span>,<span class="string">&#x27;two&#x27;</span>,<span class="string">&#x27;two&#x27;</span>,<span class="string">&#x27;one&#x27;</span>,<span class="string">&#x27;three&#x27;</span>],</span><br><span class="line">    <span class="string">&#x27;C&#x27;</span>:np.random.randn(<span class="number">8</span>),</span><br><span class="line">    <span class="string">&#x27;D&#x27;</span>:np.random.randn(<span class="number">8</span>)</span><br><span class="line">&#125;)</span><br><span class="line">print(df)</span><br><span class="line"><span class="comment">#      A      B         C         D</span></span><br><span class="line"><span class="comment"># 0  foo    one  0.144765 -0.508662</span></span><br><span class="line"><span class="comment"># 1  bar    one  2.772947 -0.538177</span></span><br><span class="line"><span class="comment"># 2  foo    two  0.139437  1.895434</span></span><br><span class="line"><span class="comment"># 3  bar  three  0.444667  1.374189</span></span><br><span class="line"><span class="comment"># 4  foo    two  0.859788 -0.241428</span></span><br><span class="line"><span class="comment"># 5  bar    two  0.086100  0.178261</span></span><br><span class="line"><span class="comment"># 6  foo    one -0.794602  0.677456</span></span><br><span class="line"><span class="comment"># 7  foo  three -0.989794 -0.524439</span></span><br><span class="line"><span class="number">1.</span> 分组并对每个分组执行<span class="built_in">sum</span>函数</span><br><span class="line">result = df.groupby(<span class="string">&#x27;A&#x27;</span>).<span class="built_in">sum</span>()</span><br><span class="line"><span class="comment"># print(result)</span></span><br><span class="line"><span class="comment">#             C         D</span></span><br><span class="line"><span class="comment"># A</span></span><br><span class="line"><span class="comment"># bar  3.303714  1.014273</span></span><br><span class="line"><span class="comment"># foo -0.640407  1.298361</span></span><br><span class="line"><span class="number">2.</span> 通过多个列进行分组形成一个层次索引，然后执行函数</span><br><span class="line">result = df.groupby([<span class="string">&#x27;A&#x27;</span>,<span class="string">&#x27;B&#x27;</span>]).<span class="built_in">sum</span>()</span><br><span class="line"><span class="comment"># print(result)</span></span><br><span class="line"><span class="comment">#                   C         D</span></span><br><span class="line"><span class="comment"># A   B</span></span><br><span class="line"><span class="comment"># bar one    2.772947 -0.538177</span></span><br><span class="line"><span class="comment">#     three  0.444667  1.374189</span></span><br><span class="line"><span class="comment">#     two    0.086100  0.178261</span></span><br><span class="line"><span class="comment"># foo one   -0.649838  0.168794</span></span><br><span class="line"><span class="comment">#     three -0.989794 -0.524439</span></span><br><span class="line"><span class="comment">#     two    0.999225  1.654005</span></span><br></pre></td></tr></table></figure>
<h3 id="reshaping"><a class="markdownIt-Anchor" href="#reshaping">#</a> Reshaping</h3>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="number">1.</span> Stack</span><br><span class="line">tuples = <span class="built_in">list</span>(<span class="built_in">zip</span>(*[[</span><br><span class="line">    <span class="string">&#x27;bar&#x27;</span>,<span class="string">&#x27;bar&#x27;</span>,<span class="string">&#x27;baz&#x27;</span>,<span class="string">&#x27;baz&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;foo&#x27;</span>,<span class="string">&#x27;foo&#x27;</span>,<span class="string">&#x27;qux&#x27;</span>,<span class="string">&#x27;qux&#x27;</span>],</span><br><span class="line">    [<span class="string">&#x27;one&#x27;</span>,<span class="string">&#x27;two&#x27;</span>,<span class="string">&#x27;one&#x27;</span>,<span class="string">&#x27;two&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;one&#x27;</span>,<span class="string">&#x27;two&#x27;</span>,<span class="string">&#x27;one&#x27;</span>,<span class="string">&#x27;two&#x27;</span>]]))</span><br><span class="line"><span class="comment"># print(tuples)</span></span><br><span class="line"><span class="comment"># [(&#x27;bar&#x27;, &#x27;one&#x27;), (&#x27;bar&#x27;, &#x27;two&#x27;), (&#x27;baz&#x27;, &#x27;one&#x27;), (&#x27;baz&#x27;, &#x27;two&#x27;),</span></span><br><span class="line"><span class="comment">#  (&#x27;foo&#x27;, &#x27;one&#x27;), (&#x27;foo&#x27;, &#x27;two&#x27;), (&#x27;qux&#x27;, &#x27;one&#x27;), (&#x27;qux&#x27;, &#x27;two&#x27;)]</span></span><br><span class="line">index = pd.MultiIndex.from_tuples(tuples,names=[<span class="string">&#x27;first&#x27;</span>,<span class="string">&#x27;second&#x27;</span>])</span><br><span class="line"><span class="comment"># print(index)</span></span><br><span class="line"><span class="comment"># MultiIndex(levels=[[&#x27;bar&#x27;, &#x27;baz&#x27;, &#x27;foo&#x27;, &#x27;qux&#x27;], [&#x27;one&#x27;, &#x27;two&#x27;]],</span></span><br><span class="line"><span class="comment">#            labels=[[0, 0, 1, 1, 2, 2, 3, 3], [0, 1, 0, 1, 0, 1, 0, 1]],</span></span><br><span class="line"><span class="comment">#            names=[&#x27;first&#x27;, &#x27;second&#x27;])</span></span><br><span class="line">df = pd.DataFrame(np.random.randn(<span class="number">8</span>,<span class="number">2</span>),index=index,columns=<span class="built_in">list</span>(<span class="string">&#x27;AB&#x27;</span>))</span><br><span class="line">df2 = df[:<span class="number">4</span>]</span><br><span class="line"><span class="comment"># print(df2)</span></span><br><span class="line"><span class="comment">#                      A         B</span></span><br><span class="line"><span class="comment"># first second</span></span><br><span class="line"><span class="comment"># bar   one    -0.583892  0.112302</span></span><br><span class="line"><span class="comment">#       two     0.423727 -0.485348</span></span><br><span class="line"><span class="comment"># baz   one     0.811787 -0.218276</span></span><br><span class="line"><span class="comment">#       two     1.684989  0.090760</span></span><br><span class="line">stacked = df2.stack()</span><br><span class="line"><span class="comment"># print(stacked)</span></span><br><span class="line"><span class="comment"># first  second</span></span><br><span class="line"><span class="comment"># bar    one     A   -0.049549</span></span><br><span class="line"><span class="comment">#                B    0.207460</span></span><br><span class="line"><span class="comment">#        two     A    1.185503</span></span><br><span class="line"><span class="comment">#                B   -1.448374</span></span><br><span class="line"><span class="comment"># baz    one     A   -2.666536</span></span><br><span class="line"><span class="comment">#                B   -0.531970</span></span><br><span class="line"><span class="comment">#        two     A    0.384126</span></span><br><span class="line"><span class="comment">#                B    0.306118</span></span><br><span class="line"><span class="comment"># print(stacked.unstack())</span></span><br><span class="line"><span class="comment">#                      A         B</span></span><br><span class="line"><span class="comment"># first second</span></span><br><span class="line"><span class="comment"># bar   one    -1.049974  0.636667</span></span><br><span class="line"><span class="comment">#       two     2.058770 -0.228693</span></span><br><span class="line"><span class="comment"># baz   one    -1.354676  1.577898</span></span><br><span class="line"><span class="comment">#       two    -0.286151  0.434033</span></span><br><span class="line">print(stacked.unstack(<span class="number">1</span>))</span><br><span class="line"><span class="comment"># second        one       two</span></span><br><span class="line"><span class="comment"># first</span></span><br><span class="line"><span class="comment"># bar   A -0.236040 -1.909281</span></span><br><span class="line"><span class="comment">#       B -0.114495 -1.118122</span></span><br><span class="line"><span class="comment"># baz   A  0.407393 -0.836405</span></span><br><span class="line"><span class="comment">#       B -0.033035 -0.696890</span></span><br><span class="line">print(stacked.unstack(<span class="number">0</span>))</span><br><span class="line"><span class="comment"># first          bar       baz</span></span><br><span class="line"><span class="comment"># second</span></span><br><span class="line"><span class="comment"># one    A -0.236040  0.407393</span></span><br><span class="line"><span class="comment">#        B -0.114495 -0.033035</span></span><br><span class="line"><span class="comment"># two    A -1.909281 -0.836405</span></span><br><span class="line"><span class="comment">#        B -1.118122 -0.696890</span></span><br></pre></td></tr></table></figure>
<h3 id="时间序列"><a class="markdownIt-Anchor" href="#时间序列">#</a> 时间序列</h3>
<p>Pandas 在对频率转换进行重新采样时拥有简单、强大且高效的功能（如将按秒采样的数据转换为按 1 分钟为单位进行采样的数据</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line">rng = pd.date_range(<span class="string">&#x27;1/1/2018&#x27;</span>,periods=<span class="number">120</span>,freq=<span class="string">&#x27;S&#x27;</span>)</span><br><span class="line">ts = pd.Series(np.random.randint(<span class="number">0</span>,<span class="number">500</span>,<span class="built_in">len</span>(rng)),index=rng)</span><br><span class="line">res = ts.resample(<span class="string">&#x27;1Min&#x27;</span>).<span class="built_in">sum</span>()</span><br><span class="line"><span class="comment"># print(res)</span></span><br><span class="line"><span class="comment"># 2018-01-01 00:00:00    14373</span></span><br><span class="line"><span class="comment"># 2018-01-01 00:01:00    14489</span></span><br><span class="line"><span class="comment"># Freq: T, dtype: int32</span></span><br></pre></td></tr></table></figure>
<h3 id="categorical"><a class="markdownIt-Anchor" href="#categorical">#</a> Categorical</h3>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line">df = pd.DataFrame(&#123;<span class="string">&quot;id&quot;</span>:[<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>],</span><br><span class="line"><span class="string">&quot;raw_grade&quot;</span>:[<span class="string">&#x27;a&#x27;</span>,<span class="string">&#x27;b&#x27;</span>,<span class="string">&#x27;b&#x27;</span>,<span class="string">&#x27;a&#x27;</span>,<span class="string">&#x27;a&#x27;</span>,<span class="string">&#x27;e&#x27;</span>]&#125;)</span><br><span class="line"><span class="comment"># print(df)</span></span><br><span class="line"><span class="comment">#    id raw_grade</span></span><br><span class="line"><span class="comment"># 0   1         a</span></span><br><span class="line"><span class="comment"># 1   2         b</span></span><br><span class="line"><span class="comment"># 2   3         b</span></span><br><span class="line"><span class="comment"># 3   4         a</span></span><br><span class="line"><span class="comment"># 4   5         a</span></span><br><span class="line"><span class="comment"># 5   6         e</span></span><br><span class="line"><span class="number">1.</span> 将原始的grade转换为Categorical数据类型</span><br><span class="line">df[<span class="string">&#x27;grade&#x27;</span>] = df[<span class="string">&quot;raw_grade&quot;</span>].astype(<span class="string">&#x27;category&#x27;</span>)</span><br><span class="line"><span class="comment"># print(df[&#x27;grade&#x27;])</span></span><br><span class="line"><span class="comment"># 0    a</span></span><br><span class="line"><span class="comment"># 1    b</span></span><br><span class="line"><span class="comment"># 2    b</span></span><br><span class="line"><span class="comment"># 3    a</span></span><br><span class="line"><span class="comment"># 4    a</span></span><br><span class="line"><span class="comment"># 5    e</span></span><br><span class="line"><span class="comment"># Name: grade, dtype: category</span></span><br><span class="line"><span class="comment"># Categories (3, object): [a, b, e]</span></span><br><span class="line"><span class="number">2.</span> 将Categorical类型数据重命名为更有意义的名称</span><br><span class="line">df[<span class="string">&#x27;grade&#x27;</span>].cat.categories = [<span class="string">&#x27;very good&#x27;</span>,<span class="string">&#x27;good&#x27;</span>,<span class="string">&#x27;very bad&#x27;</span>]</span><br><span class="line"><span class="comment"># print(df[&#x27;grade&#x27;])</span></span><br><span class="line"><span class="comment"># 0    very good</span></span><br><span class="line"><span class="comment"># 1         good</span></span><br><span class="line"><span class="comment"># 2         good</span></span><br><span class="line"><span class="comment"># 3    very good</span></span><br><span class="line"><span class="comment"># 4    very good</span></span><br><span class="line"><span class="comment"># 5     very bad</span></span><br><span class="line"><span class="comment"># Name: grade, dtype: category</span></span><br><span class="line"><span class="comment"># Categories (3, object): [very good, good, very bad]</span></span><br><span class="line"><span class="number">3.</span> 对类别进行重新排序，增加缺失的类别</span><br><span class="line">df[<span class="string">&#x27;grade&#x27;</span>] = df[<span class="string">&#x27;grade&#x27;</span>].cat.set_categories([<span class="string">&#x27;very bad&#x27;</span>,<span class="string">&#x27;bad&#x27;</span>,<span class="string">&#x27;medium&#x27;</span>,<span class="string">&#x27;good&#x27;</span>,<span class="string">&#x27;very good&#x27;</span>])</span><br><span class="line"><span class="comment"># print(df[&#x27;grade&#x27;])</span></span><br><span class="line"><span class="comment"># 0    very good</span></span><br><span class="line"><span class="comment"># 1         good</span></span><br><span class="line"><span class="comment"># 2         good</span></span><br><span class="line"><span class="comment"># 3    very good</span></span><br><span class="line"><span class="comment"># 4    very good</span></span><br><span class="line"><span class="comment"># 5     very bad</span></span><br><span class="line"><span class="comment"># Name: grade, dtype: category</span></span><br><span class="line"><span class="comment"># Categories (5, object): [very bad, bad, medium, good, very good]</span></span><br><span class="line"><span class="number">4.</span> 排序是按照Categorical的顺序进行的而不是按照字典顺序进行</span><br><span class="line">res = df.sort_values(by = <span class="string">&#x27;grade&#x27;</span>)</span><br><span class="line"><span class="comment"># print(res)</span></span><br><span class="line"><span class="comment">#    id raw_grade      grade</span></span><br><span class="line"><span class="comment"># 5   6         e   very bad</span></span><br><span class="line"><span class="comment"># 1   2         b       good</span></span><br><span class="line"><span class="comment"># 2   3         b       good</span></span><br><span class="line"><span class="comment"># 0   1         a  very good</span></span><br><span class="line"><span class="comment"># 3   4         a  very good</span></span><br><span class="line"><span class="comment"># 4   5         a  very good</span></span><br><span class="line"><span class="number">5.</span> 对Categorical列进行排序时存在空的类别</span><br><span class="line">res = df.groupby(<span class="string">&#x27;grade&#x27;</span>).size()</span><br><span class="line"><span class="comment"># print(res)</span></span><br><span class="line"><span class="comment"># grade</span></span><br><span class="line"><span class="comment"># very bad     1</span></span><br><span class="line"><span class="comment"># bad          0</span></span><br><span class="line"><span class="comment"># medium       0</span></span><br><span class="line"><span class="comment"># good         2</span></span><br><span class="line"><span class="comment"># very good    3</span></span><br><span class="line"><span class="comment"># dtype: int64</span></span><br></pre></td></tr></table></figure>
<h3 id="画图"><a class="markdownIt-Anchor" href="#画图">#</a> 画图</h3>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"></span><br><span class="line">ts = pd.Series(np.random.randn(<span class="number">1000</span>),index=pd.date_range(<span class="string">&#x27;1/1/2000&#x27;</span>,periods=<span class="number">1000</span>))</span><br><span class="line"><span class="comment"># ts = ts.cumsum()</span></span><br><span class="line"><span class="comment"># ts.plot()</span></span><br><span class="line"><span class="comment"># plt.show()</span></span><br><span class="line"></span><br><span class="line">df = pd.DataFrame(np.random.randn(<span class="number">1000</span>,<span class="number">4</span>),index=ts.index,</span><br><span class="line">                  columns=[<span class="string">&#x27;A&#x27;</span>,<span class="string">&#x27;B&#x27;</span>,<span class="string">&#x27;C&#x27;</span>,<span class="string">&#x27;D&#x27;</span>])</span><br><span class="line">df = df.cumsum()</span><br><span class="line">plt.figure();df.plot();plt.legend(loc=<span class="string">&#x27;best&#x27;</span>);plt.show()</span><br></pre></td></tr></table></figure>

<h3 id="导入和保存数据"><a class="markdownIt-Anchor" href="#导入和保存数据">#</a> 导入和保存数据</h3>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line">dates = pd.date_range(<span class="string">&#x27;20180119&#x27;</span>,periods = <span class="number">6</span>)</span><br><span class="line">df = pd.DataFrame(np.random.randn(<span class="number">6</span>,<span class="number">4</span>),index=dates,columns=<span class="built_in">list</span>(<span class="string">&#x27;ABCD&#x27;</span>))</span><br><span class="line"><span class="number">1.</span> 写入csv文件</span><br><span class="line">df.to_csv(<span class="string">&#x27;foo.csv&#x27;</span>)</span><br><span class="line"><span class="number">2.</span> 从csv文件中读取</span><br><span class="line">rdf = pd.read_csv(<span class="string">&#x27;foo.csv&#x27;</span>)</span><br><span class="line"><span class="comment"># print(rdf.head())</span></span><br><span class="line"><span class="comment">#    Unnamed: 0         A         B         C         D</span></span><br><span class="line"><span class="comment"># 0  2018-01-19 -0.493852  1.111875 -1.274353  1.253351</span></span><br><span class="line"><span class="comment"># 1  2018-01-20 -0.955214 -0.874248  0.497260  1.422481</span></span><br><span class="line"><span class="comment"># 2  2018-01-21  0.990284  0.236732 -0.216565 -0.391593</span></span><br><span class="line"><span class="comment"># 3  2018-01-22 -1.669639  0.388650  0.729114  0.553893</span></span><br><span class="line"><span class="comment"># 4  2018-01-23  0.108748 -1.347310 -1.346028 -1.075332</span></span><br><span class="line"><span class="comment"># pip install tables==3.3.0</span></span><br><span class="line"><span class="number">1.</span> 写入HDF5存储</span><br><span class="line">df.to_hdf(<span class="string">&#x27;foo.h5&#x27;</span>,<span class="string">&#x27;df&#x27;</span>)</span><br><span class="line"><span class="number">2.</span> 从HDF5存储中读取</span><br><span class="line">rdf = pd.read_hdf(<span class="string">&#x27;foo.h5&#x27;</span>,<span class="string">&#x27;df&#x27;</span>)</span><br><span class="line"><span class="comment"># print(rdf.head())</span></span><br><span class="line"><span class="comment">#                    A         B         C         D</span></span><br><span class="line"><span class="comment"># 2018-01-19 -0.012467  0.795258  0.317056  2.658598</span></span><br><span class="line"><span class="comment"># 2018-01-20  0.199918 -0.404888  0.882677  1.460073</span></span><br><span class="line"><span class="comment"># 2018-01-21 -1.454304 -0.261921 -0.247211  0.874749</span></span><br><span class="line"><span class="comment"># 2018-01-22 -0.620360 -0.835549 -0.307428  2.102838</span></span><br><span class="line"><span class="comment"># 2018-01-23 -1.901853 -0.237466 -0.241624  0.899364</span></span><br><span class="line"><span class="comment"># pip install openpyxl</span></span><br><span class="line"><span class="number">1.</span> 写入excel文件</span><br><span class="line">df.to_excel(<span class="string">&#x27;foo.xlsx&#x27;</span>,sheet_name=<span class="string">&#x27;Sheet1&#x27;</span>)</span><br><span class="line"><span class="number">2.</span> 从excel文件中读取</span><br><span class="line">rdf = pd.read_excel(<span class="string">&#x27;foo.xlsx&#x27;</span>,<span class="string">&#x27;Sheet1&#x27;</span>,index_col=<span class="literal">None</span>,na_values=[<span class="string">&#x27;NA&#x27;</span>])</span><br><span class="line"><span class="comment"># print(rdf.head())</span></span><br><span class="line"><span class="comment">#                   A         B         C         D</span></span><br><span class="line"><span class="comment"># 2018-01-19 -0.721516  1.137682 -0.302877 -0.494486</span></span><br><span class="line"><span class="comment"># 2018-01-20  0.365947  1.494965  0.241657 -0.300226</span></span><br><span class="line"><span class="comment"># 2018-01-21  0.522483  1.195972 -0.403275 -0.882628</span></span><br><span class="line"><span class="comment"># 2018-01-22 -0.556909  0.877889 -0.218577  1.026033</span></span><br><span class="line"><span class="comment"># 2018-01-23  0.459684 -0.896963  1.271079 -2.797635</span></span><br></pre></td></tr></table></figure>
<blockquote>
<p>引用: <span class="exturl" data-url="aHR0cHM6Ly93d3cuY25ibG9ncy5jb20vY2hhb3NpbXBsZS9wLzQxNTMwODMuaHRtbA==">https://www.cnblogs.com/chaosimple/p/4153083.html</span></p>
</blockquote>

      <div class="tags">
          <a href="/tags/python/" rel="tag"><i class="ic i-tag"></i> python</a>
      </div>
  </div>

   <footer>

    <div class="meta">
  <span class="item">
    <span class="icon">
      <i class="ic i-calendar-check"></i>
    </span>
    <span class="text">Edited on</span>
    <time title="Modified: 2019-09-30 15:33:14" itemprop="dateModified" datetime="2019-09-30T15:33:14+08:00">2019-09-30</time>
  </span>
</div>

      

  </footer>

</article>

  </div>
  

<div class="post-nav">
    <div class="item left">
      

  <a href="/2021/03/04/python-pandas-load-data/" itemprop="url" rel="prev" data-background-image="https:&#x2F;&#x2F;tva4.sinaimg.cn&#x2F;mw690&#x2F;6833939bly1gipey0a334j20zk0m8qpt.jpg" title="python pandas load data">
  <span class="type">Previous Post</span>
  <span class="category"><i class="ic i-flag"></i> </span>
  <h3>python pandas load data</h3>
  </a>

    </div>
    <div class="item right">
      

  <a href="/2021/03/04/python-test/" itemprop="url" rel="next" data-background-image="https:&#x2F;&#x2F;tva4.sinaimg.cn&#x2F;mw690&#x2F;6833939bly1gicm0fdw5cj20zk0m8hdt.jpg" title="python test">
  <span class="type">Next Post</span>
  <span class="category"><i class="ic i-flag"></i> </span>
  <h3>python test</h3>
  </a>

    </div>
</div>

  
  <div class="wrap" id="comments"></div>


        </div>
        <div id="sidebar">
          

<div class="inner">

  <div class="panels">
    <div class="inner">
      <div class="contents panel pjax" data-title="Contents">
          <ol class="toc"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%9B%E5%BB%BA%E5%AF%B9%E8%B1%A1"><span class="toc-number">1.</span> <span class="toc-text"> 创建对象</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9F%A5%E7%9C%8B%E6%95%B0%E6%8D%AE"><span class="toc-number">2.</span> <span class="toc-text"> 查看数据</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%80%89%E6%8B%A9"><span class="toc-number">3.</span> <span class="toc-text"> 选择</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BC%BA%E5%A4%B1%E5%80%BC%E5%A4%84%E7%90%86"><span class="toc-number">4.</span> <span class="toc-text"> 缺失值处理</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%9B%B8%E5%85%B3%E6%93%8D%E4%BD%9C"><span class="toc-number">5.</span> <span class="toc-text"> 相关操作</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%90%88%E5%B9%B6"><span class="toc-number">6.</span> <span class="toc-text"> 合并</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%86%E7%BB%84"><span class="toc-number">7.</span> <span class="toc-text"> 分组</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#reshaping"><span class="toc-number">8.</span> <span class="toc-text"> Reshaping</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%97%B6%E9%97%B4%E5%BA%8F%E5%88%97"><span class="toc-number">9.</span> <span class="toc-text"> 时间序列</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#categorical"><span class="toc-number">10.</span> <span class="toc-text"> Categorical</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%94%BB%E5%9B%BE"><span class="toc-number">11.</span> <span class="toc-text"> 画图</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AF%BC%E5%85%A5%E5%92%8C%E4%BF%9D%E5%AD%98%E6%95%B0%E6%8D%AE"><span class="toc-number">12.</span> <span class="toc-text"> 导入和保存数据</span></a></li></ol>
      </div>
      <div class="related panel pjax" data-title="Related">
      </div>
      <div class="overview panel" data-title="Overview">
        <div class="author" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <img class="image" itemprop="image" alt="江边鸟"
      data-src="/images/avatar.jpg">
  <p class="name" itemprop="name">江边鸟</p>
  <div class="description" itemprop="description"></div>
</div>

<nav class="state">
    <div class="item posts">
      <a href="/archives/">
        <span class="count">236</span>
        <span class="name">posts</span>
      </a>
    </div>
    <div class="item tags">
      <a href="/tags/">
        <span class="count">29</span>
        <span class="name">tags</span>
      </a>
    </div>
</nav>

<div class="social">
      <span class="exturl item github" data-url="aHR0cHM6Ly9naXRodWIuY29tL2xoY2hlbjc0" title="https:&#x2F;&#x2F;github.com&#x2F;lhchen74"><i class="ic i-github"></i></span>
      <span class="exturl item twitter" data-url="aHR0cHM6Ly90d2l0dGVyLmNvbS95b3VybmFtZQ==" title="https:&#x2F;&#x2F;twitter.com&#x2F;yourname"><i class="ic i-twitter"></i></span>
      <span class="exturl item zhihu" data-url="aHR0cHM6Ly93d3cuemhpaHUuY29tL3Blb3BsZS95b3VybmFtZQ==" title="https:&#x2F;&#x2F;www.zhihu.com&#x2F;people&#x2F;yourname"><i class="ic i-zhihu"></i></span>
      <span class="exturl item music" data-url="aHR0cHM6Ly9tdXNpYy4xNjMuY29tLyMvdXNlci9ob21lP2lkPXlvdXJpZA==" title="https:&#x2F;&#x2F;music.163.com&#x2F;#&#x2F;user&#x2F;home?id&#x3D;yourid"><i class="ic i-cloud-music"></i></span>
      <span class="exturl item weibo" data-url="aHR0cHM6Ly93ZWliby5jb20veW91cm5hbWU=" title="https:&#x2F;&#x2F;weibo.com&#x2F;yourname"><i class="ic i-weibo"></i></span>
      <span class="exturl item about" data-url="aHR0cHM6Ly9hYm91dC5tZS95b3VybmFtZQ==" title="https:&#x2F;&#x2F;about.me&#x2F;yourname"><i class="ic i-address-card"></i></span>
</div>

<ul class="menu">
  
    
  <li class="item">
    <a href="/" rel="section"><i class="ic i-home"></i>Home</a>
  </li>

    
  <li class="item">
    <a href="/about/" rel="section"><i class="ic i-user"></i>About</a>
  </li>

        
  <li class="item dropdown">
      <a href="javascript:void(0);"><i class="ic i-feather"></i>Posts</a>
    <ul class="submenu">

        
  <li class="item">
    <a href="/archives/" rel="section"><i class="ic i-list-alt"></i>Archives</a>
  </li>

        
  <li class="item">
    <a href="/categories/" rel="section"><i class="ic i-th"></i>Categories</a>
  </li>

        
  <li class="item">
    <a href="/tags/" rel="section"><i class="ic i-tags"></i>Tags</a>
  </li>

  </ul>
    
  <li class="item">
    <a href="/friends/" rel="section"><i class="ic i-heart"></i>friends</a>
  </li>

    
  <li class="item">
    <a href="/links/" rel="section"><i class="ic i-magic"></i>links</a>
  </li>


</ul>

      </div>
    </div>
  </div>

  <ul id="quick">
    <li class="prev pjax">
        <a href="/2021/03/04/python-pandas-load-data/" rel="prev" title="Previous Post"><i class="ic i-chevron-left"></i></a>
    </li>
    <li class="up"><i class="ic i-arrow-up"></i></li>
    <li class="down"><i class="ic i-arrow-down"></i></li>
    <li class="next pjax">
        <a href="/2021/03/04/python-test/" rel="next" title="Next Post"><i class="ic i-chevron-right"></i></a>
    </li>
    <li class="percent"></li>
  </ul>
</div>


        </div>
        <div class="dimmer"></div>
      </div>
    </main>
    <footer id="footer">
      <div class="inner">
        <div class="widgets">
          

        </div>
        <div class="status">
  <div class="copyright">
    
    &copy; 2010 – 
    <span itemprop="copyrightYear">2021</span>
    <span class="with-love">
      <i class="ic i-sakura rotate"></i>
    </span>
    <span class="author" itemprop="copyrightHolder">江边鸟 @ Dew's World</span>
  </div>
  <div class="powered-by">
    Powered by <span class="exturl" data-url="aHR0cHM6Ly9oZXhvLmlv">Hexo</span> & Theme.<span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL2FtZWhpbWUvaGV4by10aGVtZS1zaG9rYQ==">Shoka</span>
  </div>
</div>

      </div>
    </footer>
  </div>
<script data-config type="text/javascript">
  var LOCAL = {
    path: '2021/03/04/python-pandas/',
    favicon: {
      show: "（●´3｀●）Goooood",
      hide: "(´Д｀)Booooom"
    },
    search : {
      placeholder: "Search for Posts",
      empty: "We didn't find any results for the search: ${query}",
      stats: "${hits} results found in ${time} ms"
    },
    valine: true,fancybox: true,
    ignores : [
      function(uri) {
        return uri.includes('#');
      },
      function(uri) {
        return new RegExp(LOCAL.path+"$").test(uri);
      }
    ]
  };
</script>

<script src="https://cdn.polyfill.io/v2/polyfill.js"></script>

<script src="//cdn.jsdelivr.net/combine/npm/pace-js@1.0.2/pace.min.js,npm/pjax@0.2.8/pjax.min.js,npm/whatwg-fetch@3.4.0/dist/fetch.umd.min.js,npm/animejs@3.2.0/lib/anime.min.js,npm/algoliasearch@4/dist/algoliasearch-lite.umd.js,npm/instantsearch.js@4/dist/instantsearch.production.min.js,npm/lozad@1/dist/lozad.min.js,npm/quicklink@2/dist/quicklink.umd.js"></script>

<script src="/js/app.js?v=0.2.5"></script>




</body>
</html>
