



<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#FFF">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">

<link rel="icon" type="image/ico" sizes="32x32" href="/images/favicon.ico">
  <meta http-equiv="Cache-Control" content="no-transform">
  <meta http-equiv="Cache-Control" content="no-siteapp">


<link rel="alternate" type="application/rss+xml" title="我知这世界本如露水般短暂 然而 然而" href="https://lhchen74.github.io/rss.xml" />
<link rel="alternate" type="application/atom+xml" title="我知这世界本如露水般短暂 然而 然而" href="https://lhchen74.github.io/atom.xml" />
<link rel="alternate" type="application/json" title="我知这世界本如露水般短暂 然而 然而" href="https://lhchen74.github.io/feed.json" />

<link rel="stylesheet" href="//fonts.googleapis.com/css?family=Mulish:300,300italic,400,400italic,700,700italic%7CFredericka%20the%20Great:300,300italic,400,400italic,700,700italic%7CNoto%20Serif%20JP:300,300italic,400,400italic,700,700italic%7CNoto%20Serif%20SC:300,300italic,400,400italic,700,700italic%7CInconsolata:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext">

<link rel="stylesheet" href="/css/app.css?v=0.2.5">

  
  <meta name="keywords" content="java" />


<link rel="canonical" href="https://lhchen74.github.io/2021/03/13/java-hash/">



  <title>
字典、哈希与Map |
露の世 = 我知这世界本如露水般短暂 然而 然而</title>
<meta name="generator" content="Hexo 5.4.0"></head>
<body itemscope itemtype="http://schema.org/WebPage">
  <div id="loading">
    <div class="cat">
      <div class="body"></div>
      <div class="head">
        <div class="face"></div>
      </div>
      <div class="foot">
        <div class="tummy-end"></div>
        <div class="bottom"></div>
        <div class="legs left"></div>
        <div class="legs right"></div>
      </div>
      <div class="paw">
        <div class="hands left"></div>
        <div class="hands right"></div>
      </div>
    </div>
  </div>
  <div id="container">
    <header id="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="inner">
        <div id="brand">
          <div class="pjax">
          
  <h1 itemprop="name headline">字典、哈希与Map
  </h1>
  
<div class="meta">
  <span class="item" title="Created: 2021-03-13 00:00:00">
    <span class="icon">
      <i class="ic i-calendar"></i>
    </span>
    <span class="text">Posted on</span>
    <time itemprop="dateCreated datePublished" datetime="2021-03-13T00:00:00+08:00">2021-03-13</time>
  </span>
</div>


          </div>
        </div>
        <nav id="nav">
  <div class="inner">
    <div class="toggle">
      <div class="lines" aria-label="Toggle navigation bar">
        <span class="line"></span>
        <span class="line"></span>
        <span class="line"></span>
      </div>
    </div>
    <ul class="menu">
      <li class="item title"><a href="/" rel="start">露の世</a></li>
    </ul>
    <ul class="right">
      <li class="item theme">
        <i class="ic i-sun"></i>
      </li>
      <li class="item search">
        <i class="ic i-search"></i>
      </li>
    </ul>
  </div>
</nav>

      </div>
      <div id="imgs" class="pjax">
        <ul>
          <li class="item" data-background-image="https://tva2.sinaimg.cn/large/6833939bly1gipex2cdtbj20zk0m8x6p.jpg"></li>
          <li class="item" data-background-image="https://tva2.sinaimg.cn/large/6833939bly1giclga70tsj20zk0m84mr.jpg"></li>
          <li class="item" data-background-image="https://tva2.sinaimg.cn/large/6833939bly1giclhnx9glj20zk0m8npd.jpg"></li>
          <li class="item" data-background-image="https://tva2.sinaimg.cn/large/6833939bly1gipey0a334j20zk0m8qpt.jpg"></li>
          <li class="item" data-background-image="https://tva2.sinaimg.cn/large/6833939bly1gipesrnqv3j20zk0m8ava.jpg"></li>
          <li class="item" data-background-image="https://tva2.sinaimg.cn/large/6833939bly1giclh0m9pdj20zk0m8hdt.jpg"></li>
        </ul>
      </div>
    </header>
    <div id="waves">
      <svg class="waves" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 24 150 28" preserveAspectRatio="none" shape-rendering="auto">
        <defs>
          <path id="gentle-wave" d="M-160 44c30 0 58-18 88-18s 58 18 88 18 58-18 88-18 58 18 88 18 v44h-352z" />
        </defs>
        <g class="parallax">
          <use xlink:href="#gentle-wave" x="48" y="0" />
          <use xlink:href="#gentle-wave" x="48" y="3" />
          <use xlink:href="#gentle-wave" x="48" y="5" />
          <use xlink:href="#gentle-wave" x="48" y="7" />
        </g>
      </svg>
    </div>
    <main>
      <div class="inner">
        <div id="main" class="pjax">
          
  <div class="article wrap">
    
<div class="breadcrumb" itemscope itemtype="https://schema.org/BreadcrumbList">
<i class="ic i-home"></i>
<span><a href="/">Home</a></span>
</div>

    <article itemscope itemtype="http://schema.org/Article" class="post block" lang="en">
  <link itemprop="mainEntityOfPage" href="https://lhchen74.github.io/2021/03/13/java-hash/">

  <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
    <meta itemprop="image" content="/images/avatar.jpg">
    <meta itemprop="name" content="江边鸟">
    <meta itemprop="description" content=", ">
  </span>

  <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
    <meta itemprop="name" content="我知这世界本如露水般短暂 然而 然而">
  </span>

  <div class="body md" itemprop="articleBody">
    

    <blockquote>
<p>转载：<span class="exturl" data-url="aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L25pdTAxNDcvYXJ0aWNsZS9kZXRhaWxzLzUxNjgyMTMy">【必须学好】字典、哈希与 Map_niu0147 的专栏 - CSDN 博客</span></p>
</blockquote>
<p>在实际问题中，按照给定的值进行数据查询是经常遇到的，比如，在电话号码簿中查询某个人的电话号码；在图书馆中按照 ISBN 编号查找某本书的位置；在地图中按照坐标查找某个地点的地名等等。为此，人们创造了一种能够根据记录的关键码 (也就是用以标识数据在记录中的存放位置的数据项) 方便的检索到对应的记录信息的数据结构，这就是字典 (Dictionary)。</p>
<h3 id="字典的定义"><a class="markdownIt-Anchor" href="#字典的定义">#</a> 字典的定义</h3>
<p>我们都使用过字典，如英汉字典、成语字典，图书的检索目录、电话簿等也可以看作广义上的字典。在计算机科学中，把字典也当成一种数据结构。</p>
<p>我们把字典定义为 “键 - 值对”(Key-Value Pair) 的集合。根据不同的问题，我们为名字和值赋予不同的含义，比如，在英汉字典中，英文单词是名字，此单词的中文解释条目是值；在电话簿中，人名是名字，此人名对应的电话号码是值。</p>
<p>字典最基本的操作包括：find (查找)、add (插入)、remove (删除)，分别用来从字典中检索数据、插入数据和删除数据。在实际存储中，我们将 “键 - 值对” 存储于记录中，通过键 (也就是 “键 - 值对” 中的名字) 来标识该 “键 - 值对”。“键 - 值对” 的存放位置和其键之间的对应关系用一个二元组表示：(键，值的位置)。</p>
<p>从字典中查找 “键 - 值对” 的最简单方法就是使用数组存储，然后在查找的时候遍历此数组，当遍历到和被查找的 “键 - 值对” 的名字相同项的时候，这个 “键 - 值对” 就被找到了。这种最朴实的方式肯定是不能满足实际要求的，因此人们发明了一种检索效率非常高的组织字典数据的方法，即哈希表结构。</p>
<h3 id="哈希表与哈希方法"><a class="markdownIt-Anchor" href="#哈希表与哈希方法">#</a> 哈希表与哈希方法</h3>
<p>哈希方法在 “键 - 值对” 的存储位置与它的键之间建立一个确定的对应函数关系 hash ()，使得每一个键与结构中的一个唯一的存储位置相对应：</p>
<p>存储位置 = hash (键)</p>
<p>在搜索时，首先对键进行 hash 运算，把求得的值当做 “键 - 值对” 的存储位置，在结构中按照此位置取 “键 - 值对” 进行比较，若键相等，则表示搜索成功。在存储 “键 - 值对” 的时候，依照相同的 hash 函数计算存储位置，并按此位置存放，这种方法就叫做哈希方法，也叫做散列方法。在哈希方法中使用的转换函数 hash 被称作哈希函数 (或者散列函数)。按照此中算法构造出来的表叫做哈希表 (或者散列表)。</p>
<p>哈希函数建立了从 “键 - 值对” 到哈希表地址集合的一个映射，有了哈希函数，我们就可以根据键来确定 “键 - 值对” 在哈希表中的位置的地址。使用这种方法由于不必进行多次键的比较，所以其搜索速度非常快，很多系统都使用这种方法进行数据的组织和检索。</p>
<p>举一个例子，有一组 “键值对”：&lt;5,“tom”&gt;、&lt;8,“Jane”&gt;、&lt;12,“Bit”&gt;、&lt;17,“Lily”&gt;、&lt;20,“sunny”&gt;，我们按照如下哈希函数对键进行计算:hash (x)=x%17+3，得出如下结果：hash (5)=8、hash (8)=11、hash (12)=15、hash (17)=3、hash (20)=6。我们把 &lt; 5,“tom”&gt;、&lt;8,“Jane”&gt;、&lt;12,“Bit”&gt;、&lt;17,“Lily”&gt;、&lt;20,“sunny”&gt; 分别放到地址为 8、11、15、3、6 的位置上。当要检索 17 对应的值的时候，只要首先计算 17 的哈希值为 3，然后到地址为 3 的地方去取数据就可以找到 17 对应的数据是 &quot;Lily&quot; 了，可见检索速度是非常快的。</p>
<h3 id="冲突与冲突的解决"><a class="markdownIt-Anchor" href="#冲突与冲突的解决">#</a> 冲突与冲突的解决</h3>
<p>通常键的取值范围比哈希表地址集合大很多，因此有可能经过同一哈希函数的计算，把不同的键映射到了同一个地址上面，这就叫冲突。比如，有一组 “键 - 值对”，其键分别为 12361、7251、3309、30976，采用的哈希函数是：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">int</span> <span class="title">hash</span><span class="params">(<span class="keyword">int</span> key)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> key % <span class="number">73</span> + <span class="number">13420</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>则将会得到 hash (12361)=hash (7251)=hash (3309)=hash (30976)=13444，即不同的键通过哈希函数对应到了同一个地址，我们称这种哈希计算结果相同的不同键为同义词。</p>
<p>如果 “键 - 值对” 在加入哈希表的时候产生了冲突，就必须找另外一个地方来存放它，冲突太多会降低数据插入和搜索的效率，因此希望能找到一个不容易产生冲突的函数，即构造一个地址分布比较均匀的哈希函数。常用的哈希函数包括：直接定址法、数字分析法、除留余数法、乘留余数法、平方取中法、折叠法等。应该根据实际工作中关键码的特点选用适当的方法。</p>
<p>虽然采用合适的哈希方法能够降低冲突的概率，但是冲突仍然是不可避免的，处理冲突的最常用方法就是 “桶” 算法：假设哈希表有 m 个地址，就将其改为 m 个 “桶”，其桶号与哈希地址一一对应，每个桶都用来存放互为同义词的键，也就是如果两个不同的键用哈希函数计算得到了同一个哈希地址，就将它们放到同一个桶中，检索的时候在桶内进行顺序检索。</p>
<h3 id="java-中的-map-接口"><a class="markdownIt-Anchor" href="#java-中的-map-接口">#</a> Java 中的 Map 接口</h3>
<p>字典数据结构如此重要，以至于实际开发中经常需要使用它们。JDK 中提供了相关的类供我们使用，从而避免了自己开发字典类的麻烦。</p>
<p>在以前版本的 JDK 中，最常使用的字典类就是 Dictionary 抽象类及其实现类 Hashtable，不过在新版本的 JDK 中不推荐读者使用 Dictionary 抽象类而是使用 Map 接口，并且由于 Dictionary 的实现类 Hashtable 也实现了 Map 接口，所以我们没有理由不使用 Map 接口。</p>
<p>Map 接口有很多实现类，比如 HashMap、TreeMap、Hashtable、SortedMap 等，在第三方开源包中也有提供了更多功能的实现类，比如 Apache-Commons 项目中的 LRUMap。最常用的就是 HashMap 和 Hashtable，它们最大的区别就是 Hashtable 是线程安全的，而 HashMap 则不是线程安全的，在使用的时候必须进行同步。由于 JDK 中的工具类 java.util.Collections 提供了一个 synchronizedMap 方法，可以将非线程安全的 Map 接口变量采用装饰者模式改造成线程安全的，因此使用 HashMap 的场合更多一些，后边的论述也将以 HashMap 为主。</p>
<h3 id="hashmap"><a class="markdownIt-Anchor" href="#hashmap">#</a> HashMap</h3>
<p>HashMap 是 Map 接口的实现类中最常用的一个，熟练的掌握这个类的使用将会提高解决问题的速度。</p>
<p>HashMap 的主要方法</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">int</span> <span class="string">size():</span> <span class="string">得到</span> <span class="string">Map</span> <span class="string">中“键-值对”的数量</span></span><br><span class="line"></span><br><span class="line"><span class="string">boolean</span> <span class="string">isEmpty():</span> <span class="string">Map</span> <span class="string">是否是空的，也就是是否不含有任何“键-值对”</span></span><br><span class="line"></span><br><span class="line"><span class="string">boolean</span> <span class="string">containsKey(Object</span> <span class="string">key):</span> <span class="string">Map</span> <span class="string">中是否含有以</span> <span class="string">key</span> <span class="string">为键的“键-值对”</span></span><br><span class="line"></span><br><span class="line"><span class="string">boolean</span> <span class="string">containsValue(Object</span> <span class="string">value):</span> <span class="string">Map</span> <span class="string">中是否含有以</span> <span class="string">value</span> <span class="string">为值的“键-值对”</span></span><br><span class="line"></span><br><span class="line"><span class="string">Object</span> <span class="string">get(Object</span> <span class="string">key):</span> <span class="string">从</span> <span class="string">Map</span> <span class="string">中得到以</span> <span class="string">key</span> <span class="string">为键的值，如果</span> <span class="string">Map</span> <span class="string">中不含有以</span> <span class="string">key</span> <span class="string">为键的“键-值对”则返回</span> <span class="literal">null</span></span><br><span class="line"></span><br><span class="line"><span class="string">Object</span> <span class="string">put(Object</span> <span class="string">key,</span> <span class="string">Object</span> <span class="string">value):</span> <span class="string">向</span> <span class="string">Map</span> <span class="string">中存储以</span> <span class="string">key</span> <span class="string">为键、value</span> <span class="string">为值的“键-值对”</span></span><br><span class="line"></span><br><span class="line"><span class="string">Object</span> <span class="string">remove(Object</span> <span class="string">key):从</span> <span class="string">Map</span> <span class="string">中移除以</span> <span class="string">key</span> <span class="string">为键的“键-值对”</span></span><br><span class="line"></span><br><span class="line"><span class="string">void</span> <span class="string">putAll(Map</span> <span class="string">t):</span> <span class="string">将另一个</span> <span class="string">Map</span> <span class="string">中的所有“键-值对”导入到此</span> <span class="string">Map</span> <span class="string">中</span></span><br><span class="line"></span><br><span class="line"><span class="string">void</span> <span class="string">clear():</span> <span class="string">清除所有“键-值对”</span></span><br><span class="line"></span><br><span class="line"><span class="string">Set</span> <span class="string">keySet():</span> <span class="string">得到所有的键</span></span><br><span class="line"></span><br><span class="line"><span class="string">Collection</span> <span class="string">values():</span> <span class="string">得到所有的值</span></span><br><span class="line"></span><br><span class="line"><span class="string">Set</span> <span class="string">entrySet():</span> <span class="string">得到所有的“键-值对”，Set</span> <span class="string">中的类型是</span> <span class="string">Map.Entry</span></span><br></pre></td></tr></table></figure>
<h3 id="应用举例"><a class="markdownIt-Anchor" href="#应用举例">#</a> 应用举例</h3>
<h4 id="工号查询"><a class="markdownIt-Anchor" href="#工号查询">#</a> 工号查询</h4>
<p>Tom 的工号是 1155669，Jim 的工号是 1155689，Jane 的工号是 1255669，Kevin 的工号是 1165669，Bit 的工号是 1155660，Gavin 的工号是 1155639。请编写一个程序，输入工号后显示此工号对应的人名。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Map01</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        NameSearcher ns = <span class="keyword">new</span> NameSearcher();</span><br><span class="line">        System.out.println(ns.searchByNum(<span class="string">&quot;1155669&quot;</span>));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">NameSearcher</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> Map map;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">NameSearcher</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>();</span><br><span class="line">        map = <span class="keyword">new</span> HashMap();</span><br><span class="line">        map.put(<span class="string">&quot;1155669&quot;</span>, <span class="string">&quot;Tom&quot;</span>);</span><br><span class="line">        map.put(<span class="string">&quot;1155689&quot;</span>, <span class="string">&quot;Jim&quot;</span>);</span><br><span class="line">        map.put(<span class="string">&quot;1255669&quot;</span>, <span class="string">&quot;Jane&quot;</span>);</span><br><span class="line">        map.put(<span class="string">&quot;1165669&quot;</span>, <span class="string">&quot;Kevin&quot;</span>);</span><br><span class="line">        map.put(<span class="string">&quot;1155660&quot;</span>, <span class="string">&quot;Bit&quot;</span>);</span><br><span class="line">        map.put(<span class="string">&quot;1155639&quot;</span>, <span class="string">&quot;Gavin&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">searchByNum</span><span class="params">(String num)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> (String) map.get(num);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Tom</span></span><br></pre></td></tr></table></figure>
<h4 id="枚举工号"><a class="markdownIt-Anchor" href="#枚举工号">#</a> 枚举工号</h4>
<p>Tom 的工号是 1155669，Jim 的工号是 1155689，Jane 的工号是 1255669，Kevin 的工号是 1165669，Bit 的工号是 1155660，Gavin 的工号是 1155639。请编写一个程序，显示所有工号。</p>
<p>Map 的 keySet 方法返回的是所有的键，如果要显示所有人名，只要使用 values 方法即可。注意 values 方法的返回值是 Collection 接口，与 keySet 方法的 Set 类型不同，原因很简单，因为值不像键一样，值是存在重复的情况的。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">Map map = <span class="keyword">new</span> HashMap();</span><br><span class="line">map.put(<span class="string">&quot;1155669&quot;</span>, <span class="string">&quot;Tom&quot;</span>);</span><br><span class="line">map.put(<span class="string">&quot;1155689&quot;</span>, <span class="string">&quot;Jim&quot;</span>);</span><br><span class="line">map.put(<span class="string">&quot;1255669&quot;</span>, <span class="string">&quot;Jane&quot;</span>);</span><br><span class="line">map.put(<span class="string">&quot;1165669&quot;</span>, <span class="string">&quot;Kevin&quot;</span>);</span><br><span class="line">map.put(<span class="string">&quot;1155660&quot;</span>, <span class="string">&quot;Bit&quot;</span>);</span><br><span class="line">map.put(<span class="string">&quot;1155639&quot;</span>, <span class="string">&quot;Gavin&quot;</span>);</span><br><span class="line"></span><br><span class="line">Set keySet = map.keySet();</span><br><span class="line">Iterator iterator = keySet.iterator();</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span>(iterator.hasNext())</span><br><span class="line">&#123;</span><br><span class="line">    String key = (String) iterator.next();</span><br><span class="line">    System.out.println(key);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// 1155689</span></span><br><span class="line"><span class="comment">// 1155660</span></span><br><span class="line"><span class="comment">// 1155639</span></span><br><span class="line"><span class="comment">// 1165669</span></span><br><span class="line"><span class="comment">// 1155669</span></span><br><span class="line"><span class="comment">// 1255669</span></span><br></pre></td></tr></table></figure>
<h4 id="枚举工号名字"><a class="markdownIt-Anchor" href="#枚举工号名字">#</a> 枚举工号名字</h4>
<p>Tom 的工号是 1155669，Jim 的工号是 1155689，Jane 的工号是 1255669，Kevin 的工号是 1165669，Bit 的工号是 1155660，Gavin 的工号是 1155639。请编写一个程序，显示所有工号 - 名字 “键 - 值对”。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">Map map = <span class="keyword">new</span> HashMap();</span><br><span class="line">map.put(<span class="string">&quot;1155669&quot;</span>, <span class="string">&quot;Tom&quot;</span>);</span><br><span class="line">map.put(<span class="string">&quot;1155689&quot;</span>, <span class="string">&quot;Jim&quot;</span>);</span><br><span class="line">map.put(<span class="string">&quot;1255669&quot;</span>, <span class="string">&quot;Jane&quot;</span>);</span><br><span class="line">map.put(<span class="string">&quot;1165669&quot;</span>, <span class="string">&quot;Kevin&quot;</span>);</span><br><span class="line">map.put(<span class="string">&quot;1155660&quot;</span>, <span class="string">&quot;Bit&quot;</span>);</span><br><span class="line">map.put(<span class="string">&quot;1155639&quot;</span>, <span class="string">&quot;Gavin&quot;</span>);</span><br><span class="line"></span><br><span class="line">Set entrySet = map.entrySet();</span><br><span class="line">Iterator iterator = entrySet.iterator();</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> (iterator.hasNext())</span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line">    Map.Entry keyValue = (Map.Entry) iterator.next();</span><br><span class="line">    Object key = keyValue.getKey();</span><br><span class="line">    Object value = keyValue.getValue();</span><br><span class="line">    System.out.println(<span class="string">&quot;工号:&quot;</span> + key + <span class="string">&quot;;姓名:&quot;</span> + value);</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 工号:1155689;姓名:Jim</span></span><br><span class="line"><span class="comment">// 工号:1155660;姓名:Bit</span></span><br><span class="line"><span class="comment">// 工号:1155639;姓名:Gavin</span></span><br><span class="line"><span class="comment">// 工号:1165669;姓名:Kevin</span></span><br><span class="line"><span class="comment">// 工号:1155669;姓名:Tom</span></span><br><span class="line"><span class="comment">// 工号:1255669;姓名:Jane</span></span><br></pre></td></tr></table></figure>
<h4 id="嵌套哈希"><a class="markdownIt-Anchor" href="#嵌套哈希">#</a> 嵌套哈希</h4>
<p>某公司分为多个部门，各部门的名称不同，而且公司不设立统一的工号，而是每个部门内部自己指定工号，各个部门之间的工号有可能相同。请编写一个程序，用户输入部门名称和工号，检索出对应人的人名。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Map04</span></span></span><br><span class="line"><span class="class"></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span></span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line"></span><br><span class="line">        PersonSearch04 ps = <span class="keyword">new</span> PersonSearch04();</span><br><span class="line"></span><br><span class="line">        ps.add(<span class="string">&quot;开发一部&quot;</span>, <span class="string">&quot;001&quot;</span>, <span class="string">&quot;Tom&quot;</span>);</span><br><span class="line"></span><br><span class="line">        ps.add(<span class="string">&quot;开发一部&quot;</span>, <span class="string">&quot;002&quot;</span>, <span class="string">&quot;Jane&quot;</span>);</span><br><span class="line"></span><br><span class="line">        ps.add(<span class="string">&quot;开发一部&quot;</span>, <span class="string">&quot;003&quot;</span>, <span class="string">&quot;Popo&quot;</span>);</span><br><span class="line"></span><br><span class="line">        ps.add(<span class="string">&quot;开发二部&quot;</span>, <span class="string">&quot;002&quot;</span>, <span class="string">&quot;Ruby&quot;</span>);</span><br><span class="line"></span><br><span class="line">        ps.add(<span class="string">&quot;开发二部&quot;</span>, <span class="string">&quot;003&quot;</span>, <span class="string">&quot;Jay&quot;</span>);</span><br><span class="line"></span><br><span class="line">        ps.add(<span class="string">&quot;开发二部&quot;</span>, <span class="string">&quot;005&quot;</span>, <span class="string">&quot;Cheris&quot;</span>);</span><br><span class="line"></span><br><span class="line">        System.out.println(ps.get(<span class="string">&quot;开发二部&quot;</span>, <span class="string">&quot;002&quot;</span>));</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">PersonSearch04</span></span></span><br><span class="line"><span class="class"></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> Map departMap;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">PersonSearch04</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>();</span><br><span class="line">        departMap = <span class="keyword">new</span> HashMap();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">add</span><span class="params">(String departName, String number, String personName)</span></span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 首先取得部门人员的哈希表</span></span><br><span class="line">        Map personMap = (Map) departMap.get(departName);</span><br><span class="line">        <span class="comment">// 由于当 key 不存在的时候 get 方法会返回 null，因此我们只要判断 get 方法</span></span><br><span class="line">        <span class="comment">// 是否为空就可以知道“键-值对”是否存在，不用调用 containsKey 方法</span></span><br><span class="line">        <span class="comment">// 去判断，这样少了一步计算 hashCode 的过程，能提高一定的效率</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (personMap == <span class="keyword">null</span>)</span><br><span class="line">        &#123;</span><br><span class="line"></span><br><span class="line">            <span class="comment">// 如果不存在部门人员哈希表,则新建一个部门人员哈希表,</span></span><br><span class="line">            <span class="comment">// 并以部门名称为 key,部门人员哈希表为 value 加入部门哈希表</span></span><br><span class="line">            personMap = <span class="keyword">new</span> HashMap();</span><br><span class="line">            departMap.put(departName, personMap);</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 将人按照 number 为 key,人名为 value 加入部门人员哈希表</span></span><br><span class="line">        personMap.put(number, personName);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">get</span><span class="params">(String departName, String number)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 首先取得部门人员的哈希表</span></span><br><span class="line">        Map personMap = (Map) departMap.get(departName);</span><br><span class="line">        <span class="keyword">if</span> (personMap == <span class="keyword">null</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 从部门人员哈希表中按照工号取出编码</span></span><br><span class="line">        <span class="keyword">return</span> (String) personMap.get(number);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Ruby</span></span><br></pre></td></tr></table></figure>
<p>由于部门名称、工号、姓名没有一个能做为主键，所以可以以部门内的人员做为一个 Map，并将这个 Map 做为 Value 放入另一个 Map 中，也就是 “Map 中的 Map”，这就解决了数据检索的问题。这个实现算法有点烦琐，并且有点难以理解，并且如果存在嵌套三层甚至更多层的情况就更难理解，这里采用另一种 “复合主键” 来实现另一种算法。</p>
<h4 id="复合主键"><a class="markdownIt-Anchor" href="#复合主键">#</a> 复合主键</h4>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Map05</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        PersonSearch05 ps = <span class="keyword">new</span> PersonSearch05();</span><br><span class="line">        ps.add(<span class="string">&quot;开发一部&quot;</span>, <span class="string">&quot;001&quot;</span>, <span class="string">&quot;Tom&quot;</span>);</span><br><span class="line">        ps.add(<span class="string">&quot;开发一部&quot;</span>, <span class="string">&quot;002&quot;</span>, <span class="string">&quot;Jane&quot;</span>);</span><br><span class="line">        ps.add(<span class="string">&quot;开发一部&quot;</span>, <span class="string">&quot;003&quot;</span>, <span class="string">&quot;Popo&quot;</span>);</span><br><span class="line">        ps.add(<span class="string">&quot;开发二部&quot;</span>, <span class="string">&quot;002&quot;</span>, <span class="string">&quot;Ruby&quot;</span>);</span><br><span class="line">        ps.add(<span class="string">&quot;开发二部&quot;</span>, <span class="string">&quot;003&quot;</span>, <span class="string">&quot;Jay&quot;</span>);</span><br><span class="line">        ps.add(<span class="string">&quot;开发二部&quot;</span>, <span class="string">&quot;005&quot;</span>, <span class="string">&quot;Cheris&quot;</span>);</span><br><span class="line">        System.out.println(ps.get(<span class="string">&quot;开发二部&quot;</span>, <span class="string">&quot;002&quot;</span>));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">PersonSearch05</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> Map map;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">PersonSearch05</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>();</span><br><span class="line">        map = <span class="keyword">new</span> HashMap();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">add</span><span class="params">(String departName, String number, String personName)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        map.put(departName + number, personName);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">get</span><span class="params">(String departName, String number)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> (String) map.get(departName + number);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>部门名称不相同，所以部门名称加工号就可以做为键，这样就可以简化操作，算法实现起来也清晰多了。这种 “复合主键” 在实际应用中非常广泛，需要注意的是一定要保证这个 “复合主键” 不会重复，否则就会导致数据混乱。案例系统中的 SQLTranslator 中就是使用数据库类型加 SQL 语句做为 “复合主键” 的。</p>
<h3 id="map-与-hashcode"><a class="markdownIt-Anchor" href="#map-与-hashcode">#</a> Map 与 HashCode</h3>
<p>开发过程中一般都是使用 String、Integer 等类型做主键的，这些类型都有已经有实现好的哈希函数算法，我们无需为其实现哈希函数算法，但是也会碰到以自定义类型做主键的情况。</p>
<h4 id="以自定义类型做主键"><a class="markdownIt-Anchor" href="#以自定义类型做主键">#</a> 以自定义类型做主键</h4>
<p>某公司工号的编号方式为 “部门编号 + 出生年月日”，如果重复则在后边再加顺序号。比如编号为 “dev002” 的部门的出生年月日为 “1979 年 10 月 8 日” 的员工的工号为 “dev00219791008”，如果已经存在此工号，则工号为 “dev002197910081”。系统中有一个工号信息类 NumberInfo：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">NumberInfo</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> String departNum;</span><br><span class="line">    <span class="keyword">private</span> Date birthDay;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> seqNumber;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">NumberInfo</span><span class="params">(String departNum, Date birthDay, <span class="keyword">int</span> seqNumber)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>();</span><br><span class="line">        <span class="keyword">this</span>.departNum = departNum;</span><br><span class="line">        <span class="keyword">this</span>.birthDay = birthDay;</span><br><span class="line">        <span class="keyword">this</span>.seqNumber = seqNumber;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">NumberInfo</span><span class="params">(String departNum, Date birthDay)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>();</span><br><span class="line">        <span class="keyword">this</span>.departNum = departNum;</span><br><span class="line">        <span class="keyword">this</span>.birthDay = birthDay;</span><br><span class="line">        <span class="keyword">this</span>.seqNumber = -<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Date <span class="title">getBirthDay</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> birthDay;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getDepartNum</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> departNum;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getSeqNumber</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> seqNumber;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 接着实现一个检索程序以 NumberInfo 类型做为主键：</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Map06</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        NumberInfo num1 = <span class="keyword">new</span> NumberInfo(<span class="string">&quot;dev001&quot;</span>, <span class="keyword">new</span> Date(<span class="number">1979</span>, <span class="number">1</span>, <span class="number">1</span>));</span><br><span class="line">        NumberInfo num2 = <span class="keyword">new</span> NumberInfo(<span class="string">&quot;dev001&quot;</span>, <span class="keyword">new</span> Date(<span class="number">1979</span>, <span class="number">1</span>, <span class="number">1</span>), <span class="number">1</span>);</span><br><span class="line">        NumberInfo num3 = <span class="keyword">new</span> NumberInfo(<span class="string">&quot;dev002&quot;</span>, <span class="keyword">new</span> Date(<span class="number">1980</span>, <span class="number">6</span>, <span class="number">1</span>));</span><br><span class="line">        Map map = <span class="keyword">new</span> HashMap();</span><br><span class="line">        map.put(num1, <span class="string">&quot;Tom&quot;</span>);</span><br><span class="line">        map.put(num2, <span class="string">&quot;Peter&quot;</span>);</span><br><span class="line">        map.put(num3, <span class="string">&quot;Bill&quot;</span>);</span><br><span class="line">        NumberInfo numToFind = <span class="keyword">new</span> NumberInfo(<span class="string">&quot;dev001&quot;</span>, <span class="keyword">new</span> Date(<span class="number">1979</span>, <span class="number">1</span>, <span class="number">1</span>));</span><br><span class="line">        System.out.println(map.get(numToFind));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// null</span></span><br></pre></td></tr></table></figure>
<p>运行结果：null</p>
<p>有点出乎我们的意料，因为 numToFind 和我们想要查找的 num1 的 3 个域值都相等，为什么根据 numToFind 为键却查不到以 num1 为键的值呢？</p>
<p>由于 NumberInfo 直接从 Object 继承，而且没有重写 Object 类的方法，所有的行为都是和 Object 一致的，hashCode 方法也继承自 Object，而 Object 中的 hashCode 方法返回的 hashCode 对应于当前的地址，也就是说对于不同的对象，即使它们的内容完全相同，用 hashCode () 返回的值也会不同，这上违背了我们的意图。因为在使用 Map 时，希望利用相同内容的对象索引得到相同的目标对象，这就需要 hashCode () 在此时能够返回相同的值。我们期望 numToFind 与 num1 是相等的。所以要重写 hashCode 方法和 equals 方法，保证对象内容相同的 NumberInfo 类实例有相同的 hashCode。重写如下：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">equals</span><span class="params">(Object obj)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (!(obj <span class="keyword">instanceof</span> NumberInfo))</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    NumberInfo info = (NumberInfo) obj;</span><br><span class="line">    <span class="keyword">return</span> info.getDepartNum().equals(getDepartNum())</span><br><span class="line">    &amp;&amp; info.getBirthDay().equals(getBirthDay())</span><br><span class="line">    &amp;&amp; info.getSeqNumber() == getSeqNumber();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">hashCode</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    String s = getDepartNum() + getBirthDay() + getSeqNumber();</span><br><span class="line">    <span class="keyword">return</span> s.hashCode();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Tom</span></span><br></pre></td></tr></table></figure>
<p>运行结果：Tom</p>
<p>根据前边所讲的哈希表的原理，不难得出如下结论：</p>
<p>做为键的对象其 hashCode 和 equals 方法必须满足下面的条件：如果两个对象相等，那么它们的 hashCode 必须相等。</p>
<p>如果要使用自定义类做为键的话，一定要覆盖 hashCode 和 equals 方法，不能只覆盖一个而不覆盖另一个。计算 hashCode 最好的方式就是找出此类的 “组合主键”(比如上例中的 getDepartNum () + getBirthDay () + getSeqNumber ())，然后直接返回这个 “组合主键”，除非自己有十足的把握，否则不要自己实现哈希算法，因为那样很容易造成频繁的冲突。<br>
由于使用自定义类做为键有很多问题需要处理，而且处理不当很很容易造成性能问题甚至数据混乱，所以在实际开发中尽量避免用自定义类做键。</p>

      <div class="tags">
          <a href="/tags/java/" rel="tag"><i class="ic i-tag"></i> java</a>
      </div>
  </div>

   <footer>

    <div class="meta">
  <span class="item">
    <span class="icon">
      <i class="ic i-calendar-check"></i>
    </span>
    <span class="text">Edited on</span>
    <time title="Modified: 2021-03-13 15:50:54" itemprop="dateModified" datetime="2021-03-13T15:50:54+08:00">2021-03-13</time>
  </span>
</div>

      

  </footer>

</article>

  </div>
  

<div class="post-nav">
    <div class="item left">
      

  <a href="/2021/03/12/python-xml-modify/" itemprop="url" rel="prev" data-background-image="https:&#x2F;&#x2F;tva2.sinaimg.cn&#x2F;mw690&#x2F;6833939bly1gipexw3o58j20zk0m8e81.jpg" title="Python XMLの要素・属性・内容を削除する(ElementTree)">
  <span class="type">Previous Post</span>
  <span class="category"><i class="ic i-flag"></i> </span>
  <h3>Python XMLの要素・属性・内容を削除する(ElementTree)</h3>
  </a>

    </div>
    <div class="item right">
      

  <a href="/2021/03/13/bcrypt/" itemprop="url" rel="next" data-background-image="https:&#x2F;&#x2F;tva2.sinaimg.cn&#x2F;mw690&#x2F;6833939bly1gicit4jrvuj20zk0m8785.jpg" title="Hashing in Action Understanding bcrypt">
  <span class="type">Next Post</span>
  <span class="category"><i class="ic i-flag"></i> </span>
  <h3>Hashing in Action Understanding bcrypt</h3>
  </a>

    </div>
</div>

  
  <div class="wrap" id="comments"></div>


        </div>
        <div id="sidebar">
          

<div class="inner">

  <div class="panels">
    <div class="inner">
      <div class="contents panel pjax" data-title="Contents">
          <ol class="toc"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AD%97%E5%85%B8%E7%9A%84%E5%AE%9A%E4%B9%89"><span class="toc-number">1.</span> <span class="toc-text"> 字典的定义</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%93%88%E5%B8%8C%E8%A1%A8%E4%B8%8E%E5%93%88%E5%B8%8C%E6%96%B9%E6%B3%95"><span class="toc-number">2.</span> <span class="toc-text"> 哈希表与哈希方法</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%86%B2%E7%AA%81%E4%B8%8E%E5%86%B2%E7%AA%81%E7%9A%84%E8%A7%A3%E5%86%B3"><span class="toc-number">3.</span> <span class="toc-text"> 冲突与冲突的解决</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#java-%E4%B8%AD%E7%9A%84-map-%E6%8E%A5%E5%8F%A3"><span class="toc-number">4.</span> <span class="toc-text"> Java 中的 Map 接口</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#hashmap"><span class="toc-number">5.</span> <span class="toc-text"> HashMap</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%BA%94%E7%94%A8%E4%B8%BE%E4%BE%8B"><span class="toc-number">6.</span> <span class="toc-text"> 应用举例</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%B7%A5%E5%8F%B7%E6%9F%A5%E8%AF%A2"><span class="toc-number">6.1.</span> <span class="toc-text"> 工号查询</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%9E%9A%E4%B8%BE%E5%B7%A5%E5%8F%B7"><span class="toc-number">6.2.</span> <span class="toc-text"> 枚举工号</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%9E%9A%E4%B8%BE%E5%B7%A5%E5%8F%B7%E5%90%8D%E5%AD%97"><span class="toc-number">6.3.</span> <span class="toc-text"> 枚举工号名字</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%B5%8C%E5%A5%97%E5%93%88%E5%B8%8C"><span class="toc-number">6.4.</span> <span class="toc-text"> 嵌套哈希</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%A4%8D%E5%90%88%E4%B8%BB%E9%94%AE"><span class="toc-number">6.5.</span> <span class="toc-text"> 复合主键</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#map-%E4%B8%8E-hashcode"><span class="toc-number">7.</span> <span class="toc-text"> Map 与 HashCode</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BB%A5%E8%87%AA%E5%AE%9A%E4%B9%89%E7%B1%BB%E5%9E%8B%E5%81%9A%E4%B8%BB%E9%94%AE"><span class="toc-number">7.1.</span> <span class="toc-text"> 以自定义类型做主键</span></a></li></ol></li></ol>
      </div>
      <div class="related panel pjax" data-title="Related">
      </div>
      <div class="overview panel" data-title="Overview">
        <div class="author" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <img class="image" itemprop="image" alt="江边鸟"
      data-src="/images/avatar.jpg">
  <p class="name" itemprop="name">江边鸟</p>
  <div class="description" itemprop="description"></div>
</div>

<nav class="state">
    <div class="item posts">
      <a href="/archives/">
        <span class="count">277</span>
        <span class="name">posts</span>
      </a>
    </div>
    <div class="item categories">
      <a href="/categories/">
        <span class="count">2</span>
        <span class="name">categories</span>
      </a>
    </div>
    <div class="item tags">
      <a href="/tags/">
        <span class="count">39</span>
        <span class="name">tags</span>
      </a>
    </div>
</nav>

<div class="social">
      <span class="exturl item github" data-url="aHR0cHM6Ly9naXRodWIuY29tL2xoY2hlbjc0" title="https:&#x2F;&#x2F;github.com&#x2F;lhchen74"><i class="ic i-github"></i></span>
      <span class="exturl item music" data-url="aHR0cHM6Ly9tdXNpYy4xNjMuY29tLw==" title="https:&#x2F;&#x2F;music.163.com&#x2F;"><i class="ic i-cloud-music"></i></span>
</div>

<ul class="menu">
  
    
  <li class="item">
    <a href="/" rel="section"><i class="ic i-home"></i>Home</a>
  </li>

    
  <li class="item">
    <a href="/about/" rel="section"><i class="ic i-user"></i>About</a>
  </li>

        
  <li class="item dropdown">
      <a href="javascript:void(0);"><i class="ic i-feather"></i>Posts</a>
    <ul class="submenu">

        
  <li class="item">
    <a href="/archives/" rel="section"><i class="ic i-list-alt"></i>Archives</a>
  </li>

        
  <li class="item">
    <a href="/categories/" rel="section"><i class="ic i-th"></i>Categories</a>
  </li>

        
  <li class="item">
    <a href="/tags/" rel="section"><i class="ic i-tags"></i>Tags</a>
  </li>

  </ul>
    
  <li class="item">
    <a href="/friends/" rel="section"><i class="ic i-heart"></i>Friends</a>
  </li>


</ul>

      </div>
    </div>
  </div>

  <ul id="quick">
    <li class="prev pjax">
        <a href="/2021/03/12/python-xml-modify/" rel="prev" title="Previous Post"><i class="ic i-chevron-left"></i></a>
    </li>
    <li class="up"><i class="ic i-arrow-up"></i></li>
    <li class="down"><i class="ic i-arrow-down"></i></li>
    <li class="next pjax">
        <a href="/2021/03/13/bcrypt/" rel="next" title="Next Post"><i class="ic i-chevron-right"></i></a>
    </li>
    <li class="percent"></li>
  </ul>
</div>


        </div>
        <div class="dimmer"></div>
      </div>
    </main>
    <footer id="footer">
      <div class="inner">
        <div class="widgets">
          

        </div>
        <div class="status">
  <div class="copyright">
    
    &copy; 2010 – 
    <span itemprop="copyrightYear">2021</span>
    <span class="with-love">
      <i class="ic i-sakura rotate"></i>
    </span>
    <span class="author" itemprop="copyrightHolder">江边鸟 @ 露の世</span>
  </div>
  <div class="powered-by">
    Powered by <span class="exturl" data-url="aHR0cHM6Ly9oZXhvLmlv">Hexo</span> & Theme.<span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL2FtZWhpbWUvaGV4by10aGVtZS1zaG9rYQ==">Shoka</span>
  </div>
</div>

      </div>
    </footer>
  </div>
<script data-config type="text/javascript">
  var LOCAL = {
    path: '2021/03/13/java-hash/',
    favicon: {
      show: "（●´3｀●）Goooood",
      hide: "(´Д｀)Booooom"
    },
    search : {
      placeholder: "Search for Posts",
      empty: "We didn't find any results for the search: ${query}",
      stats: "${hits} results found in ${time} ms"
    },
    valine: true,fancybox: true,
    ignores : [
      function(uri) {
        return uri.includes('#');
      },
      function(uri) {
        return new RegExp(LOCAL.path+"$").test(uri);
      }
    ]
  };
</script>

<script src="https://cdn.polyfill.io/v2/polyfill.js"></script>

<script src="//cdn.jsdelivr.net/combine/npm/pace-js@1.0.2/pace.min.js,npm/pjax@0.2.8/pjax.min.js,npm/whatwg-fetch@3.4.0/dist/fetch.umd.min.js,npm/animejs@3.2.0/lib/anime.min.js,npm/algoliasearch@4/dist/algoliasearch-lite.umd.js,npm/instantsearch.js@4/dist/instantsearch.production.min.js,npm/lozad@1/dist/lozad.min.js,npm/quicklink@2/dist/quicklink.umd.js"></script>

<script src="/js/app.js?v=0.2.5"></script>




</body>
</html>
