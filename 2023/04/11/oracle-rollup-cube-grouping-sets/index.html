



<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#FFF">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">

<link rel="icon" type="image/ico" sizes="32x32" href="/images/favicon.ico">
  <meta http-equiv="Cache-Control" content="no-transform">
  <meta http-equiv="Cache-Control" content="no-siteapp">


<link rel="alternate" type="application/rss+xml" title="露の世" href="https://lhchen74.github.io/rss.xml" />
<link rel="alternate" type="application/atom+xml" title="露の世" href="https://lhchen74.github.io/atom.xml" />
<link rel="alternate" type="application/json" title="露の世" href="https://lhchen74.github.io/feed.json" />

<link rel="stylesheet" href="//fonts.googleapis.com/css?family=Mulish:300,300italic,400,400italic,700,700italic%7CFredericka%20the%20Great:300,300italic,400,400italic,700,700italic%7CNoto%20Serif%20JP:300,300italic,400,400italic,700,700italic%7CNoto%20Serif%20SC:300,300italic,400,400italic,700,700italic%7CFira%20Code:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext">

<link rel="stylesheet" href="/css/app.css?v=0.2.5">

  
  <meta name="keywords" content="db" />


<link rel="canonical" href="https://lhchen74.github.io/2023/04/11/oracle-rollup-cube-grouping-sets/">



  <title>
Oracle ROLLUP, CUBE, GROUPING Functions and GROUPING SETS |
D E W = 露の世</title>
<meta name="generator" content="Hexo 5.4.0"></head>
<body itemscope itemtype="http://schema.org/WebPage">
  <div id="loading">
    <div class="cat">
      <div class="body"></div>
      <div class="head">
        <div class="face"></div>
      </div>
      <div class="foot">
        <div class="tummy-end"></div>
        <div class="bottom"></div>
        <div class="legs left"></div>
        <div class="legs right"></div>
      </div>
      <div class="paw">
        <div class="hands left"></div>
        <div class="hands right"></div>
      </div>
    </div>
  </div>
  <div id="container">
    <header id="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="inner">
        <div id="brand">
          <div class="pjax">
          
  <h1 itemprop="name headline">Oracle ROLLUP, CUBE, GROUPING Functions and GROUPING SETS
  </h1>
  
<div class="meta">
  <span class="item" title="Created: 2023-04-11 00:00:00">
    <span class="icon">
      <i class="ic i-calendar"></i>
    </span>
    <span class="text">Posted on</span>
    <time itemprop="dateCreated datePublished" datetime="2023-04-11T00:00:00+08:00">2023-04-11</time>
  </span>
</div>


          </div>
        </div>
        <nav id="nav">
  <div class="inner">
    <div class="toggle">
      <div class="lines" aria-label="Toggle navigation bar">
        <span class="line"></span>
        <span class="line"></span>
        <span class="line"></span>
      </div>
    </div>
    <ul class="menu">
      <li class="item title"><a href="/" rel="start">D E W</a></li>
    </ul>
    <ul class="right">
      <li class="item theme">
        <i class="ic i-sun"></i>
      </li>
      <li class="item search">
        <i class="ic i-search"></i>
      </li>
    </ul>
  </div>
</nav>

      </div>
      <div id="imgs" class="pjax">
        <ul>
          <li class="item" data-background-image="/anime/index/昭和元禄落语心中-2.jpg"></li>
          <li class="item" data-background-image="/anime/index/齐木楠雄的灾难.jpg"></li>
          <li class="item" data-background-image="/anime/index/魁拔.jpg"></li>
          <li class="item" data-background-image="/anime/index/侧耳倾听-2.jpg"></li>
          <li class="item" data-background-image="/anime/index/游戏人生.jpg"></li>
          <li class="item" data-background-image="/anime/index/秒速五厘米.jpg"></li>
        </ul>
      </div>
    </header>
    <div id="waves">
      <svg class="waves" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 24 150 28" preserveAspectRatio="none" shape-rendering="auto">
        <defs>
          <path id="gentle-wave" d="M-160 44c30 0 58-18 88-18s 58 18 88 18 58-18 88-18 58 18 88 18 v44h-352z" />
        </defs>
        <g class="parallax">
          <use xlink:href="#gentle-wave" x="48" y="0" />
          <use xlink:href="#gentle-wave" x="48" y="3" />
          <use xlink:href="#gentle-wave" x="48" y="5" />
          <use xlink:href="#gentle-wave" x="48" y="7" />
        </g>
      </svg>
    </div>
    <main>
      <div class="inner">
        <div id="main" class="pjax">
          
  <div class="article wrap">
    
<div class="breadcrumb" itemscope itemtype="https://schema.org/BreadcrumbList">
<i class="ic i-home"></i>
<span><a href="/">Home</a></span>
</div>

    <article itemscope itemtype="http://schema.org/Article" class="post block" lang="en">
  <link itemprop="mainEntityOfPage" href="https://lhchen74.github.io/2023/04/11/oracle-rollup-cube-grouping-sets/">

  <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
    <meta itemprop="image" content="/images/avatar.jpg">
    <meta itemprop="name" content="江边鸟">
    <meta itemprop="description" content=", ">
  </span>

  <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
    <meta itemprop="name" content="露の世">
  </span>

  <div class="body md" itemprop="articleBody">
    

    <blockquote>
<p>转载：<span class="exturl" data-url="aHR0cHM6Ly9vcmFjbGUtYmFzZS5jb20vYXJ0aWNsZXMvbWlzYy9yb2xsdXAtY3ViZS1ncm91cGluZy1mdW5jdGlvbnMtYW5kLWdyb3VwaW5nLXNldHM=">ORACLE-BASE - ROLLUP, CUBE, GROUPING Functions and GROUPING SETS</span></p>
</blockquote>
<p>This article gives an overview of the functionality available for aggregation in data warehouses, focusing specifically on the information required for the <span class="exturl" data-url="aHR0cDovL2VkdWNhdGlvbi5vcmFjbGUuY29tL3Bscy93ZWJfcHJvZC1wbHEtZGFkL2RiX3BhZ2VzLmdldHBhZ2U/cGFnZV9pZD00MSZhbXA7cF9vcmdfaWQ9MTAwMSZhbXA7bGFuZz1VUyZhbXA7cF9leGFtX2lkPTFaMF8wNDc=">Oracle Database SQL Expert (1Z0-047)</span> exam.</p>
<ul>
<li><span class="exturl" data-url="aHR0cHM6Ly9vcmFjbGUtYmFzZS5jb20vYXJ0aWNsZXMvbWlzYy9yb2xsdXAtY3ViZS1ncm91cGluZy1mdW5jdGlvbnMtYW5kLWdyb3VwaW5nLXNldHMjc2V0dXA=">Setup</span></li>
<li><span class="exturl" data-url="aHR0cHM6Ly9vcmFjbGUtYmFzZS5jb20vYXJ0aWNsZXMvbWlzYy9yb2xsdXAtY3ViZS1ncm91cGluZy1mdW5jdGlvbnMtYW5kLWdyb3VwaW5nLXNldHMjZ3JvdXBfYnk=">GROUP BY</span></li>
<li><span class="exturl" data-url="aHR0cHM6Ly9vcmFjbGUtYmFzZS5jb20vYXJ0aWNsZXMvbWlzYy9yb2xsdXAtY3ViZS1ncm91cGluZy1mdW5jdGlvbnMtYW5kLWdyb3VwaW5nLXNldHMjcm9sbHVw">ROLLUP</span></li>
<li><span class="exturl" data-url="aHR0cHM6Ly9vcmFjbGUtYmFzZS5jb20vYXJ0aWNsZXMvbWlzYy9yb2xsdXAtY3ViZS1ncm91cGluZy1mdW5jdGlvbnMtYW5kLWdyb3VwaW5nLXNldHMjY3ViZQ==">CUBE</span></li>
<li>GROUPING Functions
<ul>
<li><span class="exturl" data-url="aHR0cHM6Ly9vcmFjbGUtYmFzZS5jb20vYXJ0aWNsZXMvbWlzYy9yb2xsdXAtY3ViZS1ncm91cGluZy1mdW5jdGlvbnMtYW5kLWdyb3VwaW5nLXNldHMjZ3JvdXBpbmc=">GROUPING Function</span></li>
<li><span class="exturl" data-url="aHR0cHM6Ly9vcmFjbGUtYmFzZS5jb20vYXJ0aWNsZXMvbWlzYy9yb2xsdXAtY3ViZS1ncm91cGluZy1mdW5jdGlvbnMtYW5kLWdyb3VwaW5nLXNldHMjZ3JvdXBpbmdfaWQ=">GROUPING_ID Function</span></li>
<li><span class="exturl" data-url="aHR0cHM6Ly9vcmFjbGUtYmFzZS5jb20vYXJ0aWNsZXMvbWlzYy9yb2xsdXAtY3ViZS1ncm91cGluZy1mdW5jdGlvbnMtYW5kLWdyb3VwaW5nLXNldHMjZ3JvdXBfaWQ=">GROUP_ID Function</span></li>
</ul>
</li>
<li><span class="exturl" data-url="aHR0cHM6Ly9vcmFjbGUtYmFzZS5jb20vYXJ0aWNsZXMvbWlzYy9yb2xsdXAtY3ViZS1ncm91cGluZy1mdW5jdGlvbnMtYW5kLWdyb3VwaW5nLXNldHMjZ3JvdXBpbmdfc2V0cw==">GROUPING SETS</span></li>
<li><span class="exturl" data-url="aHR0cHM6Ly9vcmFjbGUtYmFzZS5jb20vYXJ0aWNsZXMvbWlzYy9yb2xsdXAtY3ViZS1ncm91cGluZy1mdW5jdGlvbnMtYW5kLWdyb3VwaW5nLXNldHMjY29tcG9zaXRlX2NvbHVtbnM=">Composite Columns</span></li>
<li><span class="exturl" data-url="aHR0cHM6Ly9vcmFjbGUtYmFzZS5jb20vYXJ0aWNsZXMvbWlzYy9yb2xsdXAtY3ViZS1ncm91cGluZy1mdW5jdGlvbnMtYW5kLWdyb3VwaW5nLXNldHMjY29uY2F0ZW5hdGVkX2dyb3VwaW5ncw==">Concatenated Groupings</span></li>
</ul>
<p>For more information see:</p>
<ul>
<li><span class="exturl" data-url="aHR0cHM6Ly93d3cueW91dHViZS5jb20vd2F0Y2g/dj1DQ200SVktTnRmdw==">GROUP BY, ROLLUP and CUBE in Oracle </span></li>
</ul>
<h2 id="setup"><a class="markdownIt-Anchor" href="#setup">#</a> Setup</h2>
<p>The examples in this article will be run against the following simple dimension table.</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">DROP</span> <span class="keyword">TABLE</span> dimension_tab;</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> dimension_tab (</span><br><span class="line">  fact_1_id   NUMBER <span class="keyword">NOT</span> <span class="keyword">NULL</span>,</span><br><span class="line">  fact_2_id   NUMBER <span class="keyword">NOT</span> <span class="keyword">NULL</span>,</span><br><span class="line">  fact_3_id   NUMBER <span class="keyword">NOT</span> <span class="keyword">NULL</span>,</span><br><span class="line">  fact_4_id   NUMBER <span class="keyword">NOT</span> <span class="keyword">NULL</span>,</span><br><span class="line">  sales_value NUMBER(<span class="number">10</span>,<span class="number">2</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span></span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> dimension_tab</span><br><span class="line"><span class="keyword">SELECT</span> TRUNC(DBMS_RANDOM.value(low <span class="operator">=</span><span class="operator">&gt;</span> <span class="number">1</span>, high <span class="operator">=</span><span class="operator">&gt;</span> <span class="number">3</span>)) <span class="keyword">AS</span> fact_1_id,</span><br><span class="line">       TRUNC(DBMS_RANDOM.value(low <span class="operator">=</span><span class="operator">&gt;</span> <span class="number">1</span>, high <span class="operator">=</span><span class="operator">&gt;</span> <span class="number">6</span>)) <span class="keyword">AS</span> fact_2_id,</span><br><span class="line">       TRUNC(DBMS_RANDOM.value(low <span class="operator">=</span><span class="operator">&gt;</span> <span class="number">1</span>, high <span class="operator">=</span><span class="operator">&gt;</span> <span class="number">11</span>)) <span class="keyword">AS</span> fact_3_id,</span><br><span class="line">       TRUNC(DBMS_RANDOM.value(low <span class="operator">=</span><span class="operator">&gt;</span> <span class="number">1</span>, high <span class="operator">=</span><span class="operator">&gt;</span> <span class="number">11</span>)) <span class="keyword">AS</span> fact_4_id,</span><br><span class="line">       ROUND(DBMS_RANDOM.value(low <span class="operator">=</span><span class="operator">&gt;</span> <span class="number">1</span>, high <span class="operator">=</span><span class="operator">&gt;</span> <span class="number">100</span>), <span class="number">2</span>) <span class="keyword">AS</span> sales_value</span><br><span class="line"><span class="keyword">FROM</span>   dual</span><br><span class="line"><span class="keyword">CONNECT</span> <span class="keyword">BY</span> level <span class="operator">&lt;=</span> <span class="number">1000</span>;</span><br><span class="line"><span class="keyword">COMMIT</span>;</span><br></pre></td></tr></table></figure>
<p>To keep the queries and their output simple I am going to ignore the fact tables and also limit the number of distinct values in the columns of the dimension table.</p>
<h2 id="group-by"><a class="markdownIt-Anchor" href="#group-by">#</a> GROUP BY</h2>
<p>Let’s start be reminding ourselves how the  <code>GROUP BY</code>  clause works. An aggregate function takes multiple rows of data returned by a query and aggregates them into a single result row.</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="built_in">SUM</span>(sales_value) <span class="keyword">AS</span> sales_value</span><br><span class="line"><span class="keyword">FROM</span>   dimension_tab;</span><br><span class="line"></span><br><span class="line">SALES_VALUE</span><br><span class="line"><span class="comment">-----------</span></span><br><span class="line">   <span class="number">50528.39</span></span><br><span class="line"></span><br><span class="line"><span class="number">1</span> <span class="type">row</span> selected.</span><br><span class="line"></span><br><span class="line"><span class="keyword">SQL</span><span class="operator">&gt;</span></span><br></pre></td></tr></table></figure>
<p>Including the  <code>GROUP BY</code>  clause limits the window of data processed by the aggregate function. This way we get an aggregated value for each distinct combination of values present in the columns listed in the  <code>GROUP BY</code>  clause. The number of rows we expect can be calculated by multiplying the number of distinct values of each column listed in the  <code>GROUP BY</code>  clause. In this case, if the rows were loaded randomly we would expect the number of distinct values for the first three columns in the table to be 2, 5 and 10 respectively. So using the  <code>fact_1_id</code>  column in the  <code>GROUP BY</code>  clause should give us 2 rows.</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> fact_1_id,</span><br><span class="line">       <span class="built_in">COUNT</span>(<span class="operator">*</span>) <span class="keyword">AS</span> num_rows,</span><br><span class="line">       <span class="built_in">SUM</span>(sales_value) <span class="keyword">AS</span> sales_value</span><br><span class="line"><span class="keyword">FROM</span>   dimension_tab</span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> fact_1_id</span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> fact_1_id;</span><br><span class="line"></span><br><span class="line"> FACT_1_ID   NUM_ROWS SALES_VALUE</span><br><span class="line"><span class="comment">---------- ---------- -----------</span></span><br><span class="line">         <span class="number">1</span>        <span class="number">478</span>    <span class="number">24291.35</span></span><br><span class="line">         <span class="number">2</span>        <span class="number">522</span>    <span class="number">26237.04</span></span><br><span class="line"></span><br><span class="line"><span class="number">2</span> <span class="keyword">rows</span> selected.</span><br><span class="line"></span><br><span class="line"><span class="keyword">SQL</span><span class="operator">&gt;</span></span><br></pre></td></tr></table></figure>
<p>Including the first two columns in the  <code>GROUP BY</code>  clause should give us 10 rows (2*5), each with its aggregated values.</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> fact_1_id,</span><br><span class="line">       fact_2_id,</span><br><span class="line">       <span class="built_in">COUNT</span>(<span class="operator">*</span>) <span class="keyword">AS</span> num_rows,</span><br><span class="line">       <span class="built_in">SUM</span>(sales_value) <span class="keyword">AS</span> sales_value</span><br><span class="line"><span class="keyword">FROM</span>   dimension_tab</span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> fact_1_id, fact_2_id</span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> fact_1_id, fact_2_id;</span><br><span class="line"></span><br><span class="line"> FACT_1_ID  FACT_2_ID   NUM_ROWS SALES_VALUE</span><br><span class="line"><span class="comment">---------- ---------- ---------- -----------</span></span><br><span class="line">         <span class="number">1</span>          <span class="number">1</span>         <span class="number">83</span>     <span class="number">4363.55</span></span><br><span class="line">         <span class="number">1</span>          <span class="number">2</span>         <span class="number">96</span>     <span class="number">4794.76</span></span><br><span class="line">         <span class="number">1</span>          <span class="number">3</span>         <span class="number">93</span>     <span class="number">4718.25</span></span><br><span class="line">         <span class="number">1</span>          <span class="number">4</span>        <span class="number">105</span>     <span class="number">5387.45</span></span><br><span class="line">         <span class="number">1</span>          <span class="number">5</span>        <span class="number">101</span>     <span class="number">5027.34</span></span><br><span class="line">         <span class="number">2</span>          <span class="number">1</span>        <span class="number">109</span>     <span class="number">5652.84</span></span><br><span class="line">         <span class="number">2</span>          <span class="number">2</span>         <span class="number">96</span>     <span class="number">4583.02</span></span><br><span class="line">         <span class="number">2</span>          <span class="number">3</span>        <span class="number">110</span>     <span class="number">5555.77</span></span><br><span class="line">         <span class="number">2</span>          <span class="number">4</span>        <span class="number">113</span>     <span class="number">5936.67</span></span><br><span class="line">         <span class="number">2</span>          <span class="number">5</span>         <span class="number">94</span>     <span class="number">4508.74</span></span><br><span class="line"></span><br><span class="line"><span class="number">10</span> <span class="keyword">rows</span> selected.</span><br><span class="line"></span><br><span class="line"><span class="keyword">SQL</span><span class="operator">&gt;</span></span><br></pre></td></tr></table></figure>
<p>Including the first three columns in the  <code>GROUP BY</code>  clause should give us 100 rows (2<em>5</em>10).</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> fact_1_id,</span><br><span class="line">       fact_2_id,</span><br><span class="line">       fact_3_id,</span><br><span class="line">       <span class="built_in">COUNT</span>(<span class="operator">*</span>) <span class="keyword">AS</span> num_rows,</span><br><span class="line">       <span class="built_in">SUM</span>(sales_value) <span class="keyword">AS</span> sales_value</span><br><span class="line"><span class="keyword">FROM</span>   dimension_tab</span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> fact_1_id, fact_2_id, fact_3_id</span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> fact_1_id, fact_2_id, fact_3_id;</span><br><span class="line"></span><br><span class="line"> FACT_1_ID  FACT_2_ID  FACT_3_ID   NUM_ROWS SALES_VALUE</span><br><span class="line"><span class="comment">---------- ---------- ---------- ---------- -----------</span></span><br><span class="line">         <span class="number">1</span>          <span class="number">1</span>          <span class="number">1</span>         <span class="number">10</span>      <span class="number">381.61</span></span><br><span class="line">         <span class="number">1</span>          <span class="number">1</span>          <span class="number">2</span>          <span class="number">6</span>      <span class="number">235.29</span></span><br><span class="line">         <span class="number">1</span>          <span class="number">1</span>          <span class="number">3</span>          <span class="number">7</span>       <span class="number">270.7</span></span><br><span class="line">         <span class="number">1</span>          <span class="number">1</span>          <span class="number">4</span>         <span class="number">13</span>      <span class="number">634.05</span></span><br><span class="line">         <span class="number">1</span>          <span class="number">1</span>          <span class="number">5</span>         <span class="number">10</span>      <span class="number">602.36</span></span><br><span class="line">         <span class="number">1</span>          <span class="number">1</span>          <span class="number">6</span>          <span class="number">7</span>      <span class="number">538.41</span></span><br><span class="line">         <span class="number">1</span>          <span class="number">1</span>          <span class="number">7</span>          <span class="number">5</span>      <span class="number">245.87</span></span><br><span class="line">         <span class="number">1</span>          <span class="number">1</span>          <span class="number">8</span>          <span class="number">8</span>      <span class="number">435.54</span></span><br><span class="line">         <span class="number">1</span>          <span class="number">1</span>          <span class="number">9</span>          <span class="number">8</span>      <span class="number">506.59</span></span><br><span class="line">         <span class="number">1</span>          <span class="number">1</span>         <span class="number">10</span>          <span class="number">9</span>      <span class="number">513.13</span></span><br><span class="line">...</span><br><span class="line">         <span class="number">2</span>          <span class="number">5</span>          <span class="number">1</span>         <span class="number">14</span>      <span class="number">714.84</span></span><br><span class="line">         <span class="number">2</span>          <span class="number">5</span>          <span class="number">2</span>         <span class="number">13</span>      <span class="number">686.56</span></span><br><span class="line">         <span class="number">2</span>          <span class="number">5</span>          <span class="number">3</span>         <span class="number">13</span>       <span class="number">579.5</span></span><br><span class="line">         <span class="number">2</span>          <span class="number">5</span>          <span class="number">4</span>         <span class="number">10</span>      <span class="number">336.87</span></span><br><span class="line">         <span class="number">2</span>          <span class="number">5</span>          <span class="number">5</span>          <span class="number">5</span>      <span class="number">215.17</span></span><br><span class="line">         <span class="number">2</span>          <span class="number">5</span>          <span class="number">6</span>          <span class="number">4</span>      <span class="number">268.72</span></span><br><span class="line">         <span class="number">2</span>          <span class="number">5</span>          <span class="number">7</span>         <span class="number">14</span>      <span class="number">667.22</span></span><br><span class="line">         <span class="number">2</span>          <span class="number">5</span>          <span class="number">8</span>          <span class="number">7</span>      <span class="number">451.29</span></span><br><span class="line">         <span class="number">2</span>          <span class="number">5</span>          <span class="number">9</span>          <span class="number">8</span>      <span class="number">365.24</span></span><br><span class="line">         <span class="number">2</span>          <span class="number">5</span>         <span class="number">10</span>          <span class="number">6</span>      <span class="number">223.33</span></span><br><span class="line"></span><br><span class="line"><span class="number">100</span> <span class="keyword">rows</span> selected.</span><br><span class="line"></span><br><span class="line"><span class="keyword">SQL</span><span class="operator">&gt;</span></span><br></pre></td></tr></table></figure>
<h2 id="rollup"><a class="markdownIt-Anchor" href="#rollup">#</a> ROLLUP</h2>
<p>In addition to the regular aggregation results we expect from the  <code>GROUP BY</code>  clause, the  <code>ROLLUP</code>  extension produces group subtotals from right to left and a grand total. If “n” is the number of columns listed in the  <code>ROLLUP</code> , there will be n+1 levels of subtotals.</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> fact_1_id,</span><br><span class="line">       fact_2_id,</span><br><span class="line">       <span class="built_in">SUM</span>(sales_value) <span class="keyword">AS</span> sales_value</span><br><span class="line"><span class="keyword">FROM</span>   dimension_tab</span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> <span class="keyword">ROLLUP</span> (fact_1_id, fact_2_id)</span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> fact_1_id, fact_2_id;</span><br><span class="line"></span><br><span class="line"> FACT_1_ID  FACT_2_ID SALES_VALUE</span><br><span class="line"><span class="comment">---------- ---------- -----------</span></span><br><span class="line">         <span class="number">1</span>          <span class="number">1</span>     <span class="number">4363.55</span></span><br><span class="line">         <span class="number">1</span>          <span class="number">2</span>     <span class="number">4794.76</span></span><br><span class="line">         <span class="number">1</span>          <span class="number">3</span>     <span class="number">4718.25</span></span><br><span class="line">         <span class="number">1</span>          <span class="number">4</span>     <span class="number">5387.45</span></span><br><span class="line">         <span class="number">1</span>          <span class="number">5</span>     <span class="number">5027.34</span></span><br><span class="line">         <span class="number">1</span>               <span class="number">24291.35</span></span><br><span class="line">         <span class="number">2</span>          <span class="number">1</span>     <span class="number">5652.84</span></span><br><span class="line">         <span class="number">2</span>          <span class="number">2</span>     <span class="number">4583.02</span></span><br><span class="line">         <span class="number">2</span>          <span class="number">3</span>     <span class="number">5555.77</span></span><br><span class="line">         <span class="number">2</span>          <span class="number">4</span>     <span class="number">5936.67</span></span><br><span class="line">         <span class="number">2</span>          <span class="number">5</span>     <span class="number">4508.74</span></span><br><span class="line">         <span class="number">2</span>               <span class="number">26237.04</span></span><br><span class="line">                         <span class="number">50528.39</span></span><br><span class="line"></span><br><span class="line"><span class="number">13</span> <span class="keyword">rows</span> selected.</span><br><span class="line"></span><br><span class="line"><span class="keyword">SQL</span><span class="operator">&gt;</span></span><br></pre></td></tr></table></figure>
<p>Looking at the output in a SQL*Plus or a grid output, you can visually identify the rows containing subtotals as they have null values in the  <code>ROLLUP</code>  columns. It may be easier to spot when scanning down the output of the following query shown <span class="exturl" data-url="aHR0cHM6Ly9vcmFjbGUtYmFzZS5jb20vYXJ0aWNsZXMvbWlzYy9yb2xsdXAudHh0">here</span>. Obviously, if the raw data contains null values, using this visual identification is not an accurate approach, but we will discuss this issue later.</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> fact_1_id,</span><br><span class="line">       fact_2_id,</span><br><span class="line">       fact_3_id,</span><br><span class="line">       <span class="built_in">SUM</span>(sales_value) <span class="keyword">AS</span> sales_value</span><br><span class="line"><span class="keyword">FROM</span>   dimension_tab</span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> <span class="keyword">ROLLUP</span> (fact_1_id, fact_2_id, fact_3_id)</span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> fact_1_id, fact_2_id, fact_3_id;</span><br></pre></td></tr></table></figure>
<p>It is possible to do a partial rollup to reduce the number of subtotals calculated. The output from the following partial rollup is shown <span class="exturl" data-url="aHR0cHM6Ly9vcmFjbGUtYmFzZS5jb20vYXJ0aWNsZXMvbWlzYy9yb2xsdXAtcGFydGlhbC50eHQ=">here</span>.</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> fact_1_id,</span><br><span class="line">       fact_2_id,</span><br><span class="line">       fact_3_id,</span><br><span class="line">       <span class="built_in">SUM</span>(sales_value) <span class="keyword">AS</span> sales_value</span><br><span class="line"><span class="keyword">FROM</span>   dimension_tab</span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> fact_1_id, <span class="keyword">ROLLUP</span> (fact_2_id, fact_3_id)</span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> fact_1_id, fact_2_id, fact_3_id;</span><br></pre></td></tr></table></figure>
<h2 id="cube"><a class="markdownIt-Anchor" href="#cube">#</a> CUBE</h2>
<p>In addition to the subtotals generated by the  <code>ROLLUP</code>  extension, the  <code>CUBE</code>  extension will generate subtotals for all combinations of the dimensions specified. If “n” is the number of columns listed in the  <code>CUBE</code> , there will be 2n subtotal combinations.</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> fact_1_id,</span><br><span class="line">       fact_2_id,</span><br><span class="line">       <span class="built_in">SUM</span>(sales_value) <span class="keyword">AS</span> sales_value</span><br><span class="line"><span class="keyword">FROM</span>   dimension_tab</span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> <span class="keyword">CUBE</span> (fact_1_id, fact_2_id)</span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> fact_1_id, fact_2_id;</span><br><span class="line"></span><br><span class="line"> FACT_1_ID  FACT_2_ID SALES_VALUE</span><br><span class="line"><span class="comment">---------- ---------- -----------</span></span><br><span class="line">         <span class="number">1</span>          <span class="number">1</span>     <span class="number">4363.55</span></span><br><span class="line">         <span class="number">1</span>          <span class="number">2</span>     <span class="number">4794.76</span></span><br><span class="line">         <span class="number">1</span>          <span class="number">3</span>     <span class="number">4718.25</span></span><br><span class="line">         <span class="number">1</span>          <span class="number">4</span>     <span class="number">5387.45</span></span><br><span class="line">         <span class="number">1</span>          <span class="number">5</span>     <span class="number">5027.34</span></span><br><span class="line">         <span class="number">1</span>               <span class="number">24291.35</span></span><br><span class="line">         <span class="number">2</span>          <span class="number">1</span>     <span class="number">5652.84</span></span><br><span class="line">         <span class="number">2</span>          <span class="number">2</span>     <span class="number">4583.02</span></span><br><span class="line">         <span class="number">2</span>          <span class="number">3</span>     <span class="number">5555.77</span></span><br><span class="line">         <span class="number">2</span>          <span class="number">4</span>     <span class="number">5936.67</span></span><br><span class="line">         <span class="number">2</span>          <span class="number">5</span>     <span class="number">4508.74</span></span><br><span class="line">         <span class="number">2</span>               <span class="number">26237.04</span></span><br><span class="line">                    <span class="number">1</span>    <span class="number">10016.39</span></span><br><span class="line">                    <span class="number">2</span>     <span class="number">9377.78</span></span><br><span class="line">                    <span class="number">3</span>    <span class="number">10274.02</span></span><br><span class="line">                    <span class="number">4</span>    <span class="number">11324.12</span></span><br><span class="line">                    <span class="number">5</span>     <span class="number">9536.08</span></span><br><span class="line">                         <span class="number">50528.39</span></span><br><span class="line"></span><br><span class="line"><span class="number">18</span> <span class="keyword">rows</span> selected.</span><br><span class="line"></span><br><span class="line"><span class="keyword">SQL</span><span class="operator">&gt;</span></span><br></pre></td></tr></table></figure>
<p>As the number of dimensions increase, so do the combinations of subtotals that need to be calculated, as shown by the output of the following query, shown <span class="exturl" data-url="aHR0cHM6Ly9vcmFjbGUtYmFzZS5jb20vYXJ0aWNsZXMvbWlzYy9jdWJlLnR4dA==">here</span>.</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> fact_1_id,</span><br><span class="line">       fact_2_id,</span><br><span class="line">       fact_3_id,</span><br><span class="line">       <span class="built_in">SUM</span>(sales_value) <span class="keyword">AS</span> sales_value</span><br><span class="line"><span class="keyword">FROM</span>   dimension_tab</span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> <span class="keyword">CUBE</span> (fact_1_id, fact_2_id, fact_3_id)</span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> fact_1_id, fact_2_id, fact_3_id;</span><br></pre></td></tr></table></figure>
<p>It is possible to do a partial cube to reduce the number of subtotals calculated. The output from the following partial cube is shown <span class="exturl" data-url="aHR0cHM6Ly9vcmFjbGUtYmFzZS5jb20vYXJ0aWNsZXMvbWlzYy9jdWJlLXBhcnRpYWwudHh0">here</span>.</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> fact_1_id,</span><br><span class="line">       fact_2_id,</span><br><span class="line">       fact_3_id,</span><br><span class="line">       <span class="built_in">SUM</span>(sales_value) <span class="keyword">AS</span> sales_value</span><br><span class="line"><span class="keyword">FROM</span>   dimension_tab</span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> fact_1_id, <span class="keyword">CUBE</span> (fact_2_id, fact_3_id)</span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> fact_1_id, fact_2_id, fact_3_id;</span><br></pre></td></tr></table></figure>
<h2 id="grouping-functions"><a class="markdownIt-Anchor" href="#grouping-functions">#</a> GROUPING Functions</h2>
<h3 id="grouping"><a class="markdownIt-Anchor" href="#grouping">#</a> GROUPING</h3>
<p>It can be quite easy to visually identify subtotals generated by rollups and cubes, but to do it programatically you really need something more accurate than the presence of null values in the grouping columns. This is where the  <code>GROUPING</code>  function comes in. It accepts a single column as a parameter and returns “1” if the column contains a null value generated as part of a subtotal by a  <code>ROLLUP</code>  or  <code>CUBE</code>  operation or “0” for any other value, including stored null values.</p>
<p>The following query is a repeat of a previous cube, but the  <code>GROUPING</code>  function has been added for each of the dimensions in the cube.</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> fact_1_id,</span><br><span class="line">       fact_2_id,</span><br><span class="line">       <span class="built_in">SUM</span>(sales_value) <span class="keyword">AS</span> sales_value,</span><br><span class="line">       <span class="keyword">GROUPING</span>(fact_1_id) <span class="keyword">AS</span> f1g,</span><br><span class="line">       <span class="keyword">GROUPING</span>(fact_2_id) <span class="keyword">AS</span> f2g</span><br><span class="line"><span class="keyword">FROM</span>   dimension_tab</span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> <span class="keyword">CUBE</span> (fact_1_id, fact_2_id)</span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> fact_1_id, fact_2_id;</span><br><span class="line"></span><br><span class="line"> FACT_1_ID  FACT_2_ID SALES_VALUE        F1G        F2G</span><br><span class="line"><span class="comment">---------- ---------- ----------- ---------- ----------</span></span><br><span class="line">         <span class="number">1</span>          <span class="number">1</span>     <span class="number">4363.55</span>          <span class="number">0</span>          <span class="number">0</span></span><br><span class="line">         <span class="number">1</span>          <span class="number">2</span>     <span class="number">4794.76</span>          <span class="number">0</span>          <span class="number">0</span></span><br><span class="line">         <span class="number">1</span>          <span class="number">3</span>     <span class="number">4718.25</span>          <span class="number">0</span>          <span class="number">0</span></span><br><span class="line">         <span class="number">1</span>          <span class="number">4</span>     <span class="number">5387.45</span>          <span class="number">0</span>          <span class="number">0</span></span><br><span class="line">         <span class="number">1</span>          <span class="number">5</span>     <span class="number">5027.34</span>          <span class="number">0</span>          <span class="number">0</span></span><br><span class="line">         <span class="number">1</span>               <span class="number">24291.35</span>          <span class="number">0</span>          <span class="number">1</span></span><br><span class="line">         <span class="number">2</span>          <span class="number">1</span>     <span class="number">5652.84</span>          <span class="number">0</span>          <span class="number">0</span></span><br><span class="line">         <span class="number">2</span>          <span class="number">2</span>     <span class="number">4583.02</span>          <span class="number">0</span>          <span class="number">0</span></span><br><span class="line">         <span class="number">2</span>          <span class="number">3</span>     <span class="number">5555.77</span>          <span class="number">0</span>          <span class="number">0</span></span><br><span class="line">         <span class="number">2</span>          <span class="number">4</span>     <span class="number">5936.67</span>          <span class="number">0</span>          <span class="number">0</span></span><br><span class="line">         <span class="number">2</span>          <span class="number">5</span>     <span class="number">4508.74</span>          <span class="number">0</span>          <span class="number">0</span></span><br><span class="line">         <span class="number">2</span>               <span class="number">26237.04</span>          <span class="number">0</span>          <span class="number">1</span></span><br><span class="line">                    <span class="number">1</span>    <span class="number">10016.39</span>          <span class="number">1</span>          <span class="number">0</span></span><br><span class="line">                    <span class="number">2</span>     <span class="number">9377.78</span>          <span class="number">1</span>          <span class="number">0</span></span><br><span class="line">                    <span class="number">3</span>    <span class="number">10274.02</span>          <span class="number">1</span>          <span class="number">0</span></span><br><span class="line">                    <span class="number">4</span>    <span class="number">11324.12</span>          <span class="number">1</span>          <span class="number">0</span></span><br><span class="line">                    <span class="number">5</span>     <span class="number">9536.08</span>          <span class="number">1</span>          <span class="number">0</span></span><br><span class="line">                         <span class="number">50528.39</span>          <span class="number">1</span>          <span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="number">18</span> <span class="keyword">rows</span> selected.</span><br><span class="line"></span><br><span class="line"><span class="keyword">SQL</span><span class="operator">&gt;</span></span><br></pre></td></tr></table></figure>
<p>From this we can see:</p>
<ul>
<li>F1G=0,F2G=0 : Represents a row containing regular subtotal we would expect from a  <code>GROUP BY</code>  operation.</li>
<li>F1G=0,F2G=1 : Represents a row containing a subtotal for a distinct value of the  <code>FACT_1_ID</code>  column, as generated by  <code>ROLLUP</code>  and  <code>CUBE</code>  operations.</li>
<li>F1G=1,F2G=0 : Represents a row containing a subtotal for a distinct value of the  <code>FACT_2_ID</code>  column, which we would only see in a  <code>CUBE</code>  operation.</li>
<li>F1G=1,F2G=1 : Represents a row containing a grand total for the query, as generated by  <code>ROLLUP</code>  and  <code>CUBE</code>  operations.</li>
</ul>
<p>It would now be easy to write a program to accurately process the data.</p>
<p>The  <code>GROUPING</code>  columns can used for ordering or filtering results.</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> fact_1_id,</span><br><span class="line">       fact_2_id,</span><br><span class="line">       <span class="built_in">SUM</span>(sales_value) <span class="keyword">AS</span> sales_value,</span><br><span class="line">       <span class="keyword">GROUPING</span>(fact_1_id) <span class="keyword">AS</span> f1g,</span><br><span class="line">       <span class="keyword">GROUPING</span>(fact_2_id) <span class="keyword">AS</span> f2g</span><br><span class="line"><span class="keyword">FROM</span>   dimension_tab</span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> <span class="keyword">CUBE</span> (fact_1_id, fact_2_id)</span><br><span class="line"><span class="keyword">HAVING</span> <span class="keyword">GROUPING</span>(fact_1_id) <span class="operator">=</span> <span class="number">1</span> <span class="keyword">OR</span> <span class="keyword">GROUPING</span>(fact_2_id) <span class="operator">=</span> <span class="number">1</span></span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> <span class="keyword">GROUPING</span>(fact_1_id), <span class="keyword">GROUPING</span>(fact_2_id);</span><br><span class="line"></span><br><span class="line"> FACT_1_ID  FACT_2_ID SALES_VALUE        F1G        F2G</span><br><span class="line"><span class="comment">---------- ---------- ----------- ---------- ----------</span></span><br><span class="line">         <span class="number">1</span>               <span class="number">24291.35</span>          <span class="number">0</span>          <span class="number">1</span></span><br><span class="line">         <span class="number">2</span>               <span class="number">26237.04</span>          <span class="number">0</span>          <span class="number">1</span></span><br><span class="line">                    <span class="number">4</span>    <span class="number">11324.12</span>          <span class="number">1</span>          <span class="number">0</span></span><br><span class="line">                    <span class="number">3</span>    <span class="number">10274.02</span>          <span class="number">1</span>          <span class="number">0</span></span><br><span class="line">                    <span class="number">2</span>     <span class="number">9377.78</span>          <span class="number">1</span>          <span class="number">0</span></span><br><span class="line">                    <span class="number">1</span>    <span class="number">10016.39</span>          <span class="number">1</span>          <span class="number">0</span></span><br><span class="line">                    <span class="number">5</span>     <span class="number">9536.08</span>          <span class="number">1</span>          <span class="number">0</span></span><br><span class="line">                         <span class="number">50528.39</span>          <span class="number">1</span>          <span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="number">8</span> <span class="keyword">rows</span> selected.</span><br><span class="line"></span><br><span class="line"><span class="keyword">SQL</span><span class="operator">&gt;</span></span><br></pre></td></tr></table></figure>
<h3 id="grouping_id"><a class="markdownIt-Anchor" href="#grouping_id">#</a> GROUPING_ID</h3>
<p>The  <code>GROUPING_ID</code>  function provides an alternate and more compact way to identify subtotal rows. Passing the dimension columns as arguments, it returns a number indicating the  <code>GROUP BY</code>  level.</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> fact_1_id,</span><br><span class="line">       fact_2_id,</span><br><span class="line">       <span class="built_in">SUM</span>(sales_value) <span class="keyword">AS</span> sales_value,</span><br><span class="line">       GROUPING_ID(fact_1_id, fact_2_id) <span class="keyword">AS</span> grouping_id</span><br><span class="line"><span class="keyword">FROM</span>   dimension_tab</span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> <span class="keyword">CUBE</span> (fact_1_id, fact_2_id)</span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> fact_1_id, fact_2_id;</span><br><span class="line"></span><br><span class="line"> FACT_1_ID  FACT_2_ID SALES_VALUE GROUPING_ID</span><br><span class="line"><span class="comment">---------- ---------- ----------- -----------</span></span><br><span class="line">         <span class="number">1</span>          <span class="number">1</span>     <span class="number">4363.55</span>           <span class="number">0</span></span><br><span class="line">         <span class="number">1</span>          <span class="number">2</span>     <span class="number">4794.76</span>           <span class="number">0</span></span><br><span class="line">         <span class="number">1</span>          <span class="number">3</span>     <span class="number">4718.25</span>           <span class="number">0</span></span><br><span class="line">         <span class="number">1</span>          <span class="number">4</span>     <span class="number">5387.45</span>           <span class="number">0</span></span><br><span class="line">         <span class="number">1</span>          <span class="number">5</span>     <span class="number">5027.34</span>           <span class="number">0</span></span><br><span class="line">         <span class="number">1</span>               <span class="number">24291.35</span>           <span class="number">1</span></span><br><span class="line">         <span class="number">2</span>          <span class="number">1</span>     <span class="number">5652.84</span>           <span class="number">0</span></span><br><span class="line">         <span class="number">2</span>          <span class="number">2</span>     <span class="number">4583.02</span>           <span class="number">0</span></span><br><span class="line">         <span class="number">2</span>          <span class="number">3</span>     <span class="number">5555.77</span>           <span class="number">0</span></span><br><span class="line">         <span class="number">2</span>          <span class="number">4</span>     <span class="number">5936.67</span>           <span class="number">0</span></span><br><span class="line">         <span class="number">2</span>          <span class="number">5</span>     <span class="number">4508.74</span>           <span class="number">0</span></span><br><span class="line">         <span class="number">2</span>               <span class="number">26237.04</span>           <span class="number">1</span></span><br><span class="line">                    <span class="number">1</span>    <span class="number">10016.39</span>           <span class="number">2</span></span><br><span class="line">                    <span class="number">2</span>     <span class="number">9377.78</span>           <span class="number">2</span></span><br><span class="line">                    <span class="number">3</span>    <span class="number">10274.02</span>           <span class="number">2</span></span><br><span class="line">                    <span class="number">4</span>    <span class="number">11324.12</span>           <span class="number">2</span></span><br><span class="line">                    <span class="number">5</span>     <span class="number">9536.08</span>           <span class="number">2</span></span><br><span class="line">                         <span class="number">50528.39</span>           <span class="number">3</span></span><br><span class="line"></span><br><span class="line"><span class="number">18</span> <span class="keyword">rows</span> selected.</span><br><span class="line"></span><br><span class="line"><span class="keyword">SQL</span><span class="operator">&gt;</span></span><br></pre></td></tr></table></figure>
<h3 id="group_id"><a class="markdownIt-Anchor" href="#group_id">#</a> GROUP_ID</h3>
<p>It’s possible to write queries that return the duplicate subtotals, which can be a little confusing. The  <code>GROUP_ID</code>  function assigns the value “0” to the first set, and all subsequent sets get assigned a higher number. The following query forces duplicates to show the  <code>GROUP_ID</code>  function in action.</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> fact_1_id,</span><br><span class="line">       fact_2_id,</span><br><span class="line">       <span class="built_in">SUM</span>(sales_value) <span class="keyword">AS</span> sales_value,</span><br><span class="line">       GROUPING_ID(fact_1_id, fact_2_id) <span class="keyword">AS</span> grouping_id,</span><br><span class="line">       GROUP_ID() <span class="keyword">AS</span> group_id</span><br><span class="line"><span class="keyword">FROM</span>   dimension_tab</span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> <span class="keyword">GROUPING</span> SETS(fact_1_id, <span class="keyword">CUBE</span> (fact_1_id, fact_2_id))</span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> fact_1_id, fact_2_id;</span><br><span class="line"></span><br><span class="line"> FACT_1_ID  FACT_2_ID SALES_VALUE GROUPING_ID   GROUP_ID</span><br><span class="line"><span class="comment">---------- ---------- ----------- ----------- ----------</span></span><br><span class="line">         <span class="number">1</span>          <span class="number">1</span>     <span class="number">4363.55</span>           <span class="number">0</span>          <span class="number">0</span></span><br><span class="line">         <span class="number">1</span>          <span class="number">2</span>     <span class="number">4794.76</span>           <span class="number">0</span>          <span class="number">0</span></span><br><span class="line">         <span class="number">1</span>          <span class="number">3</span>     <span class="number">4718.25</span>           <span class="number">0</span>          <span class="number">0</span></span><br><span class="line">         <span class="number">1</span>          <span class="number">4</span>     <span class="number">5387.45</span>           <span class="number">0</span>          <span class="number">0</span></span><br><span class="line">         <span class="number">1</span>          <span class="number">5</span>     <span class="number">5027.34</span>           <span class="number">0</span>          <span class="number">0</span></span><br><span class="line">         <span class="number">1</span>               <span class="number">24291.35</span>           <span class="number">1</span>          <span class="number">1</span></span><br><span class="line">         <span class="number">1</span>               <span class="number">24291.35</span>           <span class="number">1</span>          <span class="number">0</span></span><br><span class="line">         <span class="number">2</span>          <span class="number">1</span>     <span class="number">5652.84</span>           <span class="number">0</span>          <span class="number">0</span></span><br><span class="line">         <span class="number">2</span>          <span class="number">2</span>     <span class="number">4583.02</span>           <span class="number">0</span>          <span class="number">0</span></span><br><span class="line">         <span class="number">2</span>          <span class="number">3</span>     <span class="number">5555.77</span>           <span class="number">0</span>          <span class="number">0</span></span><br><span class="line">         <span class="number">2</span>          <span class="number">4</span>     <span class="number">5936.67</span>           <span class="number">0</span>          <span class="number">0</span></span><br><span class="line">         <span class="number">2</span>          <span class="number">5</span>     <span class="number">4508.74</span>           <span class="number">0</span>          <span class="number">0</span></span><br><span class="line">         <span class="number">2</span>               <span class="number">26237.04</span>           <span class="number">1</span>          <span class="number">1</span></span><br><span class="line">         <span class="number">2</span>               <span class="number">26237.04</span>           <span class="number">1</span>          <span class="number">0</span></span><br><span class="line">                    <span class="number">1</span>    <span class="number">10016.39</span>           <span class="number">2</span>          <span class="number">0</span></span><br><span class="line">                    <span class="number">2</span>     <span class="number">9377.78</span>           <span class="number">2</span>          <span class="number">0</span></span><br><span class="line">                    <span class="number">3</span>    <span class="number">10274.02</span>           <span class="number">2</span>          <span class="number">0</span></span><br><span class="line">                    <span class="number">4</span>    <span class="number">11324.12</span>           <span class="number">2</span>          <span class="number">0</span></span><br><span class="line">                    <span class="number">5</span>     <span class="number">9536.08</span>           <span class="number">2</span>          <span class="number">0</span></span><br><span class="line">                         <span class="number">50528.39</span>           <span class="number">3</span>          <span class="number">0</span></span><br><span class="line"></span><br><span class="line"><span class="number">20</span> <span class="keyword">rows</span> selected.</span><br><span class="line"></span><br><span class="line"><span class="keyword">SQL</span><span class="operator">&gt;</span></span><br></pre></td></tr></table></figure>
<p>If necessary, you could then filter the results using the group.</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> fact_1_id,</span><br><span class="line">       fact_2_id,</span><br><span class="line">       <span class="built_in">SUM</span>(sales_value) <span class="keyword">AS</span> sales_value,</span><br><span class="line">       GROUPING_ID(fact_1_id, fact_2_id) <span class="keyword">AS</span> grouping_id,</span><br><span class="line">       GROUP_ID() <span class="keyword">AS</span> group_id</span><br><span class="line"><span class="keyword">FROM</span>   dimension_tab</span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> <span class="keyword">GROUPING</span> SETS(fact_1_id, <span class="keyword">CUBE</span> (fact_1_id, fact_2_id))</span><br><span class="line"><span class="keyword">HAVING</span> GROUP_ID() <span class="operator">=</span> <span class="number">0</span></span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> fact_1_id, fact_2_id;</span><br><span class="line"></span><br><span class="line"> FACT_1_ID  FACT_2_ID SALES_VALUE GROUPING_ID   GROUP_ID</span><br><span class="line"><span class="comment">---------- ---------- ----------- ----------- ----------</span></span><br><span class="line">         <span class="number">1</span>          <span class="number">1</span>     <span class="number">4363.55</span>           <span class="number">0</span>          <span class="number">0</span></span><br><span class="line">         <span class="number">1</span>          <span class="number">2</span>     <span class="number">4794.76</span>           <span class="number">0</span>          <span class="number">0</span></span><br><span class="line">         <span class="number">1</span>          <span class="number">3</span>     <span class="number">4718.25</span>           <span class="number">0</span>          <span class="number">0</span></span><br><span class="line">         <span class="number">1</span>          <span class="number">4</span>     <span class="number">5387.45</span>           <span class="number">0</span>          <span class="number">0</span></span><br><span class="line">         <span class="number">1</span>          <span class="number">5</span>     <span class="number">5027.34</span>           <span class="number">0</span>          <span class="number">0</span></span><br><span class="line">         <span class="number">1</span>               <span class="number">24291.35</span>           <span class="number">1</span>          <span class="number">0</span></span><br><span class="line">         <span class="number">2</span>          <span class="number">1</span>     <span class="number">5652.84</span>           <span class="number">0</span>          <span class="number">0</span></span><br><span class="line">         <span class="number">2</span>          <span class="number">2</span>     <span class="number">4583.02</span>           <span class="number">0</span>          <span class="number">0</span></span><br><span class="line">         <span class="number">2</span>          <span class="number">3</span>     <span class="number">5555.77</span>           <span class="number">0</span>          <span class="number">0</span></span><br><span class="line">         <span class="number">2</span>          <span class="number">4</span>     <span class="number">5936.67</span>           <span class="number">0</span>          <span class="number">0</span></span><br><span class="line">         <span class="number">2</span>          <span class="number">5</span>     <span class="number">4508.74</span>           <span class="number">0</span>          <span class="number">0</span></span><br><span class="line">         <span class="number">2</span>               <span class="number">26237.04</span>           <span class="number">1</span>          <span class="number">0</span></span><br><span class="line">                    <span class="number">1</span>    <span class="number">10016.39</span>           <span class="number">2</span>          <span class="number">0</span></span><br><span class="line">                    <span class="number">2</span>     <span class="number">9377.78</span>           <span class="number">2</span>          <span class="number">0</span></span><br><span class="line">                    <span class="number">3</span>    <span class="number">10274.02</span>           <span class="number">2</span>          <span class="number">0</span></span><br><span class="line">                    <span class="number">4</span>    <span class="number">11324.12</span>           <span class="number">2</span>          <span class="number">0</span></span><br><span class="line">                    <span class="number">5</span>     <span class="number">9536.08</span>           <span class="number">2</span>          <span class="number">0</span></span><br><span class="line">                         <span class="number">50528.39</span>           <span class="number">3</span>          <span class="number">0</span></span><br><span class="line"></span><br><span class="line"><span class="number">18</span> <span class="keyword">rows</span> selected.</span><br><span class="line"></span><br><span class="line"><span class="keyword">SQL</span><span class="operator">&gt;</span></span><br></pre></td></tr></table></figure>
<h2 id="grouping-sets"><a class="markdownIt-Anchor" href="#grouping-sets">#</a> GROUPING SETS</h2>
<p>Calculating all possible subtotals in a cube, especially those with many dimensions, can be quite an intensive process. If you don’t need all the subtotals, this can represent a considerable amount of wasted effort. The following cube with three dimensions gives 8 levels of subtotals (GROUPING_ID: 0-7), shown <span class="exturl" data-url="aHR0cHM6Ly9vcmFjbGUtYmFzZS5jb20vYXJ0aWNsZXMvbWlzYy9ncm91cGluZy1zZXRzLWN1YmUudHh0">here</span>.</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> fact_1_id,</span><br><span class="line">       fact_2_id,</span><br><span class="line">       fact_3_id,</span><br><span class="line">       <span class="built_in">SUM</span>(sales_value) <span class="keyword">AS</span> sales_value,</span><br><span class="line">       GROUPING_ID(fact_1_id, fact_2_id, fact_3_id) <span class="keyword">AS</span> grouping_id</span><br><span class="line"><span class="keyword">FROM</span>   dimension_tab</span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> <span class="keyword">CUBE</span>(fact_1_id, fact_2_id, fact_3_id)</span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> fact_1_id, fact_2_id, fact_3_id;</span><br></pre></td></tr></table></figure>
<p>If we only need a few of these levels of subtotaling we can use the  <code>GROUPING SETS</code>  expression and specify exactly which ones we need, saving us having to calculate the whole cube. In the following query we are only interested in subtotals for the “ <code>FACT_1_ID, FACT_2_ID</code> ” and “ <code>FACT_1_ID, FACT_3_ID</code> ” groups.</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> fact_1_id,</span><br><span class="line">       fact_2_id,</span><br><span class="line">       fact_3_id,</span><br><span class="line">       <span class="built_in">SUM</span>(sales_value) <span class="keyword">AS</span> sales_value,</span><br><span class="line">       GROUPING_ID(fact_1_id, fact_2_id, fact_3_id) <span class="keyword">AS</span> grouping_id</span><br><span class="line"><span class="keyword">FROM</span>   dimension_tab</span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> <span class="keyword">GROUPING</span> SETS((fact_1_id, fact_2_id), (fact_1_id, fact_3_id))</span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> fact_1_id, fact_2_id, fact_3_id;</span><br><span class="line"></span><br><span class="line"> FACT_1_ID  FACT_2_ID  FACT_3_ID SALES_VALUE GROUPING_ID</span><br><span class="line"><span class="comment">---------- ---------- ---------- ----------- -----------</span></span><br><span class="line">         <span class="number">1</span>          <span class="number">1</span>                <span class="number">4363.55</span>           <span class="number">1</span></span><br><span class="line">         <span class="number">1</span>          <span class="number">2</span>                <span class="number">4794.76</span>           <span class="number">1</span></span><br><span class="line">         <span class="number">1</span>          <span class="number">3</span>                <span class="number">4718.25</span>           <span class="number">1</span></span><br><span class="line">         <span class="number">1</span>          <span class="number">4</span>                <span class="number">5387.45</span>           <span class="number">1</span></span><br><span class="line">         <span class="number">1</span>          <span class="number">5</span>                <span class="number">5027.34</span>           <span class="number">1</span></span><br><span class="line">         <span class="number">1</span>                     <span class="number">1</span>      <span class="number">2737.4</span>           <span class="number">2</span></span><br><span class="line">         <span class="number">1</span>                     <span class="number">2</span>     <span class="number">1854.29</span>           <span class="number">2</span></span><br><span class="line">         <span class="number">1</span>                     <span class="number">3</span>     <span class="number">2090.96</span>           <span class="number">2</span></span><br><span class="line">         <span class="number">1</span>                     <span class="number">4</span>     <span class="number">2605.17</span>           <span class="number">2</span></span><br><span class="line">         <span class="number">1</span>                     <span class="number">5</span>     <span class="number">2590.93</span>           <span class="number">2</span></span><br><span class="line">         <span class="number">1</span>                     <span class="number">6</span>      <span class="number">2506.9</span>           <span class="number">2</span></span><br><span class="line">         <span class="number">1</span>                     <span class="number">7</span>     <span class="number">1839.85</span>           <span class="number">2</span></span><br><span class="line">         <span class="number">1</span>                     <span class="number">8</span>     <span class="number">2953.04</span>           <span class="number">2</span></span><br><span class="line">         <span class="number">1</span>                     <span class="number">9</span>     <span class="number">2778.75</span>           <span class="number">2</span></span><br><span class="line">         <span class="number">1</span>                    <span class="number">10</span>     <span class="number">2334.06</span>           <span class="number">2</span></span><br><span class="line">         <span class="number">2</span>          <span class="number">1</span>                <span class="number">5652.84</span>           <span class="number">1</span></span><br><span class="line">         <span class="number">2</span>          <span class="number">2</span>                <span class="number">4583.02</span>           <span class="number">1</span></span><br><span class="line">         <span class="number">2</span>          <span class="number">3</span>                <span class="number">5555.77</span>           <span class="number">1</span></span><br><span class="line">         <span class="number">2</span>          <span class="number">4</span>                <span class="number">5936.67</span>           <span class="number">1</span></span><br><span class="line">         <span class="number">2</span>          <span class="number">5</span>                <span class="number">4508.74</span>           <span class="number">1</span></span><br><span class="line">         <span class="number">2</span>                     <span class="number">1</span>     <span class="number">3512.69</span>           <span class="number">2</span></span><br><span class="line">         <span class="number">2</span>                     <span class="number">2</span>     <span class="number">2847.94</span>           <span class="number">2</span></span><br><span class="line">         <span class="number">2</span>                     <span class="number">3</span>      <span class="number">2972.5</span>           <span class="number">2</span></span><br><span class="line">         <span class="number">2</span>                     <span class="number">4</span>     <span class="number">2534.06</span>           <span class="number">2</span></span><br><span class="line">         <span class="number">2</span>                     <span class="number">5</span>     <span class="number">3115.99</span>           <span class="number">2</span></span><br><span class="line">         <span class="number">2</span>                     <span class="number">6</span>     <span class="number">2775.85</span>           <span class="number">2</span></span><br><span class="line">         <span class="number">2</span>                     <span class="number">7</span>     <span class="number">2208.19</span>           <span class="number">2</span></span><br><span class="line">         <span class="number">2</span>                     <span class="number">8</span>     <span class="number">2358.55</span>           <span class="number">2</span></span><br><span class="line">         <span class="number">2</span>                     <span class="number">9</span>     <span class="number">1884.11</span>           <span class="number">2</span></span><br><span class="line">         <span class="number">2</span>                    <span class="number">10</span>     <span class="number">2027.16</span>           <span class="number">2</span></span><br><span class="line"></span><br><span class="line"><span class="number">30</span> <span class="keyword">rows</span> selected.</span><br><span class="line"></span><br><span class="line"><span class="keyword">SQL</span><span class="operator">&gt;</span></span><br></pre></td></tr></table></figure>
<p>Notice how we have gone from returning 198 rows with 8 subtotal levels in the cube, to just 30 rows with 2 subtotal levels.</p>
<h2 id="composite-columns"><a class="markdownIt-Anchor" href="#composite-columns">#</a> Composite Columns</h2>
<p><code>ROLLUP</code>  and  <code>CUBE</code>  consider each column independently when deciding which subtotals must be calculated. For  <code>ROLLUP</code>  this means stepping back through the list to determine the groupings.</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ROLLUP</span> (a, b, c)</span><br><span class="line">(a, b, c)</span><br><span class="line">(a, b)</span><br><span class="line">(a)</span><br><span class="line">()</span><br></pre></td></tr></table></figure>
<p><code>CUBE</code>  creates a grouping for every possible combination of columns.</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CUBE</span> (a, b, c)</span><br><span class="line">(a, b, c)</span><br><span class="line">(a, b)</span><br><span class="line">(a, c)</span><br><span class="line">(a)</span><br><span class="line">(b, c)</span><br><span class="line">(b)</span><br><span class="line">(c)</span><br><span class="line">()</span><br></pre></td></tr></table></figure>
<p>Composite columns allow columns to be grouped together with braces so they are treated as a single unit when determining the necessary groupings. In the following  <code>ROLLUP</code>  columns “a” and “b” have been turned into a composite column by the additional braces. As a result the group of “a” is not longer calculated as the column “a” is only present as part of the composite column in the statement.</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ROLLUP</span> ((a, b), c)</span><br><span class="line">(a, b, c)</span><br><span class="line">(a, b)</span><br><span class="line">()</span><br><span class="line"></span><br><span class="line"><span class="keyword">Not</span> considered:</span><br><span class="line">(a)</span><br></pre></td></tr></table></figure>
<p>In a similar way, the possible combinations of the following  <code>CUBE</code>  are reduced because references to “a” or “b” individually are not considered as they are treated as a single column when the groupings are determined.</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CUBE</span> ((a, b), c)</span><br><span class="line">(a, b, c)</span><br><span class="line">(a, b)</span><br><span class="line">(c)</span><br><span class="line">()</span><br><span class="line"></span><br><span class="line"><span class="keyword">Not</span> considered:</span><br><span class="line">(a, c)</span><br><span class="line">(a)</span><br><span class="line">(b, c)</span><br><span class="line">(b)</span><br></pre></td></tr></table></figure>
<p>The impact of this is shown clearly in the follow two statements, whose output is shown <span class="exturl" data-url="aHR0cHM6Ly9vcmFjbGUtYmFzZS5jb20vYXJ0aWNsZXMvbWlzYy9jb21wb3NpdGUtY29sdW1uLTEudHh0">here</span> and <span class="exturl" data-url="aHR0cHM6Ly9vcmFjbGUtYmFzZS5jb20vYXJ0aWNsZXMvbWlzYy9jb21wb3NpdGUtY29sdW1uLTIudHh0">here</span>. The regular cube returns 198 rows and 8 groups (0-7), while the cube with the composite column returns only 121 rows with 4 groups (0, 1, 6, 7)</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- Regular Cube.</span></span><br><span class="line"><span class="keyword">SELECT</span> fact_1_id,</span><br><span class="line">       fact_2_id,</span><br><span class="line">       fact_3_id,</span><br><span class="line">       <span class="built_in">SUM</span>(sales_value) <span class="keyword">AS</span> sales_value,</span><br><span class="line">       GROUPING_ID(fact_1_id, fact_2_id, fact_3_id) <span class="keyword">AS</span> grouping_id</span><br><span class="line"><span class="keyword">FROM</span>   dimension_tab</span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> <span class="keyword">CUBE</span>(fact_1_id, fact_2_id, fact_3_id)</span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> fact_1_id, fact_2_id, fact_3_id;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- Cube with composite column.</span></span><br><span class="line"><span class="keyword">SELECT</span> fact_1_id,</span><br><span class="line">       fact_2_id,</span><br><span class="line">       fact_3_id,</span><br><span class="line">       <span class="built_in">SUM</span>(sales_value) <span class="keyword">AS</span> sales_value,</span><br><span class="line">       GROUPING_ID(fact_1_id, fact_2_id, fact_3_id) <span class="keyword">AS</span> grouping_id</span><br><span class="line"><span class="keyword">FROM</span>   dimension_tab</span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> <span class="keyword">CUBE</span>((fact_1_id, fact_2_id), fact_3_id)</span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> fact_1_id, fact_2_id, fact_3_id;</span><br></pre></td></tr></table></figure>
<h2 id="concatenated-groupings"><a class="markdownIt-Anchor" href="#concatenated-groupings">#</a> Concatenated Groupings</h2>
<p>Concatenated groupings are defined by putting together multiple  <code>GROUPING SETS</code> ,  <code>CUBE</code> s or  <code>ROLLUP</code> s separated by commas. The resulting groupings are the cross-product of all the groups produced by the individual grouping sets. It might be a little easier to understand what this means by looking at an example. The following  <code>GROUPING SET</code>  results in 2 groups of subtotals, one for the  <code>fact_1_id</code>  column and one for the  <code>fact_id_2</code>  column.</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> fact_1_id,</span><br><span class="line">       fact_2_id,</span><br><span class="line">       <span class="built_in">SUM</span>(sales_value) <span class="keyword">AS</span> sales_value,</span><br><span class="line">       GROUPING_ID(fact_1_id, fact_2_id) <span class="keyword">AS</span> grouping_id</span><br><span class="line"><span class="keyword">FROM</span>   dimension_tab</span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> <span class="keyword">GROUPING</span> SETS(fact_1_id, fact_2_id)</span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> fact_1_id, fact_2_id;</span><br><span class="line"></span><br><span class="line"> FACT_1_ID  FACT_2_ID SALES_VALUE GROUPING_ID</span><br><span class="line"><span class="comment">---------- ---------- ----------- -----------</span></span><br><span class="line">         <span class="number">1</span>               <span class="number">24291.35</span>           <span class="number">1</span></span><br><span class="line">         <span class="number">2</span>               <span class="number">26237.04</span>           <span class="number">1</span></span><br><span class="line">                    <span class="number">1</span>    <span class="number">10016.39</span>           <span class="number">2</span></span><br><span class="line">                    <span class="number">2</span>     <span class="number">9377.78</span>           <span class="number">2</span></span><br><span class="line">                    <span class="number">3</span>    <span class="number">10274.02</span>           <span class="number">2</span></span><br><span class="line">                    <span class="number">4</span>    <span class="number">11324.12</span>           <span class="number">2</span></span><br><span class="line">                    <span class="number">5</span>     <span class="number">9536.08</span>           <span class="number">2</span></span><br><span class="line"></span><br><span class="line"><span class="number">7</span> <span class="keyword">rows</span> selected.</span><br><span class="line"></span><br><span class="line"><span class="keyword">SQL</span><span class="operator">&gt;</span></span><br></pre></td></tr></table></figure>
<p>The next  <code>GROUPING SET</code>  results in another 2 groups of subtotals, one for the  <code>fact_3_id</code>  column and one for the  <code>fact_4_id</code>  column.</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> fact_3_id,</span><br><span class="line">       fact_4_id,</span><br><span class="line">       <span class="built_in">SUM</span>(sales_value) <span class="keyword">AS</span> sales_value,</span><br><span class="line">       GROUPING_ID(fact_3_id, fact_4_id) <span class="keyword">AS</span> grouping_id</span><br><span class="line"><span class="keyword">FROM</span>   dimension_tab</span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> <span class="keyword">GROUPING</span> SETS(fact_3_id, fact_4_id)</span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> fact_3_id, fact_4_id;</span><br><span class="line"></span><br><span class="line"> FACT_3_ID  FACT_4_ID SALES_VALUE GROUPING_ID</span><br><span class="line"><span class="comment">---------- ---------- ----------- -----------</span></span><br><span class="line">         <span class="number">1</span>                <span class="number">6250.09</span>           <span class="number">1</span></span><br><span class="line">         <span class="number">2</span>                <span class="number">4702.23</span>           <span class="number">1</span></span><br><span class="line">         <span class="number">3</span>                <span class="number">5063.46</span>           <span class="number">1</span></span><br><span class="line">         <span class="number">4</span>                <span class="number">5139.23</span>           <span class="number">1</span></span><br><span class="line">         <span class="number">5</span>                <span class="number">5706.92</span>           <span class="number">1</span></span><br><span class="line">         <span class="number">6</span>                <span class="number">5282.75</span>           <span class="number">1</span></span><br><span class="line">         <span class="number">7</span>                <span class="number">4048.04</span>           <span class="number">1</span></span><br><span class="line">         <span class="number">8</span>                <span class="number">5311.59</span>           <span class="number">1</span></span><br><span class="line">         <span class="number">9</span>                <span class="number">4662.86</span>           <span class="number">1</span></span><br><span class="line">        <span class="number">10</span>                <span class="number">4361.22</span>           <span class="number">1</span></span><br><span class="line">                    <span class="number">1</span>     <span class="number">4718.55</span>           <span class="number">2</span></span><br><span class="line">                    <span class="number">2</span>      <span class="number">5439.1</span>           <span class="number">2</span></span><br><span class="line">                    <span class="number">3</span>      <span class="number">4643.4</span>           <span class="number">2</span></span><br><span class="line">                    <span class="number">4</span>      <span class="number">4515.3</span>           <span class="number">2</span></span><br><span class="line">                    <span class="number">5</span>     <span class="number">5110.27</span>           <span class="number">2</span></span><br><span class="line">                    <span class="number">6</span>     <span class="number">5910.78</span>           <span class="number">2</span></span><br><span class="line">                    <span class="number">7</span>     <span class="number">4987.22</span>           <span class="number">2</span></span><br><span class="line">                    <span class="number">8</span>     <span class="number">4846.25</span>           <span class="number">2</span></span><br><span class="line">                    <span class="number">9</span>     <span class="number">5458.82</span>           <span class="number">2</span></span><br><span class="line">                   <span class="number">10</span>      <span class="number">4898.7</span>           <span class="number">2</span></span><br><span class="line"></span><br><span class="line"><span class="number">20</span> <span class="keyword">rows</span> selected.</span><br><span class="line"></span><br><span class="line"><span class="keyword">SQL</span><span class="operator">&gt;</span></span><br></pre></td></tr></table></figure>
<p>If we combine them together into a concatenated grouping we get 4 groups of subtotals. The output of the following query is shown <span class="exturl" data-url="aHR0cHM6Ly9vcmFjbGUtYmFzZS5jb20vYXJ0aWNsZXMvbWlzYy9jb25jYXRlbmF0ZWQtZ3JvdXBpbmdzLnR4dA==">here</span></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> fact_1_id,</span><br><span class="line">       fact_2_id,</span><br><span class="line">       fact_3_id,</span><br><span class="line">       fact_4_id,</span><br><span class="line">       <span class="built_in">SUM</span>(sales_value) <span class="keyword">AS</span> sales_value,</span><br><span class="line">       GROUPING_ID(fact_1_id, fact_2_id, fact_3_id, fact_4_id) <span class="keyword">AS</span> grouping_id</span><br><span class="line"><span class="keyword">FROM</span>   dimension_tab</span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> <span class="keyword">GROUPING</span> SETS(fact_1_id, fact_2_id), <span class="keyword">GROUPING</span> SETS(fact_3_id, fact_4_id)</span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> fact_1_id, fact_2_id, fact_3_id, fact_4_id;</span><br></pre></td></tr></table></figure>
<p>The output from the previous three queries produce the following groupings.</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">GROUPING</span> SETS(fact_1_id, fact_2_id)</span><br><span class="line">(fact_1_id)</span><br><span class="line">(fact_2_id)</span><br><span class="line"></span><br><span class="line"><span class="keyword">GROUPING</span> SETS(fact_3_id, fact_4_id)</span><br><span class="line">(fact_3_id)</span><br><span class="line">(fact_4_id)</span><br><span class="line"></span><br><span class="line"><span class="keyword">GROUPING</span> SETS(fact_1_id, fact_2_id), <span class="keyword">GROUPING</span> SETS(fact_3_id, fact_4_id)</span><br><span class="line">(fact_1_id, fact_3_id)</span><br><span class="line">(fact_1_id, fact_4_id)</span><br><span class="line">(fact_2_id, fact_3_id)</span><br><span class="line">(fact_2_id, fact_4_id)</span><br></pre></td></tr></table></figure>
<p>So we can see the final cross-product of the two  <code>GROUPING SETS</code>  that make up the concatenated grouping. A generic summary would be as follows.</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">GROUPING</span> SETS(a, b), <span class="keyword">GROUPING</span> SETS(c, d)</span><br><span class="line">(a, c)</span><br><span class="line">(a, d)</span><br><span class="line">(b, c)</span><br><span class="line">(b, d)</span><br></pre></td></tr></table></figure>
<p>For more information see:</p>
<ul>
<li><span class="exturl" data-url="aHR0cHM6Ly93d3cueW91dHViZS5jb20vd2F0Y2g/dj1DQ200SVktTnRmdw==">GROUP BY, ROLLUP and CUBE in Oracle </span></li>
<li><span class="exturl" data-url="aHR0cDovL2RvY3Mub3JhY2xlLmNvbS9jZC9FMTE4ODJfMDEvc2VydmVyLjExMi9lMjU1NTQvYWdncmVnLmh0bQ==">SQL for Aggregation in Data Warehouses</span></li>
</ul>

      <div class="tags">
          <a href="/tags/db/" rel="tag"><i class="ic i-tag"></i> db</a>
      </div>
  </div>

   <footer>

    <div class="meta">
  <span class="item">
    <span class="icon">
      <i class="ic i-calendar-check"></i>
    </span>
    <span class="text">Edited on</span>
    <time title="Modified: 2023-04-11 15:35:11" itemprop="dateModified" datetime="2023-04-11T15:35:11+08:00">2023-04-11</time>
  </span>
</div>

      

  </footer>

</article>

  </div>
  

<div class="post-nav">
    <div class="item left">
      

  <a href="/2023/04/01/c-main/" itemprop="url" rel="prev" data-background-image="&#x2F;anime&#x2F;index&#x2F;斩·赤红之瞳.jpg" title="Various declarations of main() function in C">
  <span class="type">Previous Post</span>
  <span class="category"><i class="ic i-flag"></i> </span>
  <h3>Various declarations of main() function in C</h3>
  </a>

    </div>
    <div class="item right">
      

  <a href="/2023/04/11/oracle-random/" itemprop="url" rel="next" data-background-image="&#x2F;anime&#x2F;index&#x2F;真实之泪.jpg" title="DBMS_RANDOM Get Random Value">
  <span class="type">Next Post</span>
  <span class="category"><i class="ic i-flag"></i> </span>
  <h3>DBMS_RANDOM Get Random Value</h3>
  </a>

    </div>
</div>

  
  <div class="wrap" id="comments"></div>


        </div>
        <div id="sidebar">
          

<div class="inner">

  <div class="panels">
    <div class="inner">
      <div class="contents panel pjax" data-title="Contents">
          <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#setup"><span class="toc-number">1.</span> <span class="toc-text"> Setup</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#group-by"><span class="toc-number">2.</span> <span class="toc-text"> GROUP BY</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#rollup"><span class="toc-number">3.</span> <span class="toc-text"> ROLLUP</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#cube"><span class="toc-number">4.</span> <span class="toc-text"> CUBE</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#grouping-functions"><span class="toc-number">5.</span> <span class="toc-text"> GROUPING Functions</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#grouping"><span class="toc-number">5.1.</span> <span class="toc-text"> GROUPING</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#grouping_id"><span class="toc-number">5.2.</span> <span class="toc-text"> GROUPING_ID</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#group_id"><span class="toc-number">5.3.</span> <span class="toc-text"> GROUP_ID</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#grouping-sets"><span class="toc-number">6.</span> <span class="toc-text"> GROUPING SETS</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#composite-columns"><span class="toc-number">7.</span> <span class="toc-text"> Composite Columns</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#concatenated-groupings"><span class="toc-number">8.</span> <span class="toc-text"> Concatenated Groupings</span></a></li></ol>
      </div>
      <div class="related panel pjax" data-title="Related">
      </div>
      <div class="overview panel" data-title="Overview">
        <div class="author" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <img class="image" itemprop="image" alt="江边鸟"
      data-src="/images/avatar.jpg">
  <p class="name" itemprop="name">江边鸟</p>
  <div class="description" itemprop="description"></div>
</div>

<nav class="state">
    <div class="item posts">
      <a href="/archives/">
        <span class="count">351</span>
        <span class="name">posts</span>
      </a>
    </div>
    <div class="item categories">
      <a href="/categories/">
        <span class="count">2</span>
        <span class="name">categories</span>
      </a>
    </div>
    <div class="item tags">
      <a href="/tags/">
        <span class="count">50</span>
        <span class="name">tags</span>
      </a>
    </div>
</nav>

<div class="social">
      <span class="exturl item github" data-url="aHR0cHM6Ly9naXRodWIuY29tL2xoY2hlbjc0" title="https:&#x2F;&#x2F;github.com&#x2F;lhchen74"><i class="ic i-github"></i></span>
      <span class="exturl item music" data-url="aHR0cHM6Ly9tdXNpYy4xNjMuY29tLw==" title="https:&#x2F;&#x2F;music.163.com&#x2F;"><i class="ic i-cloud-music"></i></span>
      <span class="exturl item codepen" data-url="aHR0cHM6Ly9jb2RlcGVuLmlvL2xoY2hlbjc0" title="https:&#x2F;&#x2F;codepen.io&#x2F;lhchen74"><i class="ic i-address-card"></i></span>
      <span class="exturl item anki" data-url="aHR0cHM6Ly9hbmtpd2ViLm5ldC9kZWNrcy8=" title="https:&#x2F;&#x2F;ankiweb.net&#x2F;decks&#x2F;"><i class="ic i-address-card"></i></span>
</div>

<ul class="menu">
  
    
  <li class="item">
    <a href="/" rel="section"><i class="ic i-home"></i>Home</a>
  </li>

    
  <li class="item">
    <a href="/about/" rel="section"><i class="ic i-user"></i>About</a>
  </li>

        
  <li class="item dropdown">
      <a href="javascript:void(0);"><i class="ic i-feather"></i>Posts</a>
    <ul class="submenu">

        
  <li class="item">
    <a href="/archives/" rel="section"><i class="ic i-list-alt"></i>Archives</a>
  </li>

        
  <li class="item">
    <a href="/categories/" rel="section"><i class="ic i-th"></i>Categories</a>
  </li>

        
  <li class="item">
    <a href="/tags/" rel="section"><i class="ic i-tags"></i>Tags</a>
  </li>

  </ul>
    
  <li class="item">
    <a href="/friends/" rel="section"><i class="ic i-heart"></i>Friends</a>
  </li>

    
  <li class="item">
    <a href="/anime/" rel="section"><i class="ic i-magic"></i>Anime</a>
  </li>


</ul>

      </div>
    </div>
  </div>

  <ul id="quick">
    <li class="prev pjax">
        <a href="/2023/04/01/c-main/" rel="prev" title="Previous Post"><i class="ic i-chevron-left"></i></a>
    </li>
    <li class="up"><i class="ic i-arrow-up"></i></li>
    <li class="down"><i class="ic i-arrow-down"></i></li>
    <li class="next pjax">
        <a href="/2023/04/11/oracle-random/" rel="next" title="Next Post"><i class="ic i-chevron-right"></i></a>
    </li>
    <li class="percent"></li>
  </ul>
</div>


        </div>
        <div class="dimmer"></div>
      </div>
    </main>
    <footer id="footer">
      <div class="inner">
        <div class="widgets">
          

        </div>
        <div class="status">
  <div class="copyright">
    
    &copy; 2010 – 
    <span itemprop="copyrightYear">2024</span>
    <span class="with-love">
      <i class="ic i-sakura rotate"></i>
    </span>
    <span class="author" itemprop="copyrightHolder">江边鸟 @ D E W</span>
  </div>
  <div class="powered-by">
    Powered by <span class="exturl" data-url="aHR0cHM6Ly9oZXhvLmlv">Hexo</span> & Theme.<span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL2FtZWhpbWUvaGV4by10aGVtZS1zaG9rYQ==">Shoka</span>
  </div>
</div>

      </div>
    </footer>
  </div>
<script data-config type="text/javascript">
  var LOCAL = {
    path: '2023/04/11/oracle-rollup-cube-grouping-sets/',
    favicon: {
      show: "（●´3｀●）Goooood",
      hide: "(´Д｀)Booooom"
    },
    search : {
      placeholder: "Search for Posts",
      empty: "We didn't find any results for the search: ${query}",
      stats: "${hits} results found in ${time} ms"
    },
    valine: true,fancybox: true,
    ignores : [
      function(uri) {
        return uri.includes('#');
      },
      function(uri) {
        return new RegExp(LOCAL.path+"$").test(uri);
      }
    ]
  };
</script>

<script src="https://cdn.polyfill.io/v2/polyfill.js"></script>

<script src="//cdn.jsdelivr.net/combine/npm/pace-js@1.0.2/pace.min.js,npm/pjax@0.2.8/pjax.min.js,npm/whatwg-fetch@3.4.0/dist/fetch.umd.min.js,npm/animejs@3.2.0/lib/anime.min.js,npm/algoliasearch@4/dist/algoliasearch-lite.umd.js,npm/instantsearch.js@4/dist/instantsearch.production.min.js,npm/lozad@1/dist/lozad.min.js,npm/quicklink@2/dist/quicklink.umd.js"></script>

<script src="/js/app.js?v=0.2.5"></script>




</body>
</html>
