



<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#FFF">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">

<link rel="icon" type="image/ico" sizes="32x32" href="/images/favicon.ico">
  <meta http-equiv="Cache-Control" content="no-transform">
  <meta http-equiv="Cache-Control" content="no-siteapp">


<link rel="alternate" type="application/rss+xml" title="Èú≤„ÅÆ‰∏ñ" href="https://lhchen74.github.io/rss.xml" />
<link rel="alternate" type="application/atom+xml" title="Èú≤„ÅÆ‰∏ñ" href="https://lhchen74.github.io/atom.xml" />
<link rel="alternate" type="application/json" title="Èú≤„ÅÆ‰∏ñ" href="https://lhchen74.github.io/feed.json" />

<link rel="stylesheet" href="//fonts.googleapis.com/css?family=Mulish:300,300italic,400,400italic,700,700italic%7CFredericka%20the%20Great:300,300italic,400,400italic,700,700italic%7CNoto%20Serif%20JP:300,300italic,400,400italic,700,700italic%7CNoto%20Serif%20SC:300,300italic,400,400italic,700,700italic%7CFira%20Code:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext">

<link rel="stylesheet" href="/css/app.css?v=0.2.5">

  
  <meta name="keywords" content="js" />


<link rel="canonical" href="https://lhchen74.github.io/2024/04/28/bun-elysia/">



  <title>
Create a CRUD App with Bun and Elysia.js |
D E W = Èú≤„ÅÆ‰∏ñ</title>
<meta name="generator" content="Hexo 5.4.2"></head>
<body itemscope itemtype="http://schema.org/WebPage">
  <div id="loading">
    <div class="cat">
      <div class="body"></div>
      <div class="head">
        <div class="face"></div>
      </div>
      <div class="foot">
        <div class="tummy-end"></div>
        <div class="bottom"></div>
        <div class="legs left"></div>
        <div class="legs right"></div>
      </div>
      <div class="paw">
        <div class="hands left"></div>
        <div class="hands right"></div>
      </div>
    </div>
  </div>
  <div id="container">
    <header id="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="inner">
        <div id="brand">
          <div class="pjax">
          
  <h1 itemprop="name headline">Create a CRUD App with Bun and Elysia.js
  </h1>
  
<div class="meta">
  <span class="item" title="Created: 2024-04-28 00:00:00">
    <span class="icon">
      <i class="ic i-calendar"></i>
    </span>
    <span class="text">Posted on</span>
    <time itemprop="dateCreated datePublished" datetime="2024-04-28T00:00:00+08:00">2024-04-28</time>
  </span>
</div>


          </div>
        </div>
        <nav id="nav">
  <div class="inner">
    <div class="toggle">
      <div class="lines" aria-label="Toggle navigation bar">
        <span class="line"></span>
        <span class="line"></span>
        <span class="line"></span>
      </div>
    </div>
    <ul class="menu">
      <li class="item title"><a href="/" rel="start">D E W</a></li>
    </ul>
    <ul class="right">
      <li class="item theme">
        <i class="ic i-sun"></i>
      </li>
      <li class="item search">
        <i class="ic i-search"></i>
      </li>
    </ul>
  </div>
</nav>

      </div>
      <div id="imgs" class="pjax">
        <ul>
          <li class="item" data-background-image="/anime/index/ÁÅºÁúºÁöÑÂ§èÂ®ú.jpg"></li>
          <li class="item" data-background-image="/anime/index/ÈªÑÈáëÁ•ûÂ®Å.jpg"></li>
          <li class="item" data-background-image="/anime/index/Ëê§ÁÅ´‰πãÊ£Æ.jpg"></li>
          <li class="item" data-background-image="/anime/index/ÈΩêÊú®Ê•†ÈõÑÁöÑÁÅæÈöæ.jpg"></li>
          <li class="item" data-background-image="/anime/index/ÁôæÂèòÁã∏Áå´-1.jpg"></li>
          <li class="item" data-background-image="/anime/index/ÈªëÂ≠êÁöÑÁØÆÁêÉ.jpg"></li>
        </ul>
      </div>
    </header>
    <div id="waves">
      <svg class="waves" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 24 150 28" preserveAspectRatio="none" shape-rendering="auto">
        <defs>
          <path id="gentle-wave" d="M-160 44c30 0 58-18 88-18s 58 18 88 18 58-18 88-18 58 18 88 18 v44h-352z" />
        </defs>
        <g class="parallax">
          <use xlink:href="#gentle-wave" x="48" y="0" />
          <use xlink:href="#gentle-wave" x="48" y="3" />
          <use xlink:href="#gentle-wave" x="48" y="5" />
          <use xlink:href="#gentle-wave" x="48" y="7" />
        </g>
      </svg>
    </div>
    <main>
      <div class="inner">
        <div id="main" class="pjax">
          
  <div class="article wrap">
    
<div class="breadcrumb" itemscope itemtype="https://schema.org/BreadcrumbList">
<i class="ic i-home"></i>
<span><a href="/">Home</a></span>
</div>

    <article itemscope itemtype="http://schema.org/Article" class="post block" lang="en">
  <link itemprop="mainEntityOfPage" href="https://lhchen74.github.io/2024/04/28/bun-elysia/">

  <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
    <meta itemprop="image" content="/images/avatar.jpg">
    <meta itemprop="name" content="Ê±üËæπÈ∏ü">
    <meta itemprop="description" content=", ">
  </span>

  <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
    <meta itemprop="name" content="Èú≤„ÅÆ‰∏ñ">
  </span>

  <div class="body md" itemprop="articleBody">
    

    <blockquote>
<p>repost: <span class="exturl" data-url="aHR0cHM6Ly9kZXYudG8vZ2F1cmlzaGhzL2NyZWF0ZS1hLWNydWQtYXBwLXdpdGgtYnVuLWFuZC1lbHlzaWFqcy1nam4=">Create a CRUD App with Bun and Elysia.js - DEV Community</span></p>
</blockquote>
<p>In this article we will be creating a crud web application with <span class="exturl" data-url="aHR0cHM6Ly9idW4uc2gv">Bun</span> and <span class="exturl" data-url="aHR0cHM6Ly9lbHlzaWFqcy5jb20v">Elysia.js</span></p>
<p>Before we start creating, Let‚Äôs get to know about Bun?</p>
<h2 id="what-is-bun"><a class="markdownIt-Anchor" href="#what-is-bun">#</a> What is Bun?</h2>
<p>Bun is an incredibly fast JavaScript runtime, bundler, transpiler and package manager similar to <span class="exturl" data-url="aHR0cHM6Ly9ub2RlanMub3JnLw==">Node.js</span> and <span class="exturl" data-url="aHR0cHM6Ly9kZW5vLmxhbmQv">Deno</span> . It has a lot of promising features (check them out on the <span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL292ZW4tc2gvYnVuL2lzc3Vlcy8xNTk=">Roadmap</span>) and aims to replace Node.js. It was created by <span class="exturl" data-url="aHR0cHM6Ly90d2l0dGVyLmNvbS9qYXJyZWRzdW1uZXI=">Jarred Sumner</span> in <span class="exturl" data-url="aHR0cDovL3ppZ2xhbmcub3JnLw==">Zig</span> and uses <span class="exturl" data-url="aHR0cHM6Ly9kZXZlbG9wZXIuYXBwbGUuY29tL2RvY3VtZW50YXRpb24vamF2YXNjcmlwdGNvcmU=">JavaScript core</span> instead of <span class="exturl" data-url="aHR0cHM6Ly92OC5kZXYv">v8</span></p>
<p>The cool thing about this is it has built-in TypeScript support, Yes you no longer need tsc, Moreover you can write packages in Typescript and publish it to the NPM Registry as-is, Though your package will then be limited to Bun users.</p>
<p>The benchmarks can be seen on the website</p>
<p>Let‚Äôs install Bun now,</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl -fsSL https://bun.sh/install | bash</span><br></pre></td></tr></table></figure>
<p>Verify your install and let‚Äôs dive into creating the web application.</p>
<h2 id="creating-the-application"><a class="markdownIt-Anchor" href="#creating-the-application">#</a> Creating the Application</h2>
<p>First of all, Create a new directory and change your path to it and then run the  <code>bun init</code>  command.</p>
<p>It will create a Typescript based new project, Now let‚Äôs begin writing some code. Open the directory in your IDE (mine is <span class="exturl" data-url="aHR0cHM6Ly9jb2RlLnZpc3VhbHN0dWRpby5jb20v">VSCode</span>).</p>
<p>You‚Äôll see something like this:</p>
<img data-src="/2024/04/28/bun-elysia/4e5xrigb397ixcz1c6dg.png" class="">
<p>Now, Let‚Äôs install our dependencies:</p>
<ul>
<li><code>elysia</code>  - The web framework we‚Äôre using.</li>
<li><code>@elysiajs/html</code>  - HTML Plugin for the web framework</li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">bun a elysia @elysiajs/html</span><br></pre></td></tr></table></figure>
<p>Now‚Äôs let‚Äôs create the backend first, We‚Äôll create an api which can be called from the frontend to store,retrieve,edit and delete books stored in SQLite Database (BTW, Bun provides the fastest SQLite in JavaScript ecosystem)</p>
<p>We create a  <code>db.ts</code>  to store the Database stuff which should look like this:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; Database &#125; <span class="keyword">from</span> <span class="string">&#x27;bun:sqlite&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> interface Book &#123;</span><br><span class="line">    id?: number;</span><br><span class="line">    name: string;</span><br><span class="line">    author: string;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="class"><span class="keyword">class</span> <span class="title">BooksDatabase</span> </span>&#123;</span><br><span class="line">    private db: Database;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="title">constructor</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.db = <span class="keyword">new</span> Database(<span class="string">&#x27;books.db&#x27;</span>);</span><br><span class="line">        <span class="comment">// Initialize the database</span></span><br><span class="line">        <span class="built_in">this</span>.init()</span><br><span class="line">            .then(<span class="function">() =&gt;</span> <span class="built_in">console</span>.log(<span class="string">&#x27;Database initialized&#x27;</span>))</span><br><span class="line">            .catch(<span class="built_in">console</span>.error);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Get all books</span></span><br><span class="line">    <span class="keyword">async</span> <span class="function"><span class="title">getBooks</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">this</span>.db.query(<span class="string">&#x27;SELECT * FROM books&#x27;</span>).all();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Add a book</span></span><br><span class="line">    <span class="keyword">async</span> <span class="function"><span class="title">addBook</span>(<span class="params">book: Book</span>)</span> &#123;</span><br><span class="line">        <span class="comment">// q: Get id type safely</span></span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">this</span>.db.query(<span class="string">`INSERT INTO books (name, author) VALUES (?, ?) RETURNING id`</span>).get(book.name, book.author) <span class="keyword">as</span> Book;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Update a book</span></span><br><span class="line">    <span class="keyword">async</span> <span class="function"><span class="title">updateBook</span>(<span class="params">id: number, book: Book</span>)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">this</span>.db.run(<span class="string">`UPDATE books SET name = &#x27;<span class="subst">$&#123;book.name&#125;</span>&#x27;, author = &#x27;<span class="subst">$&#123;book.author&#125;</span>&#x27; WHERE id = <span class="subst">$&#123;id&#125;</span>`</span>)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Delete a book</span></span><br><span class="line">    <span class="keyword">async</span> <span class="function"><span class="title">deleteBook</span>(<span class="params">id: number</span>)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">this</span>.db.run(<span class="string">`DELETE FROM books WHERE id = <span class="subst">$&#123;id&#125;</span>`</span>)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Initialize the database</span></span><br><span class="line">    <span class="keyword">async</span> <span class="function"><span class="title">init</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">this</span>.db.run(<span class="string">&#x27;CREATE TABLE IF NOT EXISTS books (id INTEGER PRIMARY KEY AUTOINCREMENT, name TEXT, author TEXT)&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>Here, We create a class  <code>BooksDatabase</code>  and create a  <code>Database</code>  instance in it, Add methods to create,retrieve,edit books and initialize the database (create tables).</p>
<p>What does each function do?</p>
<ul>
<li><code>addBook</code>  - Creates a new book in the database and return the autoincremented id</li>
<li><code>getBooks</code>  - Get all the books in the database</li>
<li><code>updateBook</code>  - Update a existing book in the database</li>
<li><code>deleteBook</code>  - Delete a book from the database</li>
</ul>
<p>Now, Let‚Äôs begin creating the API, Elysia is a minimalistic web framework and does not require any extra knowledge, It is full of awesome features, Check out the available plugins <span class="exturl" data-url="aHR0cHM6Ly9lbHlzaWFqcy5jb20vY29sbGVjdGlvbnMvcGx1Z2lucy5odG1s">here</span></p>
<p>We start with this:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; Elysia &#125; <span class="keyword">from</span> <span class="string">&quot;elysia&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; html &#125; <span class="keyword">from</span> <span class="string">&quot;@elysiajs/html&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; BooksDatabase &#125; <span class="keyword">from</span> <span class="string">&quot;./db.js&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">new</span> Elysia().use(html()).decorate(<span class="string">&quot;db&quot;</span>, <span class="keyword">new</span> BooksDatabase()).listen(<span class="number">3000</span>);</span><br></pre></td></tr></table></figure>
<p>Create a new Elysia instance, Inject the html plugin and add a new  <code>db</code>  property which can accessed by our route handlers.</p>
<p>Now, let‚Äôs start creating the routes</p>
<p>First, Let‚Äôs create a  <code>index.html</code>  file which will contain our main site</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>My Bookstore<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;/script.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">h1</span>&gt;</span>My Bookstore<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">button</span> <span class="attr">onclick</span>=<span class="string">&quot;addNewBook()&quot;</span> <span class="attr">type</span>=<span class="string">&quot;button&quot;</span>&gt;</span>Add Book<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">button</span> <span class="attr">onclick</span>=<span class="string">&quot;deleteBook()&quot;</span> <span class="attr">type</span>=<span class="string">&quot;button&quot;</span>&gt;</span>Remove Book<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">button</span> <span class="attr">onclick</span>=<span class="string">&quot;updateBook()&quot;</span> <span class="attr">type</span>=<span class="string">&quot;button&quot;</span>&gt;</span>Update Book<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">ul</span> <span class="attr">id</span>=<span class="string">&quot;bookList&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>This is a simple overview of how the file will look, Make sure to add  <code>&lt;!DOCTYPE html&gt;</code>  in the starting of the file so that the html plugin can add the Content type header.</p>
<p>Now, moving back to our  <code>index.ts</code>  we create a route to serve this  <code>index.html</code> . Elysia provides a static plugin as well which we won‚Äôt use since we have only 2 static files.</p>
<p>Create a new  <code>GET</code>  route which will read  <code>index.html</code>  file and send the text</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; Elysia &#125; <span class="keyword">from</span> <span class="string">&quot;elysia&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; html &#125; <span class="keyword">from</span> <span class="string">&quot;@elysiajs/html&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; BooksDatabase &#125; <span class="keyword">from</span> <span class="string">&quot;./db.js&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">new</span> Elysia()</span><br><span class="line">  .use(html())</span><br><span class="line">  .decorate(<span class="string">&quot;db&quot;</span>, <span class="keyword">new</span> BooksDatabase())</span><br><span class="line">  .get(<span class="string">&quot;/&quot;</span>, <span class="function">() =&gt;</span> Bun.file(<span class="string">&quot;index.html&quot;</span>).text())</span><br><span class="line">  .listen(<span class="number">3000</span>);</span><br></pre></td></tr></table></figure>
<p>Create a  <code>script.js</code>  route and add a route for the same</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; Elysia &#125; <span class="keyword">from</span> <span class="string">&quot;elysia&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; html &#125; <span class="keyword">from</span> <span class="string">&quot;@elysiajs/html&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; BooksDatabase &#125; <span class="keyword">from</span> <span class="string">&quot;./db.js&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">new</span> Elysia()</span><br><span class="line">  .use(html())</span><br><span class="line">  .decorate(<span class="string">&quot;db&quot;</span>, <span class="keyword">new</span> BooksDatabase())</span><br><span class="line">  .get(<span class="string">&quot;/&quot;</span>, <span class="function">() =&gt;</span> Bun.file(<span class="string">&quot;index.html&quot;</span>).text())</span><br><span class="line">  .get(<span class="string">&quot;/script.js&quot;</span>, <span class="function">() =&gt;</span> Bun.file(<span class="string">&quot;script.js&quot;</span>).text())</span><br><span class="line">  .listen(<span class="number">3000</span>);</span><br></pre></td></tr></table></figure>
<p>Now, Let‚Äôs create the database routes,</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; Elysia &#125; <span class="keyword">from</span> <span class="string">&quot;elysia&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; html &#125; <span class="keyword">from</span> <span class="string">&quot;@elysiajs/html&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; BooksDatabase &#125; <span class="keyword">from</span> <span class="string">&quot;./db.js&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">new</span> Elysia()</span><br><span class="line">  .use(html())</span><br><span class="line">  .decorate(<span class="string">&quot;db&quot;</span>, <span class="keyword">new</span> BooksDatabase())</span><br><span class="line">  .get(<span class="string">&quot;/&quot;</span>, <span class="function">() =&gt;</span> Bun.file(<span class="string">&quot;index.html&quot;</span>).text())</span><br><span class="line">  .get(<span class="string">&quot;/script.js&quot;</span>, <span class="function">() =&gt;</span> Bun.file(<span class="string">&quot;script.js&quot;</span>).text())</span><br><span class="line">  .get(<span class="string">&quot;/books&quot;</span>, <span class="function">(<span class="params">&#123; db &#125;</span>) =&gt;</span> db.getBooks())</span><br><span class="line">  .listen(<span class="number">3000</span>);</span><br></pre></td></tr></table></figure>
<p>Notice the db autocomplete in the handler üòÉ</p>
<img data-src="/2024/04/28/bun-elysia/pb3h9gjsx1rl7jzhjctl.png" class="">
<p>Create routes for creating a book</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; Elysia, t &#125; <span class="keyword">from</span> <span class="string">&quot;elysia&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; html &#125; <span class="keyword">from</span> <span class="string">&quot;@elysiajs/html&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; BooksDatabase &#125; <span class="keyword">from</span> <span class="string">&quot;./db.js&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">new</span> Elysia()</span><br><span class="line">  .use(html())</span><br><span class="line">  .decorate(<span class="string">&quot;db&quot;</span>, <span class="keyword">new</span> BooksDatabase())</span><br><span class="line">  .get(<span class="string">&quot;/&quot;</span>, <span class="function">() =&gt;</span> Bun.file(<span class="string">&quot;index.html&quot;</span>).text())</span><br><span class="line">  .get(<span class="string">&quot;/script.js&quot;</span>, <span class="function">() =&gt;</span> Bun.file(<span class="string">&quot;script.js&quot;</span>).text())</span><br><span class="line">  .get(<span class="string">&quot;/books&quot;</span>, <span class="function">(<span class="params">&#123; db &#125;</span>) =&gt;</span> db.getBooks())</span><br><span class="line">  .post(</span><br><span class="line">    <span class="string">&quot;/books&quot;</span>,</span><br><span class="line">    <span class="keyword">async</span> (&#123; db, body &#125;) =&gt; &#123;</span><br><span class="line">      <span class="built_in">console</span>.log(body);</span><br><span class="line">      <span class="keyword">const</span> id = (<span class="keyword">await</span> db.addBook(body)).id;</span><br><span class="line">      <span class="built_in">console</span>.log(id);</span><br><span class="line">      <span class="keyword">return</span> &#123; <span class="attr">success</span>: <span class="literal">true</span>, id &#125;;</span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      schema: &#123;</span><br><span class="line">        body: t.Object(&#123;</span><br><span class="line">          name: t.String(),</span><br><span class="line">          author: t.String(),</span><br><span class="line">        &#125;),</span><br><span class="line">      &#125;,</span><br><span class="line">    &#125;</span><br><span class="line">  )</span><br><span class="line"></span><br><span class="line">  .listen(<span class="number">3000</span>);</span><br></pre></td></tr></table></figure>
<p>Notice the schema validation, Elysia provides schema validation out of the box powered by  <code>@sinclair/typebox</code> , Read more about this <span class="exturl" data-url="aHR0cHM6Ly9lbHlzaWFqcy5jb20vY29uY2VwdC9zY2hlbWEuaHRtbA==">here</span></p>
<p>Now, let‚Äôs create the remaining delete and put routes</p>
<p>After which your file should look like this:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; Elysia, t &#125; <span class="keyword">from</span> <span class="string">&quot;elysia&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; BooksDatabase &#125; <span class="keyword">from</span> <span class="string">&quot;./db.js&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; html &#125; <span class="keyword">from</span> <span class="string">&quot;@elysiajs/html&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">new</span> Elysia()</span><br><span class="line">  .use(html())</span><br><span class="line">  .decorate(<span class="string">&quot;db&quot;</span>, <span class="keyword">new</span> BooksDatabase())</span><br><span class="line">  .get(<span class="string">&quot;/&quot;</span>, <span class="function">() =&gt;</span> Bun.file(<span class="string">&quot;index.html&quot;</span>).text())</span><br><span class="line">  .get(<span class="string">&quot;/script.js&quot;</span>, <span class="function">() =&gt;</span> Bun.file(<span class="string">&quot;script.js&quot;</span>).text())</span><br><span class="line">  .get(<span class="string">&quot;/books&quot;</span>, <span class="function">(<span class="params">&#123; db &#125;</span>) =&gt;</span> db.getBooks())</span><br><span class="line">  .post(</span><br><span class="line">    <span class="string">&quot;/books&quot;</span>,</span><br><span class="line">    <span class="keyword">async</span> (&#123; db, body &#125;) =&gt; &#123;</span><br><span class="line">      <span class="keyword">const</span> id = (<span class="keyword">await</span> db.addBook(body)).id;</span><br><span class="line">      <span class="keyword">return</span> &#123; <span class="attr">success</span>: <span class="literal">true</span>, id &#125;;</span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      schema: &#123;</span><br><span class="line">        body: t.Object(&#123;</span><br><span class="line">          name: t.String(),</span><br><span class="line">          author: t.String(),</span><br><span class="line">        &#125;),</span><br><span class="line">      &#125;,</span><br><span class="line">    &#125;</span><br><span class="line">  )</span><br><span class="line">  .put(</span><br><span class="line">    <span class="string">&quot;/books/:id&quot;</span>,</span><br><span class="line">    (&#123; db, params, body &#125;) =&gt; &#123;</span><br><span class="line">      <span class="keyword">try</span> &#123;</span><br><span class="line">        db.updateBook(<span class="built_in">parseInt</span>(params.id), body);</span><br><span class="line">        <span class="keyword">return</span> &#123; <span class="attr">success</span>: <span class="literal">true</span> &#125;;</span><br><span class="line">      &#125; <span class="keyword">catch</span> (e) &#123;</span><br><span class="line">        <span class="keyword">return</span> &#123; <span class="attr">success</span>: <span class="literal">false</span> &#125;;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      schema: &#123;</span><br><span class="line">        body: t.Object(&#123;</span><br><span class="line">          name: t.String(),</span><br><span class="line">          author: t.String(),</span><br><span class="line">        &#125;),</span><br><span class="line">      &#125;,</span><br><span class="line">    &#125;</span><br><span class="line">  )</span><br><span class="line">  .delete(<span class="string">&quot;/books/:id&quot;</span>, <span class="function">(<span class="params">&#123; db, params &#125;</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">      db.deleteBook(<span class="built_in">parseInt</span>(params.id));</span><br><span class="line">      <span class="keyword">return</span> &#123; <span class="attr">success</span>: <span class="literal">true</span> &#125;;</span><br><span class="line">    &#125; <span class="keyword">catch</span> (e) &#123;</span><br><span class="line">      <span class="keyword">return</span> &#123; <span class="attr">success</span>: <span class="literal">false</span> &#125;;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;)</span><br><span class="line">  .listen(<span class="number">3000</span>);</span><br></pre></td></tr></table></figure>
<p>Let‚Äôs create the  <code>script.js</code>  now:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">window</span>.addEventListener(</span><br><span class="line">  <span class="string">&quot;DOMContentLoaded&quot;</span>,</span><br><span class="line">  <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    fetch(<span class="string">&quot;/books&quot;</span>, &#123;</span><br><span class="line">      method: <span class="string">&quot;GET&quot;</span>,</span><br><span class="line">      headers: &#123;</span><br><span class="line">        <span class="string">&quot;Content-Type&quot;</span>: <span class="string">&quot;application/json&quot;</span>,</span><br><span class="line">      &#125;,</span><br><span class="line">    &#125;)</span><br><span class="line">      .then(<span class="function">(<span class="params">res</span>) =&gt;</span> res.json())</span><br><span class="line">      .then(<span class="function">(<span class="params">books</span>) =&gt;</span> &#123;</span><br><span class="line">        <span class="built_in">document</span>.getElementById(<span class="string">&quot;bookList&quot;</span>).innerHTML = books</span><br><span class="line">          .map(<span class="function">(<span class="params">book</span>) =&gt;</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="string">`</span></span><br><span class="line"><span class="string">                &lt;li id=&quot;<span class="subst">$&#123;book.id&#125;</span>&quot;&gt;</span></span><br><span class="line"><span class="string">                    ID: <span class="subst">$&#123;book.id&#125;</span> &lt;br&gt; Name: <span class="subst">$&#123;book.name&#125;</span> &lt;br&gt; Author: <span class="subst">$&#123;book.author&#125;</span></span></span><br><span class="line"><span class="string">                &lt;/li&gt;</span></span><br><span class="line"><span class="string">            `</span>;</span><br><span class="line">          &#125;)</span><br><span class="line">          .join(<span class="string">&quot;&quot;</span>);</span><br><span class="line">      &#125;);</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="literal">false</span></span><br><span class="line">);</span><br></pre></td></tr></table></figure>
<p>Whenever the page is loaded, Fetch the books and add them to the unordered list</p>
<p>Create the new  <code>addNewBook</code>  function which prompts the user for book name and author then makes the request to api to save it in the database</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> addNewBook = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> newBook = prompt(<span class="string">&quot;Book name &amp; author (separated by a comma)&quot;</span>);</span><br><span class="line">  <span class="keyword">if</span> (newBook) &#123;</span><br><span class="line">    <span class="keyword">const</span> [name, author] = newBook.split(<span class="string">&quot;,&quot;</span>);</span><br><span class="line">    fetch(<span class="string">&quot;/books&quot;</span>, &#123;</span><br><span class="line">      method: <span class="string">&quot;POST&quot;</span>,</span><br><span class="line">      headers: &#123;</span><br><span class="line">        <span class="string">&quot;Content-Type&quot;</span>: <span class="string">&quot;application/json&quot;</span>,</span><br><span class="line">      &#125;,</span><br><span class="line">      body: <span class="built_in">JSON</span>.stringify(&#123; name, author &#125;),</span><br><span class="line">    &#125;)</span><br><span class="line">      .then(<span class="function">(<span class="params">res</span>) =&gt;</span> res.json())</span><br><span class="line">      .then(<span class="function">(<span class="params">res</span>) =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (res.success) &#123;</span><br><span class="line">          <span class="built_in">document</span>.getElementById(<span class="string">&quot;bookList&quot;</span>).innerHTML += <span class="string">`</span></span><br><span class="line"><span class="string">                    &lt;li id=&quot;<span class="subst">$&#123;res.id&#125;</span>&quot;&gt;</span></span><br><span class="line"><span class="string">                        ID: <span class="subst">$&#123;res.id&#125;</span> Name: <span class="subst">$&#123;name&#125;</span> &lt;br&gt; Author: <span class="subst">$&#123;author&#125;</span></span></span><br><span class="line"><span class="string">                    &lt;/li&gt;</span></span><br><span class="line"><span class="string">                `</span>;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p>Create the remaining functions  <code>updateBook</code>   <code>deleteBook</code></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> deleteBook = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> bookPrompt = prompt(<span class="string">&quot;Book ID&quot;</span>);</span><br><span class="line">  <span class="keyword">if</span> (!bookPrompt) <span class="keyword">return</span> alert(<span class="string">&quot;Invalid book ID&quot;</span>);</span><br><span class="line">  <span class="keyword">const</span> bookId = <span class="built_in">parseInt</span>(bookPrompt);</span><br><span class="line">  <span class="keyword">if</span> (bookId) &#123;</span><br><span class="line">    fetch(<span class="string">`/books/<span class="subst">$&#123;bookId&#125;</span>`</span>, &#123;</span><br><span class="line">      method: <span class="string">&quot;DELETE&quot;</span>,</span><br><span class="line">    &#125;)</span><br><span class="line">      .then(<span class="function">(<span class="params">res</span>) =&gt;</span> res.json())</span><br><span class="line">      .then(<span class="function">(<span class="params">res</span>) =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (res.success) &#123;</span><br><span class="line">          <span class="built_in">document</span>.getElementById(bookId).remove();</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> updateBook = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> bookPrompt = prompt(<span class="string">&quot;Book ID&quot;</span>);</span><br><span class="line">  <span class="keyword">if</span> (!bookPrompt) <span class="keyword">return</span> alert(<span class="string">&quot;Invalid book ID&quot;</span>);</span><br><span class="line">  <span class="keyword">const</span> bookId = <span class="built_in">parseInt</span>(bookPrompt);</span><br><span class="line">  <span class="keyword">if</span> (bookId) &#123;</span><br><span class="line">    <span class="keyword">const</span> newBook = prompt(<span class="string">&quot;Book name &amp; author (separated by a comma)&quot;</span>);</span><br><span class="line">    <span class="keyword">if</span> (newBook) &#123;</span><br><span class="line">      <span class="keyword">const</span> [name, author] = newBook.split(<span class="string">&quot;,&quot;</span>);</span><br><span class="line">      fetch(<span class="string">`/books/<span class="subst">$&#123;bookId&#125;</span>`</span>, &#123;</span><br><span class="line">        method: <span class="string">&quot;PUT&quot;</span>,</span><br><span class="line">        headers: &#123;</span><br><span class="line">          <span class="string">&quot;Content-Type&quot;</span>: <span class="string">&quot;application/json&quot;</span>,</span><br><span class="line">        &#125;,</span><br><span class="line">        body: <span class="built_in">JSON</span>.stringify(&#123; name, author &#125;),</span><br><span class="line">      &#125;)</span><br><span class="line">        .then(<span class="function">(<span class="params">res</span>) =&gt;</span> res.json())</span><br><span class="line">        .then(<span class="function">(<span class="params">res</span>) =&gt;</span> &#123;</span><br><span class="line">          <span class="keyword">if</span> (res.success) &#123;</span><br><span class="line">            <span class="built_in">document</span>.getElementById(bookId).innerHTML = <span class="string">`</span></span><br><span class="line"><span class="string">                        ID: <span class="subst">$&#123;bookId&#125;</span> &lt;br&gt; Name: <span class="subst">$&#123;name&#125;</span> &lt;br&gt; Author: <span class="subst">$&#123;author&#125;</span></span></span><br><span class="line"><span class="string">                    `</span>;</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p>After all this, Your file should look like this</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">window</span>.addEventListener(</span><br><span class="line">  <span class="string">&quot;DOMContentLoaded&quot;</span>,</span><br><span class="line">  <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    fetch(<span class="string">&quot;/books&quot;</span>, &#123;</span><br><span class="line">      method: <span class="string">&quot;GET&quot;</span>,</span><br><span class="line">      headers: &#123;</span><br><span class="line">        <span class="string">&quot;Content-Type&quot;</span>: <span class="string">&quot;application/json&quot;</span>,</span><br><span class="line">      &#125;,</span><br><span class="line">    &#125;)</span><br><span class="line">      .then(<span class="function">(<span class="params">res</span>) =&gt;</span> res.json())</span><br><span class="line">      .then(<span class="function">(<span class="params">books</span>) =&gt;</span> &#123;</span><br><span class="line">        <span class="built_in">document</span>.getElementById(<span class="string">&quot;bookList&quot;</span>).innerHTML = books</span><br><span class="line">          .map(<span class="function">(<span class="params">book</span>) =&gt;</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="string">`</span></span><br><span class="line"><span class="string">                &lt;li id=&quot;<span class="subst">$&#123;book.id&#125;</span>&quot;&gt;</span></span><br><span class="line"><span class="string">                    ID: <span class="subst">$&#123;book.id&#125;</span> &lt;br&gt; Name: <span class="subst">$&#123;book.name&#125;</span> &lt;br&gt; Author: <span class="subst">$&#123;book.author&#125;</span></span></span><br><span class="line"><span class="string">                &lt;/li&gt;</span></span><br><span class="line"><span class="string">            `</span>;</span><br><span class="line">          &#125;)</span><br><span class="line">          .join(<span class="string">&quot;&quot;</span>);</span><br><span class="line">      &#125;);</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="literal">false</span></span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> addNewBook = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> newBook = prompt(<span class="string">&quot;Book name &amp; author (separated by a comma)&quot;</span>);</span><br><span class="line">  <span class="keyword">if</span> (newBook) &#123;</span><br><span class="line">    <span class="keyword">const</span> [name, author] = newBook.split(<span class="string">&quot;,&quot;</span>);</span><br><span class="line">    fetch(<span class="string">&quot;/books&quot;</span>, &#123;</span><br><span class="line">      method: <span class="string">&quot;POST&quot;</span>,</span><br><span class="line">      headers: &#123;</span><br><span class="line">        <span class="string">&quot;Content-Type&quot;</span>: <span class="string">&quot;application/json&quot;</span>,</span><br><span class="line">      &#125;,</span><br><span class="line">      body: <span class="built_in">JSON</span>.stringify(&#123; name, author &#125;),</span><br><span class="line">    &#125;)</span><br><span class="line">      .then(<span class="function">(<span class="params">res</span>) =&gt;</span> res.json())</span><br><span class="line">      .then(<span class="function">(<span class="params">res</span>) =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (res.success) &#123;</span><br><span class="line">          <span class="built_in">document</span>.getElementById(<span class="string">&quot;bookList&quot;</span>).innerHTML += <span class="string">`</span></span><br><span class="line"><span class="string">                    &lt;li id=&quot;<span class="subst">$&#123;res.id&#125;</span>&quot;&gt;</span></span><br><span class="line"><span class="string">                        ID: <span class="subst">$&#123;res.id&#125;</span> Name: <span class="subst">$&#123;name&#125;</span> &lt;br&gt; Author: <span class="subst">$&#123;author&#125;</span></span></span><br><span class="line"><span class="string">                    &lt;/li&gt;</span></span><br><span class="line"><span class="string">                `</span>;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> deleteBook = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> bookPrompt = prompt(<span class="string">&quot;Book ID&quot;</span>);</span><br><span class="line">  <span class="keyword">if</span> (!bookPrompt) <span class="keyword">return</span> alert(<span class="string">&quot;Invalid book ID&quot;</span>);</span><br><span class="line">  <span class="keyword">const</span> bookId = <span class="built_in">parseInt</span>(bookPrompt);</span><br><span class="line">  <span class="keyword">if</span> (bookId) &#123;</span><br><span class="line">    fetch(<span class="string">`/books/<span class="subst">$&#123;bookId&#125;</span>`</span>, &#123;</span><br><span class="line">      method: <span class="string">&quot;DELETE&quot;</span>,</span><br><span class="line">    &#125;)</span><br><span class="line">      .then(<span class="function">(<span class="params">res</span>) =&gt;</span> res.json())</span><br><span class="line">      .then(<span class="function">(<span class="params">res</span>) =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (res.success) &#123;</span><br><span class="line">          <span class="built_in">document</span>.getElementById(bookId).remove();</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> updateBook = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> bookPrompt = prompt(<span class="string">&quot;Book ID&quot;</span>);</span><br><span class="line">  <span class="keyword">if</span> (!bookPrompt) <span class="keyword">return</span> alert(<span class="string">&quot;Invalid book ID&quot;</span>);</span><br><span class="line">  <span class="keyword">const</span> bookId = <span class="built_in">parseInt</span>(bookPrompt);</span><br><span class="line">  <span class="keyword">if</span> (bookId) &#123;</span><br><span class="line">    <span class="keyword">const</span> newBook = prompt(<span class="string">&quot;Book name &amp; author (separated by a comma)&quot;</span>);</span><br><span class="line">    <span class="keyword">if</span> (newBook) &#123;</span><br><span class="line">      <span class="keyword">const</span> [name, author] = newBook.split(<span class="string">&quot;,&quot;</span>);</span><br><span class="line">      fetch(<span class="string">`/books/<span class="subst">$&#123;bookId&#125;</span>`</span>, &#123;</span><br><span class="line">        method: <span class="string">&quot;PUT&quot;</span>,</span><br><span class="line">        headers: &#123;</span><br><span class="line">          <span class="string">&quot;Content-Type&quot;</span>: <span class="string">&quot;application/json&quot;</span>,</span><br><span class="line">        &#125;,</span><br><span class="line">        body: <span class="built_in">JSON</span>.stringify(&#123; name, author &#125;),</span><br><span class="line">      &#125;)</span><br><span class="line">        .then(<span class="function">(<span class="params">res</span>) =&gt;</span> res.json())</span><br><span class="line">        .then(<span class="function">(<span class="params">res</span>) =&gt;</span> &#123;</span><br><span class="line">          <span class="keyword">if</span> (res.success) &#123;</span><br><span class="line">            <span class="built_in">document</span>.getElementById(bookId).innerHTML = <span class="string">`</span></span><br><span class="line"><span class="string">                        ID: <span class="subst">$&#123;bookId&#125;</span> &lt;br&gt; Name: <span class="subst">$&#123;name&#125;</span> &lt;br&gt; Author: <span class="subst">$&#123;author&#125;</span></span></span><br><span class="line"><span class="string">                    `</span>;</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p>Time to experiment the api, Start the server using  <code>bun index.ts</code>  It should log Database initialized and create the  <code>books.db</code>  file</p>
<p>Head to  <code>localhost:3000</code></p>
<p>This is what you should see:</p>
<img data-src="/2024/04/28/bun-elysia/ix7yoy4msb14oakhb15w.png" class="">

      <div class="tags">
          <a href="/tags/js/" rel="tag"><i class="ic i-tag"></i> js</a>
      </div>
  </div>

   <footer>

    <div class="meta">
  <span class="item">
    <span class="icon">
      <i class="ic i-calendar-check"></i>
    </span>
    <span class="text">Edited on</span>
    <time title="Modified: 2024-05-27 10:18:24" itemprop="dateModified" datetime="2024-05-27T10:18:24+08:00">2024-05-27</time>
  </span>
</div>

      

  </footer>

</article>

  </div>
  

<div class="post-nav">
    <div class="item left">
      

  <a href="/2024/04/28/bun-express/" itemprop="url" rel="prev" data-background-image="&#x2F;anime&#x2F;index&#x2F;ÂÄü‰∏úË•øÁöÑÂ∞è‰∫∫ÈòøËéâÂüÉËíÇ-2.jpg" title="How To Build a Web API using Express.js, Bun and MongoDB?">
  <span class="type">Previous Post</span>
  <span class="category"><i class="ic i-flag"></i> </span>
  <h3>How To Build a Web API using Express.js, Bun and MongoDB?</h3>
  </a>

    </div>
    <div class="item right">
      

  <a href="/2024/05/23/csharp-wpf-crud/" itemprop="url" rel="next" data-background-image="&#x2F;anime&#x2F;index&#x2F;Ê®±Ëä±Â∫ÑÁöÑÂÆ†Áâ©Â•≥Â≠©.jpg" title="CRUD Operations in WPF using EntityFrameworkCore and SQLite">
  <span class="type">Next Post</span>
  <span class="category"><i class="ic i-flag"></i> </span>
  <h3>CRUD Operations in WPF using EntityFrameworkCore and SQLite</h3>
  </a>

    </div>
</div>

  
  <div class="wrap" id="comments"></div>


        </div>
        <div id="sidebar">
          

<div class="inner">

  <div class="panels">
    <div class="inner">
      <div class="contents panel pjax" data-title="Contents">
          <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#what-is-bun"><span class="toc-number">1.</span> <span class="toc-text"> What is Bun?</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#creating-the-application"><span class="toc-number">2.</span> <span class="toc-text"> Creating the Application</span></a></li></ol>
      </div>
      <div class="related panel pjax" data-title="Related">
      </div>
      <div class="overview panel" data-title="Overview">
        <div class="author" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <img class="image" itemprop="image" alt="Ê±üËæπÈ∏ü"
      data-src="/images/avatar.jpg">
  <p class="name" itemprop="name">Ê±üËæπÈ∏ü</p>
  <div class="description" itemprop="description"></div>
</div>

<nav class="state">
    <div class="item posts">
      <a href="/archives/">
        <span class="count">363</span>
        <span class="name">posts</span>
      </a>
    </div>
    <div class="item categories">
      <a href="/categories/">
        <span class="count">2</span>
        <span class="name">categories</span>
      </a>
    </div>
    <div class="item tags">
      <a href="/tags/">
        <span class="count">52</span>
        <span class="name">tags</span>
      </a>
    </div>
</nav>

<div class="social">
      <span class="exturl item github" data-url="aHR0cHM6Ly9naXRodWIuY29tL2xoY2hlbjc0" title="https:&#x2F;&#x2F;github.com&#x2F;lhchen74"><i class="ic i-github"></i></span>
      <span class="exturl item music" data-url="aHR0cHM6Ly9tdXNpYy4xNjMuY29tLw==" title="https:&#x2F;&#x2F;music.163.com&#x2F;"><i class="ic i-cloud-music"></i></span>
      <span class="exturl item codepen" data-url="aHR0cHM6Ly9jb2RlcGVuLmlvL2xoY2hlbjc0" title="https:&#x2F;&#x2F;codepen.io&#x2F;lhchen74"><i class="ic i-address-card"></i></span>
      <span class="exturl item anki" data-url="aHR0cHM6Ly9hbmtpd2ViLm5ldC9kZWNrcy8=" title="https:&#x2F;&#x2F;ankiweb.net&#x2F;decks&#x2F;"><i class="ic i-address-card"></i></span>
</div>

<ul class="menu">
  
    
  <li class="item">
    <a href="/" rel="section"><i class="ic i-home"></i>Home</a>
  </li>

    
  <li class="item">
    <a href="/about/" rel="section"><i class="ic i-user"></i>About</a>
  </li>

        
  <li class="item dropdown">
      <a href="javascript:void(0);"><i class="ic i-feather"></i>Posts</a>
    <ul class="submenu">

        
  <li class="item">
    <a href="/archives/" rel="section"><i class="ic i-list-alt"></i>Archives</a>
  </li>

        
  <li class="item">
    <a href="/categories/" rel="section"><i class="ic i-th"></i>Categories</a>
  </li>

        
  <li class="item">
    <a href="/tags/" rel="section"><i class="ic i-tags"></i>Tags</a>
  </li>

  </ul>
    
  <li class="item">
    <a href="/friends/" rel="section"><i class="ic i-heart"></i>Friends</a>
  </li>

    
  <li class="item">
    <a href="/anime/" rel="section"><i class="ic i-magic"></i>Anime</a>
  </li>


</ul>

      </div>
    </div>
  </div>

  <ul id="quick">
    <li class="prev pjax">
        <a href="/2024/04/28/bun-express/" rel="prev" title="Previous Post"><i class="ic i-chevron-left"></i></a>
    </li>
    <li class="up"><i class="ic i-arrow-up"></i></li>
    <li class="down"><i class="ic i-arrow-down"></i></li>
    <li class="next pjax">
        <a href="/2024/05/23/csharp-wpf-crud/" rel="next" title="Next Post"><i class="ic i-chevron-right"></i></a>
    </li>
    <li class="percent"></li>
  </ul>
</div>


        </div>
        <div class="dimmer"></div>
      </div>
    </main>
    <footer id="footer">
      <div class="inner">
        <div class="widgets">
          

        </div>
        <div class="status">
  <div class="copyright">
    
    &copy; 2010 ‚Äì 
    <span itemprop="copyrightYear">2024</span>
    <span class="with-love">
      <i class="ic i-sakura rotate"></i>
    </span>
    <span class="author" itemprop="copyrightHolder">Ê±üËæπÈ∏ü @ D E W</span>
  </div>
  <div class="powered-by">
    Powered by <span class="exturl" data-url="aHR0cHM6Ly9oZXhvLmlv">Hexo</span> & Theme.<span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL2FtZWhpbWUvaGV4by10aGVtZS1zaG9rYQ==">Shoka</span>
  </div>
</div>

      </div>
    </footer>
  </div>
<script data-config type="text/javascript">
  var LOCAL = {
    path: '2024/04/28/bun-elysia/',
    favicon: {
      show: "Ôºà‚óè¬¥3ÔΩÄ‚óèÔºâGoooood",
      hide: "(¬¥–îÔΩÄ)Booooom"
    },
    search : {
      placeholder: "Search for Posts",
      empty: "We didn't find any results for the search: ${query}",
      stats: "${hits} results found in ${time} ms"
    },
    valine: true,fancybox: true,
    ignores : [
      function(uri) {
        return uri.includes('#');
      },
      function(uri) {
        return new RegExp(LOCAL.path+"$").test(uri);
      }
    ]
  };
</script>

<script src="https://cdn.polyfill.io/v2/polyfill.js"></script>

<script src="//cdn.jsdelivr.net/combine/npm/pace-js@1.0.2/pace.min.js,npm/pjax@0.2.8/pjax.min.js,npm/whatwg-fetch@3.4.0/dist/fetch.umd.min.js,npm/animejs@3.2.0/lib/anime.min.js,npm/algoliasearch@4/dist/algoliasearch-lite.umd.js,npm/instantsearch.js@4/dist/instantsearch.production.min.js,npm/lozad@1/dist/lozad.min.js,npm/quicklink@2/dist/quicklink.umd.js"></script>

<script src="/js/app.js?v=0.2.5"></script>




</body>
</html>
