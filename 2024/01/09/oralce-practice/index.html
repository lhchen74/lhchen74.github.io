



<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#FFF">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">

<link rel="icon" type="image/ico" sizes="32x32" href="/images/favicon.ico">
  <meta http-equiv="Cache-Control" content="no-transform">
  <meta http-equiv="Cache-Control" content="no-siteapp">


<link rel="alternate" type="application/rss+xml" title="露の世" href="https://lhchen74.github.io/rss.xml" />
<link rel="alternate" type="application/atom+xml" title="露の世" href="https://lhchen74.github.io/atom.xml" />
<link rel="alternate" type="application/json" title="露の世" href="https://lhchen74.github.io/feed.json" />

<link rel="stylesheet" href="//fonts.googleapis.com/css?family=Mulish:300,300italic,400,400italic,700,700italic%7CFredericka%20the%20Great:300,300italic,400,400italic,700,700italic%7CNoto%20Serif%20JP:300,300italic,400,400italic,700,700italic%7CNoto%20Serif%20SC:300,300italic,400,400italic,700,700italic%7CFira%20Code:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext">

<link rel="stylesheet" href="/css/app.css?v=0.2.5">

  
  <meta name="keywords" content="db" />


<link rel="canonical" href="https://lhchen74.github.io/2024/01/09/oralce-practice/">



  <title>
Oracle SQL Practice |
D E W = 露の世</title>
<meta name="generator" content="Hexo 5.4.2"></head>
<body itemscope itemtype="http://schema.org/WebPage">
  <div id="loading">
    <div class="cat">
      <div class="body"></div>
      <div class="head">
        <div class="face"></div>
      </div>
      <div class="foot">
        <div class="tummy-end"></div>
        <div class="bottom"></div>
        <div class="legs left"></div>
        <div class="legs right"></div>
      </div>
      <div class="paw">
        <div class="hands left"></div>
        <div class="hands right"></div>
      </div>
    </div>
  </div>
  <div id="container">
    <header id="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="inner">
        <div id="brand">
          <div class="pjax">
          
  <h1 itemprop="name headline">Oracle SQL Practice
  </h1>
  
<div class="meta">
  <span class="item" title="Created: 2024-01-09 00:00:00">
    <span class="icon">
      <i class="ic i-calendar"></i>
    </span>
    <span class="text">Posted on</span>
    <time itemprop="dateCreated datePublished" datetime="2024-01-09T00:00:00+08:00">2024-01-09</time>
  </span>
</div>


          </div>
        </div>
        <nav id="nav">
  <div class="inner">
    <div class="toggle">
      <div class="lines" aria-label="Toggle navigation bar">
        <span class="line"></span>
        <span class="line"></span>
        <span class="line"></span>
      </div>
    </div>
    <ul class="menu">
      <li class="item title"><a href="/" rel="start">D E W</a></li>
    </ul>
    <ul class="right">
      <li class="item theme">
        <i class="ic i-sun"></i>
      </li>
      <li class="item search">
        <i class="ic i-search"></i>
      </li>
    </ul>
  </div>
</nav>

      </div>
      <div id="imgs" class="pjax">
        <ul>
          <li class="item" data-background-image="/anime/index/一周的朋友.jpg"></li>
          <li class="item" data-background-image="/anime/index/文学少女-2.jpg"></li>
          <li class="item" data-background-image="/anime/index/元气囝仔.jpg"></li>
          <li class="item" data-background-image="/anime/index/魔女宅急便-1.jpg"></li>
          <li class="item" data-background-image="/anime/index/可塑性记忆-2.jpg"></li>
          <li class="item" data-background-image="/anime/index/红猪-2.jpg"></li>
        </ul>
      </div>
    </header>
    <div id="waves">
      <svg class="waves" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 24 150 28" preserveAspectRatio="none" shape-rendering="auto">
        <defs>
          <path id="gentle-wave" d="M-160 44c30 0 58-18 88-18s 58 18 88 18 58-18 88-18 58 18 88 18 v44h-352z" />
        </defs>
        <g class="parallax">
          <use xlink:href="#gentle-wave" x="48" y="0" />
          <use xlink:href="#gentle-wave" x="48" y="3" />
          <use xlink:href="#gentle-wave" x="48" y="5" />
          <use xlink:href="#gentle-wave" x="48" y="7" />
        </g>
      </svg>
    </div>
    <main>
      <div class="inner">
        <div id="main" class="pjax">
          
  <div class="article wrap">
    
<div class="breadcrumb" itemscope itemtype="https://schema.org/BreadcrumbList">
<i class="ic i-home"></i>
<span><a href="/">Home</a></span>
</div>

    <article itemscope itemtype="http://schema.org/Article" class="post block" lang="en">
  <link itemprop="mainEntityOfPage" href="https://lhchen74.github.io/2024/01/09/oralce-practice/">

  <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
    <meta itemprop="image" content="/images/avatar.jpg">
    <meta itemprop="name" content="江边鸟">
    <meta itemprop="description" content=", ">
  </span>

  <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
    <meta itemprop="name" content="露の世">
  </span>

  <div class="body md" itemprop="articleBody">
    

    <blockquote>
<p>from: <span class="exturl" data-url="aHR0cHM6Ly93d3cueW91dHViZS5jb20vcGxheWxpc3Q/bGlzdD1QTGIxcVZTeDFrMVZwRXFBWGdvRm41cDdrRlZ6Z3N2VWdN">oracle sql practice exercises with solutions - YouTube</span></p>
</blockquote>
<h2 id="select-alternate-records"><a class="markdownIt-Anchor" href="#select-alternate-records">#</a> Select alternate records</h2>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="operator">*</span></span><br><span class="line">  <span class="keyword">from</span> (<span class="keyword">select</span> empno, sal, rownum <span class="keyword">as</span> rn <span class="keyword">from</span> scott.emp <span class="keyword">order</span> <span class="keyword">by</span> empno)</span><br><span class="line"> <span class="keyword">where</span> <span class="built_in">mod</span>(rn, <span class="number">2</span>) <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span></span><br><span class="line">  <span class="keyword">from</span> (<span class="keyword">select</span> empno, sal, rownum <span class="keyword">as</span> rn <span class="keyword">from</span> scott.emp <span class="keyword">order</span> <span class="keyword">by</span> empno)</span><br><span class="line"> <span class="keyword">where</span> <span class="built_in">mod</span>(rn, <span class="number">2</span>) <span class="operator">=</span> <span class="number">1</span>;</span><br></pre></td></tr></table></figure>
<h2 id="find-unique-route-cost"><a class="markdownIt-Anchor" href="#find-unique-route-cost">#</a> Find unique route cost</h2>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> edi_route_details(</span><br><span class="line">  src varchar2(<span class="number">100</span>),</span><br><span class="line">  dest varchar2(<span class="number">100</span>),</span><br><span class="line">  cost number</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> edi_route_details <span class="keyword">values</span> (<span class="string">&#x27;CHN&#x27;</span>, <span class="string">&#x27;BNG&#x27;</span>, <span class="number">500</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> edi_route_details <span class="keyword">values</span> (<span class="string">&#x27;BNG&#x27;</span>, <span class="string">&#x27;CHN&#x27;</span>, <span class="number">500</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> edi_route_details <span class="keyword">values</span> (<span class="string">&#x27;HYB&#x27;</span>, <span class="string">&#x27;MUMB&#x27;</span>,<span class="number">2500</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> edi_route_details <span class="keyword">values</span> (<span class="string">&#x27;MUMB&#x27;</span>, <span class="string">&#x27;HYB&#x27;</span>,<span class="number">2500</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> edi_route_details <span class="keyword">values</span> (<span class="string">&#x27;PUNE&#x27;</span>, <span class="string">&#x27;UP&#x27;</span>,<span class="number">4500</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> <span class="keyword">distinct</span> least(src, dest), greatest(src, dest), cost</span><br><span class="line">  <span class="keyword">from</span> edi_route_details;</span><br><span class="line">  </span><br><span class="line"><span class="comment">--drop table edi_route_details;</span></span><br></pre></td></tr></table></figure>
<table>
<thead>
<tr>
<th>LEAST(SRC,DEST)</th>
<th>GREATEST(SRC,DEST)</th>
<th>COST</th>
</tr>
</thead>
<tbody>
<tr>
<td>HYB</td>
<td>MUMB</td>
<td>2500</td>
</tr>
<tr>
<td>BNG</td>
<td>CHN</td>
<td>500</td>
</tr>
<tr>
<td>PUNE</td>
<td>UP</td>
<td>4500</td>
</tr>
</tbody>
</table>
<h2 id="find-similar-name"><a class="markdownIt-Anchor" href="#find-similar-name">#</a> Find similar name</h2>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> edi_emp(</span><br><span class="line">  name varchar2(<span class="number">100</span>)</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> edi_emp <span class="keyword">values</span> (<span class="string">&#x27;ravi&#x27;</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> edi_emp <span class="keyword">values</span> (<span class="string">&#x27;(RAVI)&#x27;</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> edi_emp <span class="keyword">values</span> (<span class="string">&#x27;(**RAVI**)&#x27;</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> edi_emp <span class="keyword">values</span> (<span class="string">&#x27;SCOTT&#x27;</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> edi_emp <span class="keyword">values</span> (<span class="string">&#x27;King&#x27;</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> edi_emp <span class="keyword">values</span> (<span class="string">&#x27;SMITH&#x27;</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> edi_emp <span class="keyword">values</span> (<span class="string">&#x27;SMITH***&#x27;</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> edi_emp <span class="keyword">values</span> (<span class="string">&#x27;Ravi.&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">/*select *</span></span><br><span class="line"><span class="comment">  from edi_emp</span></span><br><span class="line"><span class="comment"> where lower(regexp_replace(name, &#x27;[^a-zA-Z]&#x27;)) in</span></span><br><span class="line"><span class="comment">       (select lower(regexp_replace(name, &#x27;[^a-zA-Z]&#x27;))</span></span><br><span class="line"><span class="comment">          from edi_emp</span></span><br><span class="line"><span class="comment">         group by lower(regexp_replace(name, &#x27;[^a-zA-Z]&#x27;))</span></span><br><span class="line"><span class="comment">        having count(*) &gt; 1);*/</span></span><br><span class="line">        </span><br><span class="line"><span class="keyword">with</span> t <span class="keyword">as</span></span><br><span class="line"> (<span class="keyword">select</span> name, <span class="built_in">lower</span>(regexp_replace(name, <span class="string">&#x27;[^a-zA-Z]&#x27;</span>)) compare_name</span><br><span class="line">    <span class="keyword">from</span> edi_emp)</span><br><span class="line"><span class="keyword">select</span> name</span><br><span class="line">  <span class="keyword">from</span> t</span><br><span class="line"> <span class="keyword">where</span> compare_name <span class="keyword">in</span></span><br><span class="line">       (<span class="keyword">select</span> compare_name </span><br><span class="line">          <span class="keyword">from</span> t </span><br><span class="line">         <span class="keyword">group</span> <span class="keyword">by</span> compare_name </span><br><span class="line">        <span class="keyword">having</span> <span class="built_in">count</span>(<span class="operator">*</span>) <span class="operator">&gt;</span> <span class="number">1</span>);</span><br><span class="line">        </span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span></span><br><span class="line">  <span class="keyword">from</span> (<span class="keyword">select</span> name,</span><br><span class="line">               <span class="built_in">count</span>(<span class="operator">*</span>) <span class="keyword">over</span>(<span class="keyword">partition</span> <span class="keyword">by</span> <span class="built_in">lower</span>(regexp_replace(name, <span class="string">&#x27;[^a-zA-Z]&#x27;</span>))) <span class="keyword">as</span> c</span><br><span class="line">          <span class="keyword">from</span> edi_emp)</span><br><span class="line"> <span class="keyword">where</span> c <span class="operator">&gt;</span> <span class="number">1</span>;</span><br></pre></td></tr></table></figure>
<table>
<thead>
<tr>
<th>NAME</th>
<th>C</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>ravi</code></td>
<td>4</td>
</tr>
<tr>
<td><code>(RAVI)</code></td>
<td>4</td>
</tr>
<tr>
<td><code>(**RAVI**)</code></td>
<td>4</td>
</tr>
<tr>
<td><code>Ravi.</code></td>
<td>4</td>
</tr>
<tr>
<td><code>SMITH***</code></td>
<td>2</td>
</tr>
<tr>
<td><code>SMITH</code></td>
<td>2</td>
</tr>
</tbody>
</table>
<h2 id="get-diagonal-data"><a class="markdownIt-Anchor" href="#get-diagonal-data">#</a> Get diagonal data</h2>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">with</span> t <span class="keyword">as</span></span><br><span class="line"> (<span class="keyword">select</span> level a, level <span class="operator">*</span> <span class="number">10</span> b, level <span class="operator">*</span> <span class="number">100</span> c</span><br><span class="line">    <span class="keyword">from</span> dual</span><br><span class="line">  <span class="keyword">connect</span> <span class="keyword">by</span> level <span class="operator">&lt;=</span> <span class="number">9</span>)</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> t;</span><br></pre></td></tr></table></figure>
<table>
<thead>
<tr>
<th>A</th>
<th>B</th>
<th>C</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>1</strong></td>
<td>10</td>
<td>100</td>
</tr>
<tr>
<td>2</td>
<td><strong>20</strong></td>
<td>200</td>
</tr>
<tr>
<td>3</td>
<td>30</td>
<td><strong>300</strong></td>
</tr>
<tr>
<td><strong>4</strong></td>
<td>40</td>
<td>400</td>
</tr>
<tr>
<td>5</td>
<td><strong>50</strong></td>
<td>500</td>
</tr>
<tr>
<td>6</td>
<td>60</td>
<td><strong>600</strong></td>
</tr>
<tr>
<td><strong>7</strong></td>
<td>70</td>
<td>700</td>
</tr>
<tr>
<td>8</td>
<td><strong>80</strong></td>
<td>800</td>
</tr>
<tr>
<td>9</td>
<td>90</td>
<td><strong>900</strong></td>
</tr>
</tbody>
</table>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">with</span> t <span class="keyword">as</span></span><br><span class="line"> (<span class="keyword">select</span> level a, level <span class="operator">*</span> <span class="number">10</span> b, level <span class="operator">*</span> <span class="number">100</span> c</span><br><span class="line">    <span class="keyword">from</span> dual</span><br><span class="line">  <span class="keyword">connect</span> <span class="keyword">by</span> level <span class="operator">&lt;=</span> <span class="number">9</span>)</span><br><span class="line"><span class="keyword">select</span> a,</span><br><span class="line">       b,</span><br><span class="line">       c,</span><br><span class="line">       rownum,</span><br><span class="line">       <span class="built_in">mod</span>(rownum, <span class="number">3</span>),</span><br><span class="line">       decode(<span class="built_in">mod</span>(rownum, <span class="number">3</span>), <span class="number">1</span>, a, <span class="number">2</span>, b, <span class="number">0</span>, c) <span class="keyword">as</span> diagonal</span><br><span class="line">  <span class="keyword">from</span> t;</span><br></pre></td></tr></table></figure>
<table>
<thead>
<tr>
<th>A</th>
<th>B</th>
<th>C</th>
<th>ROWNUM</th>
<th>MOD(ROWNUM,3)</th>
<th>DIAGONAL</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>10</td>
<td>100</td>
<td>1</td>
<td>1</td>
<td>1</td>
</tr>
<tr>
<td>2</td>
<td>20</td>
<td>200</td>
<td>2</td>
<td>2</td>
<td>20</td>
</tr>
<tr>
<td>3</td>
<td>30</td>
<td>300</td>
<td>3</td>
<td>0</td>
<td>300</td>
</tr>
<tr>
<td>4</td>
<td>40</td>
<td>400</td>
<td>4</td>
<td>1</td>
<td>4</td>
</tr>
<tr>
<td>5</td>
<td>50</td>
<td>500</td>
<td>5</td>
<td>2</td>
<td>50</td>
</tr>
<tr>
<td>6</td>
<td>60</td>
<td>600</td>
<td>6</td>
<td>0</td>
<td>600</td>
</tr>
<tr>
<td>7</td>
<td>70</td>
<td>700</td>
<td>7</td>
<td>1</td>
<td>7</td>
</tr>
<tr>
<td>8</td>
<td>80</td>
<td>800</td>
<td>8</td>
<td>2</td>
<td>80</td>
</tr>
<tr>
<td>9</td>
<td>90</td>
<td>900</td>
<td>9</td>
<td>0</td>
<td>900</td>
</tr>
</tbody>
</table>
<h2 id="multi-rows-into-single-row"><a class="markdownIt-Anchor" href="#multi-rows-into-single-row">#</a> Multi rows into single row</h2>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">with</span> t <span class="keyword">as</span></span><br><span class="line"> (<span class="keyword">select</span> chr(ascii(<span class="string">&#x27;A&#x27;</span>) <span class="operator">+</span> level <span class="operator">-</span> <span class="number">1</span>) <span class="operator">||</span> <span class="number">1</span> <span class="keyword">as</span> c1,</span><br><span class="line">         chr(ascii(<span class="string">&#x27;A&#x27;</span>) <span class="operator">+</span> level <span class="operator">-</span> <span class="number">1</span>) <span class="operator">||</span> <span class="number">2</span> <span class="keyword">as</span> c2,</span><br><span class="line">         chr(ascii(<span class="string">&#x27;A&#x27;</span>) <span class="operator">+</span> level <span class="operator">-</span> <span class="number">1</span>) <span class="operator">||</span> <span class="number">3</span> <span class="keyword">as</span> c3,</span><br><span class="line">         chr(ascii(<span class="string">&#x27;A&#x27;</span>) <span class="operator">+</span> level <span class="operator">-</span> <span class="number">1</span>) <span class="operator">||</span> <span class="number">4</span> <span class="keyword">as</span> c4,</span><br><span class="line">         chr(ascii(<span class="string">&#x27;A&#x27;</span>) <span class="operator">+</span> level <span class="operator">-</span> <span class="number">1</span>) <span class="operator">||</span> <span class="number">5</span> <span class="keyword">as</span> c5,</span><br><span class="line">         chr(ascii(<span class="string">&#x27;A&#x27;</span>) <span class="operator">+</span> level <span class="operator">-</span> <span class="number">1</span>) <span class="operator">||</span> <span class="number">6</span> <span class="keyword">as</span> c6</span><br><span class="line">    <span class="keyword">from</span> dual</span><br><span class="line">  <span class="keyword">connect</span> <span class="keyword">by</span> level <span class="operator">&lt;=</span> <span class="number">9</span>)</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> t;</span><br></pre></td></tr></table></figure>
<table>
<thead>
<tr>
<th>C1</th>
<th>C2</th>
<th>C3</th>
<th>C4</th>
<th>C5</th>
<th>C6</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>A1</strong></td>
<td><strong>A2</strong></td>
<td>A3</td>
<td>A4</td>
<td>A5</td>
<td>A6</td>
</tr>
<tr>
<td>B1</td>
<td>B2</td>
<td><strong>B3</strong></td>
<td><strong>B4</strong></td>
<td>B5</td>
<td>B6</td>
</tr>
<tr>
<td>C1</td>
<td>C2</td>
<td>C3</td>
<td>C4</td>
<td><strong>C5</strong></td>
<td><strong>C6</strong></td>
</tr>
<tr>
<td><strong>D1</strong></td>
<td><strong>D2</strong></td>
<td>D3</td>
<td>D4</td>
<td>D5</td>
<td>D6</td>
</tr>
<tr>
<td>E1</td>
<td>E2</td>
<td><strong>E3</strong></td>
<td><strong>E4</strong></td>
<td>E5</td>
<td>E6</td>
</tr>
<tr>
<td>F1</td>
<td>F2</td>
<td>F3</td>
<td>F4</td>
<td><strong>F5</strong></td>
<td><strong>F6</strong></td>
</tr>
<tr>
<td><strong>G1</strong></td>
<td><strong>G2</strong></td>
<td>G3</td>
<td>G4</td>
<td>G5</td>
<td>G6</td>
</tr>
<tr>
<td>H1</td>
<td>H2</td>
<td><strong>H3</strong></td>
<td>H4</td>
<td>H5</td>
<td>H6</td>
</tr>
<tr>
<td>I1</td>
<td>I2</td>
<td>I3</td>
<td>I4</td>
<td><strong>I5</strong></td>
<td><strong>I6</strong></td>
</tr>
</tbody>
</table>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">with</span> t <span class="keyword">as</span> (</span><br><span class="line">  <span class="keyword">select</span> chr(ascii(<span class="string">&#x27;A&#x27;</span>) <span class="operator">+</span> level <span class="operator">-</span> <span class="number">1</span>) <span class="operator">||</span> <span class="number">1</span> <span class="keyword">as</span> c1, </span><br><span class="line">         chr(ascii(<span class="string">&#x27;A&#x27;</span>) <span class="operator">+</span> level <span class="operator">-</span> <span class="number">1</span>) <span class="operator">||</span> <span class="number">2</span> <span class="keyword">as</span> c2, </span><br><span class="line">         chr(ascii(<span class="string">&#x27;A&#x27;</span>) <span class="operator">+</span> level <span class="operator">-</span> <span class="number">1</span>) <span class="operator">||</span> <span class="number">3</span> <span class="keyword">as</span> c3, </span><br><span class="line">         chr(ascii(<span class="string">&#x27;A&#x27;</span>) <span class="operator">+</span> level <span class="operator">-</span> <span class="number">1</span>) <span class="operator">||</span> <span class="number">4</span> <span class="keyword">as</span> c4, </span><br><span class="line">         chr(ascii(<span class="string">&#x27;A&#x27;</span>) <span class="operator">+</span> level <span class="operator">-</span> <span class="number">1</span>) <span class="operator">||</span> <span class="number">5</span> <span class="keyword">as</span> c5, </span><br><span class="line">         chr(ascii(<span class="string">&#x27;A&#x27;</span>) <span class="operator">+</span> level <span class="operator">-</span> <span class="number">1</span>) <span class="operator">||</span> <span class="number">6</span> <span class="keyword">as</span> c6</span><br><span class="line">  <span class="keyword">from</span> dual</span><br><span class="line">  <span class="keyword">connect</span> <span class="keyword">by</span> level <span class="operator">&lt;=</span> <span class="number">9</span></span><br><span class="line">)</span><br><span class="line"><span class="keyword">select</span> <span class="built_in">max</span>(decode(<span class="built_in">mod</span>(rownum, <span class="number">3</span>), <span class="number">1</span>, c1)) c1,</span><br><span class="line">       <span class="built_in">max</span>(decode(<span class="built_in">mod</span>(rownum, <span class="number">3</span>), <span class="number">1</span>, c2)) c2, </span><br><span class="line">       <span class="built_in">max</span>(decode(<span class="built_in">mod</span>(rownum, <span class="number">3</span>), <span class="number">2</span>, c3)) c3, </span><br><span class="line">       <span class="built_in">max</span>(decode(<span class="built_in">mod</span>(rownum, <span class="number">3</span>), <span class="number">2</span>, c4)) c4,</span><br><span class="line">       <span class="built_in">max</span>(decode(<span class="built_in">mod</span>(rownum, <span class="number">3</span>), <span class="number">0</span>, c5)) c5, </span><br><span class="line">       <span class="built_in">max</span>(decode(<span class="built_in">mod</span>(rownum, <span class="number">3</span>), <span class="number">0</span>, c6)) c6</span><br><span class="line">  <span class="keyword">from</span> t</span><br><span class="line"> <span class="keyword">group</span> <span class="keyword">by</span> <span class="built_in">ceil</span>(rownum <span class="operator">/</span> <span class="number">3</span>);</span><br></pre></td></tr></table></figure>
<table>
<thead>
<tr>
<th>C1</th>
<th>C2</th>
<th>C3</th>
<th>C4</th>
<th>C5</th>
<th>C6</th>
</tr>
</thead>
<tbody>
<tr>
<td>A1</td>
<td>A2</td>
<td>B3</td>
<td>B4</td>
<td>C5</td>
<td>C6</td>
</tr>
<tr>
<td>D1</td>
<td>D2</td>
<td>E3</td>
<td>E4</td>
<td>F5</td>
<td>F6</td>
</tr>
<tr>
<td>G1</td>
<td>G2</td>
<td>H3</td>
<td>H4</td>
<td>I5</td>
<td>I6</td>
</tr>
</tbody>
</table>
<h2 id="print-each-value-twice"><a class="markdownIt-Anchor" href="#print-each-value-twice">#</a> Print each value twice</h2>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">with</span> t <span class="keyword">as</span> (</span><br><span class="line">  <span class="keyword">select</span> <span class="number">1</span> <span class="keyword">as</span> c <span class="keyword">from</span> dual</span><br><span class="line">  <span class="keyword">union</span></span><br><span class="line">  <span class="keyword">select</span> <span class="number">2</span> <span class="keyword">from</span> dual</span><br><span class="line">)</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> t</span><br><span class="line"><span class="keyword">union</span> <span class="keyword">all</span></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> t;</span><br></pre></td></tr></table></figure>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">with</span> t <span class="keyword">as</span> (</span><br><span class="line">  <span class="keyword">select</span> <span class="number">1</span> <span class="keyword">as</span> c <span class="keyword">from</span> dual</span><br><span class="line">  <span class="keyword">union</span></span><br><span class="line">  <span class="keyword">select</span> <span class="number">2</span> <span class="keyword">from</span> dual</span><br><span class="line">)</span><br><span class="line"><span class="keyword">select</span> t.<span class="operator">*</span> </span><br><span class="line">  <span class="keyword">from</span> t, </span><br><span class="line">       (<span class="keyword">select</span> <span class="number">1</span> <span class="keyword">from</span> dual <span class="keyword">union</span> <span class="keyword">all</span> <span class="keyword">select</span> <span class="number">1</span> <span class="keyword">from</span> dual)</span><br><span class="line"><span class="keyword">order</span> <span class="keyword">by</span> <span class="number">1</span>;</span><br></pre></td></tr></table></figure>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">with</span> t <span class="keyword">as</span> (</span><br><span class="line">  <span class="keyword">select</span> <span class="number">1</span> <span class="keyword">as</span> c <span class="keyword">from</span> dual</span><br><span class="line">  <span class="keyword">union</span></span><br><span class="line">  <span class="keyword">select</span> <span class="number">2</span> <span class="keyword">from</span> dual</span><br><span class="line">)</span><br><span class="line"><span class="keyword">select</span> t.<span class="operator">*</span> </span><br><span class="line">  <span class="keyword">from</span> t, </span><br><span class="line">       (<span class="keyword">select</span> <span class="number">1</span> <span class="keyword">from</span> dual <span class="keyword">connect</span> <span class="keyword">by</span> level <span class="operator">&lt;=</span> <span class="number">2</span>) </span><br><span class="line"> <span class="keyword">order</span> <span class="keyword">by</span> <span class="number">1</span>;</span><br></pre></td></tr></table></figure>
<table>
<thead>
<tr>
<th>C</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
</tr>
<tr>
<td>1</td>
</tr>
<tr>
<td>2</td>
</tr>
<tr>
<td>2</td>
</tr>
</tbody>
</table>
<h2 id="find-max-value-of-columns-and-rows"><a class="markdownIt-Anchor" href="#find-max-value-of-columns-and-rows">#</a> Find max value of columns and rows</h2>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> edi_t (</span><br><span class="line"> c1 number,</span><br><span class="line"> c2 number,</span><br><span class="line"> c3 number</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> edi_t</span><br><span class="line">  <span class="keyword">select</span> (rownum <span class="operator">-</span> <span class="number">1</span>) <span class="operator">*</span> <span class="number">3</span> <span class="operator">+</span> <span class="number">1</span>, (rownum <span class="operator">-</span> <span class="number">1</span>) <span class="operator">*</span> <span class="number">3</span> <span class="operator">+</span> <span class="number">2</span>, (rownum <span class="operator">-</span> <span class="number">1</span>) <span class="operator">*</span> <span class="number">3</span> <span class="operator">+</span> <span class="number">3</span></span><br><span class="line">    <span class="keyword">from</span> dual</span><br><span class="line">  <span class="keyword">connect</span> <span class="keyword">by</span> level <span class="operator">&lt;=</span> <span class="number">3</span>;</span><br><span class="line">  </span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> edi_t;</span><br></pre></td></tr></table></figure>
<table>
<thead>
<tr>
<th>C1</th>
<th>C2</th>
<th>C3</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>2</td>
<td>3</td>
</tr>
<tr>
<td>4</td>
<td>5</td>
<td>6</td>
</tr>
<tr>
<td>7</td>
<td>8</td>
<td>9</td>
</tr>
</tbody>
</table>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> greatest(<span class="built_in">max</span>(c1), <span class="built_in">max</span>(c2), <span class="built_in">max</span>(c3)) <span class="keyword">from</span> edi_t;</span><br></pre></td></tr></table></figure>
<table>
<thead>
<tr>
<th>GREATEST</th>
</tr>
</thead>
<tbody>
<tr>
<td>9</td>
</tr>
</tbody>
</table>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">with</span> d <span class="keyword">as</span> (</span><br><span class="line">  <span class="keyword">select</span> <span class="string">&#x27;C1&#x27;</span> column_name, <span class="built_in">max</span>(c1) val <span class="keyword">from</span> edi_t</span><br><span class="line">  <span class="keyword">union</span> <span class="keyword">all</span></span><br><span class="line">  <span class="keyword">select</span> <span class="string">&#x27;C2&#x27;</span>, <span class="built_in">max</span>(c2) <span class="keyword">from</span> edi_t</span><br><span class="line">  <span class="keyword">union</span> <span class="keyword">all</span></span><br><span class="line">  <span class="keyword">select</span> <span class="string">&#x27;C3&#x27;</span>, <span class="built_in">max</span>(c3) <span class="keyword">from</span> edi_t</span><br><span class="line">)</span><br><span class="line"><span class="keyword">select</span> column_name, val</span><br><span class="line">  <span class="keyword">from</span> d</span><br><span class="line"> <span class="keyword">where</span> val <span class="operator">=</span> (<span class="keyword">select</span> <span class="built_in">max</span>(val) <span class="keyword">from</span> d);</span><br><span class="line"> </span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> d <span class="keyword">as</span> (</span><br><span class="line">  <span class="keyword">select</span> <span class="operator">*</span> </span><br><span class="line">    <span class="keyword">from</span> edi_t</span><br><span class="line">  unpivot (val <span class="keyword">for</span> column_name <span class="keyword">in</span> (c1, c2, c3))</span><br><span class="line">) </span><br><span class="line"><span class="keyword">select</span> column_name, val </span><br><span class="line"> <span class="keyword">from</span> d </span><br><span class="line"> <span class="keyword">where</span> val <span class="operator">=</span> (<span class="keyword">select</span> <span class="built_in">max</span>(val) <span class="keyword">from</span> d);</span><br></pre></td></tr></table></figure>
<table>
<thead>
<tr>
<th>COLUMN_NAME</th>
<th>VAL</th>
</tr>
</thead>
<tbody>
<tr>
<td>C3</td>
<td>9</td>
</tr>
</tbody>
</table>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">with</span> d <span class="keyword">as</span> (</span><br><span class="line">  <span class="keyword">select</span> <span class="string">&#x27;C1&#x27;</span> column_name, c1 val <span class="keyword">from</span> edi_t</span><br><span class="line">  <span class="keyword">union</span> <span class="keyword">all</span></span><br><span class="line">  <span class="keyword">select</span> <span class="string">&#x27;C2&#x27;</span>, c2 <span class="keyword">from</span> edi_t</span><br><span class="line">  <span class="keyword">union</span> <span class="keyword">all</span></span><br><span class="line">  <span class="keyword">select</span> <span class="string">&#x27;C3&#x27;</span>, c3 <span class="keyword">from</span> edi_t</span><br><span class="line">)</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span></span><br><span class="line">  <span class="keyword">from</span> (<span class="keyword">select</span> column_name,</span><br><span class="line">               <span class="keyword">case</span> <span class="keyword">when</span> val <span class="operator">=</span> <span class="built_in">max</span>(val) <span class="keyword">over</span>() <span class="keyword">then</span> val <span class="keyword">end</span> val</span><br><span class="line">          <span class="keyword">from</span> d)</span><br><span class="line"> <span class="keyword">where</span> val <span class="keyword">is</span> <span class="keyword">not</span> <span class="keyword">null</span>;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">with</span> d <span class="keyword">as</span> (</span><br><span class="line">   <span class="keyword">select</span> <span class="operator">*</span> </span><br><span class="line">     <span class="keyword">from</span> edi_t</span><br><span class="line">  unpivot (val <span class="keyword">for</span> column_name <span class="keyword">in</span> (c1, c2, c3))</span><br><span class="line">) </span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> </span><br><span class="line">  <span class="keyword">from</span> (</span><br><span class="line">  <span class="keyword">select</span> column_name, <span class="keyword">case</span> <span class="keyword">when</span> val <span class="operator">=</span> <span class="built_in">max</span>(val) <span class="keyword">over</span>() <span class="keyword">then</span> val <span class="keyword">end</span> val</span><br><span class="line">    <span class="keyword">from</span> d</span><br><span class="line">) <span class="keyword">where</span> val <span class="keyword">is</span> <span class="keyword">not</span> <span class="keyword">null</span>;</span><br></pre></td></tr></table></figure>
<h2 id="print-null-for-recurring-value"><a class="markdownIt-Anchor" href="#print-null-for-recurring-value">#</a> Print null for recurring value</h2>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> edi_t (</span><br><span class="line">  item_no varchar2(<span class="number">30</span>),</span><br><span class="line">  address varchar2(<span class="number">30</span>),</span><br><span class="line">  item    varchar2(<span class="number">30</span>)</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> edi_t <span class="keyword">values</span> (<span class="string">&#x27;5&#x27;</span>, <span class="string">&#x27;Bala&#x27;</span>, <span class="string">&#x27;Pen&#x27;</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> edi_t <span class="keyword">values</span> (<span class="string">&#x27;5&#x27;</span>, <span class="string">&#x27;Bala&#x27;</span>, <span class="string">&#x27;Pencil&#x27;</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> edi_t <span class="keyword">values</span> (<span class="string">&#x27;5&#x27;</span>, <span class="string">&#x27;Bala&#x27;</span>, <span class="string">&#x27;Notepad&#x27;</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> edi_t <span class="keyword">values</span> (<span class="string">&#x27;6&#x27;</span>, <span class="string">&#x27;Ram&#x27;</span>, <span class="string">&#x27;Laptop&#x27;</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> edi_t <span class="keyword">values</span> (<span class="string">&#x27;6&#x27;</span>, <span class="string">&#x27;Ram&#x27;</span>, <span class="string">&#x27;Notebook&#x27;</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> edi_t <span class="keyword">values</span> (<span class="string">&#x27;6&#x27;</span>, <span class="string">&#x27;Ram&#x27;</span>, <span class="string">&#x27;PC&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> d <span class="keyword">as</span></span><br><span class="line"> (<span class="keyword">select</span> item_no,</span><br><span class="line">         address,</span><br><span class="line">         item,</span><br><span class="line">         <span class="built_in">row_number</span>() <span class="keyword">over</span>(<span class="keyword">partition</span> <span class="keyword">by</span> item_no, address <span class="keyword">order</span> <span class="keyword">by</span> rownum) r</span><br><span class="line">    <span class="keyword">from</span> edi_t)</span><br><span class="line"><span class="keyword">select</span> <span class="keyword">case</span> <span class="keyword">when</span> r <span class="operator">=</span> <span class="number">1</span> <span class="keyword">then</span> item_no <span class="keyword">end</span> item_no,</span><br><span class="line">       <span class="keyword">case</span> <span class="keyword">when</span> r <span class="operator">=</span> <span class="number">1</span> <span class="keyword">then</span> address <span class="keyword">end</span> address,</span><br><span class="line">       item</span><br><span class="line">  <span class="keyword">from</span> d;</span><br></pre></td></tr></table></figure>
<table>
<thead>
<tr>
<th>ITEM_NO</th>
<th>ADDRESS</th>
<th>ITEM</th>
</tr>
</thead>
<tbody>
<tr>
<td>5</td>
<td>Bala</td>
<td>Pen</td>
</tr>
<tr>
<td></td>
<td></td>
<td>Pencil</td>
</tr>
<tr>
<td></td>
<td></td>
<td>Notepad</td>
</tr>
<tr>
<td>6</td>
<td>Ram</td>
<td>Laptop</td>
</tr>
<tr>
<td></td>
<td></td>
<td>Notebook</td>
</tr>
<tr>
<td></td>
<td></td>
<td>PC</td>
</tr>
</tbody>
</table>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">with</span> d <span class="keyword">as</span> (</span><br><span class="line">  <span class="keyword">select</span> rownum <span class="keyword">as</span> c <span class="keyword">from</span> dual <span class="keyword">connect</span> <span class="keyword">by</span> level <span class="operator">&lt;=</span> <span class="number">5</span></span><br><span class="line">   <span class="keyword">union</span> <span class="keyword">all</span></span><br><span class="line">  <span class="keyword">select</span> <span class="number">5</span> <span class="keyword">from</span> dual</span><br><span class="line">   <span class="keyword">union</span> <span class="keyword">all</span> </span><br><span class="line">  <span class="keyword">select</span> <span class="number">5</span> <span class="keyword">from</span> dual</span><br><span class="line">   <span class="keyword">union</span> <span class="keyword">all</span> </span><br><span class="line">  <span class="keyword">select</span> <span class="number">6</span> <span class="keyword">from</span> dual</span><br><span class="line">   <span class="keyword">union</span> <span class="keyword">all</span></span><br><span class="line">  <span class="keyword">select</span> rownum <span class="operator">+</span> <span class="number">5</span></span><br><span class="line">    <span class="keyword">from</span> dual</span><br><span class="line">  <span class="keyword">connect</span> <span class="keyword">by</span> level <span class="operator">&lt;=</span> <span class="number">5</span></span><br><span class="line">)</span><br><span class="line"><span class="keyword">select</span> <span class="keyword">case</span> <span class="keyword">when</span> c <span class="operator">=</span> <span class="built_in">lag</span>(c, <span class="number">1</span>) <span class="keyword">over</span>(<span class="keyword">order</span> <span class="keyword">by</span> rownum) <span class="keyword">then</span> <span class="keyword">null</span> <span class="keyword">else</span> c <span class="keyword">end</span> <span class="keyword">as</span> r</span><br><span class="line">  <span class="keyword">from</span> d;</span><br></pre></td></tr></table></figure>
<table>
<thead>
<tr>
<th>R</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
</tr>
<tr>
<td>2</td>
</tr>
<tr>
<td>3</td>
</tr>
<tr>
<td>4</td>
</tr>
<tr>
<td>5</td>
</tr>
<tr>
<td></td>
</tr>
<tr>
<td></td>
</tr>
<tr>
<td>6</td>
</tr>
<tr>
<td></td>
</tr>
<tr>
<td>7</td>
</tr>
<tr>
<td>8</td>
</tr>
<tr>
<td>9</td>
</tr>
<tr>
<td>10</td>
</tr>
</tbody>
</table>
<h2 id="generate-alphanumeric-sequence"><a class="markdownIt-Anchor" href="#generate-alphanumeric-sequence">#</a> Generate alphanumeric sequence</h2>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">with</span> d <span class="keyword">as</span></span><br><span class="line"> (<span class="keyword">select</span> <span class="string">&#x27;ABCD&#x27;</span> <span class="keyword">as</span> str, <span class="number">4</span> <span class="keyword">as</span> seq <span class="keyword">from</span> dual)</span><br><span class="line"><span class="keyword">select</span> a <span class="operator">||</span> n</span><br><span class="line">  <span class="keyword">from</span> (<span class="keyword">select</span> level <span class="keyword">as</span> n <span class="keyword">from</span> d <span class="keyword">connect</span> <span class="keyword">by</span> level <span class="operator">&lt;=</span> seq),</span><br><span class="line">       (<span class="keyword">select</span> substr(str, level, <span class="number">1</span>) <span class="keyword">as</span> a</span><br><span class="line">          <span class="keyword">from</span> d</span><br><span class="line">        <span class="keyword">connect</span> <span class="keyword">by</span> level <span class="operator">&lt;=</span> length(str));</span><br></pre></td></tr></table></figure>
<table>
<thead>
<tr>
<th>A||N</th>
</tr>
</thead>
<tbody>
<tr>
<td>A1</td>
</tr>
<tr>
<td>B1</td>
</tr>
<tr>
<td>C1</td>
</tr>
<tr>
<td>D1</td>
</tr>
<tr>
<td>A2</td>
</tr>
<tr>
<td>B2</td>
</tr>
<tr>
<td>C2</td>
</tr>
<tr>
<td>D2</td>
</tr>
<tr>
<td>A3</td>
</tr>
<tr>
<td>B3</td>
</tr>
<tr>
<td>C3</td>
</tr>
<tr>
<td>D3</td>
</tr>
<tr>
<td>A4</td>
</tr>
<tr>
<td>B4</td>
</tr>
<tr>
<td>C4</td>
</tr>
<tr>
<td>D4</td>
</tr>
</tbody>
</table>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">with</span> d <span class="keyword">as</span></span><br><span class="line"> (<span class="keyword">select</span> <span class="string">&#x27;ABCD&#x27;</span> <span class="keyword">as</span> str, <span class="number">4</span> <span class="keyword">as</span> seq <span class="keyword">from</span> dual)</span><br><span class="line"><span class="keyword">select</span> str <span class="keyword">as</span> c1,</span><br><span class="line">       <span class="built_in">ceil</span>(level <span class="operator">/</span> length(str)) <span class="keyword">as</span> c2,</span><br><span class="line">       <span class="built_in">mod</span>(level, length(str)) <span class="operator">+</span> <span class="number">1</span> <span class="keyword">as</span> c3,</span><br><span class="line">       substr(str, <span class="built_in">mod</span>(level, length(str)) <span class="operator">+</span> <span class="number">1</span>, <span class="number">1</span>) <span class="operator">||</span> <span class="built_in">ceil</span>(level <span class="operator">/</span> length(str))</span><br><span class="line">  <span class="keyword">from</span> d</span><br><span class="line"><span class="keyword">connect</span> <span class="keyword">by</span> level <span class="operator">&lt;=</span> length(str) <span class="operator">*</span> seq</span><br><span class="line"> <span class="keyword">order</span> <span class="keyword">by</span> <span class="built_in">ceil</span>(level <span class="operator">/</span> length(str)), <span class="built_in">mod</span>(level, length(str)) <span class="operator">+</span> <span class="number">1</span>;</span><br></pre></td></tr></table></figure>
<table>
<thead>
<tr>
<th>C1</th>
<th>C2</th>
<th>C3</th>
<th>AN</th>
</tr>
</thead>
<tbody>
<tr>
<td>ABCD</td>
<td>1</td>
<td>1</td>
<td>A1</td>
</tr>
<tr>
<td>ABCD</td>
<td>1</td>
<td>2</td>
<td>B1</td>
</tr>
<tr>
<td>ABCD</td>
<td>1</td>
<td>3</td>
<td>C1</td>
</tr>
<tr>
<td>ABCD</td>
<td>1</td>
<td>4</td>
<td>D1</td>
</tr>
<tr>
<td>ABCD</td>
<td>2</td>
<td>1</td>
<td>A2</td>
</tr>
<tr>
<td>ABCD</td>
<td>2</td>
<td>2</td>
<td>B2</td>
</tr>
<tr>
<td>ABCD</td>
<td>2</td>
<td>3</td>
<td>C2</td>
</tr>
<tr>
<td>ABCD</td>
<td>2</td>
<td>4</td>
<td>D2</td>
</tr>
<tr>
<td>ABCD</td>
<td>3</td>
<td>1</td>
<td>A3</td>
</tr>
<tr>
<td>ABCD</td>
<td>3</td>
<td>2</td>
<td>B3</td>
</tr>
<tr>
<td>ABCD</td>
<td>3</td>
<td>3</td>
<td>C3</td>
</tr>
<tr>
<td>ABCD</td>
<td>3</td>
<td>4</td>
<td>D3</td>
</tr>
<tr>
<td>ABCD</td>
<td>4</td>
<td>1</td>
<td>A4</td>
</tr>
<tr>
<td>ABCD</td>
<td>4</td>
<td>2</td>
<td>B4</td>
</tr>
<tr>
<td>ABCD</td>
<td>4</td>
<td>3</td>
<td>C4</td>
</tr>
<tr>
<td>ABCD</td>
<td>4</td>
<td>4</td>
<td>D4</td>
</tr>
</tbody>
</table>
<h2 id="cumulative-sum"><a class="markdownIt-Anchor" href="#cumulative-sum">#</a> Cumulative sum</h2>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> edi_t (</span><br><span class="line">  id number,</span><br><span class="line">  type varchar2(<span class="number">1</span>),</span><br><span class="line">  amount number</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> edi_t <span class="keyword">values</span> (<span class="number">1</span>, <span class="string">&#x27;C&#x27;</span>, <span class="number">10000</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> edi_t <span class="keyword">values</span> (<span class="number">2</span>, <span class="string">&#x27;D&#x27;</span>, <span class="number">2000</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> edi_t <span class="keyword">values</span> (<span class="number">3</span>, <span class="string">&#x27;C&#x27;</span>, <span class="number">10000</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> edi_t <span class="keyword">values</span> (<span class="number">4</span>, <span class="string">&#x27;D&#x27;</span>, <span class="number">5000</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> edi_t <span class="keyword">values</span> (<span class="number">5</span>, <span class="string">&#x27;D&#x27;</span>, <span class="number">4000</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> id,</span><br><span class="line">       type,</span><br><span class="line">       amount,</span><br><span class="line">       <span class="built_in">sum</span>(decode(type, <span class="string">&#x27;C&#x27;</span>, amount, <span class="operator">-</span>amount)) <span class="keyword">over</span>(<span class="keyword">order</span> <span class="keyword">by</span> id)</span><br><span class="line">  <span class="keyword">from</span> edi_t;</span><br></pre></td></tr></table></figure>
<table>
<thead>
<tr>
<th>ID</th>
<th>TYPE</th>
<th>AMOUNT</th>
<th>CUMULATIVE_SUM</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>C</td>
<td>10000</td>
<td>10000</td>
</tr>
<tr>
<td>2</td>
<td>D</td>
<td>2000</td>
<td>8000</td>
</tr>
<tr>
<td>3</td>
<td>C</td>
<td>10000</td>
<td>18000</td>
</tr>
<tr>
<td>4</td>
<td>D</td>
<td>5000</td>
<td>13000</td>
</tr>
<tr>
<td>5</td>
<td>D</td>
<td>4000</td>
<td>9000</td>
</tr>
</tbody>
</table>
<h2 id="character-occurence-two-times-only"><a class="markdownIt-Anchor" href="#character-occurence-two-times-only">#</a> Character occurence two times only</h2>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">with</span> t <span class="keyword">as</span></span><br><span class="line"> (<span class="keyword">select</span> <span class="string">&#x27;MUSHROOM&#x27;</span> <span class="keyword">as</span> s <span class="keyword">from</span> dual </span><br><span class="line">   <span class="keyword">union</span> <span class="keyword">all</span> </span><br><span class="line">  <span class="keyword">select</span> <span class="string">&#x27;HELLO&#x27;</span> <span class="keyword">as</span> s <span class="keyword">from</span> dual)</span><br><span class="line"><span class="keyword">select</span> <span class="keyword">distinct</span> s, c</span><br><span class="line">  <span class="keyword">from</span> (<span class="keyword">select</span> s,</span><br><span class="line">               column_value,</span><br><span class="line">               substr(s, column_value, <span class="number">1</span>) <span class="keyword">as</span> c,</span><br><span class="line">               regexp_count(s, substr(s, column_value, <span class="number">1</span>)) cnt</span><br><span class="line">          <span class="keyword">from</span> t,</span><br><span class="line">               <span class="keyword">table</span>(<span class="built_in">cast</span>(<span class="keyword">multiset</span> (<span class="keyword">select</span> level l</span><br><span class="line">                                      <span class="keyword">from</span> dual</span><br><span class="line">                                   <span class="keyword">connect</span> <span class="keyword">by</span> level <span class="operator">&lt;=</span> length(s)) <span class="keyword">as</span></span><br><span class="line">                          sys.odcinumberlist)))</span><br><span class="line"> <span class="keyword">where</span> cnt <span class="operator">=</span> <span class="number">2</span>;</span><br></pre></td></tr></table></figure>
<table>
<thead>
<tr>
<th>S</th>
<th>C</th>
</tr>
</thead>
<tbody>
<tr>
<td>HELLO</td>
<td>L</td>
</tr>
<tr>
<td>MUSHROOM</td>
<td>O</td>
</tr>
<tr>
<td>MUSHROOM</td>
<td>M</td>
</tr>
</tbody>
</table>
<h2 id="find-the-number-of-month-and-days-in-given-year"><a class="markdownIt-Anchor" href="#find-the-number-of-month-and-days-in-given-year">#</a> Find the number of month and days in given year</h2>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">with</span> t <span class="keyword">as</span></span><br><span class="line"> (<span class="keyword">select</span> <span class="number">2024</span> <span class="keyword">as</span> y <span class="keyword">from</span> dual)</span><br><span class="line"><span class="keyword">select</span> to_char(level, <span class="string">&#x27;00&#x27;</span>),</span><br><span class="line">       to_char(to_date(to_char(level, <span class="string">&#x27;00&#x27;</span>) <span class="operator">||</span> y, <span class="string">&#x27;mmyyyy&#x27;</span>), <span class="string">&#x27;MONTH&#x27;</span>) <span class="keyword">month</span>,</span><br><span class="line">       to_char(last_day(to_date(to_char(level, <span class="string">&#x27;00&#x27;</span>) <span class="operator">||</span> y, <span class="string">&#x27;mmyyyy&#x27;</span>)), <span class="string">&#x27;DD&#x27;</span>) days</span><br><span class="line">  <span class="keyword">from</span> t</span><br><span class="line"><span class="keyword">connect</span> <span class="keyword">by</span> level <span class="operator">&lt;=</span> <span class="number">12</span>;</span><br></pre></td></tr></table></figure>
<table>
<thead>
<tr>
<th>TO_CHAR(LEVEL,‘00’)</th>
<th>MONTH</th>
<th>DAYS</th>
</tr>
</thead>
<tbody>
<tr>
<td>01</td>
<td>JANUARY</td>
<td>31</td>
</tr>
<tr>
<td>02</td>
<td>FEBRUARY</td>
<td>29</td>
</tr>
<tr>
<td>03</td>
<td>MARCH</td>
<td>31</td>
</tr>
<tr>
<td>04</td>
<td>APRIL</td>
<td>30</td>
</tr>
<tr>
<td>05</td>
<td>MAY</td>
<td>31</td>
</tr>
<tr>
<td>06</td>
<td>JUNE</td>
<td>30</td>
</tr>
<tr>
<td>07</td>
<td>JULY</td>
<td>31</td>
</tr>
<tr>
<td>08</td>
<td>AUGUST</td>
<td>31</td>
</tr>
<tr>
<td>09</td>
<td>SEPTEMBER</td>
<td>30</td>
</tr>
<tr>
<td>10</td>
<td>OCTOBER</td>
<td>31</td>
</tr>
<tr>
<td>11</td>
<td>NOVEMBER</td>
<td>30</td>
</tr>
<tr>
<td>12</td>
<td>DECEMBER</td>
<td>31</td>
</tr>
</tbody>
</table>
<h2 id="insert-space-between-chars"><a class="markdownIt-Anchor" href="#insert-space-between-chars">#</a> Insert space between chars</h2>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="string">&#x27;HELLO&#x27;</span>,</span><br><span class="line">       <span class="built_in">trim</span>(regexp_replace(<span class="string">&#x27;HELLO&#x27;</span>, <span class="string">&#x27;(.)&#x27;</span>, <span class="string">&#x27;\1 &#x27;</span>)) <span class="keyword">as</span> space_seperated_chars</span><br><span class="line">  <span class="keyword">from</span> dual;</span><br><span class="line">  </span><br><span class="line"><span class="keyword">with</span> t <span class="keyword">as</span></span><br><span class="line"> (<span class="keyword">select</span> <span class="string">&#x27;HELLO&#x27;</span> <span class="keyword">as</span> s <span class="keyword">from</span> dual)</span><br><span class="line"><span class="keyword">select</span> s,</span><br><span class="line">       <span class="built_in">listagg</span>(substr(s, column_value, <span class="number">1</span>), <span class="string">&#x27; &#x27;</span>) <span class="keyword">within</span> <span class="keyword">group</span>(<span class="keyword">order</span> <span class="keyword">by</span> column_value) <span class="keyword">as</span> space_seperated_chars</span><br><span class="line">  <span class="keyword">from</span> t,</span><br><span class="line">       <span class="keyword">table</span>(<span class="built_in">cast</span>(<span class="keyword">multiset</span> (<span class="keyword">select</span> level </span><br><span class="line">                              <span class="keyword">from</span> dual </span><br><span class="line">                            <span class="keyword">connect</span> <span class="keyword">by</span> level <span class="operator">&lt;=</span> length(s)) <span class="keyword">as</span></span><br><span class="line">                  sys.odcinumberlist));</span><br></pre></td></tr></table></figure>
<table>
<thead>
<tr>
<th>S</th>
<th>SPACE_SEPERATED_CHARS</th>
</tr>
</thead>
<tbody>
<tr>
<td>HELLO</td>
<td>H E L L O</td>
</tr>
</tbody>
</table>
<h2 id="re-arrange-digits"><a class="markdownIt-Anchor" href="#re-arrange-digits">#</a> Re-arrange digits</h2>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">with</span> t <span class="keyword">as</span></span><br><span class="line"> (<span class="keyword">select</span> <span class="string">&#x27;12453&#x27;</span> <span class="keyword">as</span> d <span class="keyword">from</span> dual <span class="keyword">union</span> <span class="keyword">all</span> <span class="keyword">select</span> <span class="string">&#x27;5684&#x27;</span> <span class="keyword">from</span> dual)</span><br><span class="line"><span class="keyword">select</span> d,</span><br><span class="line">       <span class="built_in">listagg</span>(substr(d, column_value, <span class="number">1</span>), <span class="string">&#x27;&#x27;</span>) <span class="keyword">within</span> <span class="keyword">group</span>(<span class="keyword">order</span> <span class="keyword">by</span> substr(d, column_value, <span class="number">1</span>)) <span class="keyword">as</span> rearranged_digits</span><br><span class="line">  <span class="keyword">from</span> t,</span><br><span class="line">       <span class="keyword">table</span>(<span class="built_in">cast</span>(<span class="keyword">multiset</span> (<span class="keyword">select</span> level </span><br><span class="line">                              <span class="keyword">from</span> dual </span><br><span class="line">                           <span class="keyword">connect</span> <span class="keyword">by</span> level <span class="operator">&lt;=</span> length(d)) <span class="keyword">as</span></span><br><span class="line">                  sys.odcinumberlist))</span><br><span class="line"> <span class="keyword">group</span> <span class="keyword">by</span> d;</span><br></pre></td></tr></table></figure>
<table>
<thead>
<tr>
<th>D</th>
<th>REARRANGED_DIGITS</th>
</tr>
</thead>
<tbody>
<tr>
<td>12453</td>
<td>12345</td>
</tr>
<tr>
<td>5684</td>
<td>4568</td>
</tr>
</tbody>
</table>
<h2 id="mask-user-data-with-random-value"><a class="markdownIt-Anchor" href="#mask-user-data-with-random-value">#</a> Mask user data with random value</h2>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">with</span> t <span class="keyword">as</span></span><br><span class="line"> (<span class="keyword">select</span> <span class="string">&#x27;KA33456&#x27;</span> d <span class="keyword">from</span> dual)</span><br><span class="line"><span class="keyword">select</span> dbms_random.string(<span class="string">&#x27;U&#x27;</span>, <span class="number">1</span>) upper_char,</span><br><span class="line">       dbms_random.value random_value,</span><br><span class="line">       to_char(dbms_random.value) <span class="keyword">as</span> random_value_str,</span><br><span class="line">       substr(d, <span class="number">1</span>, <span class="number">2</span>) <span class="operator">||</span> dbms_random.string(<span class="string">&#x27;U&#x27;</span>, <span class="number">1</span>) <span class="operator">||</span></span><br><span class="line">       substr(substr(dbms_random.value, <span class="number">2</span>), <span class="number">1</span>, length(d) <span class="operator">-</span> <span class="number">3</span>) <span class="keyword">as</span> masked_result <span class="comment">--substr(dbms_random.value, 2) transfer to char firstly, so here use 2 not 3</span></span><br><span class="line">  <span class="keyword">from</span> t;</span><br></pre></td></tr></table></figure>
<table>
<thead>
<tr>
<th>UPPER_CHAR</th>
<th>RANDOM_VALUE</th>
<th>RANDOM_VALUE_STR</th>
<th>MASKED_RESULT</th>
</tr>
</thead>
<tbody>
<tr>
<td>P</td>
<td>**0.**143166111</td>
<td>**.**143166111</td>
<td>KA<strong>N8258</strong></td>
</tr>
</tbody>
</table>
<h2 id="find-symmetric-set-in-given-x-y-coordinates"><a class="markdownIt-Anchor" href="#find-symmetric-set-in-given-x-y-coordinates">#</a> Find symmetric set in given x, y coordinates</h2>
<p>(x1, y1) and (x2, y2)  are symmetric if x1=y2 and y1=x2.</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> edi_t(</span><br><span class="line">  set_name varchar2(<span class="number">10</span>),</span><br><span class="line">  x number,</span><br><span class="line">  y number</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> edi_t <span class="keyword">values</span> (<span class="string">&#x27;P1&#x27;</span>, <span class="number">1</span>, <span class="number">2</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> edi_t <span class="keyword">values</span> (<span class="string">&#x27;P2&#x27;</span>, <span class="number">2</span>, <span class="number">1</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> edi_t <span class="keyword">values</span> (<span class="string">&#x27;P3&#x27;</span>, <span class="number">6</span>, <span class="number">6</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> edi_t <span class="keyword">values</span> (<span class="string">&#x27;P4&#x27;</span>, <span class="number">6</span>, <span class="number">6</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> edi_t <span class="keyword">values</span> (<span class="string">&#x27;P5&#x27;</span>, <span class="number">7</span>, <span class="number">8</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> edi_t <span class="keyword">values</span> (<span class="string">&#x27;P6&#x27;</span>, <span class="number">8</span>, <span class="number">9</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> edi_t <span class="keyword">values</span> (<span class="string">&#x27;P7&#x27;</span>, <span class="number">8</span>, <span class="number">10</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> edi_t <span class="keyword">values</span> (<span class="string">&#x27;P8&#x27;</span>, <span class="number">10</span>, <span class="number">8</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span></span><br><span class="line">  <span class="keyword">from</span> edi_t </span><br><span class="line"> <span class="keyword">where</span> (x, y) <span class="keyword">in</span> (</span><br><span class="line">   <span class="keyword">select</span> y, x <span class="keyword">from</span> edi_t</span><br><span class="line"> ) <span class="keyword">order</span> <span class="keyword">by</span> set_name;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span></span><br><span class="line">  <span class="keyword">from</span> edi_t t1</span><br><span class="line"> <span class="keyword">where</span> <span class="keyword">exists</span> (<span class="keyword">select</span> <span class="number">1</span></span><br><span class="line">                 <span class="keyword">from</span> edi_t t2</span><br><span class="line">                <span class="keyword">where</span> t1.x <span class="operator">=</span> t2.y</span><br><span class="line">                  <span class="keyword">and</span> t1.y <span class="operator">=</span> t2.x)</span><br><span class="line"> <span class="keyword">order</span> <span class="keyword">by</span> set_name;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">select</span> <span class="keyword">distinct</span> t1.<span class="operator">*</span></span><br><span class="line">  <span class="keyword">from</span> edi_t t1, edi_t t2</span><br><span class="line"> <span class="keyword">where</span> t1.x <span class="operator">=</span> t2.y</span><br><span class="line">   <span class="keyword">and</span> t1.y <span class="operator">=</span> t2.x</span><br><span class="line"> <span class="keyword">order</span> <span class="keyword">by</span> t1.set_name;</span><br><span class="line"> </span><br><span class="line"> <span class="keyword">select</span> <span class="keyword">distinct</span> t1.<span class="operator">*</span></span><br><span class="line">  <span class="keyword">from</span> edi_t t1,</span><br><span class="line">       <span class="keyword">table</span>(<span class="built_in">cast</span>(<span class="keyword">multiset</span> (<span class="keyword">select</span> <span class="number">1</span></span><br><span class="line">                     		  <span class="keyword">from</span> edi_t t2</span><br><span class="line">                             <span class="keyword">where</span> t1.x <span class="operator">=</span> t2.y</span><br><span class="line">                               <span class="keyword">and</span> t1.y <span class="operator">=</span> t2.x) <span class="keyword">as</span> </span><br><span class="line">                  sys.odcinumberlist));</span><br></pre></td></tr></table></figure>
<table>
<thead>
<tr>
<th>SET_NAME</th>
<th>X</th>
<th>Y</th>
</tr>
</thead>
<tbody>
<tr>
<td>P1</td>
<td>1</td>
<td>2</td>
</tr>
<tr>
<td>P2</td>
<td>2</td>
<td>1</td>
</tr>
<tr>
<td>P3</td>
<td>6</td>
<td>6</td>
</tr>
<tr>
<td>P4</td>
<td>6</td>
<td>6</td>
</tr>
<tr>
<td>P7</td>
<td>8</td>
<td>10</td>
</tr>
<tr>
<td>P8</td>
<td>10</td>
<td>8</td>
</tr>
</tbody>
</table>
<h2 id="remove-duplicate-values-within-row-of-data"><a class="markdownIt-Anchor" href="#remove-duplicate-values-within-row-of-data">#</a> Remove duplicate values within row of data</h2>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> edi_t(</span><br><span class="line">  id number, </span><br><span class="line">  c1 varchar2(<span class="number">10</span>),</span><br><span class="line">  c2 varchar2(<span class="number">10</span>),</span><br><span class="line">  c3 varchar2(<span class="number">10</span>)</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> edi_t <span class="keyword">values</span> (<span class="number">1</span>, <span class="string">&#x27;A&#x27;</span>, <span class="string">&#x27;B&#x27;</span>, <span class="string">&#x27;C&#x27;</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> edi_t <span class="keyword">values</span> (<span class="number">2</span>, <span class="string">&#x27;A&#x27;</span>, <span class="string">&#x27;B&#x27;</span>, <span class="string">&#x27;A&#x27;</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> edi_t <span class="keyword">values</span> (<span class="number">3</span>, <span class="string">&#x27;A&#x27;</span>, <span class="string">&#x27;A&#x27;</span>, <span class="string">&#x27;A&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> id, </span><br><span class="line">       <span class="built_in">listagg</span>(c, <span class="string">&#x27;,&#x27;</span>) <span class="keyword">within</span> <span class="keyword">group</span>(<span class="keyword">order</span> <span class="keyword">by</span> c) </span><br><span class="line"> <span class="keyword">from</span> (</span><br><span class="line">  <span class="keyword">select</span> id, c1 <span class="keyword">as</span> c <span class="keyword">from</span> edi_t</span><br><span class="line">  <span class="keyword">union</span> </span><br><span class="line">  <span class="keyword">select</span> id, c2 <span class="keyword">from</span> edi_t</span><br><span class="line">  <span class="keyword">union</span></span><br><span class="line">  <span class="keyword">select</span> id, c3 <span class="keyword">from</span> edi_t</span><br><span class="line">) <span class="keyword">group</span> <span class="keyword">by</span> id;</span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> id, </span><br><span class="line">       <span class="built_in">listagg</span>(c, <span class="string">&#x27;,&#x27;</span>) <span class="keyword">within</span> <span class="keyword">group</span>(<span class="keyword">order</span> <span class="keyword">by</span> c) <span class="keyword">as</span> <span class="keyword">result</span></span><br><span class="line">  <span class="keyword">from</span> (</span><br><span class="line">    <span class="keyword">select</span> <span class="keyword">distinct</span> id, c</span><br><span class="line">      <span class="keyword">from</span> edi_t </span><br><span class="line">    unpivot (c <span class="keyword">for</span> column_value <span class="keyword">in</span> (c1, c2, c3))</span><br><span class="line">) <span class="keyword">group</span> <span class="keyword">by</span> id;</span><br></pre></td></tr></table></figure>
<table>
<thead>
<tr>
<th>ID</th>
<th>RESULT</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>A,B,C</td>
</tr>
<tr>
<td>2</td>
<td>A,B</td>
</tr>
<tr>
<td>3</td>
<td>A</td>
</tr>
</tbody>
</table>
<h2 id="find-consecutive-number"><a class="markdownIt-Anchor" href="#find-consecutive-number">#</a> Find consecutive number</h2>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> edi_t (</span><br><span class="line">  n number</span><br><span class="line">);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> edi_t <span class="keyword">values</span> (<span class="number">1</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> edi_t <span class="keyword">values</span> (<span class="number">3</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> edi_t <span class="keyword">values</span> (<span class="number">4</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> edi_t <span class="keyword">values</span> (<span class="number">5</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> edi_t <span class="keyword">values</span> (<span class="number">10</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> edi_t <span class="keyword">values</span> (<span class="number">13</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> edi_t <span class="keyword">values</span> (<span class="number">14</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> n</span><br><span class="line">  <span class="keyword">from</span> (</span><br><span class="line">    <span class="keyword">select</span> n,</span><br><span class="line">           <span class="built_in">lag</span>(n, <span class="number">1</span>) <span class="keyword">over</span> (<span class="keyword">order</span> <span class="keyword">by</span> n) prev,</span><br><span class="line">           <span class="built_in">lead</span>(n, <span class="number">1</span>) <span class="keyword">over</span> (<span class="keyword">order</span> <span class="keyword">by</span> n) next</span><br><span class="line">      <span class="keyword">from</span> edi_t</span><br><span class="line">  ) </span><br><span class="line"><span class="keyword">where</span> n <span class="operator">=</span> prev <span class="operator">+</span> <span class="number">1</span> <span class="keyword">or</span> n <span class="operator">=</span> next <span class="operator">-</span> <span class="number">1</span>;</span><br><span class="line">  </span><br><span class="line"><span class="keyword">select</span> n </span><br><span class="line">  <span class="keyword">from</span> (</span><br><span class="line">  <span class="keyword">select</span> n,</span><br><span class="line">         <span class="built_in">count</span>(<span class="operator">*</span>) <span class="keyword">over</span> (<span class="keyword">partition</span> <span class="keyword">by</span> (n <span class="operator">-</span> rownum)) c</span><br><span class="line">    <span class="keyword">from</span> edi_t) </span><br><span class="line"><span class="keyword">where</span> c <span class="operator">&gt;</span> <span class="number">1</span></span><br><span class="line"><span class="keyword">order</span> <span class="keyword">by</span> n;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> t.n</span><br><span class="line">  <span class="keyword">from</span> edi_t t, edi_t prev</span><br><span class="line"> <span class="keyword">where</span> t.n <span class="operator">=</span> prev.n <span class="operator">+</span> <span class="number">1</span></span><br><span class="line"><span class="keyword">union</span></span><br><span class="line"><span class="keyword">select</span> t.n</span><br><span class="line">  <span class="keyword">from</span> edi_t t, edi_t next</span><br><span class="line"> <span class="keyword">where</span> t.n <span class="operator">=</span> next.n <span class="operator">-</span> <span class="number">1</span>;</span><br><span class="line"> </span><br><span class="line"><span class="comment">--drop table edi_t;</span></span><br></pre></td></tr></table></figure>
<table>
<thead>
<tr>
<th>N</th>
</tr>
</thead>
<tbody>
<tr>
<td>3</td>
</tr>
<tr>
<td>4</td>
</tr>
<tr>
<td>5</td>
</tr>
<tr>
<td>13</td>
</tr>
<tr>
<td>14</td>
</tr>
</tbody>
</table>
<h2 id="find-data-from-one-table-that-are-not-exists-in-another-table"><a class="markdownIt-Anchor" href="#find-data-from-one-table-that-are-not-exists-in-another-table">#</a> Find data from One table that are not exists in Another table</h2>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> edi_t1(</span><br><span class="line">  c varchar2(<span class="number">1</span>)</span><br><span class="line">);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> edi_t1 <span class="keyword">values</span> (<span class="string">&#x27;A&#x27;</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> edi_t1 <span class="keyword">values</span> (<span class="string">&#x27;B&#x27;</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> edi_t1 <span class="keyword">values</span> (<span class="string">&#x27;C&#x27;</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> edi_t1 <span class="keyword">values</span> (<span class="string">&#x27;D&#x27;</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> edi_t1 <span class="keyword">values</span> (<span class="string">&#x27;E&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> edi_t2(</span><br><span class="line">  c varchar2(<span class="number">1</span>)</span><br><span class="line">);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> edi_t2 <span class="keyword">values</span> (<span class="string">&#x27;A&#x27;</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> edi_t2 <span class="keyword">values</span> (<span class="string">&#x27;C&#x27;</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> edi_t2 <span class="keyword">values</span> (<span class="string">&#x27;E&#x27;</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> edi_t2 <span class="keyword">values</span> (<span class="string">&#x27;G&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">--Method 1</span></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> </span><br><span class="line">  <span class="keyword">from</span> edi_t1 </span><br><span class="line"> <span class="keyword">where</span> c <span class="keyword">not</span> <span class="keyword">in</span> (</span><br><span class="line">   <span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> edi_t2</span><br><span class="line"> );</span><br><span class="line"> </span><br><span class="line"><span class="comment">--Method 2</span></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> </span><br><span class="line">  <span class="keyword">from</span> edi_t1 t1</span><br><span class="line"> <span class="keyword">where</span> <span class="keyword">not</span> <span class="keyword">exists</span> (</span><br><span class="line">   <span class="keyword">select</span> <span class="operator">*</span> </span><br><span class="line">     <span class="keyword">from</span> edi_t2 t2 </span><br><span class="line">    <span class="keyword">where</span> t2.c <span class="operator">=</span> t1.c </span><br><span class="line"> );</span><br><span class="line"></span><br><span class="line"><span class="comment">--Method 3</span></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> edi_t1</span><br><span class="line">minus</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> edi_t2;</span><br><span class="line"></span><br><span class="line"><span class="comment">--Method 4</span></span><br><span class="line"><span class="keyword">select</span> t1.<span class="operator">*</span> </span><br><span class="line">  <span class="keyword">from</span> edi_t1 t1 <span class="keyword">left</span> <span class="keyword">outer</span> <span class="keyword">join</span> edi_t2 t2 <span class="keyword">on</span> t1.c <span class="operator">=</span> t2.c</span><br><span class="line"> <span class="keyword">where</span> t2.c <span class="keyword">is</span> <span class="keyword">null</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">--Method 5</span></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> </span><br><span class="line">  <span class="keyword">from</span> edi_t1 t1</span><br><span class="line"><span class="keyword">where</span> (<span class="keyword">select</span> <span class="built_in">count</span>(<span class="number">1</span>) <span class="keyword">from</span> edi_t2 t2 <span class="keyword">where</span> t2.c <span class="operator">=</span> t1.c) <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">--drop table edi_t1;</span></span><br><span class="line"><span class="comment">--drop table edi_t2;</span></span><br></pre></td></tr></table></figure>
<table>
<thead>
<tr>
<th>C</th>
</tr>
</thead>
<tbody>
<tr>
<td>B</td>
</tr>
<tr>
<td>D</td>
</tr>
</tbody>
</table>
<h2 id="generate-symbol"><a class="markdownIt-Anchor" href="#generate-symbol">#</a> Generate Symbol</h2>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> rpad(<span class="string">&#x27;*&#x27;</span>, rownum, <span class="string">&#x27;*&#x27;</span>) output1, </span><br><span class="line">       rpad(<span class="string">&#x27;*&#x27;</span>, <span class="number">11</span> <span class="operator">-</span> rownum, <span class="string">&#x27;*&#x27;</span>) output2,</span><br><span class="line">       rpad(<span class="string">&#x27; &#x27;</span>, rownum, <span class="string">&#x27; &#x27;</span>) <span class="operator">||</span> rpad(<span class="string">&#x27;*&#x27;</span>, <span class="number">11</span> <span class="operator">-</span> rownum, <span class="string">&#x27;*&#x27;</span>) output3,</span><br><span class="line">       rpad(<span class="string">&#x27; &#x27;</span>, <span class="number">10</span> <span class="operator">-</span> rownum, <span class="string">&#x27; &#x27;</span>) <span class="operator">||</span> rpad(<span class="string">&#x27;*&#x27;</span>, rownum, <span class="string">&#x27;*&#x27;</span>) output4,</span><br><span class="line">       rpad(<span class="string">&#x27; &#x27;</span>, rownum, <span class="string">&#x27; &#x27;</span>) <span class="operator">||</span> rpad(<span class="string">&#x27;*&#x27;</span>, rownum, <span class="string">&#x27;*&#x27;</span>) output5,</span><br><span class="line">       rpad(<span class="string">&#x27; &#x27;</span>, <span class="number">11</span> <span class="operator">-</span> rownum, <span class="string">&#x27; &#x27;</span>) <span class="operator">||</span>  rpad(<span class="string">&#x27; &#x27;</span>, <span class="number">11</span> <span class="operator">-</span> rownum, <span class="string">&#x27; &#x27;</span>) <span class="operator">||</span> rpad(<span class="string">&#x27;*&#x27;</span>, rownum, <span class="string">&#x27;*&#x27;</span>) output6</span><br><span class="line">  <span class="keyword">from</span> dual</span><br><span class="line"><span class="keyword">connect</span> <span class="keyword">by</span> level <span class="operator">&lt;=</span> <span class="number">10</span>;</span><br></pre></td></tr></table></figure>
<table>
<thead>
<tr>
<th>OUTPUT1</th>
<th>OUTPUT2</th>
<th>OUTPUT3</th>
<th>OUTPUT4</th>
<th>OUTPUT5</th>
<th>OUTPUT6</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>*</code></td>
<td><code>**********</code></td>
<td><code>**********</code></td>
<td><code>*</code></td>
<td><code>*</code></td>
<td><code>*</code></td>
</tr>
<tr>
<td><code>**</code></td>
<td><code>*********</code></td>
<td><code>*********</code></td>
<td><code>**</code></td>
<td><code>**</code></td>
<td><code>**</code></td>
</tr>
<tr>
<td><code>***</code></td>
<td><code>********</code></td>
<td><code>********</code></td>
<td><code>***</code></td>
<td><code>***</code></td>
<td><code>***</code></td>
</tr>
<tr>
<td><code>****</code></td>
<td><code>*******</code></td>
<td><code>*******</code></td>
<td><code>****</code></td>
<td><code>****</code></td>
<td><code>****</code></td>
</tr>
<tr>
<td><code>*****</code></td>
<td><code>******</code></td>
<td><code>******</code></td>
<td><code>*****</code></td>
<td><code>*****</code></td>
<td><code>*****</code></td>
</tr>
<tr>
<td><code>******</code></td>
<td><code>*****</code></td>
<td><code>*****</code></td>
<td><code>******</code></td>
<td><code>******</code></td>
<td><code>******</code></td>
</tr>
<tr>
<td><code>*******</code></td>
<td><code>****</code></td>
<td><code>****</code></td>
<td><code>*******</code></td>
<td><code>*******</code></td>
<td><code>*******</code></td>
</tr>
<tr>
<td><code>********</code></td>
<td><code>***</code></td>
<td><code>***</code></td>
<td><code>********</code></td>
<td><code>********</code></td>
<td><code>********</code></td>
</tr>
<tr>
<td><code>*********</code></td>
<td><code>**</code></td>
<td><code>**</code></td>
<td><code>*********</code></td>
<td><code>*********</code></td>
<td><code>*********</code></td>
</tr>
<tr>
<td><code>**********</code></td>
<td><code>*</code></td>
<td><code>*</code></td>
<td><code>**********</code></td>
<td><code>**********</code></td>
<td><code>**********</code></td>
</tr>
</tbody>
</table>
<h2 id="extract-names-from-mail"><a class="markdownIt-Anchor" href="#extract-names-from-mail">#</a> Extract names from mail</h2>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">with</span> t <span class="keyword">as</span> (</span><br><span class="line">  <span class="keyword">select</span> <span class="string">&#x27;Babb.K.Chen@gmail.com&#x27;</span> <span class="keyword">as</span> name <span class="keyword">from</span> dual</span><br><span class="line">)</span><br><span class="line"><span class="keyword">select</span> name,</span><br><span class="line">       <span class="comment">--regexp_substr(name, &#x27;[^.]+&#x27;) first_name,</span></span><br><span class="line">       regexp_substr(name, <span class="string">&#x27;[^.]+&#x27;</span>, <span class="number">1</span>) first_name,</span><br><span class="line">       regexp_substr(name, <span class="string">&#x27;[^.]+&#x27;</span>, <span class="number">1</span>, <span class="number">2</span>) middle_name,</span><br><span class="line">       regexp_substr(name, <span class="string">&#x27;[^.@]+&#x27;</span>, <span class="number">1</span>, <span class="number">3</span>) last_name,</span><br><span class="line">       regexp_substr(name, <span class="string">&#x27;[^@]+$&#x27;</span>) domain_name</span><br><span class="line">  <span class="keyword">from</span> t;</span><br></pre></td></tr></table></figure>
<table>
<thead>
<tr>
<th>NAME</th>
<th>FIRST_NAME</th>
<th>MIDDLE_NAME</th>
<th>LAST_NAME</th>
<th>DOMAIN_NAME</th>
</tr>
</thead>
<tbody>
<tr>
<td><span class="exturl" data-url="bWFpbHRvOkJhYmIuSy5DaGVuQGdtYWlsLmNvbQ==">Babb.K.Chen@gmail.com</span></td>
<td>Babb</td>
<td>K</td>
<td>Chen</td>
<td><span class="exturl" data-url="aHR0cDovL2dtYWlsLmNvbQ==">gmail.com</span></td>
</tr>
</tbody>
</table>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">with</span> t <span class="keyword">as</span> (</span><br><span class="line">  <span class="keyword">select</span> <span class="string">&#x27;Babb.K.Chen@gmail.com&#x27;</span> <span class="keyword">as</span> name <span class="keyword">from</span> dual</span><br><span class="line">)</span><br><span class="line"><span class="keyword">select</span> name,</span><br><span class="line">       regexp_substr(name, <span class="string">&#x27;[^.]+&#x27;</span>, <span class="number">1</span>, level) first_name</span><br><span class="line">  <span class="keyword">from</span> t</span><br><span class="line"><span class="keyword">connect</span> <span class="keyword">by</span> level <span class="operator">&lt;=</span> regexp_count(name, <span class="string">&#x27;[^.]+&#x27;</span>);</span><br></pre></td></tr></table></figure>
<table>
<thead>
<tr>
<th>NAME</th>
<th>FIRST_NAME</th>
</tr>
</thead>
<tbody>
<tr>
<td><span class="exturl" data-url="bWFpbHRvOkJhYmIuSy5DaGVuQGdtYWlsLmNvbQ==">Babb.K.Chen@gmail.com</span></td>
<td>Babb</td>
</tr>
<tr>
<td><span class="exturl" data-url="bWFpbHRvOkJhYmIuSy5DaGVuQGdtYWlsLmNvbQ==">Babb.K.Chen@gmail.com</span></td>
<td>K</td>
</tr>
<tr>
<td><span class="exturl" data-url="bWFpbHRvOkJhYmIuSy5DaGVuQGdtYWlsLmNvbQ==">Babb.K.Chen@gmail.com</span></td>
<td>Chen@gmail</td>
</tr>
<tr>
<td><span class="exturl" data-url="bWFpbHRvOkJhYmIuSy5DaGVuQGdtYWlsLmNvbQ==">Babb.K.Chen@gmail.com</span></td>
<td>com</td>
</tr>
</tbody>
</table>
<h2 id="generate-date-range"><a class="markdownIt-Anchor" href="#generate-date-range">#</a> Generate date range</h2>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">with</span> t <span class="keyword">as</span> (</span><br><span class="line">  <span class="keyword">select</span> to_date(<span class="string">&#x27;10-JAN-19&#x27;</span>, <span class="string">&#x27;DD-MON-YY&#x27;</span>) <span class="keyword">as</span> t_date <span class="keyword">from</span> dual</span><br><span class="line">  <span class="keyword">union</span> <span class="keyword">all</span></span><br><span class="line">  <span class="keyword">select</span> to_date(<span class="string">&#x27;20-JAN-19&#x27;</span>, <span class="string">&#x27;DD-MON-YY&#x27;</span>) <span class="keyword">as</span> t_date <span class="keyword">from</span> dual</span><br><span class="line">  <span class="keyword">union</span> <span class="keyword">all</span>  </span><br><span class="line">  <span class="keyword">select</span> to_date(<span class="string">&#x27;11-JAN-19&#x27;</span>, <span class="string">&#x27;DD-MON-YY&#x27;</span>) <span class="keyword">as</span> t_date <span class="keyword">from</span> dual</span><br><span class="line">), d <span class="keyword">as</span> (</span><br><span class="line">  <span class="keyword">select</span> trunc(<span class="built_in">min</span>(t_date), <span class="string">&#x27;MONTH&#x27;</span>) first_day,</span><br><span class="line">         last_day(<span class="built_in">max</span>(t_date)) <span class="operator">-</span> trunc(<span class="built_in">min</span>(t_date), <span class="string">&#x27;MONTH&#x27;</span>) <span class="operator">+</span> <span class="number">1</span> <span class="keyword">as</span> n_of_days </span><br><span class="line">  <span class="keyword">from</span> t</span><br><span class="line">)</span><br><span class="line"><span class="keyword">select</span> to_char(first_day <span class="operator">+</span> level <span class="operator">-</span> <span class="number">1</span>, <span class="string">&#x27;DD-MON-YYYY&#x27;</span>) <span class="keyword">as</span> date_range</span><br><span class="line">  <span class="keyword">from</span> d</span><br><span class="line"><span class="keyword">connect</span> <span class="keyword">by</span> level <span class="operator">&lt;=</span> n_of_days;</span><br></pre></td></tr></table></figure>
<table>
<thead>
<tr>
<th>DATE_RANGE</th>
</tr>
</thead>
<tbody>
<tr>
<td>01-JAN-2019</td>
</tr>
<tr>
<td>02-JAN-2019</td>
</tr>
<tr>
<td>03-JAN-2019</td>
</tr>
<tr>
<td>04-JAN-2019</td>
</tr>
<tr>
<td>05-JAN-2019</td>
</tr>
<tr>
<td>06-JAN-2019</td>
</tr>
<tr>
<td>07-JAN-2019</td>
</tr>
<tr>
<td>08-JAN-2019</td>
</tr>
<tr>
<td>09-JAN-2019</td>
</tr>
<tr>
<td>10-JAN-2019</td>
</tr>
<tr>
<td>11-JAN-2019</td>
</tr>
<tr>
<td>12-JAN-2019</td>
</tr>
<tr>
<td>13-JAN-2019</td>
</tr>
<tr>
<td>14-JAN-2019</td>
</tr>
<tr>
<td>15-JAN-2019</td>
</tr>
<tr>
<td>16-JAN-2019</td>
</tr>
<tr>
<td>17-JAN-2019</td>
</tr>
<tr>
<td>18-JAN-2019</td>
</tr>
<tr>
<td>19-JAN-2019</td>
</tr>
<tr>
<td>20-JAN-2019</td>
</tr>
<tr>
<td>21-JAN-2019</td>
</tr>
<tr>
<td>22-JAN-2019</td>
</tr>
<tr>
<td>23-JAN-2019</td>
</tr>
<tr>
<td>24-JAN-2019</td>
</tr>
<tr>
<td>25-JAN-2019</td>
</tr>
<tr>
<td>26-JAN-2019</td>
</tr>
<tr>
<td>27-JAN-2019</td>
</tr>
<tr>
<td>28-JAN-2019</td>
</tr>
<tr>
<td>29-JAN-2019</td>
</tr>
<tr>
<td>30-JAN-2019</td>
</tr>
<tr>
<td>31-JAN-2019</td>
</tr>
</tbody>
</table>
<h2 id="find-saturday-and-sunday"><a class="markdownIt-Anchor" href="#find-saturday-and-sunday">#</a> Find Saturday and Sunday</h2>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">with</span> t <span class="keyword">as</span> (</span><br><span class="line">  <span class="keyword">select</span> trunc(sysdate, <span class="string">&#x27;MONTH&#x27;</span>) <span class="operator">+</span> level <span class="operator">-</span> <span class="number">1</span> <span class="keyword">as</span> t_date</span><br><span class="line">    <span class="keyword">from</span> dual</span><br><span class="line">   <span class="keyword">connect</span> <span class="keyword">by</span> level <span class="operator">&lt;=</span> last_day(sysdate) <span class="operator">-</span> trunc(sysdate, <span class="string">&#x27;MONTH&#x27;</span>) <span class="operator">+</span> <span class="number">1</span></span><br><span class="line"> )</span><br><span class="line"><span class="keyword">select</span> t_date, to_char(t_date, <span class="string">&#x27;DAY&#x27;</span>) t_day, to_char(t_date, <span class="string">&#x27;DY&#x27;</span>) t_dy, to_char(t_date, <span class="string">&#x27;D&#x27;</span>) <span class="keyword">as</span> t_d</span><br><span class="line">  <span class="keyword">from</span> t</span><br><span class="line"> <span class="keyword">where</span> to_char(t_date, <span class="string">&#x27;DY&#x27;</span>) <span class="keyword">in</span> (<span class="string">&#x27;SAT&#x27;</span>, <span class="string">&#x27;SUN&#x27;</span>);</span><br></pre></td></tr></table></figure>
<table>
<thead>
<tr>
<th>T_DATE</th>
<th>T_DAY</th>
<th>T_DY</th>
<th>T_D</th>
</tr>
</thead>
<tbody>
<tr>
<td>2024-01-06</td>
<td>SATURDAY</td>
<td>SAT</td>
<td>7</td>
</tr>
<tr>
<td>2024-01-07</td>
<td>SUNDAY</td>
<td>SUN</td>
<td>1</td>
</tr>
<tr>
<td>2024-01-13</td>
<td>SATURDAY</td>
<td>SAT</td>
<td>7</td>
</tr>
<tr>
<td>2024-01-14</td>
<td>SUNDAY</td>
<td>SUN</td>
<td>1</td>
</tr>
<tr>
<td>2024-01-20</td>
<td>SATURDAY</td>
<td>SAT</td>
<td>7</td>
</tr>
<tr>
<td>2024-01-21</td>
<td>SUNDAY</td>
<td>SUN</td>
<td>1</td>
</tr>
<tr>
<td>2024-01-27</td>
<td>SATURDAY</td>
<td>SAT</td>
<td>7</td>
</tr>
<tr>
<td>2024-01-28</td>
<td>SUNDAY</td>
<td>SUN</td>
<td>1</td>
</tr>
</tbody>
</table>
<h2 id="find-match-played-won-lost-count"><a class="markdownIt-Anchor" href="#find-match-played-won-lost-count">#</a> Find Match Played, Won, Lost count</h2>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> edi_t(</span><br><span class="line">  match_no number,</span><br><span class="line">  team_a varchar2(<span class="number">10</span>),</span><br><span class="line">  team_b varchar2(<span class="number">10</span>),</span><br><span class="line">  winner varchar2(<span class="number">10</span>)</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> edi_t <span class="keyword">values</span> (<span class="number">1</span>, <span class="string">&#x27;ABC&#x27;</span>, <span class="string">&#x27;SLP&#x27;</span>, <span class="string">&#x27;ABC&#x27;</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> edi_t <span class="keyword">values</span> (<span class="number">2</span>, <span class="string">&#x27;ABC&#x27;</span>, <span class="string">&#x27;BUS&#x27;</span>, <span class="string">&#x27;ABC&#x27;</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> edi_t <span class="keyword">values</span> (<span class="number">3</span>, <span class="string">&#x27;ABC&#x27;</span>, <span class="string">&#x27;XYZ&#x27;</span>, <span class="string">&#x27;XYZ&#x27;</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> edi_t <span class="keyword">values</span> (<span class="number">4</span>, <span class="string">&#x27;AHI&#x27;</span>, <span class="string">&#x27;XYZ&#x27;</span>, <span class="string">&#x27;XYZ&#x27;</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> edi_t <span class="keyword">values</span> (<span class="number">5</span>, <span class="string">&#x27;SNI&#x27;</span>, <span class="string">&#x27;XYZ&#x27;</span>, <span class="string">&#x27;XYZ&#x27;</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> edi_t <span class="keyword">values</span> (<span class="number">6</span>, <span class="string">&#x27;WDU&#x27;</span>, <span class="string">&#x27;ZZC&#x27;</span>, <span class="string">&#x27;ZZC&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span>  edi_t;  </span><br></pre></td></tr></table></figure>
<table>
<thead>
<tr>
<th>MATCH_NO</th>
<th>TEAM_A</th>
<th>TEAM_B</th>
<th>WINNER</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td><strong>ABC</strong></td>
<td>SLP</td>
<td><strong>ABC</strong></td>
</tr>
<tr>
<td>2</td>
<td><strong>ABC</strong></td>
<td>BUS</td>
<td><strong>ABC</strong></td>
</tr>
<tr>
<td>3</td>
<td><strong>ABC</strong></td>
<td><strong>XYZ</strong></td>
<td><strong>XYZ</strong></td>
</tr>
<tr>
<td>4</td>
<td>AHI</td>
<td><strong>XYZ</strong></td>
<td><strong>XYZ</strong></td>
</tr>
<tr>
<td>5</td>
<td>SNI</td>
<td><strong>XYZ</strong></td>
<td><strong>XYZ</strong></td>
</tr>
<tr>
<td>6</td>
<td>WDU</td>
<td>ZZC</td>
<td>ZZC</td>
</tr>
</tbody>
</table>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">with</span> t <span class="keyword">as</span> (</span><br><span class="line">  <span class="keyword">select</span> team_a, team_b,</span><br><span class="line">         <span class="keyword">case</span> <span class="keyword">when</span> team_a <span class="operator">=</span> winner <span class="keyword">then</span> <span class="number">1</span> <span class="keyword">else</span> <span class="number">0</span> <span class="keyword">end</span> t_a,</span><br><span class="line">         <span class="keyword">case</span> <span class="keyword">when</span> team_b <span class="operator">=</span> winner <span class="keyword">then</span> <span class="number">1</span> <span class="keyword">else</span> <span class="number">0</span> <span class="keyword">end</span> t_b</span><br><span class="line">    <span class="keyword">from</span> edi_t</span><br><span class="line">) </span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> t;</span><br></pre></td></tr></table></figure>
<table>
<thead>
<tr>
<th>TEAM_A</th>
<th>TEAM_B</th>
<th>T_A</th>
<th>T_B</th>
</tr>
</thead>
<tbody>
<tr>
<td>ABC</td>
<td>SLP</td>
<td>1</td>
<td>0</td>
</tr>
<tr>
<td>ABC</td>
<td>BUS</td>
<td>1</td>
<td>0</td>
</tr>
<tr>
<td>ABC</td>
<td>XYZ</td>
<td>0</td>
<td>1</td>
</tr>
<tr>
<td>AHI</td>
<td>XYZ</td>
<td>0</td>
<td>1</td>
</tr>
<tr>
<td>SNI</td>
<td>XYZ</td>
<td>0</td>
<td>1</td>
</tr>
<tr>
<td>WDU</td>
<td>ZZC</td>
<td>0</td>
<td>1</td>
</tr>
</tbody>
</table>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">with</span> t <span class="keyword">as</span> (</span><br><span class="line">  <span class="keyword">select</span> team_a, team_b,</span><br><span class="line">         <span class="keyword">case</span> <span class="keyword">when</span> team_a <span class="operator">=</span> winner <span class="keyword">then</span> <span class="number">1</span> <span class="keyword">else</span> <span class="number">0</span> <span class="keyword">end</span> t_a,</span><br><span class="line">         <span class="keyword">case</span> <span class="keyword">when</span> team_b <span class="operator">=</span> winner <span class="keyword">then</span> <span class="number">1</span> <span class="keyword">else</span> <span class="number">0</span> <span class="keyword">end</span> t_b</span><br><span class="line">    <span class="keyword">from</span> edi_t</span><br><span class="line">) </span><br><span class="line"><span class="keyword">select</span> team,</span><br><span class="line">       <span class="built_in">count</span>(<span class="operator">*</span>) <span class="keyword">as</span> played,</span><br><span class="line">       <span class="built_in">sum</span>(t_r) <span class="keyword">as</span> won,</span><br><span class="line">       <span class="built_in">count</span>(<span class="operator">*</span>) <span class="operator">-</span> <span class="built_in">sum</span>(t_r) <span class="keyword">as</span> lost</span><br><span class="line">  <span class="keyword">from</span> (<span class="keyword">select</span> decode(r, <span class="number">1</span>, team_a, team_b) <span class="keyword">as</span> team,</span><br><span class="line">               decode(r, <span class="number">1</span>, t_a, t_b) <span class="keyword">as</span> t_r</span><br><span class="line">          <span class="keyword">from</span> t, (<span class="keyword">select</span> rownum r <span class="keyword">from</span> dual <span class="keyword">connect</span> <span class="keyword">by</span> level <span class="operator">&lt;=</span> <span class="number">2</span>))</span><br><span class="line"> <span class="keyword">group</span> <span class="keyword">by</span> team</span><br><span class="line"> <span class="keyword">order</span> <span class="keyword">by</span> won <span class="keyword">desc</span>;</span><br></pre></td></tr></table></figure>
<table>
<thead>
<tr>
<th>TEAM</th>
<th>PLAYED</th>
<th>WON</th>
<th>LOST</th>
</tr>
</thead>
<tbody>
<tr>
<td>XYZ</td>
<td>3</td>
<td>3</td>
<td>0</td>
</tr>
<tr>
<td>ABC</td>
<td>3</td>
<td>2</td>
<td>1</td>
</tr>
<tr>
<td>ZZC</td>
<td>1</td>
<td>1</td>
<td>0</td>
</tr>
<tr>
<td>WDU</td>
<td>1</td>
<td>0</td>
<td>1</td>
</tr>
<tr>
<td>BUS</td>
<td>1</td>
<td>0</td>
<td>1</td>
</tr>
<tr>
<td>AHI</td>
<td>1</td>
<td>0</td>
<td>1</td>
</tr>
<tr>
<td>SLP</td>
<td>1</td>
<td>0</td>
<td>1</td>
</tr>
<tr>
<td>SNI</td>
<td>1</td>
<td>0</td>
<td>1</td>
</tr>
</tbody>
</table>
<h2 id="find-dice-rolled-combinations-and-the-third-rolled-dice-is-equal-to-sum-of-first-and-second-value"><a class="markdownIt-Anchor" href="#find-dice-rolled-combinations-and-the-third-rolled-dice-is-equal-to-sum-of-first-and-second-value">#</a> Find dice rolled combinations and the third rolled dice is equal to sum of first and second value</h2>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">with</span> t <span class="keyword">as</span> (</span><br><span class="line">   <span class="keyword">select</span> level r </span><br><span class="line">     <span class="keyword">from</span> dual</span><br><span class="line">   <span class="keyword">connect</span> <span class="keyword">by</span> level <span class="operator">&lt;=</span> <span class="number">6</span></span><br><span class="line">)</span><br><span class="line"><span class="keyword">select</span> t1.r, t2.r, t3.r</span><br><span class="line">  <span class="keyword">from</span> t t1, t t2, t t3</span><br><span class="line"> <span class="keyword">where</span> t3.r <span class="operator">=</span> t1.r <span class="operator">+</span> t2.r;</span><br><span class="line"> </span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> t <span class="keyword">as</span> (</span><br><span class="line">   <span class="keyword">select</span> level r </span><br><span class="line">     <span class="keyword">from</span> dual</span><br><span class="line">   <span class="keyword">connect</span> <span class="keyword">by</span> level <span class="operator">&lt;=</span> <span class="number">6</span></span><br><span class="line">)</span><br><span class="line"><span class="keyword">select</span> t1.r, t2.r, t1.r <span class="operator">+</span> t2.r</span><br><span class="line">  <span class="keyword">from</span> t t1, t t2</span><br><span class="line"> <span class="keyword">where</span> t1.r <span class="operator">+</span> t2.r <span class="keyword">in</span> (<span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>)</span><br><span class="line"><span class="keyword">order</span> <span class="keyword">by</span> t1.r <span class="operator">+</span> t2.r;</span><br></pre></td></tr></table></figure>
<table>
<thead>
<tr>
<th>R</th>
<th>R</th>
<th>T1.R+T2.R</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>1</td>
<td>2</td>
</tr>
<tr>
<td>1</td>
<td>2</td>
<td>3</td>
</tr>
<tr>
<td>2</td>
<td>1</td>
<td>3</td>
</tr>
<tr>
<td>2</td>
<td>2</td>
<td>4</td>
</tr>
<tr>
<td>1</td>
<td>3</td>
<td>4</td>
</tr>
<tr>
<td>3</td>
<td>1</td>
<td>4</td>
</tr>
<tr>
<td>1</td>
<td>4</td>
<td>5</td>
</tr>
<tr>
<td>2</td>
<td>3</td>
<td>5</td>
</tr>
<tr>
<td>4</td>
<td>1</td>
<td>5</td>
</tr>
<tr>
<td>3</td>
<td>2</td>
<td>5</td>
</tr>
<tr>
<td>4</td>
<td>2</td>
<td>6</td>
</tr>
<tr>
<td>3</td>
<td>3</td>
<td>6</td>
</tr>
<tr>
<td>1</td>
<td>5</td>
<td>6</td>
</tr>
<tr>
<td>2</td>
<td>4</td>
<td>6</td>
</tr>
<tr>
<td>5</td>
<td>1</td>
<td>6</td>
</tr>
</tbody>
</table>
<h2 id="sort-the-numbers-in-the-commas-seperated-list"><a class="markdownIt-Anchor" href="#sort-the-numbers-in-the-commas-seperated-list">#</a> Sort the numbers in the commas seperated list</h2>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">with</span> t <span class="keyword">as</span> (</span><br><span class="line">  <span class="keyword">select</span> <span class="string">&#x27;3,10,5,1,7,100,12&#x27;</span> s <span class="keyword">from</span> dual</span><br><span class="line">)</span><br><span class="line"><span class="keyword">select</span> s, <span class="built_in">listagg</span>(n, <span class="string">&#x27;,&#x27;</span>) <span class="keyword">within</span> <span class="keyword">group</span> (<span class="keyword">order</span> <span class="keyword">by</span> to_number(n)) <span class="keyword">as</span> sorted_result</span><br><span class="line"><span class="keyword">from</span>(</span><br><span class="line">  <span class="keyword">select</span> s, regexp_substr(s, <span class="string">&#x27;[^,]+&#x27;</span>, <span class="number">1</span>, level) n</span><br><span class="line">    <span class="keyword">from</span> t</span><br><span class="line">  <span class="keyword">connect</span> <span class="keyword">by</span> level <span class="operator">&lt;=</span> regexp_count(s, <span class="string">&#x27;,&#x27;</span>) <span class="operator">+</span> <span class="number">1</span></span><br><span class="line">) <span class="keyword">group</span> <span class="keyword">by</span> s; </span><br></pre></td></tr></table></figure>
<table>
<thead>
<tr>
<th>S</th>
<th>SORTED_RESULT</th>
</tr>
</thead>
<tbody>
<tr>
<td>3,10,5,1,7,100,12</td>
<td>1,3,5,7,10,12,100</td>
</tr>
</tbody>
</table>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">with</span> t <span class="keyword">as</span> (</span><br><span class="line">  <span class="keyword">select</span> <span class="string">&#x27;3   10 5 1     7   100   12&#x27;</span> s <span class="keyword">from</span> dual</span><br><span class="line">)</span><br><span class="line"><span class="keyword">select</span> s, <span class="built_in">listagg</span>(n, <span class="string">&#x27; &#x27;</span>) <span class="keyword">within</span> <span class="keyword">group</span> (<span class="keyword">order</span> <span class="keyword">by</span> to_number(n)) <span class="keyword">as</span> sorted_result</span><br><span class="line"><span class="keyword">from</span>(</span><br><span class="line">  <span class="keyword">select</span> s, regexp_substr(regexp_replace(s, <span class="string">&#x27;\D+&#x27;</span>, <span class="string">&#x27;,&#x27;</span>), <span class="string">&#x27;[^,]+&#x27;</span>, <span class="number">1</span>, level) n</span><br><span class="line">    <span class="keyword">from</span> t</span><br><span class="line">  <span class="keyword">connect</span> <span class="keyword">by</span> level <span class="operator">&lt;=</span> regexp_count(regexp_replace(s, <span class="string">&#x27;\D+&#x27;</span>, <span class="string">&#x27;,&#x27;</span>), <span class="string">&#x27;,&#x27;</span>) <span class="operator">+</span> <span class="number">1</span></span><br><span class="line">) <span class="keyword">group</span> <span class="keyword">by</span> s; </span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> t <span class="keyword">as</span> (</span><br><span class="line">  <span class="keyword">select</span> <span class="string">&#x27;3   10 5 1     7   100   12&#x27;</span> s <span class="keyword">from</span> dual</span><br><span class="line">)</span><br><span class="line"><span class="keyword">select</span> s, <span class="built_in">listagg</span>(n, <span class="string">&#x27; &#x27;</span>) <span class="keyword">within</span> <span class="keyword">group</span> (<span class="keyword">order</span> <span class="keyword">by</span> to_number(n)) <span class="keyword">as</span> sorted_result</span><br><span class="line"><span class="keyword">from</span>(</span><br><span class="line">  <span class="keyword">select</span> s, regexp_substr(s, <span class="string">&#x27;\d+&#x27;</span>, <span class="number">1</span>, level) n  <span class="comment">--\d+ &lt;=&gt; [0-9]+</span></span><br><span class="line">    <span class="keyword">from</span> t</span><br><span class="line">  <span class="keyword">connect</span> <span class="keyword">by</span> level <span class="operator">&lt;=</span> regexp_count(s, <span class="string">&#x27;\D+&#x27;</span>) <span class="operator">+</span> <span class="number">1</span> <span class="comment">--\D+ &lt;=&gt; [^0-9]+</span></span><br><span class="line">) <span class="keyword">group</span> <span class="keyword">by</span> s; </span><br></pre></td></tr></table></figure>
<table>
<thead>
<tr>
<th>S</th>
<th>SORTED_RESULT</th>
</tr>
</thead>
<tbody>
<tr>
<td>3   10 5 1     7   100   12</td>
<td>1 3 5 7 10 12 100</td>
</tr>
</tbody>
</table>
<h2 id="reverse-string"><a class="markdownIt-Anchor" href="#reverse-string">#</a> Reverse string</h2>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> reverse(<span class="string">&#x27;WELCOME&#x27;</span>) <span class="keyword">from</span> dual;</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> t <span class="keyword">as</span> (</span><br><span class="line">   <span class="keyword">select</span> <span class="string">&#x27;WELCOME&#x27;</span> <span class="keyword">as</span> s <span class="keyword">from</span> dual</span><br><span class="line">)</span><br><span class="line"><span class="keyword">select</span> <span class="built_in">listagg</span>(ss, <span class="string">&#x27;&#x27;</span>) <span class="keyword">within</span> <span class="keyword">group</span> (<span class="keyword">order</span> <span class="keyword">by</span> l <span class="keyword">desc</span>) <span class="keyword">as</span> reversed_result</span><br><span class="line">  <span class="keyword">from</span> (</span><br><span class="line">    <span class="keyword">select</span> substr(s, level, <span class="number">1</span>) ss, level l</span><br><span class="line">      <span class="keyword">from</span> t</span><br><span class="line">    <span class="keyword">connect</span> <span class="keyword">by</span> level <span class="operator">&lt;=</span> length(s)</span><br><span class="line">);</span><br></pre></td></tr></table></figure>
<table>
<thead>
<tr>
<th>REVERSED_RESULT</th>
</tr>
</thead>
<tbody>
<tr>
<td>EMOCLEW</td>
</tr>
</tbody>
</table>
<h2 id="consolidate-first-row-and-last-row-second-row-and-second-from-last-row-as-single-row"><a class="markdownIt-Anchor" href="#consolidate-first-row-and-last-row-second-row-and-second-from-last-row-as-single-row">#</a> Consolidate first row and last row, second row and second from last row … as single row</h2>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">with</span> t <span class="keyword">as</span> (</span><br><span class="line">   <span class="keyword">select</span> level <span class="keyword">no</span>, chr(ascii(<span class="string">&#x27;A&#x27;</span>) <span class="operator">+</span> level <span class="operator">-</span> <span class="number">1</span>) name</span><br><span class="line">     <span class="keyword">from</span> dual</span><br><span class="line">   <span class="keyword">connect</span> <span class="keyword">by</span> level <span class="operator">&lt;=</span> <span class="number">11</span></span><br><span class="line">)</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> t;</span><br></pre></td></tr></table></figure>
<table>
<thead>
<tr>
<th>NO</th>
<th>NAME</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>A</td>
</tr>
<tr>
<td>2</td>
<td>B</td>
</tr>
<tr>
<td>3</td>
<td>C</td>
</tr>
<tr>
<td>4</td>
<td>D</td>
</tr>
<tr>
<td>5</td>
<td>E</td>
</tr>
<tr>
<td>6</td>
<td>F</td>
</tr>
<tr>
<td>7</td>
<td>G</td>
</tr>
<tr>
<td>8</td>
<td>H</td>
</tr>
<tr>
<td>9</td>
<td>I</td>
</tr>
<tr>
<td>10</td>
<td>J</td>
</tr>
<tr>
<td>11</td>
<td>K</td>
</tr>
</tbody>
</table>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">with</span> t <span class="keyword">as</span> (</span><br><span class="line">   <span class="keyword">select</span> level <span class="keyword">no</span>, chr(ascii(<span class="string">&#x27;A&#x27;</span>) <span class="operator">+</span> level <span class="operator">-</span> <span class="number">1</span>) name</span><br><span class="line">     <span class="keyword">from</span> dual</span><br><span class="line">   <span class="keyword">connect</span> <span class="keyword">by</span> level <span class="operator">&lt;=</span> <span class="number">11</span></span><br><span class="line">),</span><br><span class="line">t1 <span class="keyword">as</span> (</span><br><span class="line">  <span class="keyword">select</span> <span class="keyword">no</span>,</span><br><span class="line">         name,</span><br><span class="line">   		 <span class="built_in">count</span>(<span class="number">1</span>) <span class="keyword">over</span>() <span class="operator">/</span> <span class="number">2</span>,</span><br><span class="line">         <span class="built_in">row_number</span>() <span class="keyword">over</span> (<span class="keyword">order</span> <span class="keyword">by</span> <span class="keyword">no</span>),</span><br><span class="line">         round(<span class="built_in">count</span>(<span class="number">1</span>) <span class="keyword">over</span>() <span class="operator">/</span> <span class="number">2</span>) <span class="operator">-</span> <span class="built_in">row_number</span>() <span class="keyword">over</span> (<span class="keyword">order</span> <span class="keyword">by</span> <span class="keyword">no</span>) <span class="keyword">as</span> c</span><br><span class="line">    <span class="keyword">from</span> t</span><br><span class="line">)</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> t1;</span><br></pre></td></tr></table></figure>
<table>
<thead>
<tr>
<th>NO</th>
<th>NAME</th>
<th>COUNT(1)OVER()/2</th>
<th>ROW_NUMBER()OVER(ORDERBYNO)</th>
<th>C</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>A</td>
<td>5.5</td>
<td>1</td>
<td>5</td>
</tr>
<tr>
<td>2</td>
<td>B</td>
<td>5.5</td>
<td>2</td>
<td>4</td>
</tr>
<tr>
<td>3</td>
<td>C</td>
<td>5.5</td>
<td>3</td>
<td>3</td>
</tr>
<tr>
<td>4</td>
<td>D</td>
<td>5.5</td>
<td>4</td>
<td>2</td>
</tr>
<tr>
<td>5</td>
<td>E</td>
<td>5.5</td>
<td>5</td>
<td>1</td>
</tr>
<tr>
<td>6</td>
<td>F</td>
<td>5.5</td>
<td>6</td>
<td>0</td>
</tr>
<tr>
<td>7</td>
<td>G</td>
<td>5.5</td>
<td>7</td>
<td>-1</td>
</tr>
<tr>
<td>8</td>
<td>H</td>
<td>5.5</td>
<td>8</td>
<td>-2</td>
</tr>
<tr>
<td>9</td>
<td>I</td>
<td>5.5</td>
<td>9</td>
<td>-3</td>
</tr>
<tr>
<td>10</td>
<td>J</td>
<td>5.5</td>
<td>10</td>
<td>-4</td>
</tr>
<tr>
<td>11</td>
<td>K</td>
<td>5.5</td>
<td>11</td>
<td>-5</td>
</tr>
</tbody>
</table>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">with</span> t <span class="keyword">as</span> (</span><br><span class="line">   <span class="keyword">select</span> level <span class="keyword">no</span>, chr(ascii(<span class="string">&#x27;A&#x27;</span>) <span class="operator">+</span> level <span class="operator">-</span> <span class="number">1</span>) name</span><br><span class="line">     <span class="keyword">from</span> dual</span><br><span class="line">   <span class="keyword">connect</span> <span class="keyword">by</span> level <span class="operator">&lt;=</span> <span class="number">11</span></span><br><span class="line">),</span><br><span class="line">t1 <span class="keyword">as</span> (</span><br><span class="line">  <span class="keyword">select</span> <span class="keyword">no</span>,</span><br><span class="line">         name,</span><br><span class="line">         round(<span class="built_in">count</span>(<span class="number">1</span>) <span class="keyword">over</span>() <span class="operator">/</span> <span class="number">2</span>) <span class="operator">-</span> <span class="built_in">row_number</span>() <span class="keyword">over</span> (<span class="keyword">order</span> <span class="keyword">by</span> <span class="keyword">no</span>) <span class="keyword">as</span> c</span><br><span class="line">    <span class="keyword">from</span> t</span><br><span class="line">)</span><br><span class="line">d1 <span class="keyword">as</span> (<span class="keyword">select</span> <span class="keyword">no</span>, name, c <span class="keyword">from</span> t1 <span class="keyword">where</span> c <span class="operator">&gt;=</span> <span class="number">0</span>),</span><br><span class="line">d2 <span class="keyword">as</span> (<span class="keyword">select</span> <span class="keyword">no</span>, name, <span class="built_in">abs</span>(c) c <span class="keyword">from</span> t1 <span class="keyword">where</span> c <span class="operator">&lt;</span> <span class="number">0</span>)</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> </span><br><span class="line">  <span class="keyword">from</span> d1 <span class="keyword">left</span> <span class="keyword">outer</span> <span class="keyword">join</span> d2 <span class="keyword">on</span> d1.c <span class="operator">=</span> d2.c</span><br><span class="line"><span class="keyword">order</span> <span class="keyword">by</span> d1.no;</span><br></pre></td></tr></table></figure>
<table>
<thead>
<tr>
<th>NO</th>
<th>NAME</th>
<th>C</th>
<th>NO</th>
<th>NAME</th>
<th>C</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>A</td>
<td>5</td>
<td>11</td>
<td>K</td>
<td>5</td>
</tr>
<tr>
<td>2</td>
<td>B</td>
<td>4</td>
<td>10</td>
<td>J</td>
<td>4</td>
</tr>
<tr>
<td>3</td>
<td>C</td>
<td>3</td>
<td>9</td>
<td>I</td>
<td>3</td>
</tr>
<tr>
<td>4</td>
<td>D</td>
<td>2</td>
<td>8</td>
<td>H</td>
<td>2</td>
</tr>
<tr>
<td>5</td>
<td>E</td>
<td>1</td>
<td>7</td>
<td>G</td>
<td>1</td>
</tr>
<tr>
<td>6</td>
<td>F</td>
<td>0</td>
<td></td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
<h2 id="fill-the-missing-dates-with-last-not-null-value"><a class="markdownIt-Anchor" href="#fill-the-missing-dates-with-last-not-null-value">#</a> Fill the missing dates with last not null value</h2>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">with</span> t <span class="keyword">as</span> (</span><br><span class="line">  <span class="keyword">select</span> to_date(<span class="string">&#x27;20-JUL-19&#x27;</span>, <span class="string">&#x27;DD-MON-YY&#x27;</span>) <span class="keyword">as</span> dt, <span class="number">100</span> <span class="keyword">as</span> amount <span class="keyword">from</span> dual </span><br><span class="line">  <span class="keyword">union</span> <span class="keyword">all</span></span><br><span class="line">  <span class="keyword">select</span> to_date(<span class="string">&#x27;25-JUL-19&#x27;</span>, <span class="string">&#x27;DD-MON-YY&#x27;</span>), <span class="number">200</span> <span class="keyword">from</span> dual </span><br><span class="line">  <span class="keyword">union</span> <span class="keyword">all</span></span><br><span class="line">  <span class="keyword">select</span> to_date(<span class="string">&#x27;30-JUL-19&#x27;</span>, <span class="string">&#x27;DD-MON-YY&#x27;</span>), <span class="number">300</span> <span class="keyword">from</span> dual </span><br><span class="line">), d <span class="keyword">as</span> (</span><br><span class="line">  <span class="keyword">select</span> <span class="built_in">min</span>(dt) min_dt, <span class="built_in">max</span>(dt) max_dt, <span class="built_in">max</span>(dt) <span class="operator">-</span> <span class="built_in">min</span>(dt) <span class="operator">+</span> <span class="number">1</span> num</span><br><span class="line">   <span class="keyword">from</span> t</span><br><span class="line">), d1 <span class="keyword">as</span> (</span><br><span class="line">  <span class="keyword">select</span> min_dt <span class="operator">+</span> level <span class="operator">-</span> <span class="number">1</span> <span class="keyword">as</span> dt</span><br><span class="line">    <span class="keyword">from</span> d</span><br><span class="line">  <span class="keyword">connect</span> <span class="keyword">by</span> level <span class="operator">&lt;=</span> num</span><br><span class="line">) </span><br><span class="line"><span class="keyword">select</span> d1.dt, amount</span><br><span class="line">  <span class="keyword">from</span> d1 <span class="keyword">left</span> <span class="keyword">outer</span> <span class="keyword">join</span> t</span><br><span class="line">    <span class="keyword">on</span> d1.dt <span class="operator">=</span> t.dt</span><br><span class="line"> <span class="keyword">order</span> <span class="keyword">by</span> d1.dt;</span><br></pre></td></tr></table></figure>
<table>
<thead>
<tr>
<th>DT</th>
<th>AMOUNT</th>
</tr>
</thead>
<tbody>
<tr>
<td>2019-07-20</td>
<td>100</td>
</tr>
<tr>
<td>2019-07-21</td>
<td></td>
</tr>
<tr>
<td>2019-07-22</td>
<td></td>
</tr>
<tr>
<td>2019-07-23</td>
<td></td>
</tr>
<tr>
<td>2019-07-24</td>
<td></td>
</tr>
<tr>
<td>2019-07-25</td>
<td>200</td>
</tr>
<tr>
<td>2019-07-26</td>
<td></td>
</tr>
<tr>
<td>2019-07-27</td>
<td></td>
</tr>
<tr>
<td>2019-07-28</td>
<td></td>
</tr>
<tr>
<td>2019-07-29</td>
<td></td>
</tr>
<tr>
<td>2019-07-30</td>
<td>300</td>
</tr>
</tbody>
</table>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">with</span> t <span class="keyword">as</span> (</span><br><span class="line">  <span class="keyword">select</span> to_date(<span class="string">&#x27;20-JUL-19&#x27;</span>, <span class="string">&#x27;DD-MON-YY&#x27;</span>) <span class="keyword">as</span> dt, <span class="number">100</span> <span class="keyword">as</span> amount <span class="keyword">from</span> dual </span><br><span class="line">  <span class="keyword">union</span> <span class="keyword">all</span></span><br><span class="line">  <span class="keyword">select</span> to_date(<span class="string">&#x27;25-JUL-19&#x27;</span>, <span class="string">&#x27;DD-MON-YY&#x27;</span>), <span class="number">200</span> <span class="keyword">from</span> dual </span><br><span class="line">  <span class="keyword">union</span> <span class="keyword">all</span></span><br><span class="line">  <span class="keyword">select</span> to_date(<span class="string">&#x27;30-JUL-19&#x27;</span>, <span class="string">&#x27;DD-MON-YY&#x27;</span>), <span class="number">300</span> <span class="keyword">from</span> dual </span><br><span class="line">), d <span class="keyword">as</span> (</span><br><span class="line">  <span class="keyword">select</span> <span class="built_in">min</span>(dt) min_dt, <span class="built_in">max</span>(dt) max_dt, <span class="built_in">max</span>(dt) <span class="operator">-</span> <span class="built_in">min</span>(dt) <span class="operator">+</span> <span class="number">1</span> num</span><br><span class="line">   <span class="keyword">from</span> t</span><br><span class="line">), d1 <span class="keyword">as</span> (</span><br><span class="line">  <span class="keyword">select</span> min_dt <span class="operator">+</span> level <span class="operator">-</span> <span class="number">1</span> <span class="keyword">as</span> dt</span><br><span class="line">    <span class="keyword">from</span> d</span><br><span class="line">  <span class="keyword">connect</span> <span class="keyword">by</span> level <span class="operator">&lt;=</span> num</span><br><span class="line">) </span><br><span class="line"><span class="keyword">select</span> d1.dt, </span><br><span class="line">       <span class="built_in">last_value</span>(amount ignore nulls) <span class="keyword">over</span> (<span class="keyword">order</span> <span class="keyword">by</span> d1.dt <span class="comment">/*RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW*/</span>) amount,</span><br><span class="line">       <span class="built_in">last_value</span>(amount ignore nulls) <span class="keyword">over</span> (<span class="keyword">order</span> <span class="keyword">by</span> d1.dt <span class="keyword">rows</span> <span class="keyword">between</span> unbounded preceding <span class="keyword">and</span> unbounded following) amount2</span><br><span class="line">  <span class="keyword">from</span> d1 <span class="keyword">left</span> <span class="keyword">outer</span> <span class="keyword">join</span> t</span><br><span class="line">    <span class="keyword">on</span> d1.dt <span class="operator">=</span> t.dt</span><br><span class="line"> <span class="keyword">order</span> <span class="keyword">by</span> d1.dt;</span><br></pre></td></tr></table></figure>
<table>
<thead>
<tr>
<th>DT</th>
<th>AMOUNT</th>
<th>AMOUNT2</th>
</tr>
</thead>
<tbody>
<tr>
<td>2019-07-20</td>
<td>100</td>
<td>300</td>
</tr>
<tr>
<td>2019-07-21</td>
<td>100</td>
<td>300</td>
</tr>
<tr>
<td>2019-07-22</td>
<td>100</td>
<td>300</td>
</tr>
<tr>
<td>2019-07-23</td>
<td>100</td>
<td>300</td>
</tr>
<tr>
<td>2019-07-24</td>
<td>100</td>
<td>300</td>
</tr>
<tr>
<td>2019-07-25</td>
<td>200</td>
<td>300</td>
</tr>
<tr>
<td>2019-07-26</td>
<td>200</td>
<td>300</td>
</tr>
<tr>
<td>2019-07-27</td>
<td>200</td>
<td>300</td>
</tr>
<tr>
<td>2019-07-28</td>
<td>200</td>
<td>300</td>
</tr>
<tr>
<td>2019-07-29</td>
<td>200</td>
<td>300</td>
</tr>
<tr>
<td>2019-07-30</td>
<td>300</td>
<td>300</td>
</tr>
</tbody>
</table>
<h2 id="compute-the-start-and-end-value-of-group-in-given-seq"><a class="markdownIt-Anchor" href="#compute-the-start-and-end-value-of-group-in-given-seq">#</a> Compute the start and end value of group in given seq</h2>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> type edi_number_list <span class="keyword">is</span> <span class="keyword">table</span> <span class="keyword">of</span> number;</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> t <span class="keyword">as</span> (</span><br><span class="line">  <span class="keyword">select</span> COLUMN_VALUE <span class="keyword">as</span> d </span><br><span class="line">    <span class="keyword">from</span> <span class="keyword">table</span>(edi_number_list(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">5</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>, <span class="number">11</span>, <span class="number">12</span>, <span class="number">15</span>, <span class="number">16</span>, <span class="number">20</span>))</span><br><span class="line">) </span><br><span class="line"><span class="keyword">select</span> <span class="built_in">min</span>(d) <span class="keyword">as</span> range_start, <span class="built_in">max</span>(d) <span class="keyword">as</span> range_end, d<span class="operator">-</span>rownum, <span class="built_in">count</span>(<span class="operator">*</span>)  </span><br><span class="line">  <span class="keyword">from</span> t</span><br><span class="line"> <span class="keyword">group</span> <span class="keyword">by</span> d<span class="operator">-</span>rownum</span><br><span class="line"> <span class="keyword">order</span> <span class="keyword">by</span> <span class="number">1</span>;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">with</span> t <span class="keyword">as</span></span><br><span class="line"> (<span class="keyword">select</span> column_value <span class="keyword">as</span> d</span><br><span class="line">    <span class="keyword">from</span> <span class="keyword">table</span>(sys.odcinumberlist(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">5</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>, <span class="number">11</span>, <span class="number">12</span>, <span class="number">15</span>, <span class="number">16</span>, <span class="number">20</span>)))</span><br><span class="line"><span class="keyword">select</span> <span class="built_in">min</span>(d) <span class="keyword">as</span> range_start, <span class="built_in">max</span>(d) <span class="keyword">as</span> range_end, d <span class="operator">-</span> rownum, <span class="built_in">count</span>(<span class="operator">*</span>)</span><br><span class="line">  <span class="keyword">from</span> t</span><br><span class="line"> <span class="keyword">group</span> <span class="keyword">by</span> d <span class="operator">-</span> rownum</span><br><span class="line"> <span class="keyword">order</span> <span class="keyword">by</span> <span class="number">1</span>;</span><br></pre></td></tr></table></figure>
<table>
<thead>
<tr>
<th>RANGE_START</th>
<th>RANGE_END</th>
<th>D-ROWNUM</th>
<th>COUNT(*)</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>3</td>
<td>0</td>
<td>3</td>
</tr>
<tr>
<td>5</td>
<td>5</td>
<td>1</td>
<td>1</td>
</tr>
<tr>
<td>7</td>
<td>9</td>
<td>2</td>
<td>3</td>
</tr>
<tr>
<td>11</td>
<td>12</td>
<td>3</td>
<td>2</td>
</tr>
<tr>
<td>15</td>
<td>16</td>
<td>5</td>
<td>2</td>
</tr>
<tr>
<td>20</td>
<td>20</td>
<td>8</td>
<td>1</td>
</tr>
</tbody>
</table>
<h2 id="expand-the-range-to-sequence-numbers"><a class="markdownIt-Anchor" href="#expand-the-range-to-sequence-numbers">#</a> Expand the range to sequence numbers</h2>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">with</span> t <span class="keyword">as</span></span><br><span class="line"> (<span class="keyword">select</span> <span class="number">1</span>  <span class="keyword">as</span> start_range, <span class="number">3</span>  <span class="keyword">as</span> end_range <span class="keyword">from</span> dual <span class="keyword">union</span> <span class="keyword">all</span></span><br><span class="line">  <span class="keyword">select</span> <span class="number">5</span>  <span class="keyword">as</span> start_range, <span class="number">5</span>  <span class="keyword">as</span> end_range <span class="keyword">from</span> dual <span class="keyword">union</span> <span class="keyword">all</span></span><br><span class="line">  <span class="keyword">select</span> <span class="number">7</span>  <span class="keyword">as</span> start_range, <span class="number">9</span>  <span class="keyword">as</span> end_range <span class="keyword">from</span> dual <span class="keyword">union</span> <span class="keyword">all</span></span><br><span class="line">  <span class="keyword">select</span> <span class="number">11</span> <span class="keyword">as</span> start_range, <span class="number">12</span> <span class="keyword">as</span> end_range <span class="keyword">from</span> dual <span class="keyword">union</span> <span class="keyword">all</span></span><br><span class="line">  <span class="keyword">select</span> <span class="number">15</span> <span class="keyword">as</span> start_range, <span class="number">16</span> <span class="keyword">as</span> end_range <span class="keyword">from</span> dual <span class="keyword">union</span> <span class="keyword">all</span></span><br><span class="line">  <span class="keyword">select</span> <span class="number">20</span> <span class="keyword">as</span> start_range, <span class="number">20</span> <span class="keyword">as</span> end_range <span class="keyword">from</span> dual)</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span></span><br><span class="line">  <span class="keyword">from</span> t,</span><br><span class="line">       (<span class="keyword">select</span> rownum r</span><br><span class="line">          <span class="keyword">from</span> dual</span><br><span class="line">        <span class="keyword">connect</span> <span class="keyword">by</span> level <span class="operator">&lt;=</span> (<span class="keyword">select</span> <span class="built_in">max</span>(end_range) <span class="keyword">from</span> t)) t2</span><br><span class="line"> <span class="keyword">where</span> t2.r <span class="keyword">between</span> t.start_range <span class="keyword">and</span> t.end_range;</span><br></pre></td></tr></table></figure>
<table>
<thead>
<tr>
<th>START_RANGE</th>
<th>END_RANGE</th>
<th>R</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>3</td>
<td>1</td>
</tr>
<tr>
<td>1</td>
<td>3</td>
<td>2</td>
</tr>
<tr>
<td>1</td>
<td>3</td>
<td>3</td>
</tr>
<tr>
<td>5</td>
<td>5</td>
<td>5</td>
</tr>
<tr>
<td>7</td>
<td>9</td>
<td>7</td>
</tr>
<tr>
<td>7</td>
<td>9</td>
<td>8</td>
</tr>
<tr>
<td>7</td>
<td>9</td>
<td>9</td>
</tr>
<tr>
<td>11</td>
<td>12</td>
<td>11</td>
</tr>
<tr>
<td>11</td>
<td>12</td>
<td>12</td>
</tr>
<tr>
<td>15</td>
<td>16</td>
<td>15</td>
</tr>
<tr>
<td>15</td>
<td>16</td>
<td>16</td>
</tr>
<tr>
<td>20</td>
<td>20</td>
<td>20</td>
</tr>
</tbody>
</table>
<h2 id="grouping-the-range-data"><a class="markdownIt-Anchor" href="#grouping-the-range-data">#</a> Grouping the range data</h2>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> edi_t(</span><br><span class="line">  name varchar2(<span class="number">100</span>),</span><br><span class="line">  start_year number,</span><br><span class="line">  end_year number</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> edi_t <span class="keyword">values</span> (<span class="string">&#x27;Swift&#x27;</span>, <span class="number">2007</span>, <span class="number">2009</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> edi_t <span class="keyword">values</span> (<span class="string">&#x27;Swift&#x27;</span>, <span class="number">2009</span>, <span class="number">2011</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> edi_t <span class="keyword">values</span> (<span class="string">&#x27;Swift&#x27;</span>, <span class="number">2011</span>, <span class="number">2013</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> edi_t <span class="keyword">values</span> (<span class="string">&#x27;BMW&#x27;</span>, <span class="number">2009</span>, <span class="number">2011</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> edi_t <span class="keyword">values</span> (<span class="string">&#x27;BMW&#x27;</span>, <span class="number">2013</span>, <span class="number">2015</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> edi_t;    </span><br></pre></td></tr></table></figure>
<table>
<thead>
<tr>
<th>NAME</th>
<th>START_YEAR</th>
<th>END_YEAR</th>
</tr>
</thead>
<tbody>
<tr>
<td>Swift</td>
<td>2007</td>
<td><strong>2009</strong></td>
</tr>
<tr>
<td>Swift</td>
<td><strong>2009</strong></td>
<td><em>2011</em></td>
</tr>
<tr>
<td>Swift</td>
<td><em>2011</em></td>
<td>2013</td>
</tr>
<tr>
<td>BMW</td>
<td>2009</td>
<td>2011</td>
</tr>
<tr>
<td>BMW</td>
<td>2013</td>
<td>2015</td>
</tr>
</tbody>
</table>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">with</span> r <span class="keyword">as</span></span><br><span class="line"> (<span class="keyword">select</span> <span class="keyword">distinct</span> name, start_year <span class="operator">+</span> column_value <span class="keyword">as</span> <span class="keyword">year</span></span><br><span class="line">    <span class="keyword">from</span> edi_t,</span><br><span class="line">         <span class="keyword">table</span>(<span class="built_in">cast</span>(<span class="keyword">multiset</span> (<span class="keyword">select</span> rownum <span class="operator">-</span> <span class="number">1</span></span><br><span class="line">                                <span class="keyword">from</span> dual</span><br><span class="line">                             <span class="keyword">connect</span> <span class="keyword">by</span> level <span class="operator">&lt;=</span> end_year <span class="operator">-</span> start_year <span class="operator">+</span> <span class="number">1</span>) <span class="keyword">as</span> </span><br><span class="line">                    sys.odcinumberlist))</span><br><span class="line">   <span class="keyword">order</span> <span class="keyword">by</span> <span class="number">1</span>, <span class="number">2</span>)</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> r;</span><br></pre></td></tr></table></figure>
<table>
<thead>
<tr>
<th>NAME</th>
<th>YEAR</th>
</tr>
</thead>
<tbody>
<tr>
<td>BMW</td>
<td>2009</td>
</tr>
<tr>
<td>BMW</td>
<td>2010</td>
</tr>
<tr>
<td>BMW</td>
<td>2011</td>
</tr>
<tr>
<td>BMW</td>
<td>2013</td>
</tr>
<tr>
<td>BMW</td>
<td>2014</td>
</tr>
<tr>
<td>BMW</td>
<td>2015</td>
</tr>
<tr>
<td>Swift</td>
<td>2007</td>
</tr>
<tr>
<td>Swift</td>
<td>2008</td>
</tr>
<tr>
<td>Swift</td>
<td>2009</td>
</tr>
<tr>
<td>Swift</td>
<td>2010</td>
</tr>
<tr>
<td>Swift</td>
<td>2011</td>
</tr>
<tr>
<td>Swift</td>
<td>2012</td>
</tr>
<tr>
<td>Swift</td>
<td>2013</td>
</tr>
</tbody>
</table>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">with</span> r <span class="keyword">as</span></span><br><span class="line"> (<span class="keyword">select</span> <span class="keyword">distinct</span> name, start_year <span class="operator">+</span> column_value <span class="keyword">as</span> <span class="keyword">year</span></span><br><span class="line">    <span class="keyword">from</span> edi_t,</span><br><span class="line">         <span class="keyword">table</span>(<span class="built_in">cast</span>(<span class="keyword">multiset</span> (<span class="keyword">select</span> rownum <span class="operator">-</span> <span class="number">1</span></span><br><span class="line">                                <span class="keyword">from</span> dual</span><br><span class="line">                             <span class="keyword">connect</span> <span class="keyword">by</span> level <span class="operator">&lt;=</span> end_year <span class="operator">-</span> start_year <span class="operator">+</span> <span class="number">1</span>) <span class="keyword">as</span> </span><br><span class="line">                    sys.odcinumberlist))</span><br><span class="line">   <span class="keyword">order</span> <span class="keyword">by</span> <span class="number">1</span>, <span class="number">2</span>)</span><br><span class="line"><span class="keyword">select</span> name, <span class="built_in">min</span>(<span class="keyword">year</span>), <span class="built_in">max</span>(<span class="keyword">year</span>) </span><br><span class="line">  <span class="keyword">from</span> r</span><br><span class="line"><span class="keyword">group</span> <span class="keyword">by</span> name, <span class="keyword">year</span> <span class="operator">-</span> rownum</span><br><span class="line"><span class="keyword">order</span> <span class="keyword">by</span> <span class="number">1</span>;    </span><br></pre></td></tr></table></figure>
<table>
<thead>
<tr>
<th>NAME</th>
<th>MIN(YEAR)</th>
<th>MAX(YEAR)</th>
</tr>
</thead>
<tbody>
<tr>
<td>BMW</td>
<td>2009</td>
<td>2011</td>
</tr>
<tr>
<td>BMW</td>
<td>2013</td>
<td>2015</td>
</tr>
<tr>
<td>Swift</td>
<td>2007</td>
<td>2013</td>
</tr>
</tbody>
</table>
<h2 id="convert-list-of-numbers-to-table-format"><a class="markdownIt-Anchor" href="#convert-list-of-numbers-to-table-format">#</a> Convert list of numbers to table format</h2>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">with</span> t <span class="keyword">as</span> (</span><br><span class="line"> <span class="keyword">select</span> level <span class="keyword">as</span> d </span><br><span class="line">   <span class="keyword">from</span> dual </span><br><span class="line"> <span class="keyword">connect</span> <span class="keyword">by</span> level <span class="operator">&lt;=</span> <span class="number">25</span>)</span><br><span class="line"><span class="keyword">select</span> d,</span><br><span class="line">       <span class="built_in">ceil</span>(d <span class="operator">/</span> <span class="number">5</span>) <span class="keyword">as</span> x,</span><br><span class="line">       <span class="built_in">row_number</span>() <span class="keyword">over</span> (<span class="keyword">partition</span> <span class="keyword">by</span> <span class="built_in">ceil</span>(d <span class="operator">/</span> <span class="number">5</span>) <span class="keyword">order</span> <span class="keyword">by</span> d) <span class="keyword">as</span> y</span><br><span class="line">  <span class="keyword">from</span> t;</span><br></pre></td></tr></table></figure>
<table>
<thead>
<tr>
<th>D</th>
<th>X</th>
<th>Y</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>1</td>
<td>1</td>
</tr>
<tr>
<td>2</td>
<td>1</td>
<td>2</td>
</tr>
<tr>
<td>3</td>
<td>1</td>
<td>3</td>
</tr>
<tr>
<td>4</td>
<td>1</td>
<td>4</td>
</tr>
<tr>
<td>5</td>
<td>1</td>
<td>5</td>
</tr>
<tr>
<td>6</td>
<td>2</td>
<td>1</td>
</tr>
<tr>
<td>7</td>
<td>2</td>
<td>2</td>
</tr>
<tr>
<td>8</td>
<td>2</td>
<td>3</td>
</tr>
<tr>
<td>9</td>
<td>2</td>
<td>4</td>
</tr>
<tr>
<td>10</td>
<td>2</td>
<td>5</td>
</tr>
<tr>
<td>11</td>
<td>3</td>
<td>1</td>
</tr>
<tr>
<td>12</td>
<td>3</td>
<td>2</td>
</tr>
<tr>
<td>13</td>
<td>3</td>
<td>3</td>
</tr>
<tr>
<td>14</td>
<td>3</td>
<td>4</td>
</tr>
<tr>
<td>15</td>
<td>3</td>
<td>5</td>
</tr>
<tr>
<td>16</td>
<td>4</td>
<td>1</td>
</tr>
<tr>
<td>17</td>
<td>4</td>
<td>2</td>
</tr>
<tr>
<td>18</td>
<td>4</td>
<td>3</td>
</tr>
<tr>
<td>19</td>
<td>4</td>
<td>4</td>
</tr>
<tr>
<td>20</td>
<td>4</td>
<td>5</td>
</tr>
<tr>
<td>21</td>
<td>5</td>
<td>1</td>
</tr>
<tr>
<td>22</td>
<td>5</td>
<td>2</td>
</tr>
<tr>
<td>23</td>
<td>5</td>
<td>3</td>
</tr>
<tr>
<td>24</td>
<td>5</td>
<td>4</td>
</tr>
<tr>
<td>25</td>
<td>5</td>
<td>5</td>
</tr>
</tbody>
</table>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">with</span> t <span class="keyword">as</span> (</span><br><span class="line">  <span class="keyword">select</span> level <span class="keyword">as</span> d </span><br><span class="line">    <span class="keyword">from</span> dual </span><br><span class="line"> <span class="keyword">connect</span> <span class="keyword">by</span> level <span class="operator">&lt;=</span> <span class="number">25</span></span><br><span class="line">)</span><br><span class="line"><span class="keyword">select</span>  <span class="built_in">max</span>(<span class="keyword">case</span> <span class="keyword">when</span> <span class="built_in">mod</span>(d, <span class="number">5</span>) <span class="operator">=</span> <span class="number">1</span> <span class="keyword">then</span> d <span class="keyword">end</span>) <span class="keyword">as</span> c1,  </span><br><span class="line">        <span class="built_in">max</span>(<span class="keyword">case</span> <span class="keyword">when</span> <span class="built_in">mod</span>(d, <span class="number">5</span>) <span class="operator">=</span> <span class="number">2</span> <span class="keyword">then</span> d <span class="keyword">end</span>) <span class="keyword">as</span> c2,  </span><br><span class="line">        <span class="built_in">max</span>(<span class="keyword">case</span> <span class="keyword">when</span> <span class="built_in">mod</span>(d, <span class="number">5</span>) <span class="operator">=</span> <span class="number">3</span> <span class="keyword">then</span> d <span class="keyword">end</span>) <span class="keyword">as</span> c3,  </span><br><span class="line">        <span class="built_in">max</span>(<span class="keyword">case</span> <span class="keyword">when</span> <span class="built_in">mod</span>(d, <span class="number">5</span>) <span class="operator">=</span> <span class="number">4</span> <span class="keyword">then</span> d <span class="keyword">end</span>) <span class="keyword">as</span> c4,  </span><br><span class="line">        <span class="built_in">max</span>(<span class="keyword">case</span> <span class="keyword">when</span> <span class="built_in">mod</span>(d, <span class="number">5</span>) <span class="operator">=</span> <span class="number">0</span> <span class="keyword">then</span> d <span class="keyword">end</span>) <span class="keyword">as</span> c5</span><br><span class="line">  <span class="keyword">from</span> t</span><br><span class="line"> <span class="keyword">group</span> <span class="keyword">by</span> <span class="built_in">ceil</span>(d<span class="operator">/</span><span class="number">5</span>)</span><br><span class="line"> <span class="keyword">order</span> <span class="keyword">by</span> <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> t <span class="keyword">as</span></span><br><span class="line"> (<span class="keyword">select</span> level <span class="keyword">as</span> d </span><br><span class="line">    <span class="keyword">from</span> dual </span><br><span class="line">  <span class="keyword">connect</span> <span class="keyword">by</span> level <span class="operator">&lt;=</span> <span class="number">25</span>)</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span></span><br><span class="line">  <span class="keyword">from</span> (<span class="keyword">select</span> d,</span><br><span class="line">               <span class="built_in">ceil</span>(d <span class="operator">/</span> <span class="number">5</span>) <span class="keyword">as</span> x,</span><br><span class="line">               <span class="built_in">row_number</span>() <span class="keyword">over</span> (<span class="keyword">partition</span> <span class="keyword">by</span> <span class="built_in">ceil</span>(d <span class="operator">/</span> <span class="number">5</span>) <span class="keyword">order</span> <span class="keyword">by</span> d) <span class="keyword">as</span> y</span><br><span class="line">          <span class="keyword">from</span> t) pivot(<span class="built_in">sum</span>(d) <span class="keyword">for</span> y <span class="keyword">in</span> (<span class="number">1</span> c1, <span class="number">2</span> c2, <span class="number">3</span> c3, <span class="number">4</span> c4, <span class="number">5</span> c5))</span><br><span class="line"> <span class="keyword">order</span> <span class="keyword">by</span> x;</span><br></pre></td></tr></table></figure>
<table>
<thead>
<tr>
<th>X</th>
<th>C1</th>
<th>C2</th>
<th>C3</th>
<th>C4</th>
<th>C5</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>1</td>
<td>2</td>
<td>3</td>
<td>4</td>
<td>5</td>
</tr>
<tr>
<td>2</td>
<td>6</td>
<td>7</td>
<td>8</td>
<td>9</td>
<td>10</td>
</tr>
<tr>
<td>3</td>
<td>11</td>
<td>12</td>
<td>13</td>
<td>14</td>
<td>15</td>
</tr>
<tr>
<td>4</td>
<td>16</td>
<td>17</td>
<td>18</td>
<td>19</td>
<td>20</td>
</tr>
<tr>
<td>5</td>
<td>21</td>
<td>22</td>
<td>23</td>
<td>24</td>
<td>25</td>
</tr>
</tbody>
</table>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">with</span> t <span class="keyword">as</span> (</span><br><span class="line">  <span class="keyword">select</span> level <span class="keyword">as</span> d </span><br><span class="line">    <span class="keyword">from</span> dual </span><br><span class="line"> <span class="keyword">connect</span> <span class="keyword">by</span> level <span class="operator">&lt;=</span> <span class="number">25</span>)</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span></span><br><span class="line">  <span class="keyword">from</span> (<span class="keyword">select</span> d,</span><br><span class="line">               <span class="built_in">ceil</span>(d <span class="operator">/</span> <span class="number">5</span>) <span class="keyword">as</span> x,</span><br><span class="line">               <span class="built_in">row_number</span>() <span class="keyword">over</span> (<span class="keyword">partition</span> <span class="keyword">by</span> <span class="built_in">ceil</span>(d <span class="operator">/</span> <span class="number">5</span>) <span class="keyword">order</span> <span class="keyword">by</span> d) <span class="keyword">as</span> y</span><br><span class="line">          <span class="keyword">from</span> t) pivot(<span class="built_in">sum</span>(d) <span class="keyword">for</span> x <span class="keyword">in</span> (<span class="number">1</span> c1, <span class="number">2</span> c2, <span class="number">3</span> c3, <span class="number">4</span> c4, <span class="number">5</span> c5))</span><br><span class="line"> <span class="keyword">order</span> <span class="keyword">by</span> <span class="number">1</span>;</span><br></pre></td></tr></table></figure>
<table>
<thead>
<tr>
<th>Y</th>
<th>C1</th>
<th>C2</th>
<th>C3</th>
<th>C4</th>
<th>C5</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>1</td>
<td>6</td>
<td>11</td>
<td>16</td>
<td>21</td>
</tr>
<tr>
<td>2</td>
<td>2</td>
<td>7</td>
<td>12</td>
<td>17</td>
<td>22</td>
</tr>
<tr>
<td>3</td>
<td>3</td>
<td>8</td>
<td>13</td>
<td>18</td>
<td>23</td>
</tr>
<tr>
<td>4</td>
<td>4</td>
<td>9</td>
<td>14</td>
<td>19</td>
<td>24</td>
</tr>
<tr>
<td>5</td>
<td>5</td>
<td>10</td>
<td>15</td>
<td>20</td>
<td>25</td>
</tr>
</tbody>
</table>
<h2 id="fetch-emp-hierarchical-data-in-flat-format"><a class="markdownIt-Anchor" href="#fetch-emp-hierarchical-data-in-flat-format">#</a> Fetch emp hierarchical data in Flat format</h2>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="built_in">trim</span>(<span class="string">&#x27;,&#x27;</span> <span class="keyword">from</span> sys_connect_by_path(empno, <span class="string">&#x27;,&#x27;</span>)) empno_list, </span><br><span class="line">       <span class="built_in">trim</span>(<span class="string">&#x27;,&#x27;</span> <span class="keyword">from</span> sys_connect_by_path(ename, <span class="string">&#x27;,&#x27;</span>)) ename_list, </span><br><span class="line">       connect_by_isleaf isleaf</span><br><span class="line">  <span class="keyword">from</span> scott.emp</span><br><span class="line">  <span class="keyword">start</span> <span class="keyword">with</span> mgr <span class="keyword">is</span> <span class="keyword">null</span></span><br><span class="line"><span class="keyword">connect</span> <span class="keyword">by</span> prior empno <span class="operator">=</span> mgr;</span><br></pre></td></tr></table></figure>
<table>
<thead>
<tr>
<th>EMPNO_LIST</th>
<th>ENAME_LIST</th>
<th>ISLEAF</th>
</tr>
</thead>
<tbody>
<tr>
<td>7839</td>
<td>KING</td>
<td>0</td>
</tr>
<tr>
<td>7839,7566</td>
<td>KING,JONES</td>
<td>0</td>
</tr>
<tr>
<td>7839,7566,7788</td>
<td>KING,JONES,SCOTT</td>
<td>0</td>
</tr>
<tr>
<td>7839,7566,7788,7876</td>
<td>KING,JONES,SCOTT,ADAMS</td>
<td>1</td>
</tr>
<tr>
<td>7839,7566,7902</td>
<td>KING,JONES,FORD</td>
<td>0</td>
</tr>
<tr>
<td>7839,7566,7902,7369</td>
<td>KING,JONES,FORD,SMITH</td>
<td>1</td>
</tr>
<tr>
<td>7839,7698</td>
<td>KING,BLAKE</td>
<td>0</td>
</tr>
<tr>
<td>7839,7698,7499</td>
<td>KING,BLAKE,ALLEN</td>
<td>1</td>
</tr>
<tr>
<td>7839,7698,7521</td>
<td>KING,BLAKE,WARD</td>
<td>1</td>
</tr>
<tr>
<td>7839,7698,7654</td>
<td>KING,BLAKE,MARTIN</td>
<td>1</td>
</tr>
<tr>
<td>7839,7698,7844</td>
<td>KING,BLAKE,TURNER</td>
<td>1</td>
</tr>
<tr>
<td>7839,7698,7900</td>
<td>KING,BLAKE,JAMES</td>
<td>1</td>
</tr>
<tr>
<td>7839,7782</td>
<td>KING,CLARK</td>
<td>0</td>
</tr>
<tr>
<td>7839,7782,7934</td>
<td>KING,CLARK,MILLER</td>
<td>1</td>
</tr>
</tbody>
</table>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> regexp_substr(empno_list, <span class="string">&#x27;\w+&#x27;</span>, <span class="number">1</span>, <span class="number">1</span>) lv1_empno, regexp_substr(ename_list, <span class="string">&#x27;\w+&#x27;</span>, <span class="number">1</span>, <span class="number">1</span>) lv1_ename, <span class="number">1</span> lv1,</span><br><span class="line">       regexp_substr(empno_list, <span class="string">&#x27;\w+&#x27;</span>, <span class="number">1</span>, <span class="number">2</span>) lv2_empno, regexp_substr(ename_list, <span class="string">&#x27;\w+&#x27;</span>, <span class="number">1</span>, <span class="number">2</span>) lv2_ename, <span class="number">2</span> lv2,</span><br><span class="line">       regexp_substr(empno_list, <span class="string">&#x27;\w+&#x27;</span>, <span class="number">1</span>, <span class="number">3</span>) lv3_empno, regexp_substr(ename_list, <span class="string">&#x27;\w+&#x27;</span>, <span class="number">1</span>, <span class="number">3</span>) lv3_ename, <span class="number">3</span> lv3,</span><br><span class="line">       regexp_substr(empno_list, <span class="string">&#x27;\w+&#x27;</span>, <span class="number">1</span>, <span class="number">4</span>) lv4_empno, regexp_substr(ename_list, <span class="string">&#x27;\w+&#x27;</span>, <span class="number">1</span>, <span class="number">4</span>) lv4_ename, </span><br><span class="line">       <span class="keyword">case</span> <span class="keyword">when</span> regexp_substr(empno_list, <span class="string">&#x27;\w+&#x27;</span>, <span class="number">1</span>, <span class="number">4</span>) <span class="keyword">is</span> <span class="keyword">not</span> <span class="keyword">null</span> <span class="keyword">then</span> <span class="number">4</span> <span class="keyword">end</span> lv4,</span><br><span class="line">       regexp_substr(empno_list, <span class="string">&#x27;\w+&#x27;</span>, <span class="number">1</span>, <span class="number">5</span>) lv5_empno, regexp_substr(ename_list, <span class="string">&#x27;\w+&#x27;</span>, <span class="number">1</span>, <span class="number">5</span>) lv5_ename, </span><br><span class="line">       <span class="keyword">case</span> <span class="keyword">when</span> regexp_substr(empno_list, <span class="string">&#x27;\w+&#x27;</span>, <span class="number">1</span>, <span class="number">5</span>) <span class="keyword">is</span> <span class="keyword">not</span> <span class="keyword">null</span> <span class="keyword">then</span> <span class="number">5</span> <span class="keyword">end</span> lv5</span><br><span class="line">  <span class="keyword">from</span> (</span><br><span class="line">    <span class="keyword">select</span> <span class="built_in">trim</span>(<span class="string">&#x27;,&#x27;</span> <span class="keyword">from</span> sys_connect_by_path(empno, <span class="string">&#x27;,&#x27;</span>)) empno_list, </span><br><span class="line">           <span class="built_in">trim</span>(<span class="string">&#x27;,&#x27;</span> <span class="keyword">from</span> sys_connect_by_path(ename, <span class="string">&#x27;,&#x27;</span>)) ename_list, </span><br><span class="line">           connect_by_isleaf isleaf</span><br><span class="line">      <span class="keyword">from</span> scott.emp</span><br><span class="line">      <span class="keyword">start</span> <span class="keyword">with</span> mgr <span class="keyword">is</span> <span class="keyword">null</span></span><br><span class="line">      <span class="keyword">connect</span> <span class="keyword">by</span> prior empno <span class="operator">=</span> mgr</span><br><span class="line">  ) <span class="keyword">where</span> isleaf <span class="operator">=</span> <span class="number">1</span>;</span><br></pre></td></tr></table></figure>
<table>
<thead>
<tr>
<th>LV1_EMPNO</th>
<th>LV1_ENAME</th>
<th>LV1</th>
<th>LV2_EMPNO</th>
<th>LV2_ENAME</th>
<th>LV2</th>
<th>LV3_EMPNO</th>
<th>LV3_ENAME</th>
<th>LV3</th>
<th>LV4_EMPNO</th>
<th>LV4_ENAME</th>
<th>LV4</th>
<th>LV5_EMPNO</th>
<th>LV5_ENAME</th>
</tr>
</thead>
<tbody>
<tr>
<td>7839</td>
<td>KING</td>
<td>1</td>
<td>7566</td>
<td>JONES</td>
<td>2</td>
<td>7788</td>
<td>SCOTT</td>
<td>3</td>
<td>7876</td>
<td>ADAMS</td>
<td>4</td>
<td></td>
<td></td>
</tr>
<tr>
<td>7839</td>
<td>KING</td>
<td>1</td>
<td>7566</td>
<td>JONES</td>
<td>2</td>
<td>7902</td>
<td>FORD</td>
<td>3</td>
<td>7369</td>
<td>SMITH</td>
<td>4</td>
<td></td>
<td></td>
</tr>
<tr>
<td>7839</td>
<td>KING</td>
<td>1</td>
<td>7698</td>
<td>BLAKE</td>
<td>2</td>
<td>7499</td>
<td>ALLEN</td>
<td>3</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>7839</td>
<td>KING</td>
<td>1</td>
<td>7698</td>
<td>BLAKE</td>
<td>2</td>
<td>7521</td>
<td>WARD</td>
<td>3</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>7839</td>
<td>KING</td>
<td>1</td>
<td>7698</td>
<td>BLAKE</td>
<td>2</td>
<td>7654</td>
<td>MARTIN</td>
<td>3</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>7839</td>
<td>KING</td>
<td>1</td>
<td>7698</td>
<td>BLAKE</td>
<td>2</td>
<td>7844</td>
<td>TURNER</td>
<td>3</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>7839</td>
<td>KING</td>
<td>1</td>
<td>7698</td>
<td>BLAKE</td>
<td>2</td>
<td>7900</td>
<td>JAMES</td>
<td>3</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>7839</td>
<td>KING</td>
<td>1</td>
<td>7782</td>
<td>CLARK</td>
<td>2</td>
<td>7934</td>
<td>MILLER</td>
<td>3</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
<h2 id="group-the-emplyees-into-multiple-team"><a class="markdownIt-Anchor" href="#group-the-emplyees-into-multiple-team">#</a> Group the emplyees into multiple team</h2>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> edi_t(</span><br><span class="line">  ename varchar2(<span class="number">100</span>),</span><br><span class="line">  city varchar2(<span class="number">100</span>)</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> edi_t <span class="keyword">values</span> (<span class="string">&#x27;Babb1&#x27;</span>, <span class="string">&#x27;A&#x27;</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> edi_t <span class="keyword">values</span> (<span class="string">&#x27;Babb2&#x27;</span>, <span class="string">&#x27;A&#x27;</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> edi_t <span class="keyword">values</span> (<span class="string">&#x27;Babb3&#x27;</span>, <span class="string">&#x27;A&#x27;</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> edi_t <span class="keyword">values</span> (<span class="string">&#x27;Babb4&#x27;</span>, <span class="string">&#x27;A&#x27;</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> edi_t <span class="keyword">values</span> (<span class="string">&#x27;Babb5&#x27;</span>, <span class="string">&#x27;A&#x27;</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> edi_t <span class="keyword">values</span> (<span class="string">&#x27;Babb11&#x27;</span>, <span class="string">&#x27;B&#x27;</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> edi_t <span class="keyword">values</span> (<span class="string">&#x27;Babb22&#x27;</span>, <span class="string">&#x27;B&#x27;</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> edi_t <span class="keyword">values</span> (<span class="string">&#x27;Babb111&#x27;</span>, <span class="string">&#x27;C&#x27;</span>);</span><br></pre></td></tr></table></figure>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> ename,</span><br><span class="line">       city,</span><br><span class="line">       <span class="built_in">ceil</span>(<span class="built_in">row_number</span>() <span class="keyword">over</span>(<span class="keyword">partition</span> <span class="keyword">by</span> city <span class="keyword">order</span> <span class="keyword">by</span> rownum) <span class="operator">/</span> <span class="number">2</span>) r</span><br><span class="line">  <span class="keyword">from</span> edi_t</span><br></pre></td></tr></table></figure>
<table>
<thead>
<tr>
<th>ENAME</th>
<th>CITY</th>
<th>R</th>
</tr>
</thead>
<tbody>
<tr>
<td>Babb1</td>
<td>A</td>
<td>1</td>
</tr>
<tr>
<td>Babb2</td>
<td>A</td>
<td>1</td>
</tr>
<tr>
<td>Babb3</td>
<td>A</td>
<td>2</td>
</tr>
<tr>
<td>Babb4</td>
<td>A</td>
<td>2</td>
</tr>
<tr>
<td>Babb5</td>
<td>A</td>
<td>3</td>
</tr>
<tr>
<td>Babb11</td>
<td>B</td>
<td>1</td>
</tr>
<tr>
<td>Babb22</td>
<td>B</td>
<td>1</td>
</tr>
<tr>
<td>Babb111</td>
<td>C</td>
<td>1</td>
</tr>
</tbody>
</table>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">--max team members = 2</span></span><br><span class="line"><span class="keyword">select</span> city, <span class="built_in">listagg</span>(ename, <span class="string">&#x27;,&#x27;</span>) <span class="keyword">within</span> <span class="keyword">group</span>(<span class="keyword">order</span> <span class="keyword">by</span> ename) <span class="keyword">as</span> team_members, <span class="string">&#x27;Team&#x27;</span> <span class="operator">||</span> r <span class="keyword">as</span> team_name</span><br><span class="line">  <span class="keyword">from</span> (</span><br><span class="line">    <span class="keyword">select</span> ename, </span><br><span class="line">      	   city, </span><br><span class="line">           <span class="built_in">ceil</span>(<span class="built_in">row_number</span>() <span class="keyword">over</span> (<span class="keyword">partition</span> <span class="keyword">by</span> city <span class="keyword">order</span> <span class="keyword">by</span> rownum) <span class="operator">/</span> <span class="number">2</span>) r</span><br><span class="line">      <span class="keyword">from</span> edi_t</span><br><span class="line">  )</span><br><span class="line"><span class="keyword">group</span> <span class="keyword">by</span> city, r;</span><br></pre></td></tr></table></figure>
<table>
<thead>
<tr>
<th>CITY</th>
<th>TEAM_MEMBERS</th>
<th>TEAM_NAME</th>
</tr>
</thead>
<tbody>
<tr>
<td>A</td>
<td>Babb1,Babb2</td>
<td>Team1</td>
</tr>
<tr>
<td>A</td>
<td>Babb3,Babb4</td>
<td>Team2</td>
</tr>
<tr>
<td>A</td>
<td>Babb5</td>
<td>Team3</td>
</tr>
<tr>
<td>B</td>
<td>Babb11,Babb22</td>
<td>Team1</td>
</tr>
<tr>
<td>C</td>
<td>Babb111</td>
<td>Team1</td>
</tr>
</tbody>
</table>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">--max team members = 3</span></span><br><span class="line"><span class="keyword">select</span> city, <span class="built_in">listagg</span>(ename, <span class="string">&#x27;,&#x27;</span>) <span class="keyword">within</span> <span class="keyword">group</span>(<span class="keyword">order</span> <span class="keyword">by</span> ename) <span class="keyword">as</span> team_members, <span class="string">&#x27;Team&#x27;</span> <span class="operator">||</span> r <span class="keyword">as</span> team_name</span><br><span class="line">  <span class="keyword">from</span> (</span><br><span class="line">    <span class="keyword">select</span> ename, </span><br><span class="line">           city, </span><br><span class="line">           <span class="built_in">ceil</span>(<span class="built_in">row_number</span>() <span class="keyword">over</span> (<span class="keyword">partition</span> <span class="keyword">by</span> city <span class="keyword">order</span> <span class="keyword">by</span> rownum) <span class="operator">/</span> <span class="number">3</span>) r</span><br><span class="line">      <span class="keyword">from</span> edi_t</span><br><span class="line">  )</span><br><span class="line"><span class="keyword">group</span> <span class="keyword">by</span> city, r;</span><br></pre></td></tr></table></figure>
<table>
<thead>
<tr>
<th>CITY</th>
<th>TEAM_MEMBERS</th>
<th>TEAM_NAME</th>
</tr>
</thead>
<tbody>
<tr>
<td>A</td>
<td>Babb1,Babb2,Babb3</td>
<td>Team1</td>
</tr>
<tr>
<td>A</td>
<td>Babb4,Babb5</td>
<td>Team2</td>
</tr>
<tr>
<td>B</td>
<td>Babb11,Babb22</td>
<td>Team1</td>
</tr>
<tr>
<td>C</td>
<td>Babb111</td>
<td>Team1</td>
</tr>
</tbody>
</table>
<h2 id="fill-the-missing-months-with-previous-month-salary"><a class="markdownIt-Anchor" href="#fill-the-missing-months-with-previous-month-salary">#</a> Fill the missing months with previous month salary</h2>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> edi_t(</span><br><span class="line">  ename varchar2(<span class="number">100</span>),</span><br><span class="line">  month_year varchar2(<span class="number">100</span>),</span><br><span class="line">  salary number</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> edi_t <span class="keyword">values</span> (<span class="string">&#x27;Peter&#x27;</span>, <span class="string">&#x27;May-19&#x27;</span>, <span class="number">5000</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> edi_t <span class="keyword">values</span> (<span class="string">&#x27;Peter&#x27;</span>, <span class="string">&#x27;Aug-19&#x27;</span>, <span class="number">10000</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> edi_t <span class="keyword">values</span> (<span class="string">&#x27;Peter&#x27;</span>, <span class="string">&#x27;Mar-20&#x27;</span>, <span class="number">15000</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> edi_t <span class="keyword">values</span> (<span class="string">&#x27;Solomon&#x27;</span>, <span class="string">&#x27;Oct-19&#x27;</span>, <span class="number">20000</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> edi_t <span class="keyword">values</span> (<span class="string">&#x27;Solomon&#x27;</span>, <span class="string">&#x27;Feb-20&#x27;</span>, <span class="number">30000</span>);</span><br></pre></td></tr></table></figure>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> ename,</span><br><span class="line">       salary,</span><br><span class="line">       to_date(month_year, <span class="string">&#x27;Mon-YY&#x27;</span>) d,</span><br><span class="line">       <span class="built_in">lead</span>(to_date(month_year, <span class="string">&#x27;Mon-YY&#x27;</span>)) <span class="keyword">over</span>(<span class="keyword">partition</span> <span class="keyword">by</span> ename <span class="keyword">order</span> <span class="keyword">by</span> to_date(month_year, <span class="string">&#x27;Mon-YY&#x27;</span>)) next_d,</span><br><span class="line">       nvl(</span><br><span class="line">          months_between(</span><br><span class="line">            <span class="built_in">lead</span>(to_date(month_year, <span class="string">&#x27;Mon-YY&#x27;</span>)) <span class="keyword">over</span>(<span class="keyword">partition</span> <span class="keyword">by</span> ename <span class="keyword">order</span> <span class="keyword">by</span> to_date(month_year, <span class="string">&#x27;Mon-YY&#x27;</span>)),</span><br><span class="line">            to_date(month_year, <span class="string">&#x27;Mon-YY&#x27;</span>)</span><br><span class="line">          ),</span><br><span class="line">       <span class="number">1</span>) n</span><br><span class="line">  <span class="keyword">from</span> edi_t;</span><br></pre></td></tr></table></figure>
<table>
<thead>
<tr>
<th>ENAME</th>
<th>SALARY</th>
<th>D</th>
<th>NEXT_D</th>
<th>N</th>
</tr>
</thead>
<tbody>
<tr>
<td>Peter</td>
<td>5000</td>
<td>2019-05-01</td>
<td>2019-08-01</td>
<td>3</td>
</tr>
<tr>
<td>Peter</td>
<td>10000</td>
<td>2019-08-01</td>
<td>2020-03-01</td>
<td>7</td>
</tr>
<tr>
<td>Peter</td>
<td>15000</td>
<td>2020-03-01</td>
<td></td>
<td>1</td>
</tr>
<tr>
<td>Solomon</td>
<td>20000</td>
<td>2019-10-01</td>
<td>2020-02-01</td>
<td>4</td>
</tr>
<tr>
<td>Solomon</td>
<td>30000</td>
<td>2020-02-01</td>
<td></td>
<td>1</td>
</tr>
</tbody>
</table>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">with</span> t <span class="keyword">as</span> (</span><br><span class="line">  <span class="keyword">select</span> ename,</span><br><span class="line">         salary,</span><br><span class="line">         to_date(month_year, <span class="string">&#x27;Mon-YY&#x27;</span>) d,</span><br><span class="line">         <span class="built_in">lead</span>(to_date(month_year, <span class="string">&#x27;Mon-YY&#x27;</span>)) <span class="keyword">over</span>(<span class="keyword">partition</span> <span class="keyword">by</span> ename <span class="keyword">order</span> <span class="keyword">by</span> to_date(month_year, <span class="string">&#x27;Mon-YY&#x27;</span>)) next_d,</span><br><span class="line">         nvl(</span><br><span class="line">            months_between(</span><br><span class="line">              <span class="built_in">lead</span>(to_date(month_year, <span class="string">&#x27;Mon-YY&#x27;</span>)) <span class="keyword">over</span>(<span class="keyword">partition</span> <span class="keyword">by</span> ename <span class="keyword">order</span> <span class="keyword">by</span> to_date(month_year, <span class="string">&#x27;Mon-YY&#x27;</span>)),</span><br><span class="line">              to_date(month_year, <span class="string">&#x27;Mon-YY&#x27;</span>)</span><br><span class="line">            ),</span><br><span class="line">         <span class="number">1</span>) n</span><br><span class="line">    <span class="keyword">from</span> edi_t</span><br><span class="line">)</span><br><span class="line"><span class="keyword">select</span> ename, to_char(add_months(d, column_value), <span class="string">&#x27;Mon-YY&#x27;</span>) month_year, salary</span><br><span class="line">  <span class="keyword">from</span> t,</span><br><span class="line">       <span class="keyword">table</span>(<span class="built_in">cast</span>(<span class="keyword">multiset</span> (<span class="keyword">select</span> rownum <span class="operator">-</span> <span class="number">1</span></span><br><span class="line">                                    <span class="keyword">from</span> dual</span><br><span class="line">                                  <span class="keyword">connect</span> <span class="keyword">by</span> level <span class="operator">&lt;=</span> t.n) <span class="keyword">as</span> sys.odcinumberlist)</span><br><span class="line">            );</span><br></pre></td></tr></table></figure>
<table>
<thead>
<tr>
<th>ENAME</th>
<th>MONTH_YEAR</th>
<th>SALARY</th>
</tr>
</thead>
<tbody>
<tr>
<td>Peter</td>
<td>May-19</td>
<td>5000</td>
</tr>
<tr>
<td>Peter</td>
<td>Jun-19</td>
<td>5000</td>
</tr>
<tr>
<td>Peter</td>
<td>Jul-19</td>
<td>5000</td>
</tr>
<tr>
<td>Peter</td>
<td>Aug-19</td>
<td>10000</td>
</tr>
<tr>
<td>Peter</td>
<td>Sep-19</td>
<td>10000</td>
</tr>
<tr>
<td>Peter</td>
<td>Oct-19</td>
<td>10000</td>
</tr>
<tr>
<td>Peter</td>
<td>Nov-19</td>
<td>10000</td>
</tr>
<tr>
<td>Peter</td>
<td>Dec-19</td>
<td>10000</td>
</tr>
<tr>
<td>Peter</td>
<td>Jan-20</td>
<td>10000</td>
</tr>
<tr>
<td>Peter</td>
<td>Feb-20</td>
<td>10000</td>
</tr>
<tr>
<td>Peter</td>
<td>Mar-20</td>
<td>15000</td>
</tr>
<tr>
<td>Solomon</td>
<td>Oct-19</td>
<td>20000</td>
</tr>
<tr>
<td>Solomon</td>
<td>Nov-19</td>
<td>20000</td>
</tr>
<tr>
<td>Solomon</td>
<td>Dec-19</td>
<td>20000</td>
</tr>
<tr>
<td>Solomon</td>
<td>Jan-20</td>
<td>20000</td>
</tr>
<tr>
<td>Solomon</td>
<td>Feb-20</td>
<td>30000</td>
</tr>
</tbody>
</table>
<h2 id="count-number-of-occurences-of-vowels-in-a-string"><a class="markdownIt-Anchor" href="#count-number-of-occurences-of-vowels-in-a-string">#</a> Count number of occurences of vowels in a string</h2>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">with</span> t <span class="keyword">as</span></span><br><span class="line"> (<span class="keyword">select</span> <span class="string">&#x27;SUBHASIS ORACLE&#x27;</span> name <span class="keyword">from</span> dual</span><br><span class="line">  <span class="keyword">union</span> <span class="keyword">all</span></span><br><span class="line">  <span class="keyword">select</span> <span class="string">&#x27;BABB CHEN&#x27;</span> <span class="keyword">from</span> dual),</span><br><span class="line">d <span class="keyword">as</span></span><br><span class="line"> (<span class="keyword">select</span> name, substr(name, column_value, <span class="number">1</span>) w</span><br><span class="line">    <span class="keyword">from</span> t,</span><br><span class="line">         <span class="keyword">table</span>(<span class="built_in">cast</span>(<span class="keyword">multiset</span> (<span class="keyword">select</span> level l</span><br><span class="line">                       <span class="keyword">from</span> dual</span><br><span class="line">                     <span class="keyword">connect</span> <span class="keyword">by</span> level <span class="operator">&lt;=</span> length(name)) <span class="keyword">as</span> sys.odcinumberlist)))</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span></span><br><span class="line">  <span class="keyword">from</span> (<span class="keyword">select</span> name, w, <span class="built_in">count</span>(<span class="operator">*</span>) cnt</span><br><span class="line">          <span class="keyword">from</span> d</span><br><span class="line">         <span class="keyword">where</span> d.w <span class="keyword">in</span> (<span class="string">&#x27;A&#x27;</span>, <span class="string">&#x27;E&#x27;</span>, <span class="string">&#x27;I&#x27;</span>, <span class="string">&#x27;O&#x27;</span>, <span class="string">&#x27;U&#x27;</span>)</span><br><span class="line">         <span class="keyword">group</span> <span class="keyword">by</span> name, w) pivot (<span class="built_in">max</span>(cnt) <span class="keyword">for</span> w <span class="keyword">in</span> (<span class="string">&#x27;A&#x27;</span>, <span class="string">&#x27;E&#x27;</span>, <span class="string">&#x27;I&#x27;</span>, <span class="string">&#x27;O&#x27;</span>, <span class="string">&#x27;U&#x27;</span>));</span><br><span class="line"></span><br><span class="line"><span class="comment">--</span></span><br><span class="line"><span class="keyword">with</span> t <span class="keyword">as</span> (</span><br><span class="line">  <span class="keyword">select</span> <span class="string">&#x27;SUBHASIS ORACLE&#x27;</span> name <span class="keyword">from</span> dual</span><br><span class="line">  <span class="keyword">union</span> <span class="keyword">all</span></span><br><span class="line">  <span class="keyword">select</span> <span class="string">&#x27;BABB CHEN&#x27;</span> <span class="keyword">from</span> dual</span><br><span class="line">)</span><br><span class="line"><span class="keyword">select</span> name, </span><br><span class="line">       length(name) <span class="operator">-</span> length(replace(name, <span class="string">&#x27;A&#x27;</span>)) A,</span><br><span class="line">       regexp_count(name, <span class="string">&#x27;E&#x27;</span>) E,</span><br><span class="line">       regexp_count(name, <span class="string">&#x27;I&#x27;</span>) I,</span><br><span class="line">       regexp_count(name, <span class="string">&#x27;O&#x27;</span>) O,</span><br><span class="line">       regexp_count(name, <span class="string">&#x27;U&#x27;</span>) U</span><br><span class="line">  <span class="keyword">from</span> t;</span><br></pre></td></tr></table></figure>
<table>
<thead>
<tr>
<th>NAME</th>
<th>A</th>
<th>E</th>
<th>I</th>
<th>O</th>
<th>U</th>
</tr>
</thead>
<tbody>
<tr>
<td>SUBHASIS ORACLE</td>
<td>2</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>1</td>
</tr>
<tr>
<td>BABB CHEN</td>
<td>1</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
</tr>
</tbody>
</table>
<h2 id="get-all-dates-for-the-given-input-month-and-year"><a class="markdownIt-Anchor" href="#get-all-dates-for-the-given-input-month-and-year">#</a> Get all dates for the given input month and year</h2>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">with</span> t <span class="keyword">as</span></span><br><span class="line"> (<span class="keyword">select</span> <span class="string">&#x27;DEC&#x27;</span> m, <span class="number">2023</span> y <span class="keyword">from</span> dual),</span><br><span class="line">t1 <span class="keyword">as</span></span><br><span class="line"> (<span class="keyword">select</span> m <span class="operator">||</span> y <span class="keyword">as</span> my <span class="keyword">from</span> t),</span><br><span class="line">t2 <span class="keyword">as</span></span><br><span class="line"> (<span class="keyword">select</span> to_date(my, <span class="string">&#x27;MONYYYY&#x27;</span>) first_day,</span><br><span class="line">         last_day(to_date(my, <span class="string">&#x27;MONYYYY&#x27;</span>)) <span class="operator">-</span> to_date(my, <span class="string">&#x27;MONYYYY&#x27;</span>) <span class="operator">+</span> <span class="number">1</span> n_of_days</span><br><span class="line">    <span class="keyword">from</span> t1)</span><br><span class="line"><span class="keyword">select</span> first_day <span class="operator">+</span> level <span class="operator">-</span> <span class="number">1</span> </span><br><span class="line">  <span class="keyword">from</span> t2 <span class="keyword">connect</span> <span class="keyword">by</span> level <span class="operator">&lt;=</span> n_of_days;</span><br></pre></td></tr></table></figure>
<table>
<thead>
<tr>
<th>FIRST_DAY+LEVEL-1</th>
</tr>
</thead>
<tbody>
<tr>
<td>2023-12-01</td>
</tr>
<tr>
<td>2023-12-02</td>
</tr>
<tr>
<td>2023-12-03</td>
</tr>
<tr>
<td>2023-12-04</td>
</tr>
<tr>
<td>2023-12-05</td>
</tr>
<tr>
<td>2023-12-06</td>
</tr>
<tr>
<td>2023-12-07</td>
</tr>
<tr>
<td>2023-12-08</td>
</tr>
<tr>
<td>2023-12-09</td>
</tr>
<tr>
<td>2023-12-10</td>
</tr>
<tr>
<td>2023-12-11</td>
</tr>
<tr>
<td>2023-12-12</td>
</tr>
<tr>
<td>2023-12-13</td>
</tr>
<tr>
<td>2023-12-14</td>
</tr>
<tr>
<td>2023-12-15</td>
</tr>
<tr>
<td>2023-12-16</td>
</tr>
<tr>
<td>2023-12-17</td>
</tr>
<tr>
<td>2023-12-18</td>
</tr>
<tr>
<td>2023-12-19</td>
</tr>
<tr>
<td>2023-12-20</td>
</tr>
<tr>
<td>2023-12-21</td>
</tr>
<tr>
<td>2023-12-22</td>
</tr>
<tr>
<td>2023-12-23</td>
</tr>
<tr>
<td>2023-12-24</td>
</tr>
<tr>
<td>2023-12-25</td>
</tr>
<tr>
<td>2023-12-26</td>
</tr>
<tr>
<td>2023-12-27</td>
</tr>
<tr>
<td>2023-12-28</td>
</tr>
<tr>
<td>2023-12-29</td>
</tr>
<tr>
<td>2023-12-30</td>
</tr>
<tr>
<td>2023-12-31</td>
</tr>
</tbody>
</table>
<h2 id="comma-separated-string-into-row-of-data"><a class="markdownIt-Anchor" href="#comma-separated-string-into-row-of-data">#</a> Comma separated string into row of data</h2>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">with</span> t <span class="keyword">as</span> (</span><br><span class="line">  <span class="keyword">select</span> <span class="number">10</span> <span class="keyword">as</span> deptno, <span class="string">&#x27;A,B,C,D&#x27;</span>  <span class="keyword">as</span> ename <span class="keyword">from</span> dual <span class="keyword">union</span> <span class="keyword">all</span></span><br><span class="line">  <span class="keyword">select</span> <span class="number">20</span> <span class="keyword">as</span> deptno, <span class="string">&#x27;AA,BB,CC&#x27;</span> <span class="keyword">as</span> ename <span class="keyword">from</span> dual <span class="keyword">union</span> <span class="keyword">all</span></span><br><span class="line">  <span class="keyword">select</span> <span class="number">30</span> <span class="keyword">as</span> deptno, <span class="string">&#x27;AAA,BBB&#x27;</span>  <span class="keyword">as</span> ename <span class="keyword">from</span> dual)</span><br><span class="line"><span class="keyword">select</span> deptno, ename, regexp_substr(ename, <span class="string">&#x27;[^,]+&#x27;</span>, <span class="number">1</span>, column_value) <span class="keyword">as</span> sub</span><br><span class="line">  <span class="keyword">from</span> t,</span><br><span class="line">       <span class="keyword">table</span>(<span class="built_in">cast</span>(<span class="keyword">multiset</span> (<span class="keyword">select</span> level l</span><br><span class="line">                     		  <span class="keyword">from</span> dual</span><br><span class="line">                   		   <span class="keyword">connect</span> <span class="keyword">by</span> level <span class="operator">&lt;=</span> regexp_count(ename, <span class="string">&#x27;,&#x27;</span>) <span class="operator">+</span> <span class="number">1</span>) <span class="keyword">as</span></span><br><span class="line">                  sys.odcinumberlist));</span><br></pre></td></tr></table></figure>
<table>
<thead>
<tr>
<th>DEPTNO</th>
<th>ENAME</th>
<th>SUB</th>
</tr>
</thead>
<tbody>
<tr>
<td>10</td>
<td>A,B,C,D</td>
<td>A</td>
</tr>
<tr>
<td>10</td>
<td>A,B,C,D</td>
<td>B</td>
</tr>
<tr>
<td>10</td>
<td>A,B,C,D</td>
<td>C</td>
</tr>
<tr>
<td>10</td>
<td>A,B,C,D</td>
<td>D</td>
</tr>
<tr>
<td>20</td>
<td>AA,BB,CC</td>
<td>AA</td>
</tr>
<tr>
<td>20</td>
<td>AA,BB,CC</td>
<td>BB</td>
</tr>
<tr>
<td>20</td>
<td>AA,BB,CC</td>
<td>CC</td>
</tr>
<tr>
<td>30</td>
<td>AAA,BBB</td>
<td>AAA</td>
</tr>
<tr>
<td>30</td>
<td>AAA,BBB</td>
<td>BBB</td>
</tr>
</tbody>
</table>
<h2 id="find-the-set-of-rows-in-hierarchical-relational-data"><a class="markdownIt-Anchor" href="#find-the-set-of-rows-in-hierarchical-relational-data">#</a> Find the set of rows in hierarchical relational data</h2>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> edi_t (</span><br><span class="line">  id number,</span><br><span class="line">  old_id number</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> edi_t <span class="keyword">values</span> (<span class="number">1</span>, <span class="keyword">null</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> edi_t <span class="keyword">values</span> (<span class="number">2</span>, <span class="number">1</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> edi_t <span class="keyword">values</span> (<span class="number">3</span>, <span class="number">2</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> edi_t <span class="keyword">values</span> (<span class="number">4</span>, <span class="number">3</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> edi_t <span class="keyword">values</span> (<span class="number">5</span>, <span class="number">4</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> edi_t <span class="keyword">values</span> (<span class="number">6</span>, <span class="keyword">null</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> edi_t <span class="keyword">values</span> (<span class="number">7</span>, <span class="keyword">null</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> edi_t <span class="keyword">values</span> (<span class="number">8</span>, <span class="number">7</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> edi_t <span class="keyword">values</span> (<span class="number">9</span>, <span class="keyword">null</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> edi_t <span class="keyword">values</span> (<span class="number">10</span>, <span class="number">9</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> edi_t <span class="keyword">values</span> (<span class="number">11</span>, <span class="number">10</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> edi_t;</span><br></pre></td></tr></table></figure>
<table>
<thead>
<tr>
<th>ID</th>
<th>OLD_ID</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td></td>
</tr>
<tr>
<td>2</td>
<td>1</td>
</tr>
<tr>
<td>3</td>
<td>2</td>
</tr>
<tr>
<td>4</td>
<td>3</td>
</tr>
<tr>
<td>5</td>
<td>4</td>
</tr>
<tr>
<td>6</td>
<td></td>
</tr>
<tr>
<td>7</td>
<td></td>
</tr>
<tr>
<td>8</td>
<td>7</td>
</tr>
<tr>
<td>9</td>
<td></td>
</tr>
<tr>
<td>10</td>
<td>9</td>
</tr>
<tr>
<td>11</td>
<td>10</td>
</tr>
</tbody>
</table>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> id, old_id, connect_by_isleaf l</span><br><span class="line">  <span class="keyword">from</span> edi_t</span><br><span class="line"><span class="keyword">connect</span> <span class="keyword">by</span> prior old_id <span class="operator">=</span> id</span><br><span class="line"> <span class="keyword">start</span> <span class="keyword">with</span> id <span class="operator">=</span> <span class="number">3</span>;</span><br></pre></td></tr></table></figure>
<table>
<thead>
<tr>
<th>ID</th>
<th>OLD_ID</th>
<th>L</th>
</tr>
</thead>
<tbody>
<tr>
<td>3</td>
<td>2</td>
<td>0</td>
</tr>
<tr>
<td>2</td>
<td>1</td>
<td>0</td>
</tr>
<tr>
<td>1</td>
<td></td>
<td>1</td>
</tr>
</tbody>
</table>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">with</span> t <span class="keyword">as</span></span><br><span class="line"> (<span class="keyword">select</span> id</span><br><span class="line">    <span class="keyword">from</span> (<span class="keyword">select</span> id, old_id, connect_by_isleaf l</span><br><span class="line">            <span class="keyword">from</span> edi_t</span><br><span class="line">          <span class="keyword">connect</span> <span class="keyword">by</span> prior old_id <span class="operator">=</span> id</span><br><span class="line">           <span class="keyword">start</span> <span class="keyword">with</span> id <span class="operator">=</span> <span class="number">3</span>)</span><br><span class="line">   <span class="keyword">where</span> l <span class="operator">=</span> <span class="number">1</span>)</span><br><span class="line"><span class="keyword">select</span> id, old_id</span><br><span class="line">  <span class="keyword">from</span> edi_t</span><br><span class="line"><span class="keyword">connect</span> <span class="keyword">by</span> prior id <span class="operator">=</span> old_id</span><br><span class="line"> <span class="keyword">start</span> <span class="keyword">with</span> id <span class="operator">=</span> (<span class="keyword">select</span> id <span class="keyword">from</span> t);</span><br></pre></td></tr></table></figure>
<table>
<thead>
<tr>
<th>ID</th>
<th>OLD_ID</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td></td>
</tr>
<tr>
<td>2</td>
<td>1</td>
</tr>
<tr>
<td>3</td>
<td>2</td>
</tr>
<tr>
<td>4</td>
<td>3</td>
</tr>
<tr>
<td>5</td>
<td>4</td>
</tr>
</tbody>
</table>
<h2 id="convert-data-representation-in-different-format"><a class="markdownIt-Anchor" href="#convert-data-representation-in-different-format">#</a> Convert data representation in different format</h2>
<p><strong>Source</strong></p>
<table>
<thead>
<tr>
<th>ACTIVATION_DT</th>
<th>DEACTIVATION_DT</th>
<th>RATE</th>
</tr>
</thead>
<tbody>
<tr>
<td>2018-01-01</td>
<td>2018-01-31</td>
<td>10</td>
</tr>
<tr>
<td>2018-02-01</td>
<td>2018-02-27</td>
<td>15</td>
</tr>
<tr>
<td>2018-03-01</td>
<td>2018-04-30</td>
<td>12</td>
</tr>
</tbody>
</table>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> edi_t(</span><br><span class="line">  activation_dt <span class="type">date</span>,</span><br><span class="line">  deactivation_dt <span class="type">date</span>,</span><br><span class="line">  rate number</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> edi_t <span class="keyword">values</span> (to_date(<span class="string">&#x27;01-JAN-18&#x27;</span>, <span class="string">&#x27;DD-MON-YY&#x27;</span>), to_date(<span class="string">&#x27;31-JAN-18&#x27;</span>, <span class="string">&#x27;DD-MON-YY&#x27;</span>), <span class="number">10</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> edi_t <span class="keyword">values</span> (to_date(<span class="string">&#x27;01-FEB-18&#x27;</span>, <span class="string">&#x27;DD-MON-YY&#x27;</span>), to_date(<span class="string">&#x27;27-FEB-18&#x27;</span>, <span class="string">&#x27;DD-MON-YY&#x27;</span>), <span class="number">15</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> edi_t <span class="keyword">values</span> (to_date(<span class="string">&#x27;01-MAR-18&#x27;</span>, <span class="string">&#x27;DD-MON-YY&#x27;</span>), to_date(<span class="string">&#x27;30-APR-18&#x27;</span>, <span class="string">&#x27;DD-MON-YY&#x27;</span>), <span class="number">12</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> edi_t;</span><br></pre></td></tr></table></figure>
<p><strong>Result</strong></p>
<table>
<thead>
<tr>
<th>DT</th>
<th>RATE</th>
<th>CHANGE_LOG</th>
</tr>
</thead>
<tbody>
<tr>
<td>2018-01-01</td>
<td>10</td>
<td>Added</td>
</tr>
<tr>
<td>2018-02-01</td>
<td>15</td>
<td>Modified</td>
</tr>
<tr>
<td>2018-02-27</td>
<td>15</td>
<td>Removed</td>
</tr>
<tr>
<td>2018-03-01</td>
<td>12</td>
<td>Added</td>
</tr>
<tr>
<td>2018-04-30</td>
<td>12</td>
<td>Removed</td>
</tr>
</tbody>
</table>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">with</span> t <span class="keyword">as</span> (</span><br><span class="line">  <span class="keyword">select</span> activation_dt, deactivation_dt, rate, </span><br><span class="line">         <span class="built_in">lag</span>(activation_dt) <span class="keyword">over</span> (<span class="keyword">order</span> <span class="keyword">by</span> activation_dt) p_activation_dt, </span><br><span class="line">         <span class="built_in">lag</span>(deactivation_dt) <span class="keyword">over</span> (<span class="keyword">order</span> <span class="keyword">by</span> activation_dt) p_deactivation_dt,</span><br><span class="line">         <span class="built_in">lag</span>(rate) <span class="keyword">over</span> (<span class="keyword">order</span> <span class="keyword">by</span> activation_dt) p_rate,</span><br><span class="line">         <span class="built_in">lead</span>(activation_dt) <span class="keyword">over</span> (<span class="keyword">order</span> <span class="keyword">by</span> activation_dt) n_activation_dt, </span><br><span class="line">         <span class="built_in">lead</span>(deactivation_dt) <span class="keyword">over</span> (<span class="keyword">order</span> <span class="keyword">by</span> activation_dt) n_deactivation_dt,</span><br><span class="line">         <span class="built_in">lead</span>(rate) <span class="keyword">over</span> (<span class="keyword">order</span> <span class="keyword">by</span> activation_dt)  n_rate</span><br><span class="line">    <span class="keyword">from</span> edi_t</span><br><span class="line">),</span><br><span class="line">t2 <span class="keyword">as</span> (</span><br><span class="line"><span class="keyword">select</span> activation_dt, deactivation_dt, rate,</span><br><span class="line">       <span class="keyword">case</span> </span><br><span class="line">         <span class="keyword">when</span> p_activation_dt <span class="keyword">is</span> <span class="keyword">null</span> <span class="keyword">or</span> activation_dt <span class="operator">&lt;&gt;</span> p_deactivation_dt <span class="operator">+</span> <span class="number">1</span> <span class="keyword">then</span> <span class="string">&#x27;Added&#x27;</span></span><br><span class="line">         <span class="keyword">when</span> activation_dt <span class="operator">=</span> p_deactivation_dt <span class="operator">+</span> <span class="number">1</span> <span class="keyword">and</span> rate <span class="operator">&lt;&gt;</span> p_rate <span class="keyword">then</span> <span class="string">&#x27;Modified&#x27;</span></span><br><span class="line">       <span class="keyword">end</span> add_or_mod,</span><br><span class="line">       <span class="keyword">case</span> </span><br><span class="line">         <span class="keyword">when</span> n_deactivation_dt <span class="keyword">is</span> <span class="keyword">null</span> <span class="keyword">or</span> deactivation_dt <span class="operator">+</span> <span class="number">1</span> <span class="operator">&lt;&gt;</span> n_activation_dt <span class="keyword">then</span> <span class="string">&#x27;Removed&#x27;</span></span><br><span class="line">       <span class="keyword">end</span> rem</span><br><span class="line">  <span class="keyword">from</span> t</span><br><span class="line">)</span><br><span class="line"><span class="keyword">select</span> decode(l, <span class="number">1</span>, activation_dt, deactivation_dt) <span class="keyword">as</span> dt,</span><br><span class="line">       rate,</span><br><span class="line">       decode(l, <span class="number">1</span>, add_or_mod, rem) <span class="keyword">as</span> change_log</span><br><span class="line">  <span class="keyword">from</span> t2, (<span class="keyword">select</span> level <span class="keyword">as</span> l  <span class="keyword">from</span> dual <span class="keyword">connect</span> <span class="keyword">by</span> level <span class="operator">&lt;=</span> <span class="number">2</span>)</span><br><span class="line"><span class="keyword">where</span> decode(l, <span class="number">1</span>, add_or_mod, rem) <span class="keyword">is</span> <span class="keyword">not</span> <span class="keyword">null</span></span><br><span class="line"><span class="keyword">order</span> <span class="keyword">by</span> activation_dt, l;</span><br></pre></td></tr></table></figure>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">with</span> t <span class="keyword">as</span> (</span><br><span class="line">  <span class="keyword">select</span> <span class="keyword">case</span> </span><br><span class="line">           <span class="keyword">when</span> p.activation_dt <span class="keyword">is</span> <span class="keyword">null</span> <span class="keyword">then</span> <span class="string">&#x27;Added&#x27;</span></span><br><span class="line">           <span class="keyword">when</span> p.rate <span class="operator">&lt;&gt;</span> c.rate <span class="keyword">then</span> <span class="string">&#x27;Modified&#x27;</span></span><br><span class="line">         <span class="keyword">end</span> change1, </span><br><span class="line">         c.activation_dt, c.deactivation_dt, c.rate,</span><br><span class="line">         <span class="keyword">case</span></span><br><span class="line">           <span class="keyword">when</span> n.activation_dt <span class="keyword">is</span> <span class="keyword">null</span> <span class="keyword">then</span> <span class="string">&#x27;Removed&#x27;</span></span><br><span class="line">         <span class="keyword">end</span> change2</span><br><span class="line">    <span class="keyword">from</span> edi_t c </span><br><span class="line">    <span class="keyword">left</span> <span class="keyword">outer</span> <span class="keyword">join</span> edi_t p <span class="keyword">on</span> (c.activation_dt <span class="operator">=</span> p.deactivation_dt <span class="operator">+</span> <span class="number">1</span>)</span><br><span class="line">    <span class="keyword">left</span> <span class="keyword">outer</span> <span class="keyword">join</span> edi_t n <span class="keyword">on</span> (c.deactivation_dt <span class="operator">+</span> <span class="number">1</span> <span class="operator">=</span> n.activation_dt)</span><br><span class="line">)</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> </span><br><span class="line">  <span class="keyword">from</span> (</span><br><span class="line">  <span class="keyword">select</span> activation_dt, rate, change1 <span class="keyword">as</span> change_log <span class="keyword">from</span> t</span><br><span class="line">  <span class="keyword">union</span> <span class="keyword">all</span></span><br><span class="line">  <span class="keyword">select</span> deactivation_dt, rate, change2 <span class="keyword">as</span> change_log <span class="keyword">from</span> t</span><br><span class="line">) <span class="keyword">where</span> change_log <span class="keyword">is</span> <span class="keyword">not</span> <span class="keyword">null</span></span><br><span class="line"><span class="keyword">order</span> <span class="keyword">by</span> <span class="number">1</span>;</span><br></pre></td></tr></table></figure>
<h2 id="determine-whether-two-strings-are-anagram"><a class="markdownIt-Anchor" href="#determine-whether-two-strings-are-anagram">#</a> Determine whether two strings are anagram</h2>
<p><strong>ASCII</strong></p>
<p>Use this method, MAN and TAG also are anagram. This is not right.</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">with</span> t <span class="keyword">as</span> (</span><br><span class="line">  <span class="keyword">select</span> <span class="string">&#x27;HEART&#x27;</span> c1, <span class="string">&#x27;EARTH&#x27;</span> c2 <span class="keyword">from</span> dual</span><br><span class="line">)</span><br><span class="line"><span class="keyword">select</span> c1, c2, <span class="built_in">sum</span>(a1), <span class="built_in">sum</span>(a2), <span class="keyword">case</span> <span class="keyword">when</span> <span class="built_in">sum</span>(a1) <span class="operator">=</span> <span class="built_in">sum</span>(a2) <span class="keyword">then</span> <span class="string">&#x27;Valid Anagram&#x27;</span> <span class="keyword">else</span> <span class="string">&#x27;No Anagram&#x27;</span> <span class="keyword">end</span> output</span><br><span class="line"> <span class="keyword">from</span> (</span><br><span class="line">  <span class="keyword">select</span> c1, c2, ascii(substr(c1, level, <span class="number">1</span>)) a1, ascii(substr(c2, level, <span class="number">1</span>)) a2</span><br><span class="line">    <span class="keyword">from</span> t</span><br><span class="line">  <span class="keyword">connect</span> <span class="keyword">by</span> level <span class="operator">&lt;=</span> length(c1)</span><br><span class="line">)</span><br><span class="line"><span class="keyword">group</span> <span class="keyword">by</span> c1, c2;</span><br></pre></td></tr></table></figure>
<p><strong>ORA_HASH</strong></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">with</span> t <span class="keyword">as</span> (</span><br><span class="line">  <span class="keyword">select</span> <span class="string">&#x27;MAN&#x27;</span> c1, <span class="string">&#x27;TAG&#x27;</span> c2 <span class="keyword">from</span> dual</span><br><span class="line">)</span><br><span class="line"><span class="keyword">select</span> c1, c2, <span class="built_in">sum</span>(a1), <span class="built_in">sum</span>(a2), <span class="keyword">case</span> <span class="keyword">when</span> <span class="built_in">sum</span>(a1) <span class="operator">=</span> <span class="built_in">sum</span>(a2) <span class="keyword">then</span> <span class="string">&#x27;Valid Anagram&#x27;</span> <span class="keyword">else</span> <span class="string">&#x27;No Anagram&#x27;</span> <span class="keyword">end</span> output</span><br><span class="line"> <span class="keyword">from</span> (</span><br><span class="line">  <span class="keyword">select</span> c1, c2, ora_hash(substr(c1, level, <span class="number">1</span>)) a1, ora_hash(substr(c2, level, <span class="number">1</span>)) a2</span><br><span class="line">    <span class="keyword">from</span> t</span><br><span class="line">  <span class="keyword">connect</span> <span class="keyword">by</span> level <span class="operator">&lt;=</span> length(c1)</span><br><span class="line">)</span><br><span class="line"><span class="keyword">group</span> <span class="keyword">by</span> c1, c2;</span><br></pre></td></tr></table></figure>
<table>
<thead>
<tr>
<th>C1</th>
<th>C2</th>
<th>SUM(A1)</th>
<th>SUM(A2)</th>
<th>OUTPUT</th>
</tr>
</thead>
<tbody>
<tr>
<td>MAN</td>
<td>TAG</td>
<td>4199279673</td>
<td>5736920293</td>
<td>No Anagram</td>
</tr>
</tbody>
</table>
<p><strong>LISTAGG</strong></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">with</span> t <span class="keyword">as</span> (</span><br><span class="line">  <span class="keyword">select</span> <span class="string">&#x27;HEART&#x27;</span> c1, <span class="string">&#x27;EARTH&#x27;</span> c2 <span class="keyword">from</span> dual</span><br><span class="line">  <span class="keyword">union</span> <span class="keyword">all</span> </span><br><span class="line">  <span class="keyword">select</span> <span class="string">&#x27;MAN&#x27;</span> c1, <span class="string">&#x27;TAG&#x27;</span> c2 <span class="keyword">from</span> dual</span><br><span class="line">  <span class="keyword">union</span> <span class="keyword">all</span> </span><br><span class="line">  <span class="keyword">select</span> <span class="string">&#x27;HELLO&#x27;</span> c1, <span class="string">&#x27;HELLOO&#x27;</span> c2 <span class="keyword">from</span> dual</span><br><span class="line">)</span><br><span class="line"><span class="keyword">select</span> c1, c2, </span><br><span class="line">       <span class="built_in">listagg</span>(substr(c1, column_value, <span class="number">1</span>), <span class="string">&#x27;&#x27;</span>) <span class="keyword">within</span> <span class="keyword">group</span> (<span class="keyword">order</span> <span class="keyword">by</span> substr(c1, column_value, <span class="number">1</span>)) w1, </span><br><span class="line">       <span class="built_in">listagg</span>(substr(c2, column_value, <span class="number">1</span>), <span class="string">&#x27;&#x27;</span>) <span class="keyword">within</span> <span class="keyword">group</span> (<span class="keyword">order</span> <span class="keyword">by</span> substr(c2, column_value, <span class="number">1</span>)) w2,</span><br><span class="line">       <span class="keyword">case</span> </span><br><span class="line">         <span class="keyword">when</span> <span class="built_in">listagg</span>(substr(c1, column_value, <span class="number">1</span>), <span class="string">&#x27;&#x27;</span>) <span class="keyword">within</span> <span class="keyword">group</span> (<span class="keyword">order</span> <span class="keyword">by</span> substr(c1, column_value, <span class="number">1</span>))</span><br><span class="line">              <span class="operator">=</span> <span class="built_in">listagg</span>(substr(c2, column_value, <span class="number">1</span>), <span class="string">&#x27;&#x27;</span>) <span class="keyword">within</span> <span class="keyword">group</span> (<span class="keyword">order</span> <span class="keyword">by</span> substr(c2, column_value, <span class="number">1</span>))</span><br><span class="line">         <span class="keyword">then</span> <span class="string">&#x27;Valid Anagram&#x27;</span> <span class="keyword">else</span> <span class="string">&#x27;No Anagram&#x27;</span> </span><br><span class="line">       <span class="keyword">end</span> output</span><br><span class="line">  <span class="keyword">from</span> t, <span class="keyword">table</span>(</span><br><span class="line">    <span class="built_in">cast</span> (</span><br><span class="line">      <span class="keyword">multiset</span>(</span><br><span class="line">        <span class="keyword">select</span> level <span class="keyword">from</span> dual <span class="keyword">connect</span> <span class="keyword">by</span> level <span class="operator">&lt;=</span> greatest(length(c1), length(c2)) </span><br><span class="line">      ) <span class="keyword">as</span> sys.odcinumberlist</span><br><span class="line">    )</span><br><span class="line">  )</span><br><span class="line"><span class="keyword">group</span> <span class="keyword">by</span> c1, c2;</span><br></pre></td></tr></table></figure>
<table>
<thead>
<tr>
<th>C1</th>
<th>C2</th>
<th>W1</th>
<th>W2</th>
<th>OUTPUT</th>
</tr>
</thead>
<tbody>
<tr>
<td>MAN</td>
<td>TAG</td>
<td>AMN</td>
<td>AGT</td>
<td>No Anagram</td>
</tr>
<tr>
<td>HEART</td>
<td>EARTH</td>
<td>AEHRT</td>
<td>AEHRT</td>
<td>Valid Anagram</td>
</tr>
<tr>
<td>HELLO</td>
<td>HELLOO</td>
<td>EHLLO</td>
<td>EHLLOO</td>
<td>No Anagram</td>
</tr>
</tbody>
</table>
<h2 id="divide-the-rows-into-groups"><a class="markdownIt-Anchor" href="#divide-the-rows-into-groups">#</a> Divide the rows into groups</h2>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">with</span> t <span class="keyword">as</span></span><br><span class="line"> (<span class="keyword">select</span> level <span class="keyword">as</span> <span class="keyword">no</span>, chr(ascii(<span class="string">&#x27;A&#x27;</span>) <span class="operator">+</span> level <span class="operator">-</span> <span class="number">1</span>) <span class="keyword">as</span> name</span><br><span class="line">    <span class="keyword">from</span> dual</span><br><span class="line">  <span class="keyword">connect</span> <span class="keyword">by</span> level <span class="operator">&lt;=</span> <span class="number">10</span>),</span><br><span class="line">t2 <span class="keyword">as</span></span><br><span class="line"> (<span class="keyword">select</span> <span class="keyword">no</span>, name, <span class="built_in">ntile</span>(<span class="number">3</span>) <span class="keyword">over</span>(<span class="keyword">order</span> <span class="keyword">by</span> <span class="keyword">no</span>) <span class="keyword">as</span> group_no <span class="keyword">from</span> t),</span><br><span class="line">t3 <span class="keyword">as</span></span><br><span class="line"> (<span class="keyword">select</span> group_no, <span class="keyword">no</span>, name, <span class="keyword">null</span> <span class="keyword">as</span> min_no, <span class="keyword">null</span> <span class="keyword">as</span> max_no</span><br><span class="line">    <span class="keyword">from</span> t2</span><br><span class="line">  <span class="keyword">union</span> <span class="keyword">all</span></span><br><span class="line">  <span class="keyword">select</span> group_no, <span class="keyword">null</span>, <span class="keyword">null</span>, <span class="built_in">min</span>(<span class="keyword">no</span>) <span class="keyword">as</span> min_no, <span class="built_in">max</span>(<span class="keyword">no</span>) <span class="keyword">as</span> max_no</span><br><span class="line">    <span class="keyword">from</span> t2</span><br><span class="line">   <span class="keyword">group</span> <span class="keyword">by</span> group_no)</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> t3 <span class="keyword">order</span> <span class="keyword">by</span> group_no, <span class="keyword">no</span> nulls <span class="keyword">last</span>;</span><br></pre></td></tr></table></figure>
<table>
<thead>
<tr>
<th>GROUP_NO</th>
<th>NO</th>
<th>NAME</th>
<th>MIN_NO</th>
<th>MAX_NO</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>1</td>
<td>A</td>
<td></td>
<td></td>
</tr>
<tr>
<td>1</td>
<td>2</td>
<td>B</td>
<td></td>
<td></td>
</tr>
<tr>
<td>1</td>
<td>3</td>
<td>C</td>
<td></td>
<td></td>
</tr>
<tr>
<td>1</td>
<td>4</td>
<td>D</td>
<td></td>
<td></td>
</tr>
<tr>
<td>1</td>
<td></td>
<td></td>
<td>1</td>
<td>4</td>
</tr>
<tr>
<td>2</td>
<td>5</td>
<td>E</td>
<td></td>
<td></td>
</tr>
<tr>
<td>2</td>
<td>6</td>
<td>F</td>
<td></td>
<td></td>
</tr>
<tr>
<td>2</td>
<td>7</td>
<td>G</td>
<td></td>
<td></td>
</tr>
<tr>
<td>2</td>
<td></td>
<td></td>
<td>5</td>
<td>7</td>
</tr>
<tr>
<td>3</td>
<td>8</td>
<td>H</td>
<td></td>
<td></td>
</tr>
<tr>
<td>3</td>
<td>9</td>
<td>I</td>
<td></td>
<td></td>
</tr>
<tr>
<td>3</td>
<td>10</td>
<td>J</td>
<td></td>
<td></td>
</tr>
<tr>
<td>3</td>
<td></td>
<td></td>
<td>8</td>
<td>10</td>
</tr>
</tbody>
</table>
<h2 id="compute-group-number-for-repeating-numbers"><a class="markdownIt-Anchor" href="#compute-group-number-for-repeating-numbers">#</a> Compute group number for repeating numbers</h2>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> edi_t (</span><br><span class="line">  c1 number,</span><br><span class="line">  c2 number</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> edi_t <span class="keyword">values</span> (<span class="number">1</span>, <span class="number">100</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> edi_t <span class="keyword">values</span> (<span class="number">2</span>, <span class="number">100</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> edi_t <span class="keyword">values</span> (<span class="number">3</span>, <span class="number">100</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> edi_t <span class="keyword">values</span> (<span class="number">4</span>, <span class="number">200</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> edi_t <span class="keyword">values</span> (<span class="number">5</span>, <span class="number">200</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> edi_t <span class="keyword">values</span> (<span class="number">6</span>, <span class="number">300</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> edi_t <span class="keyword">values</span> (<span class="number">7</span>, <span class="number">300</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> edi_t <span class="keyword">values</span> (<span class="number">8</span>, <span class="number">100</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> edi_t <span class="keyword">values</span> (<span class="number">9</span>, <span class="number">300</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> edi_t <span class="keyword">values</span> (<span class="number">10</span>, <span class="number">400</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> edi_t <span class="keyword">values</span> (<span class="number">11</span>, <span class="number">400</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> edi_t <span class="keyword">values</span> (<span class="number">12</span>, <span class="number">100</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> c1, c2,</span><br><span class="line">       <span class="keyword">case</span> </span><br><span class="line">         <span class="keyword">when</span> c2 <span class="operator">&lt;&gt;</span> nvl(<span class="built_in">lag</span>(c2) <span class="keyword">over</span> (<span class="keyword">order</span> <span class="keyword">by</span> c1), <span class="number">0</span>) <span class="keyword">then</span> <span class="number">1</span></span><br><span class="line">         <span class="keyword">else</span> <span class="number">0</span></span><br><span class="line">       <span class="keyword">end</span> r</span><br><span class="line">  <span class="keyword">from</span> edi_t;</span><br></pre></td></tr></table></figure>
<table>
<thead>
<tr>
<th>C1</th>
<th>C2</th>
<th>R</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>100</td>
<td>1</td>
</tr>
<tr>
<td>2</td>
<td>100</td>
<td>0</td>
</tr>
<tr>
<td>3</td>
<td>100</td>
<td>0</td>
</tr>
<tr>
<td>4</td>
<td>200</td>
<td>1</td>
</tr>
<tr>
<td>5</td>
<td>200</td>
<td>0</td>
</tr>
<tr>
<td>6</td>
<td>300</td>
<td>1</td>
</tr>
<tr>
<td>7</td>
<td>300</td>
<td>0</td>
</tr>
<tr>
<td>8</td>
<td>100</td>
<td>1</td>
</tr>
<tr>
<td>9</td>
<td>300</td>
<td>1</td>
</tr>
<tr>
<td>10</td>
<td>400</td>
<td>1</td>
</tr>
<tr>
<td>11</td>
<td>400</td>
<td>0</td>
</tr>
<tr>
<td>12</td>
<td>100</td>
<td>1</td>
</tr>
</tbody>
</table>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> c1, c2, <span class="built_in">sum</span>(r) <span class="keyword">over</span> (<span class="keyword">order</span> <span class="keyword">by</span> c1) <span class="keyword">as</span> group_number</span><br><span class="line">  <span class="keyword">from</span> (</span><br><span class="line">  <span class="keyword">select</span> c1, c2,</span><br><span class="line">         <span class="keyword">case</span> </span><br><span class="line">           <span class="keyword">when</span> c2 <span class="operator">&lt;&gt;</span> nvl(<span class="built_in">lag</span>(c2) <span class="keyword">over</span> (<span class="keyword">order</span> <span class="keyword">by</span> c1), <span class="number">0</span>) <span class="keyword">then</span> <span class="number">1</span></span><br><span class="line">           <span class="keyword">else</span> <span class="number">0</span></span><br><span class="line">         <span class="keyword">end</span> r</span><br><span class="line">    <span class="keyword">from</span> edi_t</span><br><span class="line">);</span><br></pre></td></tr></table></figure>
<table>
<thead>
<tr>
<th>C1</th>
<th>C2</th>
<th>GROUP_NUMBER</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>100</td>
<td>1</td>
</tr>
<tr>
<td>2</td>
<td>100</td>
<td>1</td>
</tr>
<tr>
<td>3</td>
<td>100</td>
<td>1</td>
</tr>
<tr>
<td>4</td>
<td>200</td>
<td>2</td>
</tr>
<tr>
<td>5</td>
<td>200</td>
<td>2</td>
</tr>
<tr>
<td>6</td>
<td>300</td>
<td>3</td>
</tr>
<tr>
<td>7</td>
<td>300</td>
<td>3</td>
</tr>
<tr>
<td>8</td>
<td>100</td>
<td>4</td>
</tr>
<tr>
<td>9</td>
<td>300</td>
<td>5</td>
</tr>
<tr>
<td>10</td>
<td>400</td>
<td>6</td>
</tr>
<tr>
<td>11</td>
<td>400</td>
<td>6</td>
</tr>
<tr>
<td>12</td>
<td>100</td>
<td>7</td>
</tr>
</tbody>
</table>
<h2 id="compute-count-of-group-of-repeating-values"><a class="markdownIt-Anchor" href="#compute-count-of-group-of-repeating-values">#</a> Compute count of group of repeating values</h2>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">with</span> t <span class="keyword">as</span> (</span><br><span class="line">  <span class="keyword">select</span> level <span class="keyword">as</span> <span class="keyword">no</span>,  substr(<span class="string">&#x27;AAAABCCCAAACA&#x27;</span>, level, <span class="number">1</span>) <span class="keyword">as</span> c</span><br><span class="line">    <span class="keyword">from</span> dual</span><br><span class="line">    <span class="keyword">connect</span> <span class="keyword">by</span> level <span class="operator">&lt;=</span> length(<span class="string">&#x27;AAAABCCCAAACA&#x27;</span>)</span><br><span class="line">)</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> t;</span><br></pre></td></tr></table></figure>
<table>
<thead>
<tr>
<th>NO</th>
<th>C</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td><strong>A</strong></td>
</tr>
<tr>
<td>2</td>
<td><strong>A</strong></td>
</tr>
<tr>
<td>3</td>
<td><strong>A</strong></td>
</tr>
<tr>
<td>4</td>
<td><strong>A</strong></td>
</tr>
<tr>
<td>5</td>
<td>B</td>
</tr>
<tr>
<td>6</td>
<td>C</td>
</tr>
<tr>
<td>7</td>
<td>C</td>
</tr>
<tr>
<td>8</td>
<td>C</td>
</tr>
<tr>
<td>9</td>
<td><strong>A</strong></td>
</tr>
<tr>
<td>10</td>
<td><strong>A</strong></td>
</tr>
<tr>
<td>11</td>
<td><strong>A</strong></td>
</tr>
<tr>
<td>12</td>
<td>C</td>
</tr>
<tr>
<td>13</td>
<td><strong>A</strong></td>
</tr>
</tbody>
</table>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">with</span> t <span class="keyword">as</span></span><br><span class="line"> (<span class="keyword">select</span> level <span class="keyword">as</span> <span class="keyword">no</span>, substr(<span class="string">&#x27;AAAABCCCAAACA&#x27;</span>, level, <span class="number">1</span>) <span class="keyword">as</span> c</span><br><span class="line">    <span class="keyword">from</span> dual</span><br><span class="line">  <span class="keyword">connect</span> <span class="keyword">by</span> level <span class="operator">&lt;=</span> length(<span class="string">&#x27;AAAABCCCAAACA&#x27;</span>))</span><br><span class="line"><span class="keyword">select</span> c,</span><br><span class="line">       <span class="built_in">row_number</span>() <span class="keyword">over</span>(<span class="keyword">order</span> <span class="keyword">by</span> <span class="keyword">no</span>) <span class="operator">-</span> <span class="built_in">row_number</span>() <span class="keyword">over</span>(<span class="keyword">partition</span> <span class="keyword">by</span> c <span class="keyword">order</span> <span class="keyword">by</span> <span class="keyword">no</span>) <span class="keyword">as</span> r,</span><br><span class="line">       <span class="built_in">row_number</span>() <span class="keyword">over</span>(<span class="keyword">order</span> <span class="keyword">by</span> <span class="keyword">no</span>),</span><br><span class="line">       <span class="built_in">row_number</span>() <span class="keyword">over</span>(<span class="keyword">partition</span> <span class="keyword">by</span> c <span class="keyword">order</span> <span class="keyword">by</span> <span class="keyword">no</span>)</span><br><span class="line">  <span class="keyword">from</span> t;</span><br></pre></td></tr></table></figure>
<table>
<thead>
<tr>
<th>C</th>
<th>R</th>
<th>ROW_NUMBER()OVER(ORDERBYNO)</th>
<th>ROW_NUMBER()OVER(PARTITIONBYCO</th>
</tr>
</thead>
<tbody>
<tr>
<td>A</td>
<td>0</td>
<td>1</td>
<td>1</td>
</tr>
<tr>
<td>A</td>
<td>0</td>
<td>2</td>
<td>2</td>
</tr>
<tr>
<td>A</td>
<td>0</td>
<td>3</td>
<td>3</td>
</tr>
<tr>
<td>A</td>
<td>0</td>
<td>4</td>
<td>4</td>
</tr>
<tr>
<td>B</td>
<td>4</td>
<td>5</td>
<td>1</td>
</tr>
<tr>
<td>C</td>
<td>5</td>
<td>6</td>
<td>1</td>
</tr>
<tr>
<td>C</td>
<td>5</td>
<td>7</td>
<td>2</td>
</tr>
<tr>
<td>C</td>
<td>5</td>
<td>8</td>
<td>3</td>
</tr>
<tr>
<td>A</td>
<td>4</td>
<td>9</td>
<td>5</td>
</tr>
<tr>
<td>A</td>
<td>4</td>
<td>10</td>
<td>6</td>
</tr>
<tr>
<td>A</td>
<td>4</td>
<td>11</td>
<td>7</td>
</tr>
</tbody>
</table>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">with</span> t <span class="keyword">as</span> (</span><br><span class="line">  <span class="keyword">select</span> level <span class="keyword">as</span> <span class="keyword">no</span>,  substr(<span class="string">&#x27;AAAABCCCAAACA&#x27;</span>, level, <span class="number">1</span>) <span class="keyword">as</span> c</span><br><span class="line">    <span class="keyword">from</span> dual</span><br><span class="line">    <span class="keyword">connect</span> <span class="keyword">by</span> level <span class="operator">&lt;=</span> length(<span class="string">&#x27;AAAABCCCAAACA&#x27;</span>)</span><br><span class="line">)</span><br><span class="line"><span class="keyword">select</span> c, <span class="built_in">count</span>(<span class="operator">*</span>)</span><br><span class="line">  <span class="keyword">from</span> (</span><br><span class="line">    <span class="keyword">select</span> <span class="keyword">distinct</span> c, <span class="built_in">row_number</span>() <span class="keyword">over</span> (<span class="keyword">order</span> <span class="keyword">by</span> <span class="keyword">no</span>) <span class="operator">-</span> <span class="built_in">row_number</span>() <span class="keyword">over</span> (<span class="keyword">partition</span> <span class="keyword">by</span> c <span class="keyword">order</span> <span class="keyword">by</span> <span class="keyword">no</span>) <span class="keyword">as</span> r</span><br><span class="line">      <span class="keyword">from</span> t</span><br><span class="line">) <span class="keyword">group</span> <span class="keyword">by</span> c;</span><br></pre></td></tr></table></figure>
<table>
<thead>
<tr>
<th>C</th>
<th>COUNT(*)</th>
</tr>
</thead>
<tbody>
<tr>
<td>A</td>
<td>3</td>
</tr>
<tr>
<td>C</td>
<td>2</td>
</tr>
<tr>
<td>B</td>
<td>1</td>
</tr>
</tbody>
</table>
<h2 id="concate-previous-row-value-continuously"><a class="markdownIt-Anchor" href="#concate-previous-row-value-continuously">#</a> Concate previous row value continuously</h2>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">with</span> t <span class="keyword">as</span> (</span><br><span class="line">  <span class="keyword">select</span> <span class="string">&#x27;A&#x27;</span> <span class="keyword">as</span> col1, <span class="number">1</span> <span class="keyword">as</span> col2 <span class="keyword">from</span> dual <span class="keyword">union</span> <span class="keyword">all</span></span><br><span class="line">  <span class="keyword">select</span> <span class="string">&#x27;A&#x27;</span>,  <span class="number">2</span> <span class="keyword">from</span> dual <span class="keyword">union</span> <span class="keyword">all</span></span><br><span class="line">  <span class="keyword">select</span> <span class="string">&#x27;A&#x27;</span>,  <span class="number">3</span> <span class="keyword">from</span> dual <span class="keyword">union</span> <span class="keyword">all</span></span><br><span class="line">  <span class="keyword">select</span> <span class="string">&#x27;B&#x27;</span>, <span class="number">100</span> <span class="keyword">from</span> dual <span class="keyword">union</span> <span class="keyword">all</span> </span><br><span class="line">  <span class="keyword">select</span> <span class="string">&#x27;B&#x27;</span>, <span class="number">200</span> <span class="keyword">from</span> dual <span class="keyword">union</span> <span class="keyword">all</span></span><br><span class="line">  <span class="keyword">select</span> <span class="string">&#x27;B&#x27;</span>, <span class="number">300</span> <span class="keyword">from</span> dual <span class="keyword">union</span> <span class="keyword">all</span></span><br><span class="line">  <span class="keyword">select</span> <span class="string">&#x27;B&#x27;</span>, <span class="number">400</span> <span class="keyword">from</span> dual <span class="keyword">union</span> <span class="keyword">all</span></span><br><span class="line">  <span class="keyword">select</span> <span class="string">&#x27;B&#x27;</span>, <span class="number">500</span> <span class="keyword">from</span> dual</span><br><span class="line">),</span><br><span class="line">t1 <span class="keyword">as</span> (</span><br><span class="line">  <span class="keyword">select</span> col1,</span><br><span class="line">         col2,</span><br><span class="line">         <span class="built_in">listagg</span>(col2, <span class="string">&#x27;,&#x27;</span>) <span class="keyword">within</span> <span class="keyword">group</span>(<span class="keyword">order</span> <span class="keyword">by</span> col2) <span class="keyword">over</span> (<span class="keyword">partition</span> <span class="keyword">by</span> col1) agg,</span><br><span class="line">         <span class="built_in">row_number</span>() <span class="keyword">over</span> (<span class="keyword">partition</span> <span class="keyword">by</span> col1 <span class="keyword">order</span> <span class="keyword">by</span> col2) r</span><br><span class="line">    <span class="keyword">from</span> t</span><br><span class="line">)</span><br></pre></td></tr></table></figure>
<table>
<thead>
<tr>
<th>COL1</th>
<th>COL2</th>
<th>AGG</th>
<th>R</th>
</tr>
</thead>
<tbody>
<tr>
<td>A</td>
<td>1</td>
<td>1,2,3</td>
<td>1</td>
</tr>
<tr>
<td>A</td>
<td>2</td>
<td>1,2,3</td>
<td>2</td>
</tr>
<tr>
<td>A</td>
<td>3</td>
<td>1,2,3</td>
<td>3</td>
</tr>
<tr>
<td>B</td>
<td>100</td>
<td>100,200,300,400,500</td>
<td>1</td>
</tr>
<tr>
<td>B</td>
<td>200</td>
<td>100,200,300,400,500</td>
<td>2</td>
</tr>
<tr>
<td>B</td>
<td>300</td>
<td>100,200,300,400,500</td>
<td>3</td>
</tr>
<tr>
<td>B</td>
<td>400</td>
<td>100,200,300,400,500</td>
<td>4</td>
</tr>
<tr>
<td>B</td>
<td>500</td>
<td>100,200,300,400,500</td>
<td>5</td>
</tr>
</tbody>
</table>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">with</span> t <span class="keyword">as</span> (</span><br><span class="line">  <span class="keyword">select</span> <span class="string">&#x27;A&#x27;</span> <span class="keyword">as</span> col1, <span class="number">1</span> <span class="keyword">as</span> col2 <span class="keyword">from</span> dual <span class="keyword">union</span> <span class="keyword">all</span></span><br><span class="line">  <span class="keyword">select</span> <span class="string">&#x27;A&#x27;</span>,  <span class="number">2</span> <span class="keyword">from</span> dual <span class="keyword">union</span> <span class="keyword">all</span></span><br><span class="line">  <span class="keyword">select</span> <span class="string">&#x27;A&#x27;</span>,  <span class="number">3</span> <span class="keyword">from</span> dual <span class="keyword">union</span> <span class="keyword">all</span></span><br><span class="line">  <span class="keyword">select</span> <span class="string">&#x27;B&#x27;</span>, <span class="number">100</span> <span class="keyword">from</span> dual <span class="keyword">union</span> <span class="keyword">all</span> </span><br><span class="line">  <span class="keyword">select</span> <span class="string">&#x27;B&#x27;</span>, <span class="number">200</span> <span class="keyword">from</span> dual <span class="keyword">union</span> <span class="keyword">all</span></span><br><span class="line">  <span class="keyword">select</span> <span class="string">&#x27;B&#x27;</span>, <span class="number">300</span> <span class="keyword">from</span> dual <span class="keyword">union</span> <span class="keyword">all</span></span><br><span class="line">  <span class="keyword">select</span> <span class="string">&#x27;B&#x27;</span>, <span class="number">400</span> <span class="keyword">from</span> dual <span class="keyword">union</span> <span class="keyword">all</span></span><br><span class="line">  <span class="keyword">select</span> <span class="string">&#x27;B&#x27;</span>, <span class="number">500</span> <span class="keyword">from</span> dual</span><br><span class="line">),</span><br><span class="line">t1 <span class="keyword">as</span> (</span><br><span class="line">  <span class="keyword">select</span> col1,</span><br><span class="line">         col2,</span><br><span class="line">         <span class="built_in">listagg</span>(col2, <span class="string">&#x27;,&#x27;</span>) <span class="keyword">within</span> <span class="keyword">group</span>(<span class="keyword">order</span> <span class="keyword">by</span> col2) <span class="keyword">over</span> (<span class="keyword">partition</span> <span class="keyword">by</span> col1) agg,</span><br><span class="line">         <span class="built_in">row_number</span>() <span class="keyword">over</span> (<span class="keyword">partition</span> <span class="keyword">by</span> col1 <span class="keyword">order</span> <span class="keyword">by</span> col2) r</span><br><span class="line">    <span class="keyword">from</span> t</span><br><span class="line">)</span><br><span class="line"><span class="keyword">select</span> col1, col2, </span><br><span class="line">       substr(agg, <span class="number">0</span>, instr(agg <span class="operator">||</span> <span class="string">&#x27;,&#x27;</span>, <span class="string">&#x27;,&#x27;</span>, <span class="number">1</span>, r) <span class="operator">-</span> <span class="number">1</span>) output</span><br><span class="line">  <span class="keyword">from</span> t1;</span><br></pre></td></tr></table></figure>
<table>
<thead>
<tr>
<th>COL1</th>
<th>COL2</th>
<th>OUTPUT</th>
</tr>
</thead>
<tbody>
<tr>
<td>A</td>
<td>1</td>
<td>1</td>
</tr>
<tr>
<td>A</td>
<td>2</td>
<td>1,2</td>
</tr>
<tr>
<td>A</td>
<td>3</td>
<td>1,2,3</td>
</tr>
<tr>
<td>B</td>
<td>100</td>
<td>100</td>
</tr>
<tr>
<td>B</td>
<td>200</td>
<td>100,200</td>
</tr>
<tr>
<td>B</td>
<td>300</td>
<td>100,200,300</td>
</tr>
<tr>
<td>B</td>
<td>400</td>
<td>100,200,300,400</td>
</tr>
<tr>
<td>B</td>
<td>500</td>
<td>100,200,300,400,500</td>
</tr>
</tbody>
</table>
<h2 id="generate-integer-series-1n"><a class="markdownIt-Anchor" href="#generate-integer-series-1n">#</a> Generate integer series 1…n</h2>
<h3 id="integer-table-method"><a class="markdownIt-Anchor" href="#integer-table-method">#</a> Integer Table Method</h3>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> integers</span><br><span class="line">  ( integer_value <span class="type">integer</span> <span class="keyword">primary</span> key )</span><br><span class="line">  organization index;</span><br><span class="line"></span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">  <span class="keyword">for</span> i <span class="keyword">in</span> <span class="number">-5</span> .. <span class="number">5</span> loop</span><br><span class="line">    <span class="keyword">insert</span> <span class="keyword">into</span> integers <span class="keyword">values</span> ( i );</span><br><span class="line">  <span class="keyword">end</span> loop;</span><br><span class="line">  <span class="keyword">commit</span>;</span><br><span class="line"><span class="keyword">end</span>;</span><br><span class="line"><span class="operator">/</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> integers ;</span><br></pre></td></tr></table></figure>
<table>
<thead>
<tr>
<th>INTEGER_VALUE</th>
</tr>
</thead>
<tbody>
<tr>
<td>-5</td>
</tr>
<tr>
<td>-4</td>
</tr>
<tr>
<td>-3</td>
</tr>
<tr>
<td>-2</td>
</tr>
<tr>
<td>-1</td>
</tr>
<tr>
<td>0</td>
</tr>
<tr>
<td>1</td>
</tr>
<tr>
<td>2</td>
</tr>
<tr>
<td>3</td>
</tr>
<tr>
<td>4</td>
</tr>
<tr>
<td>5</td>
</tr>
</tbody>
</table>
<h3 id="model-method"><a class="markdownIt-Anchor" href="#model-method">#</a> MODEL Method</h3>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> integer_value</span><br><span class="line">  <span class="keyword">from</span> dual </span><br><span class="line">  model </span><br><span class="line">  dimension <span class="keyword">by</span>(<span class="number">0</span> <span class="keyword">as</span> key) </span><br><span class="line">  measures(<span class="number">0</span> <span class="keyword">as</span> integer_value) </span><br><span class="line">  rules iterate(<span class="number">5</span>)</span><br><span class="line">    (integer_value[ iteration_number ] <span class="operator">=</span> iteration_number <span class="operator">+</span> <span class="number">1</span>)</span><br><span class="line"> <span class="keyword">order</span> <span class="keyword">by</span> <span class="number">1</span>;</span><br></pre></td></tr></table></figure>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> integer_value</span><br><span class="line">  <span class="keyword">from</span> dual</span><br><span class="line"> <span class="keyword">where</span> <span class="number">1</span> <span class="operator">=</span> <span class="number">2</span> </span><br><span class="line"> model </span><br><span class="line"> dimension <span class="keyword">by</span> (<span class="number">0</span> <span class="keyword">as</span> key) </span><br><span class="line"> measures (<span class="number">0</span> <span class="keyword">as</span> integer_value)</span><br><span class="line"> rules upsert(integer_value[ <span class="keyword">for</span> key <span class="keyword">from</span> <span class="number">-5</span> <span class="keyword">to</span> <span class="number">5</span> increment <span class="number">1</span> ] <span class="operator">=</span> cv(key))</span><br></pre></td></tr></table></figure>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> integer_value</span><br><span class="line">  <span class="keyword">from</span> dual</span><br><span class="line"> <span class="keyword">where</span> <span class="number">1</span> <span class="operator">=</span> <span class="number">2</span> </span><br><span class="line"> model </span><br><span class="line"> dimension <span class="keyword">by</span> (<span class="number">0</span> <span class="keyword">as</span> key) </span><br><span class="line"> measures (<span class="number">0</span> <span class="keyword">as</span> integer_value)</span><br><span class="line"> rules upsert (integer_value[ <span class="keyword">for</span> key <span class="keyword">from</span> <span class="number">-5</span> <span class="keyword">to</span> <span class="number">5</span> increment <span class="number">2</span> ] <span class="operator">=</span> cv(key));</span><br></pre></td></tr></table></figure>
<table>
<thead>
<tr>
<th>INTEGER_VALUE</th>
</tr>
</thead>
<tbody>
<tr>
<td>-5</td>
</tr>
<tr>
<td>-3</td>
</tr>
<tr>
<td>-1</td>
</tr>
<tr>
<td>1</td>
</tr>
<tr>
<td>3</td>
</tr>
<tr>
<td>5</td>
</tr>
</tbody>
</table>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> integer_value</span><br><span class="line">  <span class="keyword">from</span> dual</span><br><span class="line"> <span class="keyword">where</span> <span class="number">1</span> <span class="operator">=</span> <span class="number">2</span> </span><br><span class="line"> model </span><br><span class="line"> dimension <span class="keyword">by</span> (<span class="number">0</span> <span class="keyword">as</span> key) </span><br><span class="line"> measures (<span class="number">0</span> <span class="keyword">as</span> integer_value)</span><br><span class="line"> rules upsert(integer_value [ <span class="keyword">for</span> key <span class="keyword">from</span> <span class="number">3</span> <span class="keyword">to</span> <span class="number">1</span> DECREMENT <span class="number">1</span> ] <span class="operator">=</span> cv(key))</span><br><span class="line"> <span class="keyword">order</span> <span class="keyword">by</span> integer_value <span class="keyword">desc</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">--or</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> integer_value</span><br><span class="line">  <span class="keyword">from</span> dual</span><br><span class="line"> <span class="keyword">where</span> <span class="number">1</span> <span class="operator">=</span> <span class="number">2</span> </span><br><span class="line"> model </span><br><span class="line"> dimension <span class="keyword">by</span> (<span class="number">0</span> <span class="keyword">as</span> key) </span><br><span class="line"> measures (<span class="number">0</span> <span class="keyword">as</span> integer_value)</span><br><span class="line"> rules upsert(integer_value [ <span class="keyword">for</span> key <span class="keyword">from</span> <span class="number">1</span> <span class="keyword">to</span> <span class="number">3</span> INCREMENT <span class="number">1</span> ] <span class="operator">=</span> cv(key))</span><br><span class="line"> <span class="keyword">order</span> <span class="keyword">by</span> integer_value <span class="keyword">desc</span>;</span><br></pre></td></tr></table></figure>
<table>
<thead>
<tr>
<th>INTEGER_VALUE</th>
</tr>
</thead>
<tbody>
<tr>
<td>3</td>
</tr>
<tr>
<td>2</td>
</tr>
<tr>
<td>1</td>
</tr>
</tbody>
</table>
<h3 id="rownum-a-big-table-method"><a class="markdownIt-Anchor" href="#rownum-a-big-table-method">#</a> ROWNUM + a Big Table Method</h3>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> rownum</span><br><span class="line">  <span class="keyword">from</span> all_objects</span><br><span class="line"> <span class="keyword">where</span> rownum <span class="operator">&lt;=</span> <span class="number">5</span>;</span><br></pre></td></tr></table></figure>
<h3 id="connect-by-level-method"><a class="markdownIt-Anchor" href="#connect-by-level-method">#</a> CONNECT BY LEVEL Method</h3>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> level </span><br><span class="line">  <span class="keyword">from</span> dual </span><br><span class="line"><span class="keyword">connect</span> <span class="keyword">by</span> level <span class="operator">&lt;=</span> <span class="number">5</span>;</span><br></pre></td></tr></table></figure>
<h3 id="cube-method"><a class="markdownIt-Anchor" href="#cube-method">#</a> CUBE Method</h3>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> rownum</span><br><span class="line">  <span class="keyword">from</span> (<span class="keyword">select</span> <span class="number">1</span> </span><br><span class="line">          <span class="keyword">from</span> dual </span><br><span class="line">         <span class="keyword">group</span> <span class="keyword">by</span> <span class="keyword">cube</span>(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>))</span><br><span class="line"> <span class="keyword">where</span> rownum <span class="operator">&lt;=</span> <span class="number">5</span>;</span><br></pre></td></tr></table></figure>
<h3 id="type-constructor-expression-method"><a class="markdownIt-Anchor" href="#type-constructor-expression-method">#</a> Type Constructor Expression Method</h3>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> type integer_table_type <span class="keyword">as</span> <span class="keyword">table</span> <span class="keyword">of</span> <span class="type">integer</span>;</span><br></pre></td></tr></table></figure>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> column_value</span><br><span class="line">  <span class="keyword">from</span> <span class="keyword">table</span>(integer_table_type(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>));</span><br></pre></td></tr></table></figure>
<table>
<thead>
<tr>
<th>COLUMN_VALUE</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
</tr>
<tr>
<td>2</td>
</tr>
<tr>
<td>3</td>
</tr>
<tr>
<td>4</td>
</tr>
<tr>
<td>5</td>
</tr>
</tbody>
</table>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> column_value </span><br><span class="line">  <span class="keyword">from</span> <span class="keyword">table</span>(integer_table_type(<span class="number">1</span>, <span class="number">1</span>, <span class="number">4</span>, <span class="number">4</span>, <span class="number">4</span>, <span class="number">8</span>, <span class="number">10</span>));</span><br></pre></td></tr></table></figure>
<table>
<thead>
<tr>
<th>COLUMN_VALUE</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
</tr>
<tr>
<td>1</td>
</tr>
<tr>
<td>4</td>
</tr>
<tr>
<td>4</td>
</tr>
<tr>
<td>4</td>
</tr>
<tr>
<td>8</td>
</tr>
<tr>
<td>10</td>
</tr>
</tbody>
</table>
<h3 id="type-constructor-cartesian-product-method"><a class="markdownIt-Anchor" href="#type-constructor-cartesian-product-method">#</a> Type Constructor + Cartesian Product Method</h3>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> type integer_table_type <span class="keyword">as</span> <span class="keyword">table</span> <span class="keyword">of</span> <span class="type">integer</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> i <span class="keyword">as</span></span><br><span class="line"> (<span class="keyword">select</span> <span class="operator">*</span> </span><br><span class="line">    <span class="keyword">from</span> <span class="keyword">table</span>(integer_table_type(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>)))</span><br><span class="line"><span class="keyword">select</span> rownum <span class="keyword">from</span> i, i, i, i <span class="keyword">where</span> rownum <span class="operator">&lt;=</span> <span class="number">5</span>;</span><br></pre></td></tr></table></figure>
<h3 id="pipelined-function-method"><a class="markdownIt-Anchor" href="#pipelined-function-method">#</a> Pipelined Function Method</h3>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> type integer_table_type <span class="keyword">as</span> <span class="keyword">table</span> <span class="keyword">of</span> <span class="type">integer</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">function</span> integer_series(p_lower_bound <span class="keyword">in</span> number,</span><br><span class="line">                               p_upper_bound <span class="keyword">in</span> number)</span><br><span class="line">  <span class="keyword">return</span> integer_table_type</span><br><span class="line">  pipelined <span class="keyword">as</span></span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">for</span> i <span class="keyword">in</span> p_lower_bound .. p_upper_bound loop</span><br><span class="line">    pipe <span class="type">row</span>(i);</span><br><span class="line">  <span class="keyword">end</span> loop;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span>;</span><br><span class="line"><span class="keyword">end</span>;</span><br><span class="line"><span class="operator">/</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span></span><br><span class="line">  <span class="keyword">from</span> <span class="keyword">table</span>(integer_series(<span class="number">-5</span>, <span class="number">5</span>)) ;</span><br></pre></td></tr></table></figure>
<h3 id="table-function-method"><a class="markdownIt-Anchor" href="#table-function-method">#</a> Table Function Method</h3>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">or</span> replace <span class="keyword">function</span> integer_series(p_lower_bound <span class="keyword">in</span> number,</span><br><span class="line">                                          p_upper_bound <span class="keyword">in</span> number)</span><br><span class="line">  <span class="keyword">return</span> sys.odcinumberlist <span class="keyword">is</span></span><br><span class="line">  l_num_tab sys.odcinumberlist :<span class="operator">=</span> sys.odcinumberlist();</span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">  <span class="keyword">for</span> i <span class="keyword">in</span> p_lower_bound .. p_upper_bound loop</span><br><span class="line">    l_num_tab.extend;</span><br><span class="line">    l_num_tab(l_num_tab.last) :<span class="operator">=</span> i;</span><br><span class="line">  <span class="keyword">end</span> loop;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> l_num_tab;</span><br><span class="line"><span class="keyword">end</span>;</span><br><span class="line"><span class="operator">/</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> <span class="keyword">table</span>(integer_series(<span class="number">-5</span>, <span class="number">5</span>));</span><br></pre></td></tr></table></figure>
<h3 id="xml-method"><a class="markdownIt-Anchor" href="#xml-method">#</a> XML Method</h3>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> rownum <span class="keyword">from</span> (</span><br><span class="line">  <span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> xmltable(<span class="string">&#x27;1 to 10&#x27;</span>)</span><br><span class="line">);</span><br></pre></td></tr></table></figure>
<h3 id="with-cte-method"><a class="markdownIt-Anchor" href="#with-cte-method">#</a> WITH CTE Method</h3>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">with</span> t(n) <span class="keyword">as</span> (</span><br><span class="line">   <span class="keyword">select</span> <span class="number">1</span> <span class="keyword">from</span> dual</span><br><span class="line">   <span class="keyword">union</span> <span class="keyword">all</span></span><br><span class="line">   <span class="keyword">select</span> n <span class="operator">+</span> <span class="number">1</span> <span class="keyword">from</span> t <span class="keyword">where</span> n <span class="operator">&lt;</span> <span class="number">10</span>  </span><br><span class="line">)</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> t;</span><br></pre></td></tr></table></figure>
<h2 id="split-string-to-rows"><a class="markdownIt-Anchor" href="#split-string-to-rows">#</a> Split string to rows</h2>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> edi_t</span><br><span class="line">(</span><br><span class="line">  id  number,</span><br><span class="line">  data varchar2(<span class="number">10</span>),</span><br><span class="line">  note varchar2(<span class="number">25</span>)</span><br><span class="line">);</span><br><span class="line"><span class="operator">/</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> edi_t <span class="keyword">values</span> ( <span class="number">1</span> ,  <span class="string">&#x27;v1&#x27;</span>       , <span class="string">&#x27;One value&#x27;</span>               );</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> edi_t <span class="keyword">values</span> ( <span class="number">2</span> ,  <span class="string">&#x27;v1,&#x27;</span>      , <span class="string">&#x27;Two values, one empty&#x27;</span>   );</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> edi_t <span class="keyword">values</span> ( <span class="number">3</span> ,  <span class="string">&#x27;v1,,&#x27;</span>     , <span class="string">&#x27;Three values, two empty&#x27;</span> );</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> edi_t <span class="keyword">values</span> ( <span class="number">4</span> ,  <span class="string">&#x27;,v2,&#x27;</span>     , <span class="string">&#x27;Three values, two empty&#x27;</span> );</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> edi_t <span class="keyword">values</span> ( <span class="number">5</span> ,  <span class="string">&#x27;,,v3&#x27;</span>     , <span class="string">&#x27;Three values, two empty&#x27;</span> );</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> edi_t <span class="keyword">values</span> ( <span class="number">6</span> ,  <span class="string">&#x27;v1,v2&#x27;</span>    , <span class="string">&#x27;Two values&#x27;</span>              );</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> edi_t <span class="keyword">values</span> ( <span class="number">7</span> ,  <span class="string">&#x27;v1,v2,&#x27;</span>   , <span class="string">&#x27;Three values, one empty&#x27;</span> );</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> edi_t <span class="keyword">values</span> ( <span class="number">8</span> ,  <span class="string">&#x27;v1,v2,v3&#x27;</span> , <span class="string">&#x27;Three values, none empty&#x27;</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> edi_t <span class="keyword">values</span> ( <span class="number">9</span> ,  <span class="keyword">null</span>       , <span class="string">&#x27;One empty value&#x27;</span>         );</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> edi_t <span class="keyword">values</span> ( <span class="number">10</span> , <span class="string">&#x27;,&#x27;</span>        , <span class="string">&#x27;Two values, two empty&#x27;</span>   );</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> edi_t <span class="keyword">values</span> ( <span class="number">11</span> , <span class="string">&#x27;,,&#x27;</span>       , <span class="string">&#x27;Three values, all empty&#x27;</span> );</span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> edi_t;</span><br></pre></td></tr></table></figure>
<table>
<thead>
<tr>
<th>ID</th>
<th>DATA</th>
<th>NOTE</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>v1</td>
<td>One value</td>
</tr>
<tr>
<td>2</td>
<td>v1,</td>
<td>Two values, one empty</td>
</tr>
<tr>
<td>3</td>
<td>v1,</td>
<td>Three values, two empty</td>
</tr>
<tr>
<td>4</td>
<td>,v2,</td>
<td>Three values, two empty</td>
</tr>
<tr>
<td>5</td>
<td>,v3</td>
<td>Three values, two empty</td>
</tr>
<tr>
<td>6</td>
<td>v1,v2</td>
<td>Two values</td>
</tr>
<tr>
<td>7</td>
<td>v1,v2,</td>
<td>Three values, one empty</td>
</tr>
<tr>
<td>8</td>
<td>v1,v2,v3</td>
<td>Three values, none empty</td>
</tr>
<tr>
<td>9</td>
<td></td>
<td>One empty value</td>
</tr>
<tr>
<td>10</td>
<td>,</td>
<td>Two values, two empty</td>
</tr>
<tr>
<td>11</td>
<td>,</td>
<td>Three values, all empty</td>
</tr>
</tbody>
</table>
<h3 id="collection-method"><a class="markdownIt-Anchor" href="#collection-method">#</a> Collection Method</h3>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> id,</span><br><span class="line">       data,</span><br><span class="line">       regexp_substr(data, <span class="string">&#x27;[^,]+&#x27;</span>, <span class="number">1</span>, column_value) <span class="keyword">as</span> val,</span><br><span class="line">       column_value <span class="keyword">as</span> position,</span><br><span class="line">       note</span><br><span class="line">  <span class="keyword">from</span> edi_t,</span><br><span class="line">       <span class="keyword">table</span>(<span class="built_in">cast</span>(<span class="keyword">multiset</span></span><br><span class="line">                  (<span class="keyword">select</span> level l</span><br><span class="line">                     <span class="keyword">from</span> dual</span><br><span class="line">                   <span class="keyword">connect</span> <span class="keyword">by</span> level <span class="operator">&lt;=</span> regexp_count(data, <span class="string">&#x27;,&#x27;</span>) <span class="operator">+</span> <span class="number">1</span>) <span class="keyword">as</span></span><br><span class="line">                  sys.odcinumberlist));</span><br></pre></td></tr></table></figure>
<table>
<thead>
<tr>
<th>ID</th>
<th>DATA</th>
<th>VAL</th>
<th>POSITION</th>
<th>NOTE</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>v1</td>
<td>v1</td>
<td>1</td>
<td>One value</td>
</tr>
<tr>
<td>2</td>
<td>v1,</td>
<td>v1</td>
<td>1</td>
<td>Two values, one empty</td>
</tr>
<tr>
<td>2</td>
<td>v1,</td>
<td></td>
<td>2</td>
<td>Two values, one empty</td>
</tr>
<tr>
<td>3</td>
<td>v1,</td>
<td>v1</td>
<td>1</td>
<td>Three values, two empty</td>
</tr>
<tr>
<td>3</td>
<td>v1,</td>
<td></td>
<td>2</td>
<td>Three values, two empty</td>
</tr>
<tr>
<td>3</td>
<td>v1,</td>
<td></td>
<td>3</td>
<td>Three values, two empty</td>
</tr>
<tr>
<td>4</td>
<td>,v2,</td>
<td>v2</td>
<td>1</td>
<td>Three values, two empty</td>
</tr>
<tr>
<td>4</td>
<td>,v2,</td>
<td></td>
<td>2</td>
<td>Three values, two empty</td>
</tr>
<tr>
<td>4</td>
<td>,v2,</td>
<td></td>
<td>3</td>
<td>Three values, two empty</td>
</tr>
<tr>
<td>5</td>
<td>,v3</td>
<td>v3</td>
<td>1</td>
<td>Three values, two empty</td>
</tr>
<tr>
<td>5</td>
<td>,v3</td>
<td></td>
<td>2</td>
<td>Three values, two empty</td>
</tr>
<tr>
<td>5</td>
<td>,v3</td>
<td></td>
<td>3</td>
<td>Three values, two empty</td>
</tr>
<tr>
<td>6</td>
<td>v1,v2</td>
<td>v1</td>
<td>1</td>
<td>Two values</td>
</tr>
<tr>
<td>6</td>
<td>v1,v2</td>
<td>v2</td>
<td>2</td>
<td>Two values</td>
</tr>
<tr>
<td>7</td>
<td>v1,v2,</td>
<td>v1</td>
<td>1</td>
<td>Three values, one empty</td>
</tr>
<tr>
<td>7</td>
<td>v1,v2,</td>
<td>v2</td>
<td>2</td>
<td>Three values, one empty</td>
</tr>
<tr>
<td>7</td>
<td>v1,v2,</td>
<td></td>
<td>3</td>
<td>Three values, one empty</td>
</tr>
<tr>
<td>8</td>
<td>v1,v2,v3</td>
<td>v1</td>
<td>1</td>
<td>Three values, none empty</td>
</tr>
<tr>
<td>8</td>
<td>v1,v2,v3</td>
<td>v2</td>
<td>2</td>
<td>Three values, none empty</td>
</tr>
<tr>
<td>8</td>
<td>v1,v2,v3</td>
<td>v3</td>
<td>3</td>
<td>Three values, none empty</td>
</tr>
<tr>
<td>9</td>
<td></td>
<td></td>
<td>1</td>
<td>One empty value</td>
</tr>
<tr>
<td>10</td>
<td>,</td>
<td></td>
<td>1</td>
<td>Two values, two empty</td>
</tr>
<tr>
<td>10</td>
<td>,</td>
<td></td>
<td>2</td>
<td>Two values, two empty</td>
</tr>
<tr>
<td>11</td>
<td>,</td>
<td></td>
<td>1</td>
<td>Three values, all empty</td>
</tr>
<tr>
<td>11</td>
<td>,</td>
<td></td>
<td>2</td>
<td>Three values, all empty</td>
</tr>
<tr>
<td>11</td>
<td>,</td>
<td></td>
<td>3</td>
<td>Three values, all empty</td>
</tr>
</tbody>
</table>
<h3 id="model-method-2"><a class="markdownIt-Anchor" href="#model-method-2">#</a> Model Method</h3>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> id, data, val, position, note</span><br><span class="line">  <span class="keyword">from</span> edi_t</span><br><span class="line">model</span><br><span class="line">  <span class="keyword">return</span> updated <span class="keyword">rows</span></span><br><span class="line">  <span class="keyword">partition</span> <span class="keyword">by</span> ( id, data, note )</span><br><span class="line">  dimension <span class="keyword">by</span> ( <span class="number">0</span> <span class="keyword">as</span> position )</span><br><span class="line">  measures     ( data <span class="operator">||</span> <span class="string">&#x27;,&#x27;</span> <span class="keyword">as</span> val )</span><br><span class="line">  rules upsert</span><br><span class="line">  ( val</span><br><span class="line">    [ <span class="keyword">for</span> position</span><br><span class="line">        <span class="keyword">from</span> <span class="number">1</span></span><br><span class="line">        <span class="keyword">to</span>   regexp_count(val[<span class="number">0</span>], <span class="string">&#x27;,&#x27;</span>)</span><br><span class="line">        increment <span class="number">1</span></span><br><span class="line">    ] <span class="operator">=</span> rtrim( regexp_substr( val[<span class="number">0</span>], <span class="string">&#x27;[^,]+&#x27;</span>, <span class="number">1</span>, cv(position) ), <span class="string">&#x27;,&#x27;</span> )</span><br><span class="line">  )</span><br><span class="line"><span class="keyword">order</span> <span class="keyword">by</span> id, position;</span><br></pre></td></tr></table></figure>
<table>
<thead>
<tr>
<th>ID</th>
<th>DATA</th>
<th>VAL</th>
<th>POSITION</th>
<th>NOTE</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>v1</td>
<td>v1</td>
<td>1</td>
<td>One value</td>
</tr>
<tr>
<td>2</td>
<td>v1,</td>
<td>v1</td>
<td>1</td>
<td>Two values, one empty</td>
</tr>
<tr>
<td>2</td>
<td>v1,</td>
<td></td>
<td>2</td>
<td>Two values, one empty</td>
</tr>
<tr>
<td>3</td>
<td>v1,</td>
<td>v1</td>
<td>1</td>
<td>Three values, two empty</td>
</tr>
<tr>
<td>3</td>
<td>v1,</td>
<td></td>
<td>2</td>
<td>Three values, two empty</td>
</tr>
<tr>
<td>3</td>
<td>v1,</td>
<td></td>
<td>3</td>
<td>Three values, two empty</td>
</tr>
<tr>
<td>4</td>
<td>,v2,</td>
<td>v2</td>
<td>1</td>
<td>Three values, two empty</td>
</tr>
<tr>
<td>4</td>
<td>,v2,</td>
<td></td>
<td>2</td>
<td>Three values, two empty</td>
</tr>
<tr>
<td>4</td>
<td>,v2,</td>
<td></td>
<td>3</td>
<td>Three values, two empty</td>
</tr>
<tr>
<td>5</td>
<td>,v3</td>
<td>v3</td>
<td>1</td>
<td>Three values, two empty</td>
</tr>
<tr>
<td>5</td>
<td>,v3</td>
<td></td>
<td>2</td>
<td>Three values, two empty</td>
</tr>
<tr>
<td>5</td>
<td>,v3</td>
<td></td>
<td>3</td>
<td>Three values, two empty</td>
</tr>
<tr>
<td>6</td>
<td>v1,v2</td>
<td>v1</td>
<td>1</td>
<td>Two values</td>
</tr>
<tr>
<td>6</td>
<td>v1,v2</td>
<td>v2</td>
<td>2</td>
<td>Two values</td>
</tr>
<tr>
<td>7</td>
<td>v1,v2,</td>
<td>v1</td>
<td>1</td>
<td>Three values, one empty</td>
</tr>
<tr>
<td>7</td>
<td>v1,v2,</td>
<td>v2</td>
<td>2</td>
<td>Three values, one empty</td>
</tr>
<tr>
<td>7</td>
<td>v1,v2,</td>
<td></td>
<td>3</td>
<td>Three values, one empty</td>
</tr>
<tr>
<td>8</td>
<td>v1,v2,v3</td>
<td>v1</td>
<td>1</td>
<td>Three values, none empty</td>
</tr>
<tr>
<td>8</td>
<td>v1,v2,v3</td>
<td>v2</td>
<td>2</td>
<td>Three values, none empty</td>
</tr>
<tr>
<td>8</td>
<td>v1,v2,v3</td>
<td>v3</td>
<td>3</td>
<td>Three values, none empty</td>
</tr>
<tr>
<td>9</td>
<td></td>
<td></td>
<td>1</td>
<td>One empty value</td>
</tr>
<tr>
<td>10</td>
<td>,</td>
<td></td>
<td>1</td>
<td>Two values, two empty</td>
</tr>
<tr>
<td>10</td>
<td>,</td>
<td></td>
<td>2</td>
<td>Two values, two empty</td>
</tr>
<tr>
<td>11</td>
<td>,</td>
<td></td>
<td>1</td>
<td>Three values, all empty</td>
</tr>
<tr>
<td>11</td>
<td>,</td>
<td></td>
<td>2</td>
<td>Three values, all empty</td>
</tr>
<tr>
<td>11</td>
<td>,</td>
<td></td>
<td>3</td>
<td>Three values, all empty</td>
</tr>
</tbody>
</table>
<h3 id="pipelined-function-method-2"><a class="markdownIt-Anchor" href="#pipelined-function-method-2">#</a> Pipelined Function Method</h3>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> type table_str <span class="keyword">is</span> <span class="keyword">table</span> <span class="keyword">of</span> varchar2(<span class="number">4000</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">or</span> replace <span class="keyword">function</span> split_str(p_str       <span class="keyword">in</span> varchar2,</span><br><span class="line">                                     p_separator <span class="keyword">in</span> varchar2 <span class="keyword">default</span> <span class="string">&#x27;,&#x27;</span>)</span><br><span class="line">  <span class="keyword">return</span> table_str</span><br><span class="line">  pipelined <span class="keyword">as</span></span><br><span class="line"></span><br><span class="line">  l_index pls_integer;</span><br><span class="line">  l_start pls_integer;</span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">  l_start :<span class="operator">=</span> <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">  loop</span><br><span class="line">    l_index :<span class="operator">=</span> instr(p_str, p_separator, l_start);</span><br><span class="line">    if nvl(l_index, <span class="number">0</span>) <span class="operator">=</span> <span class="number">0</span> <span class="keyword">then</span></span><br><span class="line">      pipe <span class="type">row</span>(substr(p_str, l_start));</span><br><span class="line">      exit;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">      pipe <span class="type">row</span>(substr(p_str, l_start, l_index <span class="operator">-</span> l_start));</span><br><span class="line">      l_start :<span class="operator">=</span> l_index <span class="operator">+</span> length(p_separator);</span><br><span class="line">    <span class="keyword">end</span> if;</span><br><span class="line">  <span class="keyword">end</span> loop;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span>;</span><br><span class="line"><span class="keyword">end</span> split_str;</span><br><span class="line"><span class="operator">/</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> id,</span><br><span class="line">       data,</span><br><span class="line">       column_value <span class="keyword">as</span> val,</span><br><span class="line">       <span class="built_in">row_number</span>() <span class="keyword">over</span>(<span class="keyword">partition</span> <span class="keyword">by</span> id <span class="keyword">order</span> <span class="keyword">by</span> rownum) <span class="keyword">as</span> position,</span><br><span class="line">       note</span><br><span class="line">  <span class="keyword">from</span> edi_t, <span class="keyword">table</span>(split_str(data));</span><br></pre></td></tr></table></figure>
<table>
<thead>
<tr>
<th>ID</th>
<th>DATA</th>
<th>VAL</th>
<th>POSITION</th>
<th>NOTE</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>v1</td>
<td>v1</td>
<td>1</td>
<td>One value</td>
</tr>
<tr>
<td>2</td>
<td>v1,</td>
<td>v1</td>
<td>1</td>
<td>Two values, one empty</td>
</tr>
<tr>
<td>2</td>
<td>v1,</td>
<td></td>
<td>2</td>
<td>Two values, one empty</td>
</tr>
<tr>
<td>3</td>
<td>v1,</td>
<td>v1</td>
<td>1</td>
<td>Three values, two empty</td>
</tr>
<tr>
<td>3</td>
<td>v1,</td>
<td></td>
<td>2</td>
<td>Three values, two empty</td>
</tr>
<tr>
<td>3</td>
<td>v1,</td>
<td></td>
<td>3</td>
<td>Three values, two empty</td>
</tr>
<tr>
<td>4</td>
<td>,v2,</td>
<td></td>
<td>1</td>
<td>Three values, two empty</td>
</tr>
<tr>
<td>4</td>
<td>,v2,</td>
<td>v2</td>
<td>2</td>
<td>Three values, two empty</td>
</tr>
<tr>
<td>4</td>
<td>,v2,</td>
<td></td>
<td>3</td>
<td>Three values, two empty</td>
</tr>
<tr>
<td>5</td>
<td>,v3</td>
<td></td>
<td>1</td>
<td>Three values, two empty</td>
</tr>
<tr>
<td>5</td>
<td>,v3</td>
<td></td>
<td>2</td>
<td>Three values, two empty</td>
</tr>
<tr>
<td>5</td>
<td>,v3</td>
<td>v3</td>
<td>3</td>
<td>Three values, two empty</td>
</tr>
<tr>
<td>6</td>
<td>v1,v2</td>
<td>v1</td>
<td>1</td>
<td>Two values</td>
</tr>
<tr>
<td>6</td>
<td>v1,v2</td>
<td>v2</td>
<td>2</td>
<td>Two values</td>
</tr>
<tr>
<td>7</td>
<td>v1,v2,</td>
<td>v1</td>
<td>1</td>
<td>Three values, one empty</td>
</tr>
<tr>
<td>7</td>
<td>v1,v2,</td>
<td>v2</td>
<td>2</td>
<td>Three values, one empty</td>
</tr>
<tr>
<td>7</td>
<td>v1,v2,</td>
<td></td>
<td>3</td>
<td>Three values, one empty</td>
</tr>
<tr>
<td>8</td>
<td>v1,v2,v3</td>
<td>v1</td>
<td>1</td>
<td>Three values, none empty</td>
</tr>
<tr>
<td>8</td>
<td>v1,v2,v3</td>
<td>v2</td>
<td>2</td>
<td>Three values, none empty</td>
</tr>
<tr>
<td>8</td>
<td>v1,v2,v3</td>
<td>v3</td>
<td>3</td>
<td>Three values, none empty</td>
</tr>
<tr>
<td>9</td>
<td></td>
<td></td>
<td>1</td>
<td>One empty value</td>
</tr>
<tr>
<td>10</td>
<td>,</td>
<td></td>
<td>1</td>
<td>Two values, two empty</td>
</tr>
<tr>
<td>10</td>
<td>,</td>
<td></td>
<td>2</td>
<td>Two values, two empty</td>
</tr>
<tr>
<td>11</td>
<td>,</td>
<td></td>
<td>1</td>
<td>Three values, all empty</td>
</tr>
<tr>
<td>11</td>
<td>,</td>
<td></td>
<td>2</td>
<td>Three values, all empty</td>
</tr>
<tr>
<td>11</td>
<td>,</td>
<td></td>
<td>3</td>
<td>Three values, all empty</td>
</tr>
</tbody>
</table>
<h3 id="java-function-method"><a class="markdownIt-Anchor" href="#java-function-method">#</a> Java Function Method</h3>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> type edi_varchar_list_type <span class="keyword">is</span> <span class="keyword">table</span> <span class="keyword">of</span> varchar2(<span class="number">32767</span>);</span><br><span class="line"><span class="operator">/</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">or</span> replace <span class="keyword">and</span> compile java source named edi_java_test <span class="keyword">as</span></span><br><span class="line">import java.lang.<span class="operator">*</span>;</span><br><span class="line">public class edi_java_test &#123;</span><br><span class="line">    public static java.sql.Array split_str(String str, String separator) throws java.sql.SQLException &#123;</span><br><span class="line">        String[] elements <span class="operator">=</span> str.split(separator);</span><br><span class="line">        </span><br><span class="line">        oracle.jdbc.OracleDriver driver <span class="operator">=</span> <span class="keyword">new</span> oracle.jdbc.OracleDriver();</span><br><span class="line">        java.sql.Connection conn <span class="operator">=</span> driver.defaultConnection();</span><br><span class="line">        oracle.jdbc.OracleConnection oracleConn <span class="operator">=</span> (oracle.jdbc.OracleConnection)conn;</span><br><span class="line">        </span><br><span class="line">        String typeName <span class="operator">=</span> &quot;EDI_VARCHAR_LIST_TYPE&quot;; <span class="comment">/* typeName have to be UPPERCASE */</span></span><br><span class="line">        java.sql.Array sqlArr <span class="operator">=</span> oracleConn.createARRAY(typeName, elements);</span><br><span class="line">        <span class="keyword">return</span> sqlArr;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="operator">/</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">or</span> replace <span class="keyword">function</span> edi_split_str(p_str varchar2, p_separator varchar2) <span class="keyword">return</span> edi_varchar_list_type <span class="keyword">as</span></span><br><span class="line"><span class="keyword">language</span> java name <span class="string">&#x27;edi_java_test.split_str(java.lang.String, java.lang.String) return java.sql.Array&#x27;</span>;</span><br><span class="line"><span class="operator">/</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> id,</span><br><span class="line">       data,</span><br><span class="line">       column_value <span class="keyword">as</span> val,</span><br><span class="line">       <span class="built_in">row_number</span>() <span class="keyword">over</span>(<span class="keyword">partition</span> <span class="keyword">by</span> id <span class="keyword">order</span> <span class="keyword">by</span> rownum) <span class="keyword">as</span> position,</span><br><span class="line">       note</span><br><span class="line">  <span class="keyword">from</span> edi_t, <span class="keyword">table</span>(edi_split_str(data, <span class="string">&#x27;,&#x27;</span>))</span><br><span class="line"> <span class="keyword">where</span> data <span class="keyword">is</span> <span class="keyword">not</span> <span class="keyword">null</span>;</span><br></pre></td></tr></table></figure>
<table>
<thead>
<tr>
<th>ID</th>
<th>DATA</th>
<th>VAL</th>
<th>POSITION</th>
<th>NOTE</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>v1</td>
<td>v1</td>
<td>1</td>
<td>One value</td>
</tr>
<tr>
<td>2</td>
<td>v1,</td>
<td>v1</td>
<td>1</td>
<td>Two values, one empty</td>
</tr>
<tr>
<td>3</td>
<td>v1,</td>
<td>v1</td>
<td>1</td>
<td>Three values, two empty</td>
</tr>
<tr>
<td>4</td>
<td>,v2,</td>
<td></td>
<td>1</td>
<td>Three values, two empty</td>
</tr>
<tr>
<td>4</td>
<td>,v2,</td>
<td>v2</td>
<td>2</td>
<td>Three values, two empty</td>
</tr>
<tr>
<td>5</td>
<td>,v3</td>
<td></td>
<td>1</td>
<td>Three values, two empty</td>
</tr>
<tr>
<td>5</td>
<td>,v3</td>
<td></td>
<td>2</td>
<td>Three values, two empty</td>
</tr>
<tr>
<td>5</td>
<td>,v3</td>
<td>v3</td>
<td>3</td>
<td>Three values, two empty</td>
</tr>
<tr>
<td>6</td>
<td>v1,v2</td>
<td>v1</td>
<td>1</td>
<td>Two values</td>
</tr>
<tr>
<td>6</td>
<td>v1,v2</td>
<td>v2</td>
<td>2</td>
<td>Two values</td>
</tr>
<tr>
<td>7</td>
<td>v1,v2,</td>
<td>v1</td>
<td>1</td>
<td>Three values, one empty</td>
</tr>
<tr>
<td>7</td>
<td>v1,v2,</td>
<td>v2</td>
<td>2</td>
<td>Three values, one empty</td>
</tr>
<tr>
<td>8</td>
<td>v1,v2,v3</td>
<td>v1</td>
<td>1</td>
<td>Three values, none empty</td>
</tr>
<tr>
<td>8</td>
<td>v1,v2,v3</td>
<td>v2</td>
<td>2</td>
<td>Three values, none empty</td>
</tr>
<tr>
<td>8</td>
<td>v1,v2,v3</td>
<td>v3</td>
<td>3</td>
<td>Three values, none empty</td>
</tr>
</tbody>
</table>
<h3 id="xml-method-2"><a class="markdownIt-Anchor" href="#xml-method-2">#</a> XML Method</h3>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">with</span> t <span class="keyword">as</span></span><br><span class="line"> (<span class="keyword">select</span> id,</span><br><span class="line">         data,</span><br><span class="line">         note,</span><br><span class="line">         <span class="string">&#x27;&lt;val&gt;&#x27;</span> <span class="operator">||</span> replace(data, <span class="string">&#x27;,&#x27;</span>, <span class="string">&#x27;&lt;/val&gt;&lt;val&gt;&#x27;</span>) <span class="operator">||</span> <span class="string">&#x27;&lt;/val&gt;&#x27;</span> <span class="keyword">as</span> data_xml</span><br><span class="line">    <span class="keyword">from</span> edi_t)</span><br><span class="line"><span class="keyword">select</span> id,</span><br><span class="line">       data,</span><br><span class="line">       EXTRACTVALUE(t2.column_value, <span class="string">&#x27;/*/text()&#x27;</span>) val,</span><br><span class="line">       <span class="built_in">row_number</span>() <span class="keyword">over</span>(<span class="keyword">partition</span> <span class="keyword">by</span> id <span class="keyword">order</span> <span class="keyword">by</span> rownum) <span class="keyword">as</span> position,</span><br><span class="line">       note</span><br><span class="line">  <span class="keyword">from</span> t, <span class="keyword">table</span>(XMLSEQUENCE(XMLPARSE(content t.data_xml wellformed))) t2;</span><br></pre></td></tr></table></figure>
<table>
<thead>
<tr>
<th>ID</th>
<th>DATA</th>
<th>VAL</th>
<th>POSITION</th>
<th>NOTE</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>v1</td>
<td>v1</td>
<td>1</td>
<td>One value</td>
</tr>
<tr>
<td>2</td>
<td>v1,</td>
<td>v1</td>
<td>1</td>
<td>Two values, one empty</td>
</tr>
<tr>
<td>2</td>
<td>v1,</td>
<td></td>
<td>2</td>
<td>Two values, one empty</td>
</tr>
<tr>
<td>3</td>
<td>v1,</td>
<td>v1</td>
<td>1</td>
<td>Three values, two empty</td>
</tr>
<tr>
<td>3</td>
<td>v1,</td>
<td></td>
<td>2</td>
<td>Three values, two empty</td>
</tr>
<tr>
<td>3</td>
<td>v1,</td>
<td></td>
<td>3</td>
<td>Three values, two empty</td>
</tr>
<tr>
<td>4</td>
<td>,v2,</td>
<td></td>
<td>1</td>
<td>Three values, two empty</td>
</tr>
<tr>
<td>4</td>
<td>,v2,</td>
<td>v2</td>
<td>2</td>
<td>Three values, two empty</td>
</tr>
<tr>
<td>4</td>
<td>,v2,</td>
<td></td>
<td>3</td>
<td>Three values, two empty</td>
</tr>
<tr>
<td>5</td>
<td>,v3</td>
<td></td>
<td>1</td>
<td>Three values, two empty</td>
</tr>
<tr>
<td>5</td>
<td>,v3</td>
<td></td>
<td>2</td>
<td>Three values, two empty</td>
</tr>
<tr>
<td>5</td>
<td>,v3</td>
<td>v3</td>
<td>3</td>
<td>Three values, two empty</td>
</tr>
<tr>
<td>6</td>
<td>v1,v2</td>
<td>v1</td>
<td>1</td>
<td>Two values</td>
</tr>
<tr>
<td>6</td>
<td>v1,v2</td>
<td>v2</td>
<td>2</td>
<td>Two values</td>
</tr>
<tr>
<td>7</td>
<td>v1,v2,</td>
<td>v1</td>
<td>1</td>
<td>Three values, one empty</td>
</tr>
<tr>
<td>7</td>
<td>v1,v2,</td>
<td>v2</td>
<td>2</td>
<td>Three values, one empty</td>
</tr>
<tr>
<td>7</td>
<td>v1,v2,</td>
<td></td>
<td>3</td>
<td>Three values, one empty</td>
</tr>
<tr>
<td>8</td>
<td>v1,v2,v3</td>
<td>v1</td>
<td>1</td>
<td>Three values, none empty</td>
</tr>
<tr>
<td>8</td>
<td>v1,v2,v3</td>
<td>v2</td>
<td>2</td>
<td>Three values, none empty</td>
</tr>
<tr>
<td>8</td>
<td>v1,v2,v3</td>
<td>v3</td>
<td>3</td>
<td>Three values, none empty</td>
</tr>
<tr>
<td>9</td>
<td></td>
<td></td>
<td>1</td>
<td>One empty value</td>
</tr>
<tr>
<td>10</td>
<td>,</td>
<td></td>
<td>1</td>
<td>Two values, two empty</td>
</tr>
<tr>
<td>10</td>
<td>,</td>
<td></td>
<td>2</td>
<td>Two values, two empty</td>
</tr>
<tr>
<td>11</td>
<td>,</td>
<td></td>
<td>1</td>
<td>Three values, all empty</td>
</tr>
<tr>
<td>11</td>
<td>,</td>
<td></td>
<td>2</td>
<td>Three values, all empty</td>
</tr>
<tr>
<td>11</td>
<td>,</td>
<td></td>
<td>3</td>
<td>Three values, all empty</td>
</tr>
</tbody>
</table>
<h2 id="calculate-the-median"><a class="markdownIt-Anchor" href="#calculate-the-median">#</a> Calculate the median</h2>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> movie_ratings (</span><br><span class="line">  rating number</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> movie_ratings(rating) <span class="keyword">values</span> (<span class="number">11</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> movie_ratings(rating) <span class="keyword">values</span> (<span class="number">12</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> movie_ratings(rating) <span class="keyword">values</span> (<span class="number">15</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> movie_ratings(rating) <span class="keyword">values</span> (<span class="number">19</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> movie_ratings(rating) <span class="keyword">values</span> (<span class="number">12</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> movie_ratings(rating) <span class="keyword">values</span> (<span class="number">13</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> movie_ratings(rating) <span class="keyword">values</span> (<span class="number">16</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> movie_ratings(rating) <span class="keyword">values</span> (<span class="number">20</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> movie_ratings;</span><br></pre></td></tr></table></figure>
<table>
<thead>
<tr>
<th>RATING</th>
</tr>
</thead>
<tbody>
<tr>
<td>11</td>
</tr>
<tr>
<td>12</td>
</tr>
<tr>
<td>15</td>
</tr>
<tr>
<td>19</td>
</tr>
<tr>
<td>12</td>
</tr>
<tr>
<td>13</td>
</tr>
<tr>
<td>16</td>
</tr>
<tr>
<td>20</td>
</tr>
</tbody>
</table>
<h3 id="row_number-window-function-method"><a class="markdownIt-Anchor" href="#row_number-window-function-method">#</a> ROW_NUMBER() Window Function Method</h3>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="built_in">avg</span>(m.rating)</span><br><span class="line">  <span class="keyword">from</span> (<span class="keyword">select</span> m1.rating,</span><br><span class="line">               <span class="built_in">row_number</span>() <span class="keyword">over</span>(<span class="keyword">order</span> <span class="keyword">by</span> m1.rating) <span class="keyword">as</span> row_num,</span><br><span class="line">               <span class="built_in">count</span>(<span class="operator">*</span>) <span class="keyword">over</span>() <span class="keyword">as</span> cnt</span><br><span class="line">          <span class="keyword">from</span> movie_ratings m1) m</span><br><span class="line"> <span class="keyword">where</span> m.row_num <span class="keyword">in</span></span><br><span class="line">       (<span class="built_in">floor</span>(cnt <span class="operator">/</span> <span class="number">2</span>) <span class="operator">+</span> <span class="number">1</span>,</span><br><span class="line">        <span class="keyword">case</span> <span class="keyword">when</span> <span class="built_in">mod</span>(cnt, <span class="number">2</span>) <span class="operator">=</span> <span class="number">0</span> <span class="keyword">then</span> cnt <span class="operator">/</span> <span class="number">2</span> <span class="keyword">else</span> <span class="built_in">floor</span>(cnt <span class="operator">/</span> <span class="number">2</span>) <span class="operator">+</span> <span class="number">1</span> <span class="keyword">end</span>);</span><br><span class="line">        </span><br><span class="line">        </span><br><span class="line"><span class="keyword">select</span> <span class="built_in">avg</span>(m.rating)</span><br><span class="line">  <span class="keyword">from</span> (<span class="keyword">select</span> m1.rating,</span><br><span class="line">               <span class="built_in">row_number</span>() <span class="keyword">over</span>(<span class="keyword">order</span> <span class="keyword">by</span> m1.rating) <span class="keyword">as</span> row_num1, <span class="comment">--11, 12, 12, 13, 15, 16, 19, 20</span></span><br><span class="line">               <span class="built_in">row_number</span>() <span class="keyword">over</span>(<span class="keyword">order</span> <span class="keyword">by</span> m1.rating <span class="keyword">desc</span>) <span class="keyword">as</span> row_num2, <span class="comment">--20, 19, 16, 15, 13, 12, 12, 11</span></span><br><span class="line">               <span class="built_in">count</span>(<span class="operator">*</span>) <span class="keyword">over</span>() <span class="keyword">as</span> cnt</span><br><span class="line">          <span class="keyword">from</span> movie_ratings m1) m</span><br><span class="line"> <span class="keyword">where</span> row_num1 <span class="operator">=</span> round(cnt <span class="operator">/</span> <span class="number">2</span>) <span class="comment">--13</span></span><br><span class="line">    <span class="keyword">or</span> row_num2 <span class="operator">=</span> round(cnt <span class="operator">/</span> <span class="number">2</span>); <span class="comment">--15</span></span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line"> <span class="keyword">select</span> <span class="built_in">avg</span>(m.rating)</span><br><span class="line">  <span class="keyword">from</span> (<span class="keyword">select</span> m1.rating,</span><br><span class="line">               <span class="built_in">row_number</span>() <span class="keyword">over</span>(<span class="keyword">order</span> <span class="keyword">by</span> m1.rating) <span class="keyword">as</span> row_num,</span><br><span class="line">               <span class="built_in">count</span>(<span class="operator">*</span>) <span class="keyword">over</span>() <span class="keyword">as</span> cnt</span><br><span class="line">          <span class="keyword">from</span> movie_ratings m1) m</span><br><span class="line"> <span class="keyword">where</span> m.row_num <span class="keyword">between</span> cnt <span class="operator">/</span> <span class="number">2</span> <span class="keyword">and</span> cnt <span class="operator">/</span> <span class="number">2</span> <span class="operator">+</span> <span class="number">1</span>;</span><br></pre></td></tr></table></figure>
<table>
<thead>
<tr>
<th>MEDIAN</th>
</tr>
</thead>
<tbody>
<tr>
<td>14</td>
</tr>
</tbody>
</table>
<h3 id="having-clause-method"><a class="markdownIt-Anchor" href="#having-clause-method">#</a> Having Clause Method</h3>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="built_in">avg</span>(m.rating)</span><br><span class="line">  <span class="keyword">from</span> (<span class="keyword">select</span> m1.rating</span><br><span class="line">          <span class="keyword">from</span> movie_ratings m1, movie_ratings m2</span><br><span class="line">         <span class="keyword">group</span> <span class="keyword">by</span> m1.rating</span><br><span class="line">        <span class="keyword">having</span> <span class="built_in">sum</span>(<span class="keyword">case</span> <span class="keyword">when</span> m1.rating <span class="operator">&lt;=</span> m2.rating <span class="keyword">then</span> <span class="number">1</span> <span class="keyword">else</span> <span class="number">0</span> <span class="keyword">end</span>) <span class="operator">&gt;=</span> <span class="built_in">count</span>(<span class="operator">*</span>) <span class="operator">/</span> <span class="number">2</span> <span class="comment">--11, 12, 12, 13, 15</span></span><br><span class="line">           <span class="keyword">and</span> <span class="built_in">sum</span>(<span class="keyword">case</span> <span class="keyword">when</span> m1.rating <span class="operator">&gt;=</span> m2.rating <span class="keyword">then</span> <span class="number">1</span> <span class="keyword">else</span> <span class="number">0</span> <span class="keyword">end</span>) <span class="operator">&gt;=</span> <span class="built_in">count</span>(<span class="operator">*</span>) <span class="operator">/</span> <span class="number">2</span> <span class="comment">--13, 15, 16, 19, 20</span></span><br><span class="line">        ) m;</span><br></pre></td></tr></table></figure>
<h3 id="median-function-method"><a class="markdownIt-Anchor" href="#median-function-method">#</a> Median Function Method</h3>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> median(rating) <span class="keyword">from</span> movie_ratings;</span><br></pre></td></tr></table></figure>

      <div class="tags">
          <a href="/tags/db/" rel="tag"><i class="ic i-tag"></i> db</a>
      </div>
  </div>

   <footer>

    <div class="meta">
  <span class="item">
    <span class="icon">
      <i class="ic i-calendar-check"></i>
    </span>
    <span class="text">Edited on</span>
    <time title="Modified: 2024-05-29 19:57:54" itemprop="dateModified" datetime="2024-05-29T19:57:54+08:00">2024-05-29</time>
  </span>
</div>

      

  </footer>

</article>

  </div>
  

<div class="post-nav">
    <div class="item left">
      

  <a href="/2024/01/05/oracle-model-clause/" itemprop="url" rel="prev" data-background-image="&#x2F;anime&#x2F;index&#x2F;妖精森林的小不点-2.jpg" title="Oracle MODEL Clause">
  <span class="type">Previous Post</span>
  <span class="category"><i class="ic i-flag"></i> </span>
  <h3>Oracle MODEL Clause</h3>
  </a>

    </div>
    <div class="item right">
      

  <a href="/2024/02/19/oracle-utlfile/" itemprop="url" rel="next" data-background-image="&#x2F;anime&#x2F;index&#x2F;编舟记.jpg" title="Oracle PL&#x2F;SQL UTL_FILE">
  <span class="type">Next Post</span>
  <span class="category"><i class="ic i-flag"></i> </span>
  <h3>Oracle PL/SQL UTL_FILE</h3>
  </a>

    </div>
</div>

  
  <div class="wrap" id="comments"></div>


        </div>
        <div id="sidebar">
          

<div class="inner">

  <div class="panels">
    <div class="inner">
      <div class="contents panel pjax" data-title="Contents">
          <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#select-alternate-records"><span class="toc-number">1.</span> <span class="toc-text"> Select alternate records</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#find-unique-route-cost"><span class="toc-number">2.</span> <span class="toc-text"> Find unique route cost</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#find-similar-name"><span class="toc-number">3.</span> <span class="toc-text"> Find similar name</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#get-diagonal-data"><span class="toc-number">4.</span> <span class="toc-text"> Get diagonal data</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#multi-rows-into-single-row"><span class="toc-number">5.</span> <span class="toc-text"> Multi rows into single row</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#print-each-value-twice"><span class="toc-number">6.</span> <span class="toc-text"> Print each value twice</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#find-max-value-of-columns-and-rows"><span class="toc-number">7.</span> <span class="toc-text"> Find max value of columns and rows</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#print-null-for-recurring-value"><span class="toc-number">8.</span> <span class="toc-text"> Print null for recurring value</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#generate-alphanumeric-sequence"><span class="toc-number">9.</span> <span class="toc-text"> Generate alphanumeric sequence</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#cumulative-sum"><span class="toc-number">10.</span> <span class="toc-text"> Cumulative sum</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#character-occurence-two-times-only"><span class="toc-number">11.</span> <span class="toc-text"> Character occurence two times only</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#find-the-number-of-month-and-days-in-given-year"><span class="toc-number">12.</span> <span class="toc-text"> Find the number of month and days in given year</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#insert-space-between-chars"><span class="toc-number">13.</span> <span class="toc-text"> Insert space between chars</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#re-arrange-digits"><span class="toc-number">14.</span> <span class="toc-text"> Re-arrange digits</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#mask-user-data-with-random-value"><span class="toc-number">15.</span> <span class="toc-text"> Mask user data with random value</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#find-symmetric-set-in-given-x-y-coordinates"><span class="toc-number">16.</span> <span class="toc-text"> Find symmetric set in given x, y coordinates</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#remove-duplicate-values-within-row-of-data"><span class="toc-number">17.</span> <span class="toc-text"> Remove duplicate values within row of data</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#find-consecutive-number"><span class="toc-number">18.</span> <span class="toc-text"> Find consecutive number</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#find-data-from-one-table-that-are-not-exists-in-another-table"><span class="toc-number">19.</span> <span class="toc-text"> Find data from One table that are not exists in Another table</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#generate-symbol"><span class="toc-number">20.</span> <span class="toc-text"> Generate Symbol</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#extract-names-from-mail"><span class="toc-number">21.</span> <span class="toc-text"> Extract names from mail</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#generate-date-range"><span class="toc-number">22.</span> <span class="toc-text"> Generate date range</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#find-saturday-and-sunday"><span class="toc-number">23.</span> <span class="toc-text"> Find Saturday and Sunday</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#find-match-played-won-lost-count"><span class="toc-number">24.</span> <span class="toc-text"> Find Match Played, Won, Lost count</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#find-dice-rolled-combinations-and-the-third-rolled-dice-is-equal-to-sum-of-first-and-second-value"><span class="toc-number">25.</span> <span class="toc-text"> Find dice rolled combinations and the third rolled dice is equal to sum of first and second value</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#sort-the-numbers-in-the-commas-seperated-list"><span class="toc-number">26.</span> <span class="toc-text"> Sort the numbers in the commas seperated list</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#reverse-string"><span class="toc-number">27.</span> <span class="toc-text"> Reverse string</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#consolidate-first-row-and-last-row-second-row-and-second-from-last-row-as-single-row"><span class="toc-number">28.</span> <span class="toc-text"> Consolidate first row and last row, second row and second from last row … as single row</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#fill-the-missing-dates-with-last-not-null-value"><span class="toc-number">29.</span> <span class="toc-text"> Fill the missing dates with last not null value</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#compute-the-start-and-end-value-of-group-in-given-seq"><span class="toc-number">30.</span> <span class="toc-text"> Compute the start and end value of group in given seq</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#expand-the-range-to-sequence-numbers"><span class="toc-number">31.</span> <span class="toc-text"> Expand the range to sequence numbers</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#grouping-the-range-data"><span class="toc-number">32.</span> <span class="toc-text"> Grouping the range data</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#convert-list-of-numbers-to-table-format"><span class="toc-number">33.</span> <span class="toc-text"> Convert list of numbers to table format</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#fetch-emp-hierarchical-data-in-flat-format"><span class="toc-number">34.</span> <span class="toc-text"> Fetch emp hierarchical data in Flat format</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#group-the-emplyees-into-multiple-team"><span class="toc-number">35.</span> <span class="toc-text"> Group the emplyees into multiple team</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#fill-the-missing-months-with-previous-month-salary"><span class="toc-number">36.</span> <span class="toc-text"> Fill the missing months with previous month salary</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#count-number-of-occurences-of-vowels-in-a-string"><span class="toc-number">37.</span> <span class="toc-text"> Count number of occurences of vowels in a string</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#get-all-dates-for-the-given-input-month-and-year"><span class="toc-number">38.</span> <span class="toc-text"> Get all dates for the given input month and year</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#comma-separated-string-into-row-of-data"><span class="toc-number">39.</span> <span class="toc-text"> Comma separated string into row of data</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#find-the-set-of-rows-in-hierarchical-relational-data"><span class="toc-number">40.</span> <span class="toc-text"> Find the set of rows in hierarchical relational data</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#convert-data-representation-in-different-format"><span class="toc-number">41.</span> <span class="toc-text"> Convert data representation in different format</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#determine-whether-two-strings-are-anagram"><span class="toc-number">42.</span> <span class="toc-text"> Determine whether two strings are anagram</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#divide-the-rows-into-groups"><span class="toc-number">43.</span> <span class="toc-text"> Divide the rows into groups</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#compute-group-number-for-repeating-numbers"><span class="toc-number">44.</span> <span class="toc-text"> Compute group number for repeating numbers</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#compute-count-of-group-of-repeating-values"><span class="toc-number">45.</span> <span class="toc-text"> Compute count of group of repeating values</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#concate-previous-row-value-continuously"><span class="toc-number">46.</span> <span class="toc-text"> Concate previous row value continuously</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#generate-integer-series-1n"><span class="toc-number">47.</span> <span class="toc-text"> Generate integer series 1…n</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#integer-table-method"><span class="toc-number">47.1.</span> <span class="toc-text"> Integer Table Method</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#model-method"><span class="toc-number">47.2.</span> <span class="toc-text"> MODEL Method</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#rownum-a-big-table-method"><span class="toc-number">47.3.</span> <span class="toc-text"> ROWNUM + a Big Table Method</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#connect-by-level-method"><span class="toc-number">47.4.</span> <span class="toc-text"> CONNECT BY LEVEL Method</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#cube-method"><span class="toc-number">47.5.</span> <span class="toc-text"> CUBE Method</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#type-constructor-expression-method"><span class="toc-number">47.6.</span> <span class="toc-text"> Type Constructor Expression Method</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#type-constructor-cartesian-product-method"><span class="toc-number">47.7.</span> <span class="toc-text"> Type Constructor + Cartesian Product Method</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#pipelined-function-method"><span class="toc-number">47.8.</span> <span class="toc-text"> Pipelined Function Method</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#table-function-method"><span class="toc-number">47.9.</span> <span class="toc-text"> Table Function Method</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#xml-method"><span class="toc-number">47.10.</span> <span class="toc-text"> XML Method</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#with-cte-method"><span class="toc-number">47.11.</span> <span class="toc-text"> WITH CTE Method</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#split-string-to-rows"><span class="toc-number">48.</span> <span class="toc-text"> Split string to rows</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#collection-method"><span class="toc-number">48.1.</span> <span class="toc-text"> Collection Method</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#model-method-2"><span class="toc-number">48.2.</span> <span class="toc-text"> Model Method</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#pipelined-function-method-2"><span class="toc-number">48.3.</span> <span class="toc-text"> Pipelined Function Method</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#java-function-method"><span class="toc-number">48.4.</span> <span class="toc-text"> Java Function Method</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#xml-method-2"><span class="toc-number">48.5.</span> <span class="toc-text"> XML Method</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#calculate-the-median"><span class="toc-number">49.</span> <span class="toc-text"> Calculate the median</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#row_number-window-function-method"><span class="toc-number">49.1.</span> <span class="toc-text"> ROW_NUMBER() Window Function Method</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#having-clause-method"><span class="toc-number">49.2.</span> <span class="toc-text"> Having Clause Method</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#median-function-method"><span class="toc-number">49.3.</span> <span class="toc-text"> Median Function Method</span></a></li></ol></li></ol>
      </div>
      <div class="related panel pjax" data-title="Related">
      </div>
      <div class="overview panel" data-title="Overview">
        <div class="author" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <img class="image" itemprop="image" alt="江边鸟"
      data-src="/images/avatar.jpg">
  <p class="name" itemprop="name">江边鸟</p>
  <div class="description" itemprop="description"></div>
</div>

<nav class="state">
    <div class="item posts">
      <a href="/archives/">
        <span class="count">363</span>
        <span class="name">posts</span>
      </a>
    </div>
    <div class="item categories">
      <a href="/categories/">
        <span class="count">2</span>
        <span class="name">categories</span>
      </a>
    </div>
    <div class="item tags">
      <a href="/tags/">
        <span class="count">51</span>
        <span class="name">tags</span>
      </a>
    </div>
</nav>

<div class="social">
      <span class="exturl item github" data-url="aHR0cHM6Ly9naXRodWIuY29tL2xoY2hlbjc0" title="https:&#x2F;&#x2F;github.com&#x2F;lhchen74"><i class="ic i-github"></i></span>
      <span class="exturl item music" data-url="aHR0cHM6Ly9tdXNpYy4xNjMuY29tLw==" title="https:&#x2F;&#x2F;music.163.com&#x2F;"><i class="ic i-cloud-music"></i></span>
      <span class="exturl item codepen" data-url="aHR0cHM6Ly9jb2RlcGVuLmlvL2xoY2hlbjc0" title="https:&#x2F;&#x2F;codepen.io&#x2F;lhchen74"><i class="ic i-address-card"></i></span>
      <span class="exturl item anki" data-url="aHR0cHM6Ly9hbmtpd2ViLm5ldC9kZWNrcy8=" title="https:&#x2F;&#x2F;ankiweb.net&#x2F;decks&#x2F;"><i class="ic i-address-card"></i></span>
</div>

<ul class="menu">
  
    
  <li class="item">
    <a href="/" rel="section"><i class="ic i-home"></i>Home</a>
  </li>

    
  <li class="item">
    <a href="/about/" rel="section"><i class="ic i-user"></i>About</a>
  </li>

        
  <li class="item dropdown">
      <a href="javascript:void(0);"><i class="ic i-feather"></i>Posts</a>
    <ul class="submenu">

        
  <li class="item">
    <a href="/archives/" rel="section"><i class="ic i-list-alt"></i>Archives</a>
  </li>

        
  <li class="item">
    <a href="/categories/" rel="section"><i class="ic i-th"></i>Categories</a>
  </li>

        
  <li class="item">
    <a href="/tags/" rel="section"><i class="ic i-tags"></i>Tags</a>
  </li>

  </ul>
    
  <li class="item">
    <a href="/friends/" rel="section"><i class="ic i-heart"></i>Friends</a>
  </li>

    
  <li class="item">
    <a href="/anime/" rel="section"><i class="ic i-magic"></i>Anime</a>
  </li>


</ul>

      </div>
    </div>
  </div>

  <ul id="quick">
    <li class="prev pjax">
        <a href="/2024/01/05/oracle-model-clause/" rel="prev" title="Previous Post"><i class="ic i-chevron-left"></i></a>
    </li>
    <li class="up"><i class="ic i-arrow-up"></i></li>
    <li class="down"><i class="ic i-arrow-down"></i></li>
    <li class="next pjax">
        <a href="/2024/02/19/oracle-utlfile/" rel="next" title="Next Post"><i class="ic i-chevron-right"></i></a>
    </li>
    <li class="percent"></li>
  </ul>
</div>


        </div>
        <div class="dimmer"></div>
      </div>
    </main>
    <footer id="footer">
      <div class="inner">
        <div class="widgets">
          

        </div>
        <div class="status">
  <div class="copyright">
    
    &copy; 2010 – 
    <span itemprop="copyrightYear">2024</span>
    <span class="with-love">
      <i class="ic i-sakura rotate"></i>
    </span>
    <span class="author" itemprop="copyrightHolder">江边鸟 @ D E W</span>
  </div>
  <div class="powered-by">
    Powered by <span class="exturl" data-url="aHR0cHM6Ly9oZXhvLmlv">Hexo</span> & Theme.<span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL2FtZWhpbWUvaGV4by10aGVtZS1zaG9rYQ==">Shoka</span>
  </div>
</div>

      </div>
    </footer>
  </div>
<script data-config type="text/javascript">
  var LOCAL = {
    path: '2024/01/09/oralce-practice/',
    favicon: {
      show: "（●´3｀●）Goooood",
      hide: "(´Д｀)Booooom"
    },
    search : {
      placeholder: "Search for Posts",
      empty: "We didn't find any results for the search: ${query}",
      stats: "${hits} results found in ${time} ms"
    },
    valine: true,fancybox: true,
    ignores : [
      function(uri) {
        return uri.includes('#');
      },
      function(uri) {
        return new RegExp(LOCAL.path+"$").test(uri);
      }
    ]
  };
</script>

<script src="https://cdn.polyfill.io/v2/polyfill.js"></script>

<script src="//cdn.jsdelivr.net/combine/npm/pace-js@1.0.2/pace.min.js,npm/pjax@0.2.8/pjax.min.js,npm/whatwg-fetch@3.4.0/dist/fetch.umd.min.js,npm/animejs@3.2.0/lib/anime.min.js,npm/algoliasearch@4/dist/algoliasearch-lite.umd.js,npm/instantsearch.js@4/dist/instantsearch.production.min.js,npm/lozad@1/dist/lozad.min.js,npm/quicklink@2/dist/quicklink.umd.js"></script>

<script src="/js/app.js?v=0.2.5"></script>




</body>
</html>
